name: raw.orders
type: ingestr

description: Ingest OLTP orders from Postgres into DuckDB raw layer.

parameters:
  source_connection: pg-default
  source_table: "public.orders"
  destination: duckdb

columns:
  - name: id
    type: integer
    primary_key: true
    checks:
      - name: not_null
      - name: unique
      - name: positive
  - name: customer_id
    type: integer
    checks:
      - name: not_null
      - name: positive
  - name: order_date
    type: timestamp
    checks:
      - name: not_null
  - name: status
    type: string
    checks:
      - name: not_null
      - name: accepted_values
        value: [ 'pending', 'paid', 'cancelled', 'shipped' ]
  - name: total_amount
    type: numeric
    checks:
      - name: not_null
      - name: range
        min: 0
  - name: created_at
    type: timestamp
    checks:
      - name: not_null
  - name: updated_at
    type: timestamp
    checks:
      - name: not_null

