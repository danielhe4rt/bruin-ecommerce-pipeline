[{"data":1,"prerenderedAt":15863},["ShallowReactive",2],{"navigation":3,"/tutorials/ecommerce-pipeline":23,"/tutorials/ecommerce-pipeline-surround":15860},[4,13],{"title":5,"path":6,"stem":7,"children":8,"icon":12},"Getting Started","/getting-started","1.getting-started/1.index",[9],{"title":10,"path":6,"stem":7,"icon":11},"Introduction","i-lucide-house",false,{"title":14,"path":15,"stem":16,"children":17,"page":12},"Tutorials","/tutorials","2.tutorials",[18],{"title":19,"path":20,"stem":21,"icon":22},"E-commerce Showcase","/tutorials/ecommerce-pipeline","2.tutorials/1.ecommerce-pipeline","i-lucide-shopping-cart",{"id":24,"title":19,"body":25,"description":15853,"extension":15854,"links":15855,"meta":15856,"navigation":15857,"path":20,"seo":15858,"stem":21,"__hash__":15859},"docs/2.tutorials/1.ecommerce-pipeline.md",{"type":26,"value":27,"toc":15842},"minimark",[28,1972,1980,2016,2023,2027,2052,2079,2082,2109,2112,2116,2127,2134,2208,2211,2214,2217,2275,2996,2999,3013,3016,3137,3140,3144,3147,3256,3259,3315,3326,3330,3333,3340,3343,3360,3363,8168,8171,8207,8210,8444,8447,8627,8640,8644,8647,8650,8653,8675,8678,8750,8764,8767,8771,8778,8789,8795,9402,9405,9437,9440,9443,9487,9490,9509,9512,9793,9802,9806,9813,9828,12987,12993,13188,13193,13330,13348,13351,13356,13499,13502,13529,13536,13621,13624,13647,13650,14035,14038,14042,14045,14048,15838],[29,30,32,191,255,912,1008,1110,1193,1463,1816],"code-tree",{"default-value":31},".bruin.yml",[33,34,39],"pre",{"className":35,"code":36,"filename":31,"language":37,"meta":38,"style":38},"language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","default_environment: default\nenvironments:\n    default:\n        connections:\n            postgres:\n                - name: pg-default\n                  username: postgres\n                  password: postgres\n                  host: localhost\n                  port: 5432\n                  database: postgres\n            duckdb:\n                - name: duckdb-default\n                  path: duckdb.db\n","yaml","",[40,41,42,59,68,76,84,92,106,117,127,138,150,160,168,180],"code",{"__ignoreMap":38},[43,44,47,51,55],"span",{"class":45,"line":46},"line",1,[43,48,50],{"class":49},"swJcz","default_environment",[43,52,54],{"class":53},"sMK4o",":",[43,56,58],{"class":57},"sfazB"," default\n",[43,60,62,65],{"class":45,"line":61},2,[43,63,64],{"class":49},"environments",[43,66,67],{"class":53},":\n",[43,69,71,74],{"class":45,"line":70},3,[43,72,73],{"class":49},"    default",[43,75,67],{"class":53},[43,77,79,82],{"class":45,"line":78},4,[43,80,81],{"class":49},"        connections",[43,83,67],{"class":53},[43,85,87,90],{"class":45,"line":86},5,[43,88,89],{"class":49},"            postgres",[43,91,67],{"class":53},[43,93,95,98,101,103],{"class":45,"line":94},6,[43,96,97],{"class":53},"                -",[43,99,100],{"class":49}," name",[43,102,54],{"class":53},[43,104,105],{"class":57}," pg-default\n",[43,107,109,112,114],{"class":45,"line":108},7,[43,110,111],{"class":49},"                  username",[43,113,54],{"class":53},[43,115,116],{"class":57}," postgres\n",[43,118,120,123,125],{"class":45,"line":119},8,[43,121,122],{"class":49},"                  password",[43,124,54],{"class":53},[43,126,116],{"class":57},[43,128,130,133,135],{"class":45,"line":129},9,[43,131,132],{"class":49},"                  host",[43,134,54],{"class":53},[43,136,137],{"class":57}," localhost\n",[43,139,141,144,146],{"class":45,"line":140},10,[43,142,143],{"class":49},"                  port",[43,145,54],{"class":53},[43,147,149],{"class":148},"sbssI"," 5432\n",[43,151,153,156,158],{"class":45,"line":152},11,[43,154,155],{"class":49},"                  database",[43,157,54],{"class":53},[43,159,116],{"class":57},[43,161,163,166],{"class":45,"line":162},12,[43,164,165],{"class":49},"            duckdb",[43,167,67],{"class":53},[43,169,171,173,175,177],{"class":45,"line":170},13,[43,172,97],{"class":53},[43,174,100],{"class":49},[43,176,54],{"class":53},[43,178,179],{"class":57}," duckdb-default\n",[43,181,183,186,188],{"class":45,"line":182},14,[43,184,185],{"class":49},"                  path",[43,187,54],{"class":53},[43,189,190],{"class":57}," duckdb.db\n",[33,192,197],{"className":193,"code":194,"filename":195,"language":196,"meta":38,"style":38},"language-toml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","[project]\nname = \"bruin\"\nversion = \"0.1.0\"\nrequires-python = \">=3.13\"\ndependencies = [\n    \"faker>=37.11.0\",\n    \"psycopg>=3.2.10\",\n]\n\n[project.scripts]\ngenerate-data = \"generate_data:main\"\n","pyproject.toml","toml",[40,198,199,204,209,214,219,224,229,234,239,245,250],{"__ignoreMap":38},[43,200,201],{"class":45,"line":46},[43,202,203],{},"[project]\n",[43,205,206],{"class":45,"line":61},[43,207,208],{},"name = \"bruin\"\n",[43,210,211],{"class":45,"line":70},[43,212,213],{},"version = \"0.1.0\"\n",[43,215,216],{"class":45,"line":78},[43,217,218],{},"requires-python = \">=3.13\"\n",[43,220,221],{"class":45,"line":86},[43,222,223],{},"dependencies = [\n",[43,225,226],{"class":45,"line":94},[43,227,228],{},"    \"faker>=37.11.0\",\n",[43,230,231],{"class":45,"line":108},[43,232,233],{},"    \"psycopg>=3.2.10\",\n",[43,235,236],{"class":45,"line":119},[43,237,238],{},"]\n",[43,240,241],{"class":45,"line":129},[43,242,244],{"emptyLinePlaceholder":243},true,"\n",[43,246,247],{"class":45,"line":140},[43,248,249],{},"[project.scripts]\n",[43,251,252],{"class":45,"line":152},[43,253,254],{},"generate-data = \"generate_data:main\"\n",[33,256,259],{"className":35,"code":257,"filename":258,"language":37,"meta":38,"style":38},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fields for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n      Country:\n        name: country\n        type: string\n      Age:\n        name: age\n        type: integer\n        checks:\n          - name: range\n            min: 0\n","glossary.yml",[40,260,261,268,275,285,292,306,313,320,327,336,342,352,358,365,372,380,390,397,408,415,423,428,436,444,454,462,470,481,492,504,515,523,536,548,556,566,576,586,593,604,612,622,631,641,648,659,667,677,685,693,700,707,717,726,733,744,755,763,773,783,790,801,809,819,828,836,846,855,863,873,882,889,901],{"__ignoreMap":38},[43,262,263,266],{"class":45,"line":46},[43,264,265],{"class":49},"domains",[43,267,67],{"class":53},[43,269,270,273],{"class":45,"line":61},[43,271,272],{"class":49},"  customer-management",[43,274,67],{"class":53},[43,276,277,280,282],{"class":45,"line":70},[43,278,279],{"class":49},"    description",[43,281,54],{"class":53},[43,283,284],{"class":57}," All aspects related to customer data, registration, and account management\n",[43,286,287,290],{"class":45,"line":78},[43,288,289],{"class":49},"    owners",[43,291,67],{"class":53},[43,293,294,297,300,303],{"class":45,"line":86},[43,295,296],{"class":53},"      -",[43,298,299],{"class":53}," \"",[43,301,302],{"class":57},"Data Team",[43,304,305],{"class":53},"\"\n",[43,307,308,311],{"class":45,"line":94},[43,309,310],{"class":49},"    tags",[43,312,67],{"class":53},[43,314,315,317],{"class":45,"line":108},[43,316,296],{"class":53},[43,318,319],{"class":57}," customer\n",[43,321,322,325],{"class":45,"line":119},[43,323,324],{"class":49},"  product-catalog",[43,326,67],{"class":53},[43,328,329,331,333],{"class":45,"line":129},[43,330,279],{"class":49},[43,332,54],{"class":53},[43,334,335],{"class":57}," Product and catalog data including variants and SKUs\n",[43,337,338,340],{"class":45,"line":140},[43,339,289],{"class":49},[43,341,67],{"class":53},[43,343,344,346,348,350],{"class":45,"line":152},[43,345,296],{"class":53},[43,347,299],{"class":53},[43,349,302],{"class":57},[43,351,305],{"class":53},[43,353,354,356],{"class":45,"line":162},[43,355,310],{"class":49},[43,357,67],{"class":53},[43,359,360,362],{"class":45,"line":170},[43,361,296],{"class":53},[43,363,364],{"class":57}," product\n",[43,366,367,369],{"class":45,"line":182},[43,368,296],{"class":53},[43,370,371],{"class":57}," catalog\n",[43,373,375,378],{"class":45,"line":374},15,[43,376,377],{"class":49},"  sales",[43,379,67],{"class":53},[43,381,383,385,387],{"class":45,"line":382},16,[43,384,279],{"class":49},[43,386,54],{"class":53},[43,388,389],{"class":57}," Orders and order items lifecycle data\n",[43,391,393,395],{"class":45,"line":392},17,[43,394,289],{"class":49},[43,396,67],{"class":53},[43,398,400,402,404,406],{"class":45,"line":399},18,[43,401,296],{"class":53},[43,403,299],{"class":53},[43,405,302],{"class":57},[43,407,305],{"class":53},[43,409,411,413],{"class":45,"line":410},19,[43,412,310],{"class":49},[43,414,67],{"class":53},[43,416,418,420],{"class":45,"line":417},20,[43,419,296],{"class":53},[43,421,422],{"class":57}," sales\n",[43,424,426],{"class":45,"line":425},21,[43,427,244],{"emptyLinePlaceholder":243},[43,429,431,434],{"class":45,"line":430},22,[43,432,433],{"class":49},"entities",[43,435,67],{"class":53},[43,437,439,442],{"class":45,"line":438},23,[43,440,441],{"class":49},"  Base",[43,443,67],{"class":53},[43,445,447,449,451],{"class":45,"line":446},24,[43,448,279],{"class":49},[43,450,54],{"class":53},[43,452,453],{"class":57}," Required fields for every Ingestion/Staging step.\n",[43,455,457,460],{"class":45,"line":456},25,[43,458,459],{"class":49},"    attributes",[43,461,67],{"class":53},[43,463,465,468],{"class":45,"line":464},26,[43,466,467],{"class":49},"      ID",[43,469,67],{"class":53},[43,471,473,476,478],{"class":45,"line":472},27,[43,474,475],{"class":49},"        name",[43,477,54],{"class":53},[43,479,480],{"class":57}," id\n",[43,482,484,487,489],{"class":45,"line":483},28,[43,485,486],{"class":49},"        type",[43,488,54],{"class":53},[43,490,491],{"class":57}," integer\n",[43,493,495,498,500],{"class":45,"line":494},29,[43,496,497],{"class":49},"        primary_key",[43,499,54],{"class":53},[43,501,503],{"class":502},"sfNiH"," true\n",[43,505,507,510,512],{"class":45,"line":506},30,[43,508,509],{"class":49},"        description",[43,511,54],{"class":53},[43,513,514],{"class":57}," The unique identifier in our systems.\n",[43,516,518,521],{"class":45,"line":517},31,[43,519,520],{"class":49},"        checks",[43,522,67],{"class":53},[43,524,526,529,531,533],{"class":45,"line":525},32,[43,527,528],{"class":53},"          -",[43,530,100],{"class":49},[43,532,54],{"class":53},[43,534,535],{"class":57}," not_null\n",[43,537,539,541,543,545],{"class":45,"line":538},33,[43,540,528],{"class":53},[43,542,100],{"class":49},[43,544,54],{"class":53},[43,546,547],{"class":57}," unique\n",[43,549,551,554],{"class":45,"line":550},34,[43,552,553],{"class":49},"      CreatedAt",[43,555,67],{"class":53},[43,557,559,561,563],{"class":45,"line":558},35,[43,560,475],{"class":49},[43,562,54],{"class":53},[43,564,565],{"class":57}," created_at\n",[43,567,569,571,573],{"class":45,"line":568},36,[43,570,486],{"class":49},[43,572,54],{"class":53},[43,574,575],{"class":57}," timestamp\n",[43,577,579,581,583],{"class":45,"line":578},37,[43,580,509],{"class":49},[43,582,54],{"class":53},[43,584,585],{"class":57}," Timestamp when the record was created.\n",[43,587,589,591],{"class":45,"line":588},38,[43,590,520],{"class":49},[43,592,67],{"class":53},[43,594,596,598,600,602],{"class":45,"line":595},39,[43,597,528],{"class":53},[43,599,100],{"class":49},[43,601,54],{"class":53},[43,603,535],{"class":57},[43,605,607,610],{"class":45,"line":606},40,[43,608,609],{"class":49},"      UpdatedAt",[43,611,67],{"class":53},[43,613,615,617,619],{"class":45,"line":614},41,[43,616,475],{"class":49},[43,618,54],{"class":53},[43,620,621],{"class":57}," updated_at\n",[43,623,625,627,629],{"class":45,"line":624},42,[43,626,486],{"class":49},[43,628,54],{"class":53},[43,630,575],{"class":57},[43,632,634,636,638],{"class":45,"line":633},43,[43,635,509],{"class":49},[43,637,54],{"class":53},[43,639,640],{"class":57}," Timestamp when the record was last updated.\n",[43,642,644,646],{"class":45,"line":643},44,[43,645,520],{"class":49},[43,647,67],{"class":53},[43,649,651,653,655,657],{"class":45,"line":650},45,[43,652,528],{"class":53},[43,654,100],{"class":49},[43,656,54],{"class":53},[43,658,535],{"class":57},[43,660,662,665],{"class":45,"line":661},46,[43,663,664],{"class":49},"  Customer",[43,666,67],{"class":53},[43,668,670,672,674],{"class":45,"line":669},47,[43,671,279],{"class":49},[43,673,54],{"class":53},[43,675,676],{"class":57}," Customer is an individual/business registered on our platform.\n",[43,678,680,683],{"class":45,"line":679},48,[43,681,682],{"class":49},"    domains",[43,684,67],{"class":53},[43,686,688,690],{"class":45,"line":687},49,[43,689,296],{"class":53},[43,691,692],{"class":57}," customer-management\n",[43,694,696,698],{"class":45,"line":695},50,[43,697,459],{"class":49},[43,699,67],{"class":53},[43,701,703,705],{"class":45,"line":702},51,[43,704,467],{"class":49},[43,706,67],{"class":53},[43,708,710,712,714],{"class":45,"line":709},52,[43,711,475],{"class":49},[43,713,54],{"class":53},[43,715,716],{"class":57}," customer_id\n",[43,718,720,722,724],{"class":45,"line":719},53,[43,721,486],{"class":49},[43,723,54],{"class":53},[43,725,491],{"class":57},[43,727,729,731],{"class":45,"line":728},54,[43,730,520],{"class":49},[43,732,67],{"class":53},[43,734,736,738,740,742],{"class":45,"line":735},55,[43,737,528],{"class":53},[43,739,100],{"class":49},[43,741,54],{"class":53},[43,743,535],{"class":57},[43,745,747,749,751,753],{"class":45,"line":746},56,[43,748,528],{"class":53},[43,750,100],{"class":49},[43,752,54],{"class":53},[43,754,547],{"class":57},[43,756,758,761],{"class":45,"line":757},57,[43,759,760],{"class":49},"      Email",[43,762,67],{"class":53},[43,764,766,768,770],{"class":45,"line":765},58,[43,767,475],{"class":49},[43,769,54],{"class":53},[43,771,772],{"class":57}," email\n",[43,774,776,778,780],{"class":45,"line":775},59,[43,777,486],{"class":49},[43,779,54],{"class":53},[43,781,782],{"class":57}," string\n",[43,784,786,788],{"class":45,"line":785},60,[43,787,520],{"class":49},[43,789,67],{"class":53},[43,791,793,795,797,799],{"class":45,"line":792},61,[43,794,528],{"class":53},[43,796,100],{"class":49},[43,798,54],{"class":53},[43,800,535],{"class":57},[43,802,804,807],{"class":45,"line":803},62,[43,805,806],{"class":49},"      FullName",[43,808,67],{"class":53},[43,810,812,814,816],{"class":45,"line":811},63,[43,813,475],{"class":49},[43,815,54],{"class":53},[43,817,818],{"class":57}," full_name\n",[43,820,822,824,826],{"class":45,"line":821},64,[43,823,486],{"class":49},[43,825,54],{"class":53},[43,827,782],{"class":57},[43,829,831,834],{"class":45,"line":830},65,[43,832,833],{"class":49},"      Country",[43,835,67],{"class":53},[43,837,839,841,843],{"class":45,"line":838},66,[43,840,475],{"class":49},[43,842,54],{"class":53},[43,844,845],{"class":57}," country\n",[43,847,849,851,853],{"class":45,"line":848},67,[43,850,486],{"class":49},[43,852,54],{"class":53},[43,854,782],{"class":57},[43,856,858,861],{"class":45,"line":857},68,[43,859,860],{"class":49},"      Age",[43,862,67],{"class":53},[43,864,866,868,870],{"class":45,"line":865},69,[43,867,475],{"class":49},[43,869,54],{"class":53},[43,871,872],{"class":57}," age\n",[43,874,876,878,880],{"class":45,"line":875},70,[43,877,486],{"class":49},[43,879,54],{"class":53},[43,881,491],{"class":57},[43,883,885,887],{"class":45,"line":884},71,[43,886,520],{"class":49},[43,888,67],{"class":53},[43,890,892,894,896,898],{"class":45,"line":891},72,[43,893,528],{"class":53},[43,895,100],{"class":49},[43,897,54],{"class":53},[43,899,900],{"class":57}," range\n",[43,902,904,907,909],{"class":45,"line":903},73,[43,905,906],{"class":49},"            min",[43,908,54],{"class":53},[43,910,911],{"class":148}," 0\n",[33,913,916],{"className":35,"code":914,"filename":915,"language":37,"meta":38,"style":38},"name: orders_performance\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\nvariables:\n  all_time:\n    type: int\n    default: 1 # 0 for all time - 1 to enable start_date and end_date\n","orders-performance/pipeline.yml",[40,917,918,928,932,939,953,967,971,978,985,995],{"__ignoreMap":38},[43,919,920,923,925],{"class":45,"line":46},[43,921,922],{"class":49},"name",[43,924,54],{"class":53},[43,926,927],{"class":57}," orders_performance\n",[43,929,930],{"class":45,"line":61},[43,931,244],{"emptyLinePlaceholder":243},[43,933,934,937],{"class":45,"line":70},[43,935,936],{"class":49},"default_connections",[43,938,67],{"class":53},[43,940,941,944,946,948,951],{"class":45,"line":78},[43,942,943],{"class":49},"  duckdb",[43,945,54],{"class":53},[43,947,299],{"class":53},[43,949,950],{"class":57},"duckdb-default",[43,952,305],{"class":53},[43,954,955,958,960,962,965],{"class":45,"line":86},[43,956,957],{"class":49},"  postgres",[43,959,54],{"class":53},[43,961,299],{"class":53},[43,963,964],{"class":57},"pg-default",[43,966,305],{"class":53},[43,968,969],{"class":45,"line":94},[43,970,244],{"emptyLinePlaceholder":243},[43,972,973,976],{"class":45,"line":108},[43,974,975],{"class":49},"variables",[43,977,67],{"class":53},[43,979,980,983],{"class":45,"line":119},[43,981,982],{"class":49},"  all_time",[43,984,67],{"class":53},[43,986,987,990,992],{"class":45,"line":129},[43,988,989],{"class":49},"    type",[43,991,54],{"class":53},[43,993,994],{"class":57}," int\n",[43,996,997,999,1001,1004],{"class":45,"line":140},[43,998,73],{"class":49},[43,1000,54],{"class":53},[43,1002,1003],{"class":148}," 1",[43,1005,1007],{"class":1006},"sHwdD"," # 0 for all time - 1 to enable start_date and end_date\n",[33,1009,1012],{"className":35,"code":1010,"filename":1011,"language":37,"meta":38,"style":38},"name: raw.customers\ntype: ingestr\n\ndescription: Ingest OLTP customers from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.customers\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.customers.asset.yml",[40,1013,1014,1023,1033,1037,1047,1051,1058,1066,1070,1077,1086,1100],{"__ignoreMap":38},[43,1015,1016,1018,1020],{"class":45,"line":46},[43,1017,922],{"class":49},[43,1019,54],{"class":53},[43,1021,1022],{"class":57}," raw.customers\n",[43,1024,1025,1028,1030],{"class":45,"line":61},[43,1026,1027],{"class":49},"type",[43,1029,54],{"class":53},[43,1031,1032],{"class":57}," ingestr\n",[43,1034,1035],{"class":45,"line":70},[43,1036,244],{"emptyLinePlaceholder":243},[43,1038,1039,1042,1044],{"class":45,"line":78},[43,1040,1041],{"class":49},"description",[43,1043,54],{"class":53},[43,1045,1046],{"class":57}," Ingest OLTP customers from Postgres into DuckDB raw layer.\n",[43,1048,1049],{"class":45,"line":86},[43,1050,244],{"emptyLinePlaceholder":243},[43,1052,1053,1056],{"class":45,"line":94},[43,1054,1055],{"class":49},"tags",[43,1057,67],{"class":53},[43,1059,1060,1063],{"class":45,"line":108},[43,1061,1062],{"class":53},"  -",[43,1064,1065],{"class":57}," raw\n",[43,1067,1068],{"class":45,"line":119},[43,1069,244],{"emptyLinePlaceholder":243},[43,1071,1072,1075],{"class":45,"line":129},[43,1073,1074],{"class":49},"parameters",[43,1076,67],{"class":53},[43,1078,1079,1082,1084],{"class":45,"line":140},[43,1080,1081],{"class":49},"  source_connection",[43,1083,54],{"class":53},[43,1085,105],{"class":57},[43,1087,1088,1091,1093,1095,1098],{"class":45,"line":152},[43,1089,1090],{"class":49},"  source_table",[43,1092,54],{"class":53},[43,1094,299],{"class":53},[43,1096,1097],{"class":57},"public.customers",[43,1099,305],{"class":53},[43,1101,1102,1105,1107],{"class":45,"line":162},[43,1103,1104],{"class":49},"  destination",[43,1106,54],{"class":53},[43,1108,1109],{"class":57}," duckdb\n",[33,1111,1114],{"className":35,"code":1112,"filename":1113,"language":37,"meta":38,"style":38},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n","orders-performance/assets/ingestion/raw.orders.asset.yml",[40,1115,1116,1125,1133,1142,1146,1152,1158,1162,1168,1176,1184],{"__ignoreMap":38},[43,1117,1118,1120,1122],{"class":45,"line":46},[43,1119,922],{"class":49},[43,1121,54],{"class":53},[43,1123,1124],{"class":57}," raw.orders\n",[43,1126,1127,1129,1131],{"class":45,"line":61},[43,1128,1027],{"class":49},[43,1130,54],{"class":53},[43,1132,1032],{"class":57},[43,1134,1135,1137,1139],{"class":45,"line":70},[43,1136,1041],{"class":49},[43,1138,54],{"class":53},[43,1140,1141],{"class":57}," Ingest OLTP orders from Postgres into DuckDB raw layer.\n",[43,1143,1144],{"class":45,"line":78},[43,1145,244],{"emptyLinePlaceholder":243},[43,1147,1148,1150],{"class":45,"line":86},[43,1149,1055],{"class":49},[43,1151,67],{"class":53},[43,1153,1154,1156],{"class":45,"line":94},[43,1155,1062],{"class":53},[43,1157,1065],{"class":57},[43,1159,1160],{"class":45,"line":108},[43,1161,244],{"emptyLinePlaceholder":243},[43,1163,1164,1166],{"class":45,"line":119},[43,1165,1074],{"class":49},[43,1167,67],{"class":53},[43,1169,1170,1172,1174],{"class":45,"line":129},[43,1171,1104],{"class":49},[43,1173,54],{"class":53},[43,1175,1109],{"class":57},[43,1177,1178,1180,1182],{"class":45,"line":140},[43,1179,1081],{"class":49},[43,1181,54],{"class":53},[43,1183,105],{"class":57},[43,1185,1186,1188,1190],{"class":45,"line":152},[43,1187,1090],{"class":49},[43,1189,54],{"class":53},[43,1191,1192],{"class":57}," public.orders\n",[33,1194,1199],{"className":1195,"code":1196,"filename":1197,"language":1198,"meta":38,"style":38},"language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","/* @bruin\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n@bruin */\n\nWITH src AS (\n  SELECT CASE\n            WHEN age \u003C 25 THEN '18-24'\n            WHEN age BETWEEN 25 AND 34 THEN '25-34'\n            WHEN age BETWEEN 35 AND 49 THEN '35-49'\n            ELSE '50+'\n         END AS age_group\n  FROM stg.customers\n)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","orders-performance/assets/mart/customers/mart.customers_by_age.asset.sql","sql",[40,1200,1201,1206,1211,1216,1221,1226,1231,1236,1241,1246,1251,1256,1261,1266,1270,1285,1293,1319,1345,1370,1382,1393,1401,1406,1414,1434,1442,1449],{"__ignoreMap":38},[43,1202,1203],{"class":45,"line":46},[43,1204,1205],{"class":1006},"/* @bruin\n",[43,1207,1208],{"class":45,"line":61},[43,1209,1210],{"class":1006},"name: mart.customers_by_age\n",[43,1212,1213],{"class":45,"line":70},[43,1214,1215],{"class":1006},"type: duckdb.sql\n",[43,1217,1218],{"class":45,"line":78},[43,1219,1220],{"class":1006},"tags:\n",[43,1222,1223],{"class":45,"line":86},[43,1224,1225],{"class":1006},"  - mart\n",[43,1227,1228],{"class":45,"line":94},[43,1229,1230],{"class":1006},"  - amazing-tag\n",[43,1232,1233],{"class":45,"line":108},[43,1234,1235],{"class":1006},"materialization:\n",[43,1237,1238],{"class":45,"line":119},[43,1239,1240],{"class":1006},"  type: table\n",[43,1242,1243],{"class":45,"line":129},[43,1244,1245],{"class":1006},"  strategy: create+replace\n",[43,1247,1248],{"class":45,"line":140},[43,1249,1250],{"class":1006},"depends:\n",[43,1252,1253],{"class":45,"line":152},[43,1254,1255],{"class":1006},"  - stg.customers\n",[43,1257,1258],{"class":45,"line":162},[43,1259,1260],{"class":1006},"owner: danielhe4rt@gmail.com\n",[43,1262,1263],{"class":45,"line":170},[43,1264,1265],{"class":1006},"@bruin */\n",[43,1267,1268],{"class":45,"line":182},[43,1269,244],{"emptyLinePlaceholder":243},[43,1271,1272,1275,1279,1282],{"class":45,"line":374},[43,1273,1274],{"class":148},"WITH",[43,1276,1278],{"class":1277},"sTEyZ"," src ",[43,1280,1281],{"class":148},"AS",[43,1283,1284],{"class":1277}," (\n",[43,1286,1287,1290],{"class":45,"line":382},[43,1288,1289],{"class":148},"  SELECT",[43,1291,1292],{"class":148}," CASE\n",[43,1294,1295,1298,1301,1304,1307,1310,1313,1316],{"class":45,"line":392},[43,1296,1297],{"class":148},"            WHEN",[43,1299,1300],{"class":1277}," age ",[43,1302,1303],{"class":53},"\u003C",[43,1305,1306],{"class":148}," 25",[43,1308,1309],{"class":148}," THEN",[43,1311,1312],{"class":53}," '",[43,1314,1315],{"class":57},"18-24",[43,1317,1318],{"class":53},"'\n",[43,1320,1321,1323,1325,1328,1330,1333,1336,1338,1340,1343],{"class":45,"line":399},[43,1322,1297],{"class":148},[43,1324,1300],{"class":1277},[43,1326,1327],{"class":148},"BETWEEN",[43,1329,1306],{"class":148},[43,1331,1332],{"class":148}," AND",[43,1334,1335],{"class":148}," 34",[43,1337,1309],{"class":148},[43,1339,1312],{"class":53},[43,1341,1342],{"class":57},"25-34",[43,1344,1318],{"class":53},[43,1346,1347,1349,1351,1353,1356,1358,1361,1363,1365,1368],{"class":45,"line":410},[43,1348,1297],{"class":148},[43,1350,1300],{"class":1277},[43,1352,1327],{"class":148},[43,1354,1355],{"class":148}," 35",[43,1357,1332],{"class":148},[43,1359,1360],{"class":148}," 49",[43,1362,1309],{"class":148},[43,1364,1312],{"class":53},[43,1366,1367],{"class":57},"35-49",[43,1369,1318],{"class":53},[43,1371,1372,1375,1377,1380],{"class":45,"line":417},[43,1373,1374],{"class":148},"            ELSE",[43,1376,1312],{"class":53},[43,1378,1379],{"class":57},"50+",[43,1381,1318],{"class":53},[43,1383,1384,1387,1390],{"class":45,"line":425},[43,1385,1386],{"class":148},"         END",[43,1388,1389],{"class":148}," AS",[43,1391,1392],{"class":1277}," age_group\n",[43,1394,1395,1398],{"class":45,"line":430},[43,1396,1397],{"class":148},"  FROM",[43,1399,1400],{"class":1277}," stg.customers\n",[43,1402,1403],{"class":45,"line":438},[43,1404,1405],{"class":1277},")\n",[43,1407,1408,1411],{"class":45,"line":446},[43,1409,1410],{"class":148},"SELECT",[43,1412,1413],{"class":1277}," age_group,\n",[43,1415,1416,1420,1423,1426,1429,1431],{"class":45,"line":456},[43,1417,1419],{"class":1418},"s2Zo4","       COUNT",[43,1421,1422],{"class":1277},"(",[43,1424,1425],{"class":53},"*",[43,1427,1428],{"class":1277},") ",[43,1430,1281],{"class":148},[43,1432,1433],{"class":1277}," total_customers\n",[43,1435,1436,1439],{"class":45,"line":464},[43,1437,1438],{"class":148},"FROM",[43,1440,1441],{"class":1277}," src\n",[43,1443,1444,1447],{"class":45,"line":472},[43,1445,1446],{"class":148},"GROUP BY",[43,1448,1392],{"class":1277},[43,1450,1451,1454,1457,1460],{"class":45,"line":483},[43,1452,1453],{"class":148},"ORDER BY",[43,1455,1456],{"class":1277}," total_customers ",[43,1458,1459],{"class":148},"DESC",[43,1461,1462],{"class":1277},";\n",[33,1464,1467],{"className":1195,"code":1465,"filename":1466,"language":1198,"meta":38,"style":38},"/* @bruin\nname: mart.product_performance\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n),\nitems_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","orders-performance/assets/mart/products/mart.product_performance.asset.sql",[40,1468,1469,1473,1478,1482,1486,1490,1494,1498,1503,1508,1513,1518,1522,1526,1537,1547,1554,1574,1608,1613,1622,1627,1632,1637,1642,1649,1666,1670,1675,1680,1690,1695,1708,1720,1764,1771,1789,1805],{"__ignoreMap":38},[43,1470,1471],{"class":45,"line":46},[43,1472,1205],{"class":1006},[43,1474,1475],{"class":45,"line":61},[43,1476,1477],{"class":1006},"name: mart.product_performance\n",[43,1479,1480],{"class":45,"line":70},[43,1481,1215],{"class":1006},[43,1483,1484],{"class":45,"line":78},[43,1485,1235],{"class":1006},[43,1487,1488],{"class":45,"line":86},[43,1489,1240],{"class":1006},[43,1491,1492],{"class":45,"line":94},[43,1493,1245],{"class":1006},[43,1495,1496],{"class":45,"line":108},[43,1497,1250],{"class":1006},[43,1499,1500],{"class":45,"line":119},[43,1501,1502],{"class":1006},"  - stg.products\n",[43,1504,1505],{"class":45,"line":129},[43,1506,1507],{"class":1006},"  - stg.product_variants\n",[43,1509,1510],{"class":45,"line":140},[43,1511,1512],{"class":1006},"  - stg.order_items\n",[43,1514,1515],{"class":45,"line":152},[43,1516,1517],{"class":1006},"  - stg.orders\n",[43,1519,1520],{"class":45,"line":162},[43,1521,1265],{"class":1006},[43,1523,1524],{"class":45,"line":170},[43,1525,244],{"emptyLinePlaceholder":243},[43,1527,1528,1530,1533,1535],{"class":45,"line":182},[43,1529,1274],{"class":148},[43,1531,1532],{"class":1277}," paid_items ",[43,1534,1281],{"class":148},[43,1536,1284],{"class":1277},[43,1538,1539,1541,1544],{"class":45,"line":374},[43,1540,1289],{"class":148},[43,1542,1543],{"class":1277}," oi.",[43,1545,1546],{"class":53},"*\n",[43,1548,1549,1551],{"class":45,"line":382},[43,1550,1397],{"class":148},[43,1552,1553],{"class":1277}," stg.order_items oi\n",[43,1555,1556,1559,1562,1565,1568,1571],{"class":45,"line":392},[43,1557,1558],{"class":148},"  JOIN",[43,1560,1561],{"class":1277}," stg.orders o ",[43,1563,1564],{"class":148},"ON",[43,1566,1567],{"class":1277}," o.order_id ",[43,1569,1570],{"class":53},"=",[43,1572,1573],{"class":1277}," oi.order_id\n",[43,1575,1576,1579,1582,1585,1588,1591,1594,1596,1599,1601,1604,1606],{"class":45,"line":399},[43,1577,1578],{"class":148},"  WHERE",[43,1580,1581],{"class":1277}," o.status ",[43,1583,1584],{"class":148},"IN",[43,1586,1587],{"class":1277}," (",[43,1589,1590],{"class":53},"'",[43,1592,1593],{"class":57},"paid",[43,1595,1590],{"class":53},[43,1597,1598],{"class":1277},",",[43,1600,1590],{"class":53},[43,1602,1603],{"class":57},"shipped",[43,1605,1590],{"class":53},[43,1607,1405],{"class":1277},[43,1609,1610],{"class":45,"line":410},[43,1611,1612],{"class":1277},"),\n",[43,1614,1615,1618,1620],{"class":45,"line":417},[43,1616,1617],{"class":1277},"items_with_product ",[43,1619,1281],{"class":148},[43,1621,1284],{"class":1277},[43,1623,1624],{"class":45,"line":425},[43,1625,1626],{"class":148},"  SELECT\n",[43,1628,1629],{"class":45,"line":430},[43,1630,1631],{"class":1277},"    v.product_id,\n",[43,1633,1634],{"class":45,"line":438},[43,1635,1636],{"class":1277},"    oi.quantity,\n",[43,1638,1639],{"class":45,"line":446},[43,1640,1641],{"class":1277},"    oi.total_price\n",[43,1643,1644,1646],{"class":45,"line":456},[43,1645,1397],{"class":148},[43,1647,1648],{"class":1277}," paid_items oi\n",[43,1650,1651,1653,1656,1658,1661,1663],{"class":45,"line":464},[43,1652,1558],{"class":148},[43,1654,1655],{"class":1277}," stg.product_variants v ",[43,1657,1564],{"class":148},[43,1659,1660],{"class":1277}," v.variant_id ",[43,1662,1570],{"class":53},[43,1664,1665],{"class":1277}," oi.variant_id\n",[43,1667,1668],{"class":45,"line":472},[43,1669,1405],{"class":1277},[43,1671,1672],{"class":45,"line":483},[43,1673,1674],{"class":148},"SELECT\n",[43,1676,1677],{"class":45,"line":494},[43,1678,1679],{"class":1277},"  p.product_id,\n",[43,1681,1682,1685,1687],{"class":45,"line":506},[43,1683,1684],{"class":1277},"  p.name ",[43,1686,1281],{"class":148},[43,1688,1689],{"class":1277}," product_name,\n",[43,1691,1692],{"class":45,"line":517},[43,1693,1694],{"class":1277},"  p.category,\n",[43,1696,1697,1700,1703,1705],{"class":45,"line":525},[43,1698,1699],{"class":1418},"  SUM",[43,1701,1702],{"class":1277},"(i.quantity) ",[43,1704,1281],{"class":148},[43,1706,1707],{"class":1277}," items_sold,\n",[43,1709,1710,1712,1715,1717],{"class":45,"line":538},[43,1711,1699],{"class":1418},[43,1713,1714],{"class":1277},"(i.total_price) ",[43,1716,1281],{"class":148},[43,1718,1719],{"class":1277}," gross_revenue,\n",[43,1721,1722,1725,1728,1731,1733,1735,1738,1740,1742,1745,1747,1749,1752,1754,1756,1759,1761],{"class":45,"line":550},[43,1723,1724],{"class":148},"  CASE",[43,1726,1727],{"class":148}," WHEN",[43,1729,1730],{"class":1418}," SUM",[43,1732,1702],{"class":1277},[43,1734,1570],{"class":53},[43,1736,1737],{"class":148}," 0",[43,1739,1309],{"class":148},[43,1741,1737],{"class":148},[43,1743,1744],{"class":148}," ELSE",[43,1746,1730],{"class":1418},[43,1748,1714],{"class":1277},[43,1750,1751],{"class":53},"/",[43,1753,1730],{"class":1418},[43,1755,1702],{"class":1277},[43,1757,1758],{"class":148},"END",[43,1760,1389],{"class":148},[43,1762,1763],{"class":1277}," avg_item_price\n",[43,1765,1766,1768],{"class":45,"line":558},[43,1767,1438],{"class":148},[43,1769,1770],{"class":1277}," items_with_product i\n",[43,1772,1773,1776,1779,1781,1784,1786],{"class":45,"line":568},[43,1774,1775],{"class":148},"JOIN",[43,1777,1778],{"class":1277}," stg.products p ",[43,1780,1564],{"class":148},[43,1782,1783],{"class":1277}," p.product_id ",[43,1785,1570],{"class":53},[43,1787,1788],{"class":1277}," i.product_id\n",[43,1790,1791,1793,1795,1797,1800,1802],{"class":45,"line":578},[43,1792,1446],{"class":148},[43,1794,1003],{"class":148},[43,1796,1598],{"class":1277},[43,1798,1799],{"class":148},"2",[43,1801,1598],{"class":1277},[43,1803,1804],{"class":148},"3\n",[43,1806,1807,1809,1812,1814],{"class":45,"line":588},[43,1808,1453],{"class":148},[43,1810,1811],{"class":1277}," gross_revenue ",[43,1813,1459],{"class":148},[43,1815,1462],{"class":1277},[33,1817,1820],{"className":1195,"code":1818,"filename":1819,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\n@bruin */\n\nSELECT\n  id::INT AS customer_id,\n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n","orders-performance/assets/staging/stg.customers.asset.sql",[40,1821,1822,1826,1831,1835,1839,1843,1847,1852,1856,1860,1864,1878,1901,1926,1943,1948,1953,1959],{"__ignoreMap":38},[43,1823,1824],{"class":45,"line":46},[43,1825,1205],{"class":1006},[43,1827,1828],{"class":45,"line":61},[43,1829,1830],{"class":1006},"name: stg.customers\n",[43,1832,1833],{"class":45,"line":70},[43,1834,1215],{"class":1006},[43,1836,1837],{"class":45,"line":78},[43,1838,1235],{"class":1006},[43,1840,1841],{"class":45,"line":86},[43,1842,1240],{"class":1006},[43,1844,1845],{"class":45,"line":94},[43,1846,1250],{"class":1006},[43,1848,1849],{"class":45,"line":108},[43,1850,1851],{"class":1006},"  - raw.customers\n",[43,1853,1854],{"class":45,"line":119},[43,1855,1265],{"class":1006},[43,1857,1858],{"class":45,"line":129},[43,1859,244],{"emptyLinePlaceholder":243},[43,1861,1862],{"class":45,"line":140},[43,1863,1674],{"class":148},[43,1865,1866,1869,1873,1875],{"class":45,"line":152},[43,1867,1868],{"class":1277},"  id::",[43,1870,1872],{"class":1871},"spNyl","INT",[43,1874,1389],{"class":148},[43,1876,1877],{"class":1277}," customer_id,\n",[43,1879,1880,1883,1885,1888,1891,1894,1896,1898],{"class":45,"line":162},[43,1881,1882],{"class":1418},"  COALESCE",[43,1884,1422],{"class":1277},[43,1886,1887],{"class":1418},"TRIM",[43,1889,1890],{"class":1277},"(email), ",[43,1892,1893],{"class":53},"''",[43,1895,1428],{"class":1277},[43,1897,1281],{"class":148},[43,1899,1900],{"class":1277}," email,\n",[43,1902,1903,1905,1907,1909,1912,1914,1917,1919,1921,1923],{"class":45,"line":170},[43,1904,1882],{"class":1418},[43,1906,1422],{"class":1277},[43,1908,1887],{"class":1418},[43,1910,1911],{"class":1277},"(country), ",[43,1913,1590],{"class":53},[43,1915,1916],{"class":57},"Unknown",[43,1918,1590],{"class":53},[43,1920,1428],{"class":1277},[43,1922,1281],{"class":148},[43,1924,1925],{"class":1277}," country,\n",[43,1927,1928,1930,1933,1936,1938,1940],{"class":45,"line":182},[43,1929,1882],{"class":1418},[43,1931,1932],{"class":1277},"(age, ",[43,1934,1935],{"class":148},"0",[43,1937,1428],{"class":1277},[43,1939,1281],{"class":148},[43,1941,1942],{"class":1277}," age,\n",[43,1944,1945],{"class":45,"line":374},[43,1946,1947],{"class":1277},"  created_at,\n",[43,1949,1950],{"class":45,"line":382},[43,1951,1952],{"class":1277},"  updated_at\n",[43,1954,1955,1957],{"class":45,"line":392},[43,1956,1438],{"class":148},[43,1958,1022],{"class":1277},[43,1960,1961,1964,1967,1970],{"class":45,"line":399},[43,1962,1963],{"class":148},"WHERE",[43,1965,1966],{"class":1277}," email ",[43,1968,1969],{"class":148},"IS NOT NULL",[43,1971,1462],{"class":1277},[1973,1974,1976],"h2",{"id":1975},"what-this-hands-on-tutorial-covers",[1977,1978,1979],"strong",{},"What this hands-on tutorial covers",[1981,1982,1985,1995,2002,2009],"card-group",{"className":1983},[1984],"w-full",[1986,1987,1991],"card",{"icon":1988,"target":1989,"title":1990},"i-tabler-database-import","_blank","Ingestion Layer",[1992,1993,1994],"p",{},"Learn how to configure Bruin assets for incremental ingestion from Postgres into DuckDB.",[1986,1996,1999],{"icon":1997,"target":1989,"title":1998},"i-tabler-transform","Transformation Layer",[1992,2000,2001],{},"Explore staging and mart patterns that turn raw e-commerce data into usable analytics.",[1986,2003,2006],{"icon":2004,"target":1989,"title":2005},"i-tabler-shield-check","Quality Checks",[1992,2007,2008],{},"Implement column-level and business logic validations to ensure data integrity.",[1986,2010,2013],{"icon":2011,"target":1989,"title":2012},"i-tabler-chart-bar","Analytics & Insights",[1992,2014,2015],{},"Build daily revenue and customer lifetime value dashboards from validated datasets.",[1992,2017,2018,2019,2022],{},"This tutorial is structured to give you a ",[1977,2020,2021],{},"straightforward, engineering-first path"," to building a production-ready analytics pipeline. It’s about understanding how each component — ingestion, transformation, validation, and analysis — fits together under Bruin’s unified workflow.",[1973,2024,2026],{"id":2025},"_1-prerequisites-setup","1) Prerequisites & Setup",[2028,2029,2030,2034,2037,2049],"ul",{},[2031,2032,2033],"li",{},"Docker (for Postgres)",[2031,2035,2036],{},"Python 3.11+",[2031,2038,2039,2042,2043],{},[40,2040,2041],{},"uv"," (fast Python toolchain manager) → ",[2044,2045,2046],"a",{"href":2046,"rel":2047},"https://docs.astral.sh/uv/",[2048],"nofollow",[2031,2050,2051],{},"Git, Bash",[33,2053,2057],{"className":2054,"code":2055,"language":2056,"meta":38,"style":38},"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","git clone https://github.com/danielhe4rt/bruin-ecommerce-pipeline\ncd bruin-ecommerce-pipeline\n","bash",[40,2058,2059,2071],{"__ignoreMap":38},[43,2060,2061,2065,2068],{"class":45,"line":46},[43,2062,2064],{"class":2063},"sBMFI","git",[43,2066,2067],{"class":57}," clone",[43,2069,2070],{"class":57}," https://github.com/danielhe4rt/bruin-ecommerce-pipeline\n",[43,2072,2073,2076],{"class":45,"line":61},[43,2074,2075],{"class":1418},"cd",[43,2077,2078],{"class":57}," bruin-ecommerce-pipeline\n",[1992,2080,2081],{},"Or use the bruin templates directly from the CLI:",[33,2083,2085],{"className":2054,"code":2084,"language":2056,"meta":38,"style":38},"bruin init ecommerce\n\ncd bruin\n",[40,2086,2087,2098,2102],{"__ignoreMap":38},[43,2088,2089,2092,2095],{"class":45,"line":46},[43,2090,2091],{"class":2063},"bruin",[43,2093,2094],{"class":57}," init",[43,2096,2097],{"class":57}," ecommerce\n",[43,2099,2100],{"class":45,"line":61},[43,2101,244],{"emptyLinePlaceholder":243},[43,2103,2104,2106],{"class":45,"line":70},[43,2105,2075],{"class":1418},[43,2107,2108],{"class":57}," bruin\n",[1992,2110,2111],{},"Then, open the project in your favorite code editor and let's get started!",[1973,2113,2115],{"id":2114},"_2-understanding-the-data-model-oltp-analytics","2) Understanding the Data Model (OLTP → Analytics)",[1992,2117,2118,2119,2122,2123,2126],{},"In e-commerce — and most analytics-driven businesses — data pipelines are typically organized into ",[1977,2120,2121],{},"layers",", each\nserving a specific purpose. This layered structure keeps data ",[1977,2124,2125],{},"reliable, interpretable, and adaptable"," as the business\nscales.",[1992,2128,2129,2130,2133],{},"The ultimate goal is to make data analysis effortless and focused on ",[1977,2131,2132],{},"answering real business questions"," across key\ndomains, such as:",[2135,2136,2137,2150],"table",{},[2138,2139,2140],"thead",{},[2141,2142,2143,2147],"tr",{},[2144,2145,2146],"th",{},"Domain",[2144,2148,2149],{},"Analysis Focus",[2151,2152,2153,2164,2174,2184],"tbody",{},[2141,2154,2155,2161],{},[2156,2157,2158],"td",{},[1977,2159,2160],{},"Customers",[2156,2162,2163],{},"Segmentation by age, geography, and behavior patterns",[2141,2165,2166,2171],{},[2156,2167,2168],{},[1977,2169,2170],{},"Products and Product Variants",[2156,2172,2173],{},"Performance by category, profitability, and pricing insights",[2141,2175,2176,2181],{},[2156,2177,2178],{},[1977,2179,2180],{},"Orders and Order Items",[2156,2182,2183],{},"Daily revenue, order volume, and purchasing trends",[2141,2185,2186,2191],{},[2156,2187,2188],{},[1977,2189,2190],{},"KPI layer",[2156,2192,2193,2194,2197,2198,2197,2201,2204,2205],{},"Metrics like ",[1977,2195,2196],{},"AOV",", ",[1977,2199,2200],{},"units per order",[1977,2202,2203],{},"top SKUs",", and ",[1977,2206,2207],{},"repeat purchase rate",[1992,2209,2210],{},"By structuring data this way, teams can move from raw information to actionable insights with clarity and confidence.",[1992,2212,2213],{},"At this tutorial, it's important to understand the data relationships that form the backbone of most e-commerce\nsystems. These relationships define how information flows across entities — from customers placing orders to\nproducts being sold and analyzed.",[1992,2215,2216],{},"Here’s the simplified schema we’ll use throughout this tutorial:",[2135,2218,2219,2232],{},[2138,2220,2221],{},[2141,2222,2223,2226,2229],{},[2144,2224,2225],{},"From",[2144,2227,2228],{},"To",[2144,2230,2231],{},"Relationship Type",[2151,2233,2234,2245,2255,2265],{},[2141,2235,2236,2239,2242],{},[2156,2237,2238],{},"customers(id)",[2156,2240,2241],{},"orders(customer_id)",[2156,2243,2244],{},"1:N (One-to-Many)",[2141,2246,2247,2250,2253],{},[2156,2248,2249],{},"orders(id)",[2156,2251,2252],{},"order_items(order_id)",[2156,2254,2244],{},[2141,2256,2257,2260,2263],{},[2156,2258,2259],{},"products(id)",[2156,2261,2262],{},"product_variants(product_id)",[2156,2264,2244],{},[2141,2266,2267,2270,2273],{},[2156,2268,2269],{},"product_variants(id)",[2156,2271,2272],{},"order_items(variant_id)",[2156,2274,2244],{},[29,2276,2278,2422,2523,2719,2848],{"default-value":2277},"customers.sql",[33,2279,2281],{"className":1195,"code":2280,"filename":2277,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS customers (\n    id          BIGSERIAL PRIMARY KEY,\n    full_name   TEXT        NOT NULL,\n    email       TEXT        NOT NULL UNIQUE,\n    country     TEXT        NOT NULL,\n    age         INTEGER     NOT NULL CHECK (age >= 0),\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n",[40,2282,2283,2303,2317,2330,2344,2355,2379,2401,2417],{"__ignoreMap":38},[43,2284,2285,2288,2291,2294,2297,2300],{"class":45,"line":46},[43,2286,2287],{"class":148},"CREATE",[43,2289,2290],{"class":148}," TABLE",[43,2292,2293],{"class":1418}," IF",[43,2295,2296],{"class":148}," NOT",[43,2298,2299],{"class":148}," EXISTS",[43,2301,2302],{"class":1277}," customers (\n",[43,2304,2305,2308,2311,2314],{"class":45,"line":61},[43,2306,2307],{"class":1277},"    id          ",[43,2309,2310],{"class":1871},"BIGSERIAL",[43,2312,2313],{"class":1871}," PRIMARY KEY",[43,2315,2316],{"class":1277},",\n",[43,2318,2319,2322,2325,2328],{"class":45,"line":70},[43,2320,2321],{"class":1277},"    full_name   ",[43,2323,2324],{"class":1871},"TEXT",[43,2326,2327],{"class":148},"        NOT NULL",[43,2329,2316],{"class":1277},[43,2331,2332,2335,2337,2339,2342],{"class":45,"line":78},[43,2333,2334],{"class":1277},"    email       ",[43,2336,2324],{"class":1871},[43,2338,2327],{"class":148},[43,2340,2341],{"class":148}," UNIQUE",[43,2343,2316],{"class":1277},[43,2345,2346,2349,2351,2353],{"class":45,"line":86},[43,2347,2348],{"class":1277},"    country     ",[43,2350,2324],{"class":1871},[43,2352,2327],{"class":148},[43,2354,2316],{"class":1277},[43,2356,2357,2360,2363,2366,2369,2372,2375,2377],{"class":45,"line":94},[43,2358,2359],{"class":1277},"    age         ",[43,2361,2362],{"class":1871},"INTEGER",[43,2364,2365],{"class":148},"     NOT NULL",[43,2367,2368],{"class":1871}," CHECK",[43,2370,2371],{"class":1277}," (age ",[43,2373,2374],{"class":53},">=",[43,2376,1737],{"class":148},[43,2378,1612],{"class":1277},[43,2380,2381,2384,2387,2390,2393,2396,2399],{"class":45,"line":108},[43,2382,2383],{"class":1277},"    created_at  ",[43,2385,2386],{"class":1871},"TIMESTAMPTZ",[43,2388,2389],{"class":148}," NOT NULL",[43,2391,2392],{"class":1871}," DEFAULT",[43,2394,2395],{"class":148}," now",[43,2397,2398],{"class":53},"()",[43,2400,2316],{"class":1277},[43,2402,2403,2406,2408,2410,2412,2414],{"class":45,"line":119},[43,2404,2405],{"class":1277},"    updated_at  ",[43,2407,2386],{"class":1871},[43,2409,2389],{"class":148},[43,2411,2392],{"class":1871},[43,2413,2395],{"class":148},[43,2415,2416],{"class":53},"()\n",[43,2418,2419],{"class":45,"line":129},[43,2420,2421],{"class":1277},");\n",[33,2423,2426],{"className":1195,"code":2424,"filename":2425,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS products (\n    id          BIGSERIAL PRIMARY KEY,\n    name        TEXT        NOT NULL,\n    category    TEXT        NOT NULL,\n    sku         TEXT        NOT NULL UNIQUE,\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","products.sql",[40,2427,2428,2443,2453,2465,2476,2489,2505,2519],{"__ignoreMap":38},[43,2429,2430,2432,2434,2436,2438,2440],{"class":45,"line":46},[43,2431,2287],{"class":148},[43,2433,2290],{"class":148},[43,2435,2293],{"class":1418},[43,2437,2296],{"class":148},[43,2439,2299],{"class":148},[43,2441,2442],{"class":1277}," products (\n",[43,2444,2445,2447,2449,2451],{"class":45,"line":61},[43,2446,2307],{"class":1277},[43,2448,2310],{"class":1871},[43,2450,2313],{"class":1871},[43,2452,2316],{"class":1277},[43,2454,2455,2458,2461,2463],{"class":45,"line":70},[43,2456,2457],{"class":148},"    name",[43,2459,2460],{"class":1871},"        TEXT",[43,2462,2327],{"class":148},[43,2464,2316],{"class":1277},[43,2466,2467,2470,2472,2474],{"class":45,"line":78},[43,2468,2469],{"class":1277},"    category    ",[43,2471,2324],{"class":1871},[43,2473,2327],{"class":148},[43,2475,2316],{"class":1277},[43,2477,2478,2481,2483,2485,2487],{"class":45,"line":86},[43,2479,2480],{"class":1277},"    sku         ",[43,2482,2324],{"class":1871},[43,2484,2327],{"class":148},[43,2486,2341],{"class":148},[43,2488,2316],{"class":1277},[43,2490,2491,2493,2495,2497,2499,2501,2503],{"class":45,"line":94},[43,2492,2383],{"class":1277},[43,2494,2386],{"class":1871},[43,2496,2389],{"class":148},[43,2498,2392],{"class":1871},[43,2500,2395],{"class":148},[43,2502,2398],{"class":53},[43,2504,2316],{"class":1277},[43,2506,2507,2509,2511,2513,2515,2517],{"class":45,"line":108},[43,2508,2405],{"class":1277},[43,2510,2386],{"class":1871},[43,2512,2389],{"class":148},[43,2514,2392],{"class":1871},[43,2516,2395],{"class":148},[43,2518,2416],{"class":53},[43,2520,2521],{"class":45,"line":119},[43,2522,2421],{"class":1277},[33,2524,2527],{"className":1195,"code":2525,"filename":2526,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS product_variants (\n    id                  BIGSERIAL PRIMARY KEY,\n    product_id          BIGINT         NOT NULL REFERENCES products(id) ON DELETE CASCADE,\n    variant_sku         TEXT           NOT NULL UNIQUE,\n    color               TEXT,\n    size                TEXT,\n    manufacturing_price NUMERIC(10,2)  NOT NULL,\n    selling_price       NUMERIC(10,2)  NOT NULL,\n    stock_quantity      INTEGER        NOT NULL,\n    is_active           BOOLEAN        NOT NULL DEFAULT TRUE,\n    created_at          TIMESTAMPTZ    NOT NULL DEFAULT now(),\n    updated_at          TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","product_variants.sql",[40,2528,2529,2544,2555,2577,2591,2600,2610,2635,2656,2667,2682,2700,2715],{"__ignoreMap":38},[43,2530,2531,2533,2535,2537,2539,2541],{"class":45,"line":46},[43,2532,2287],{"class":148},[43,2534,2290],{"class":148},[43,2536,2293],{"class":1418},[43,2538,2296],{"class":148},[43,2540,2299],{"class":148},[43,2542,2543],{"class":1277}," product_variants (\n",[43,2545,2546,2549,2551,2553],{"class":45,"line":61},[43,2547,2548],{"class":1277},"    id                  ",[43,2550,2310],{"class":1871},[43,2552,2313],{"class":1871},[43,2554,2316],{"class":1277},[43,2556,2557,2560,2563,2566,2569,2572,2575],{"class":45,"line":70},[43,2558,2559],{"class":1277},"    product_id          ",[43,2561,2562],{"class":1871},"BIGINT",[43,2564,2565],{"class":148},"         NOT NULL",[43,2567,2568],{"class":1871}," REFERENCES",[43,2570,2571],{"class":1277}," products(id) ",[43,2573,2574],{"class":1871},"ON DELETE CASCADE",[43,2576,2316],{"class":1277},[43,2578,2579,2582,2584,2587,2589],{"class":45,"line":78},[43,2580,2581],{"class":1277},"    variant_sku         ",[43,2583,2324],{"class":1871},[43,2585,2586],{"class":148},"           NOT NULL",[43,2588,2341],{"class":148},[43,2590,2316],{"class":1277},[43,2592,2593,2596,2598],{"class":45,"line":86},[43,2594,2595],{"class":1277},"    color               ",[43,2597,2324],{"class":1871},[43,2599,2316],{"class":1277},[43,2601,2602,2605,2608],{"class":45,"line":94},[43,2603,2604],{"class":148},"    size",[43,2606,2607],{"class":1871},"                TEXT",[43,2609,2316],{"class":1277},[43,2611,2612,2615,2618,2620,2623,2625,2627,2630,2633],{"class":45,"line":108},[43,2613,2614],{"class":1277},"    manufacturing_price ",[43,2616,2617],{"class":1871},"NUMERIC",[43,2619,1422],{"class":1277},[43,2621,2622],{"class":148},"10",[43,2624,1598],{"class":1277},[43,2626,1799],{"class":148},[43,2628,2629],{"class":1277},")  ",[43,2631,2632],{"class":148},"NOT NULL",[43,2634,2316],{"class":1277},[43,2636,2637,2640,2642,2644,2646,2648,2650,2652,2654],{"class":45,"line":119},[43,2638,2639],{"class":1277},"    selling_price       ",[43,2641,2617],{"class":1871},[43,2643,1422],{"class":1277},[43,2645,2622],{"class":148},[43,2647,1598],{"class":1277},[43,2649,1799],{"class":148},[43,2651,2629],{"class":1277},[43,2653,2632],{"class":148},[43,2655,2316],{"class":1277},[43,2657,2658,2661,2663,2665],{"class":45,"line":129},[43,2659,2660],{"class":1277},"    stock_quantity      ",[43,2662,2362],{"class":1871},[43,2664,2327],{"class":148},[43,2666,2316],{"class":1277},[43,2668,2669,2672,2675,2677,2679],{"class":45,"line":140},[43,2670,2671],{"class":1277},"    is_active           ",[43,2673,2674],{"class":1871},"BOOLEAN",[43,2676,2327],{"class":148},[43,2678,2392],{"class":1871},[43,2680,2681],{"class":1277}," TRUE,\n",[43,2683,2684,2687,2689,2692,2694,2696,2698],{"class":45,"line":152},[43,2685,2686],{"class":1277},"    created_at          ",[43,2688,2386],{"class":1871},[43,2690,2691],{"class":148},"    NOT NULL",[43,2693,2392],{"class":1871},[43,2695,2395],{"class":148},[43,2697,2398],{"class":53},[43,2699,2316],{"class":1277},[43,2701,2702,2705,2707,2709,2711,2713],{"class":45,"line":162},[43,2703,2704],{"class":1277},"    updated_at          ",[43,2706,2386],{"class":1871},[43,2708,2691],{"class":148},[43,2710,2392],{"class":1871},[43,2712,2395],{"class":148},[43,2714,2416],{"class":53},[43,2716,2717],{"class":45,"line":170},[43,2718,2421],{"class":1277},[33,2720,2723],{"className":1195,"code":2721,"filename":2722,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS orders (\n    id            BIGSERIAL PRIMARY KEY,\n    customer_id   BIGINT      NOT NULL REFERENCES customers(id),\n    order_date    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    status        TEXT        NOT NULL,\n    total_amount  NUMERIC(12,2),\n    created_at    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at    TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","orders.sql",[40,2724,2725,2740,2751,2766,2783,2794,2812,2829,2844],{"__ignoreMap":38},[43,2726,2727,2729,2731,2733,2735,2737],{"class":45,"line":46},[43,2728,2287],{"class":148},[43,2730,2290],{"class":148},[43,2732,2293],{"class":1418},[43,2734,2296],{"class":148},[43,2736,2299],{"class":148},[43,2738,2739],{"class":1277}," orders (\n",[43,2741,2742,2745,2747,2749],{"class":45,"line":61},[43,2743,2744],{"class":1277},"    id            ",[43,2746,2310],{"class":1871},[43,2748,2313],{"class":1871},[43,2750,2316],{"class":1277},[43,2752,2753,2756,2758,2761,2763],{"class":45,"line":70},[43,2754,2755],{"class":1277},"    customer_id   ",[43,2757,2562],{"class":1871},[43,2759,2760],{"class":148},"      NOT NULL",[43,2762,2568],{"class":1871},[43,2764,2765],{"class":1277}," customers(id),\n",[43,2767,2768,2771,2773,2775,2777,2779,2781],{"class":45,"line":78},[43,2769,2770],{"class":1277},"    order_date    ",[43,2772,2386],{"class":1871},[43,2774,2389],{"class":148},[43,2776,2392],{"class":1871},[43,2778,2395],{"class":148},[43,2780,2398],{"class":53},[43,2782,2316],{"class":1277},[43,2784,2785,2788,2790,2792],{"class":45,"line":86},[43,2786,2787],{"class":148},"    status",[43,2789,2460],{"class":1871},[43,2791,2327],{"class":148},[43,2793,2316],{"class":1277},[43,2795,2796,2799,2801,2803,2806,2808,2810],{"class":45,"line":94},[43,2797,2798],{"class":1277},"    total_amount  ",[43,2800,2617],{"class":1871},[43,2802,1422],{"class":1277},[43,2804,2805],{"class":148},"12",[43,2807,1598],{"class":1277},[43,2809,1799],{"class":148},[43,2811,1612],{"class":1277},[43,2813,2814,2817,2819,2821,2823,2825,2827],{"class":45,"line":108},[43,2815,2816],{"class":1277},"    created_at    ",[43,2818,2386],{"class":1871},[43,2820,2389],{"class":148},[43,2822,2392],{"class":1871},[43,2824,2395],{"class":148},[43,2826,2398],{"class":53},[43,2828,2316],{"class":1277},[43,2830,2831,2834,2836,2838,2840,2842],{"class":45,"line":119},[43,2832,2833],{"class":1277},"    updated_at    ",[43,2835,2386],{"class":1871},[43,2837,2389],{"class":148},[43,2839,2392],{"class":1871},[43,2841,2395],{"class":148},[43,2843,2416],{"class":53},[43,2845,2846],{"class":45,"line":129},[43,2847,2421],{"class":1277},[33,2849,2852],{"className":1195,"code":2850,"filename":2851,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS order_items (\n    id           BIGSERIAL PRIMARY KEY,\n    order_id     BIGINT         NOT NULL REFERENCES orders(id) ON DELETE CASCADE,\n    variant_id   BIGINT         NOT NULL REFERENCES product_variants(id),\n    quantity     INTEGER        NOT NULL,\n    unit_price   NUMERIC(10,2)  NOT NULL,\n    total_price  NUMERIC(12,2)  GENERATED ALWAYS AS (quantity * unit_price) STORED,\n    created_at   TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","order_items.sql",[40,2853,2854,2869,2880,2898,2912,2923,2944,2977,2992],{"__ignoreMap":38},[43,2855,2856,2858,2860,2862,2864,2866],{"class":45,"line":46},[43,2857,2287],{"class":148},[43,2859,2290],{"class":148},[43,2861,2293],{"class":1418},[43,2863,2296],{"class":148},[43,2865,2299],{"class":148},[43,2867,2868],{"class":1277}," order_items (\n",[43,2870,2871,2874,2876,2878],{"class":45,"line":61},[43,2872,2873],{"class":1277},"    id           ",[43,2875,2310],{"class":1871},[43,2877,2313],{"class":1871},[43,2879,2316],{"class":1277},[43,2881,2882,2885,2887,2889,2891,2894,2896],{"class":45,"line":70},[43,2883,2884],{"class":1277},"    order_id     ",[43,2886,2562],{"class":1871},[43,2888,2565],{"class":148},[43,2890,2568],{"class":1871},[43,2892,2893],{"class":1277}," orders(id) ",[43,2895,2574],{"class":1871},[43,2897,2316],{"class":1277},[43,2899,2900,2903,2905,2907,2909],{"class":45,"line":78},[43,2901,2902],{"class":1277},"    variant_id   ",[43,2904,2562],{"class":1871},[43,2906,2565],{"class":148},[43,2908,2568],{"class":1871},[43,2910,2911],{"class":1277}," product_variants(id),\n",[43,2913,2914,2917,2919,2921],{"class":45,"line":86},[43,2915,2916],{"class":1277},"    quantity     ",[43,2918,2362],{"class":1871},[43,2920,2327],{"class":148},[43,2922,2316],{"class":1277},[43,2924,2925,2928,2930,2932,2934,2936,2938,2940,2942],{"class":45,"line":94},[43,2926,2927],{"class":1277},"    unit_price   ",[43,2929,2617],{"class":1871},[43,2931,1422],{"class":1277},[43,2933,2622],{"class":148},[43,2935,1598],{"class":1277},[43,2937,1799],{"class":148},[43,2939,2629],{"class":1277},[43,2941,2632],{"class":148},[43,2943,2316],{"class":1277},[43,2945,2946,2949,2951,2953,2955,2957,2959,2961,2964,2967,2969,2972,2974],{"class":45,"line":108},[43,2947,2948],{"class":1277},"    total_price  ",[43,2950,2617],{"class":1871},[43,2952,1422],{"class":1277},[43,2954,2805],{"class":148},[43,2956,1598],{"class":1277},[43,2958,1799],{"class":148},[43,2960,2629],{"class":1277},[43,2962,2963],{"class":148},"GENERATED",[43,2965,2966],{"class":148}," ALWAYS",[43,2968,1389],{"class":148},[43,2970,2971],{"class":1277}," (quantity ",[43,2973,1425],{"class":53},[43,2975,2976],{"class":1277}," unit_price) STORED,\n",[43,2978,2979,2982,2984,2986,2988,2990],{"class":45,"line":119},[43,2980,2981],{"class":1277},"    created_at   ",[43,2983,2386],{"class":1871},[43,2985,2691],{"class":148},[43,2987,2392],{"class":1871},[43,2989,2395],{"class":148},[43,2991,2416],{"class":53},[43,2993,2994],{"class":45,"line":129},[43,2995,2421],{"class":1277},[1992,2997,2998],{},"This model mirrors a real-world e-commerce workflow:",[2028,3000,3001,3004,3007,3010],{},[2031,3002,3003],{},"A customer makes one or more orders.",[2031,3005,3006],{},"Each order contains one or more items.",[2031,3008,3009],{},"Each item points to a specific product variant (like a red T-shirt, size M).",[2031,3011,3012],{},"Each variant belongs to a broader product (e.g., “Classic T-Shirt”).",[1992,3014,3015],{},"These foreign key relationships allow us to join datasets efficiently and enable downstream analytics like:",[2135,3017,3018,3031],{},[2138,3019,3020],{},[2141,3021,3022,3025,3028],{},[2144,3023,2146],{"align":3024},"left",[2144,3026,3027],{},"Materialized Table",[2144,3029,3030],{},"Depends On",[2151,3032,3033,3047,3060,3081,3098,3121],{},[2141,3034,3035,3037,3042],{},[2156,3036,2160],{"align":3024},[2156,3038,3039],{},[40,3040,3041],{},"mart.customers_by_age",[2156,3043,3044],{},[40,3045,3046],{},"stg.customers",[2141,3048,3049,3051,3056],{},[2156,3050,2160],{"align":3024},[2156,3052,3053],{},[40,3054,3055],{},"mart.customers_by_country",[2156,3057,3058],{},[40,3059,3046],{},[2141,3061,3062,3065,3070],{},[2156,3063,3064],{"align":3024},"Products",[2156,3066,3067],{},[40,3068,3069],{},"mart.revenue_by_product",[2156,3071,3072,2197,3075,2197,3078],{},[40,3073,3074],{},"raw.order_items",[40,3076,3077],{},"raw.product_variants",[40,3079,3080],{},"raw.products",[2141,3082,3083,3085,3090],{},[2156,3084,3064],{"align":3024},[2156,3086,3087],{},[40,3088,3089],{},"mart.revenue_by_category",[2156,3091,3092,2197,3094,2197,3096],{},[40,3093,3074],{},[40,3095,3077],{},[40,3097,3080],{},[2141,3099,3100,3102,3107],{},[2156,3101,3064],{"align":3024},[2156,3103,3104],{},[40,3105,3106],{},"mart.revenue_by_product_variant",[2156,3108,3109,2197,3112,2197,3115,2197,3118],{},[40,3110,3111],{},"stg.product_variants",[40,3113,3114],{},"stg.order_items",[40,3116,3117],{},"stg.orders",[40,3119,3120],{},"stg.products",[2141,3122,3123,3126,3131],{},[2156,3124,3125],{"align":3024},"Sales",[2156,3127,3128],{},[40,3129,3130],{},"mart.sales_daily",[2156,3132,3133,2197,3135],{},[40,3134,3114],{},[40,3136,3117],{},[1992,3138,3139],{},"By establishing these links early, every layer of the pipeline — raw, staging, and mart — can remain consistent and\ntraceable across transformations.",[1973,3141,3143],{"id":3142},"_3-setting-up-the-source-database-docker-postgres","3) Setting Up the Source Database (Docker + Postgres)",[1992,3145,3146],{},"First, let's spin up our PostgreSQL instance:",[3148,3149,3150,3223,3242],"code-group",{},[33,3151,3154],{"className":2054,"code":3152,"filename":3153,"language":2056,"meta":38,"style":38},"docker run -d \\\n  --name bruin-postgres \\\n  -e POSTGRES_USER=postgres \\\n  -e POSTGRES_PASSWORD=postgres \\\n  -e POSTGRES_DB=postgres \\\n  -p 5432:5432 \\\n  postgres:18-alpine\n","Docker Run",[40,3155,3156,3170,3180,3190,3199,3208,3218],{"__ignoreMap":38},[43,3157,3158,3161,3164,3167],{"class":45,"line":46},[43,3159,3160],{"class":2063},"docker",[43,3162,3163],{"class":57}," run",[43,3165,3166],{"class":57}," -d",[43,3168,3169],{"class":1277}," \\\n",[43,3171,3172,3175,3178],{"class":45,"line":61},[43,3173,3174],{"class":57},"  --name",[43,3176,3177],{"class":57}," bruin-postgres",[43,3179,3169],{"class":1277},[43,3181,3182,3185,3188],{"class":45,"line":70},[43,3183,3184],{"class":57},"  -e",[43,3186,3187],{"class":57}," POSTGRES_USER=postgres",[43,3189,3169],{"class":1277},[43,3191,3192,3194,3197],{"class":45,"line":78},[43,3193,3184],{"class":57},[43,3195,3196],{"class":57}," POSTGRES_PASSWORD=postgres",[43,3198,3169],{"class":1277},[43,3200,3201,3203,3206],{"class":45,"line":86},[43,3202,3184],{"class":57},[43,3204,3205],{"class":57}," POSTGRES_DB=postgres",[43,3207,3169],{"class":1277},[43,3209,3210,3213,3216],{"class":45,"line":94},[43,3211,3212],{"class":57},"  -p",[43,3214,3215],{"class":57}," 5432:5432",[43,3217,3169],{"class":1277},[43,3219,3220],{"class":45,"line":108},[43,3221,3222],{"class":57},"  postgres:18-alpine\n",[33,3224,3227],{"className":2054,"code":3225,"filename":3226,"language":2056,"meta":38,"style":38},"docker compose up -d\n","Docker Compose",[40,3228,3229],{"__ignoreMap":38},[43,3230,3231,3233,3236,3239],{"class":45,"line":46},[43,3232,3160],{"class":2063},[43,3234,3235],{"class":57}," compose",[43,3237,3238],{"class":57}," up",[43,3240,3241],{"class":57}," -d\n",[33,3243,3246],{"className":2054,"code":3244,"filename":3245,"language":2056,"meta":38,"style":38},"make docker-up\n","Makefile",[40,3247,3248],{"__ignoreMap":38},[43,3249,3250,3253],{"class":45,"line":46},[43,3251,3252],{"class":2063},"make",[43,3254,3255],{"class":57}," docker-up\n",[1992,3257,3258],{},"Now, we must ingest the DDL inside the PostgresSQL instance:",[3148,3260,3261,3303],{},[33,3262,3265],{"className":2054,"code":3263,"filename":3264,"language":2056,"meta":38,"style":38},"cat sql/ddl.sql | docker exec -i bruin-ecommerce psql -U postgres -d postgres\n","Docker Exec",[40,3266,3267],{"__ignoreMap":38},[43,3268,3269,3272,3275,3278,3281,3284,3287,3290,3293,3296,3299,3301],{"class":45,"line":46},[43,3270,3271],{"class":2063},"cat",[43,3273,3274],{"class":57}," sql/ddl.sql",[43,3276,3277],{"class":53}," |",[43,3279,3280],{"class":2063}," docker",[43,3282,3283],{"class":57}," exec",[43,3285,3286],{"class":57}," -i",[43,3288,3289],{"class":57}," bruin-ecommerce",[43,3291,3292],{"class":57}," psql",[43,3294,3295],{"class":57}," -U",[43,3297,3298],{"class":57}," postgres",[43,3300,3166],{"class":57},[43,3302,116],{"class":57},[33,3304,3306],{"className":2054,"code":3305,"filename":3245,"language":2056,"meta":38,"style":38},"make db-migrate\n",[40,3307,3308],{"__ignoreMap":38},[43,3309,3310,3312],{"class":45,"line":46},[43,3311,3252],{"class":2063},[43,3313,3314],{"class":57}," db-migrate\n",[3316,3317,3320],"note",{"className":3318},[1984,3319],"my-0",[1992,3321,3322,3323],{},"If you're using Makefile, check the commands available using ",[40,3324,3325],{},"make help",[1973,3327,3329],{"id":3328},"_4-populating-test-data","4) Populating Test Data",[1992,3331,3332],{},"We’ll use Python with uv — a fast, lightweight Python environment manager — to handle dependencies and execution.\nThis approach lets us install only what’s needed (no global dependencies, no virtualenv folders), and it’s fully idempotent.",[1992,3334,3335,3336,3339],{},"Inside the project, you’ll find a script called ",[40,3337,3338],{},"generate_data.py",".\nThis script populates our five main tables (customers, products, product_variants, orders, and order_items) with realistic, time-distributed data that mimics an actual e-commerce platform.",[1992,3341,3342],{},"To make this possible, we rely on two lightweight Python libraries:",[33,3344,3348],{"className":3345,"code":3346,"language":3347,"meta":38,"style":38},"language-diff shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","+ faker==37     # For realistic names, emails, and categorical data\n+ psycopg==3    # For direct PostgreSQL database access\n","diff",[40,3349,3350,3355],{"__ignoreMap":38},[43,3351,3352],{"class":45,"line":46},[43,3353,3354],{},"+ faker==37     # For realistic names, emails, and categorical data\n",[43,3356,3357],{"class":45,"line":61},[43,3358,3359],{},"+ psycopg==3    # For direct PostgreSQL database access\n",[1992,3361,3362],{},"These are automatically handled when running with uv.",[3364,3365,3366],"code-collapse",{},[33,3367,3371],{"className":3368,"code":3369,"filename":3338,"language":3370,"meta":38,"style":38},"language-python shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","#!/usr/bin/env python3\n\"\"\"\nE-commerce demo data generator (Postgres).\n\nUsage:\n    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n\"\"\"\n\nimport argparse, random\nfrom datetime import datetime, timedelta, timezone\nfrom faker import Faker\nimport psycopg\n\n# -------------------------------------------------------------------\n# GLOBAL CONFIGURATION\n# -------------------------------------------------------------------\n\nfake = Faker()\n\n# --- Static categorical constants ---\nPRODUCT_CATEGORIES = [\"t-shirts\", \"hoodies\", \"shoes\", \"accessories\", \"jackets\"]\nCOLORS = [\"Red\", \"Blue\", \"Black\", \"White\", \"Green\"]\nSIZES_APPAREL = [\"S\", \"M\", \"L\", \"XL\"]\nSIZES_SHOES = [36, 38, 40, 42, 44]\nORDER_STATUSES = [\"pending\", \"paid\", \"cancelled\", \"shipped\"]\nORDER_STATUS_WEIGHTS = [0.2, 0.5, 0.1, 0.2]\n\n# --- SQL Statements ---\nSQL_INSERT_CUSTOMERS = \"\"\"\n                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n                       VALUES (%s, %s, %s, %s, %s, %s) ON CONFLICT (email) DO\n                       UPDATE\n                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; \\\n                       \"\"\"\n\nSQL_INSERT_PRODUCTS = \"\"\"\n                      INSERT INTO products(name, category, sku, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s) ON CONFLICT (sku) DO\n                      UPDATE\n                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_INSERT_VARIANTS = \"\"\"\n                      INSERT INTO product_variants\n                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n                       stock_quantity, is_active, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT (variant_sku) DO\n                      UPDATE\n                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n                          manufacturing_price=EXCLUDED.manufacturing_price,\n                          selling_price=EXCLUDED.selling_price,\n                          stock_quantity=EXCLUDED.stock_quantity,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_DELETE_ORDERS_IN_WINDOW = \"DELETE FROM orders WHERE order_date BETWEEN %s AND %s;\"\n\nSQL_INSERT_ORDERS = \"\"\"\n                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n                    VALUES (%s, %s, %s, %s, %s, %s); \\\n                    \"\"\"\n\nSQL_INSERT_ORDER_ITEMS = \"\"\"\n                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n                         VALUES (%s, %s, %s, %s, %s); \\\n                         \"\"\"\n\nSQL_UPDATE_ORDER_TOTALS = \"\"\"\n                          UPDATE orders o\n                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n  SELECT order_id, SUM(total_price) sum_total\n  FROM order_items GROUP BY order_id\n) oi\n                          WHERE o.id = oi.order_id\n                            AND o.order_date BETWEEN %s\n                            AND %s; \\\n                          \"\"\"\n\nSQL_STATS_COUNTS = {\n    \"customers\": \"SELECT COUNT(*) FROM customers\",\n    \"products\": \"SELECT COUNT(*) FROM products\",\n    \"variants\": \"SELECT COUNT(*) FROM product_variants\",\n    \"orders\": \"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN %s AND %s\",\n    \"items\": \"\"\"\n             SELECT COUNT(*)\n             FROM order_items oi\n                      JOIN orders o ON o.id = oi.order_id\n             WHERE o.order_date BETWEEN %s AND %s;\n             \"\"\",\n}\n\nSQL_CHAOS_VALIDATION = \"\"\"\n                       SELECT p.category,\n                              SUM(CASE\n                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n                                          THEN 1\n                                      ELSE 0 END) invalid\n                       FROM product_variants v\n                                JOIN products p ON p.id = v.product_id\n                       GROUP BY 1\n                       ORDER BY 1; \\\n                       \"\"\"\n\n\ndef parse_args():\n    now = datetime.now(timezone.utc)\n    day_start = now.replace(hour=0, minute=0, second=0, microsecond=0)\n    day_end = now.replace(hour=23, minute=59, second=59, microsecond=999999)\n\n    p = argparse.ArgumentParser(description=\"Generate demo ecommerce data (idempotent).\")\n    p.add_argument(\"--dsn\", required=True, help=\"PostgreSQL DSN\")\n    p.add_argument(\"--customers\", type=int, default=100)\n    p.add_argument(\"--products\", type=int, default=50)\n    p.add_argument(\"--orders\", type=int, default=500)\n    p.add_argument(\"--max-items-per-order\", type=int, default=5)\n    p.add_argument(\"--chaos-percent\", type=float, default=0.0, help=\"%% of variants with invalid sizes\")\n    p.add_argument(\"--scale\", type=int, default=1, help=\"Multiply base volumes\")\n    p.add_argument(\"--seed\", type=int, default=42, help=\"Deterministic RNG seed\")\n    p.add_argument(\"--starting-at\", type=str, help=\"ISO start (e.g. 2024-01-01)\")\n    p.add_argument(\"--ending-at\", type=str, help=\"ISO end (e.g. 2024-06-30)\")\n\n    a = p.parse_args()\n    a.starting_at = a.starting_at or day_start.isoformat()\n    a.ending_at = a.ending_at or day_end.isoformat()\n    return a\n\n\ndef iso(dt):\n    return datetime.fromisoformat(dt).astimezone(timezone.utc)\n\n\ndef rdate(s, e):\n    \"\"\"Return random datetime between s and e.\"\"\"\n    return s + timedelta(seconds=random.randint(0, int((e - s).total_seconds())))\n\n\ndef execmany(conn, sql, rows):\n    with conn.cursor() as cur:\n        cur.executemany(sql, rows)\n    conn.commit()\n\ndef gen_customers(n):\n    for _ in range(n):\n        yield (\n            fake.name(),\n            fake.unique.email(),\n            fake.country(),\n            random.randint(18, 70),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_products(n):\n    for _ in range(n):\n        cat = random.choice(PRODUCT_CATEGORIES)\n        yield (\n            f\"{fake.word().capitalize()} {cat}\",\n            cat,\n            fake.unique.bothify(\"SKU-####-??\").upper(),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_variants(prod_rows, chaos):\n    for pid, cat in prod_rows:\n        for _ in range(random.randint(1, 4)):\n            sku = fake.unique.bothify(\"VAR-####-??\").upper()\n            color = random.choice(COLORS)\n            size = str(random.choice(SIZES_SHOES)) if cat == \"shoes\" else random.choice(SIZES_APPAREL)\n\n            # Chaos mode\n            if chaos > 0 and random.random() \u003C (chaos / 100):\n                if cat == \"shoes\":\n                    size = random.choice(SIZES_APPAREL)\n                else:\n                    size = str(random.choice(SIZES_SHOES))\n\n            manuf = round(random.uniform(10, 80), 2)\n            sell = round(manuf * random.uniform(1.2, 2.0), 2)\n            yield (\n                pid, sku, color, size, manuf, sell,\n                random.randint(0, 200), True,\n                datetime.now(timezone.utc), datetime.now(timezone.utc),\n            )\n\n\ndef gen_orders(cust_ids, n, s, e):\n    for _ in range(n):\n        yield (random.choice(cust_ids), rdate(s, e), random.choices(ORDER_STATUSES, ORDER_STATUS_WEIGHTS)[0], 0.0,\n               datetime.now(timezone.utc), datetime.now(timezone.utc),)\n\n\ndef gen_items(order_ids, variant_ids, max_items):\n    for oid in order_ids:\n        for vid in random.sample(variant_ids, random.randint(1, max(1, max_items))):\n            yield (oid, vid, random.randint(1, 3), round(random.uniform(20, 200), 2), datetime.now(timezone.utc))\n\n\ndef print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, max_items, bad_by_cat):\n    print(\"\\n✅ Data generation complete (idempotent window load)\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Counts — Customers: {c_cnt:,} | Products: {p_cnt:,} | Variants: {v_cnt:,}\")\n    print(f\"Window Facts — Orders: {o_cnt:,} | Items: {i_cnt:,} | MaxItems/Order: {max_items}\")\n    print(\"Chaos check (invalid sizes per category):\")\n    for cat, bad in bad_by_cat:\n        print(f\"  • {cat}: {bad:,} invalid\")\n\n\ndef main():\n    args = parse_args()\n    random.seed(args.seed)\n    Faker.seed(args.seed)\n    S, E = iso(args.starting_at), iso(args.ending_at)\n\n    print(\"\\n=== Generating E-commerce Demo Data ===\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Scale x{args.scale} | Seed {args.seed} | Chaos {args.chaos_percent:.1f}%\\n\")\n\n    base_c, base_p, base_o = args.customers, args.products, args.orders\n    n_c, n_p, n_o = base_c * args.scale, base_p * args.scale, base_o * args.scale\n\n    with psycopg.connect(args.dsn) as conn:\n        execmany(conn, SQL_INSERT_CUSTOMERS, gen_customers(n_c))\n        execmany(conn, SQL_INSERT_PRODUCTS, gen_products(n_p))\n\n        prod_rows = list(conn.execute(\"SELECT id, category FROM products\"))\n        execmany(conn, SQL_INSERT_VARIANTS, gen_variants(prod_rows, args.chaos_percent))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_DELETE_ORDERS_IN_WINDOW, (S, E))\n        conn.commit()\n\n        cust_ids = [r[0] for r in conn.execute(\"SELECT id FROM customers\")]\n        execmany(conn, SQL_INSERT_ORDERS, gen_orders(cust_ids, n_o, S, E))\n\n        order_ids = [r[0] for r in conn.execute(\"SELECT id FROM orders WHERE order_date BETWEEN %s AND %s\", (S, E))]\n        variant_ids = [r[0] for r in conn.execute(\"SELECT id FROM product_variants\")]\n        execmany(conn, SQL_INSERT_ORDER_ITEMS, gen_items(order_ids, variant_ids, args.max_items_per_order))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_UPDATE_ORDER_TOTALS, (S, E))\n        conn.commit()\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_STATS_COUNTS[\"customers\"]);\n            c_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"products\"]);\n            p_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"variants\"]);\n            v_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"orders\"], (S, E));\n            o_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"items\"], (S, E));\n            i_cnt = cur.fetchone()[0]\n            cur.execute(SQL_CHAOS_VALIDATION);\n            bad_by_cat = cur.fetchall()\n\n    print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, args.max_items_per_order, bad_by_cat)\n\n\nif __name__ == \"__main__\":\n    main()\n","python",[40,3372,3373,3378,3384,3389,3393,3398,3403,3407,3411,3424,3447,3459,3466,3470,3475,3480,3484,3488,3500,3504,3509,3565,3619,3664,3698,3741,3770,3774,3779,3789,3794,3825,3830,3835,3843,3848,3852,3861,3866,3892,3897,3902,3909,3914,3918,3927,3932,3937,3942,3987,3991,3996,4001,4006,4011,4017,4021,4025,4049,4053,4062,4067,4099,4104,4108,4117,4122,4149,4154,4158,4167,4172,4177,4182,4188,4194,4200,4209,4222,4228,4233,4244,4266,4287,4308,4335,4349,4355,4361,4367,4381,4389,4395,4400,4410,4416,4422,4428,4434,4440,4446,4452,4458,4464,4472,4477,4482,4487,4499,4527,4581,4632,4637,4667,4709,4749,4786,4823,4860,4914,4964,5014,5056,5097,5102,5120,5154,5183,5192,5197,5202,5218,5250,5255,5260,5280,5291,5348,5353,5358,5383,5407,5428,5441,5446,5461,5482,5490,5503,5520,5532,5554,5574,5593,5599,5604,5609,5623,5640,5663,5670,5711,5719,5749,5768,5787,5792,5797,5802,5822,5842,5874,5908,5929,5986,5991,5997,6037,6055,6075,6083,6107,6112,6149,6188,6196,6229,6253,6289,6295,6300,6305,6333,6350,6411,6448,6453,6458,6483,6498,6548,6623,6628,6633,6686,6706,6751,6801,6848,6864,6883,6919,6924,6929,6939,6951,6973,6993,7030,7035,7053,7094,7156,7161,7203,7258,7263,7294,7320,7345,7350,7381,7413,7418,7438,7465,7477,7482,7529,7567,7572,7630,7671,7708,7713,7732,7758,7769,7774,7793,7820,7842,7867,7887,7912,7932,7967,7987,8022,8042,8060,8077,8082,8130,8135,8140,8160],{"__ignoreMap":38},[43,3374,3375],{"class":45,"line":46},[43,3376,3377],{"class":1006},"#!/usr/bin/env python3\n",[43,3379,3380],{"class":45,"line":61},[43,3381,3383],{"class":3382},"s7zQu","\"\"\"\n",[43,3385,3386],{"class":45,"line":70},[43,3387,3388],{"class":1006},"E-commerce demo data generator (Postgres).\n",[43,3390,3391],{"class":45,"line":78},[43,3392,244],{"emptyLinePlaceholder":243},[43,3394,3395],{"class":45,"line":86},[43,3396,3397],{"class":1006},"Usage:\n",[43,3399,3400],{"class":45,"line":94},[43,3401,3402],{"class":1006},"    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n",[43,3404,3405],{"class":45,"line":108},[43,3406,3383],{"class":3382},[43,3408,3409],{"class":45,"line":119},[43,3410,244],{"emptyLinePlaceholder":243},[43,3412,3413,3416,3419,3421],{"class":45,"line":129},[43,3414,3415],{"class":3382},"import",[43,3417,3418],{"class":1277}," argparse",[43,3420,1598],{"class":53},[43,3422,3423],{"class":1277}," random\n",[43,3425,3426,3429,3432,3434,3437,3439,3442,3444],{"class":45,"line":140},[43,3427,3428],{"class":3382},"from",[43,3430,3431],{"class":1277}," datetime ",[43,3433,3415],{"class":3382},[43,3435,3436],{"class":1277}," datetime",[43,3438,1598],{"class":53},[43,3440,3441],{"class":1277}," timedelta",[43,3443,1598],{"class":53},[43,3445,3446],{"class":1277}," timezone\n",[43,3448,3449,3451,3454,3456],{"class":45,"line":152},[43,3450,3428],{"class":3382},[43,3452,3453],{"class":1277}," faker ",[43,3455,3415],{"class":3382},[43,3457,3458],{"class":1277}," Faker\n",[43,3460,3461,3463],{"class":45,"line":162},[43,3462,3415],{"class":3382},[43,3464,3465],{"class":1277}," psycopg\n",[43,3467,3468],{"class":45,"line":170},[43,3469,244],{"emptyLinePlaceholder":243},[43,3471,3472],{"class":45,"line":182},[43,3473,3474],{"class":1006},"# -------------------------------------------------------------------\n",[43,3476,3477],{"class":45,"line":374},[43,3478,3479],{"class":1006},"# GLOBAL CONFIGURATION\n",[43,3481,3482],{"class":45,"line":382},[43,3483,3474],{"class":1006},[43,3485,3486],{"class":45,"line":392},[43,3487,244],{"emptyLinePlaceholder":243},[43,3489,3490,3493,3495,3498],{"class":45,"line":399},[43,3491,3492],{"class":1277},"fake ",[43,3494,1570],{"class":53},[43,3496,3497],{"class":1418}," Faker",[43,3499,2416],{"class":53},[43,3501,3502],{"class":45,"line":410},[43,3503,244],{"emptyLinePlaceholder":243},[43,3505,3506],{"class":45,"line":417},[43,3507,3508],{"class":1006},"# --- Static categorical constants ---\n",[43,3510,3511,3514,3516,3519,3522,3525,3527,3529,3531,3534,3536,3538,3540,3543,3545,3547,3549,3552,3554,3556,3558,3561,3563],{"class":45,"line":425},[43,3512,3513],{"class":1277},"PRODUCT_CATEGORIES ",[43,3515,1570],{"class":53},[43,3517,3518],{"class":53}," [",[43,3520,3521],{"class":53},"\"",[43,3523,3524],{"class":57},"t-shirts",[43,3526,3521],{"class":53},[43,3528,1598],{"class":53},[43,3530,299],{"class":53},[43,3532,3533],{"class":57},"hoodies",[43,3535,3521],{"class":53},[43,3537,1598],{"class":53},[43,3539,299],{"class":53},[43,3541,3542],{"class":57},"shoes",[43,3544,3521],{"class":53},[43,3546,1598],{"class":53},[43,3548,299],{"class":53},[43,3550,3551],{"class":57},"accessories",[43,3553,3521],{"class":53},[43,3555,1598],{"class":53},[43,3557,299],{"class":53},[43,3559,3560],{"class":57},"jackets",[43,3562,3521],{"class":53},[43,3564,238],{"class":53},[43,3566,3567,3570,3572,3574,3576,3579,3581,3583,3585,3588,3590,3592,3594,3597,3599,3601,3603,3606,3608,3610,3612,3615,3617],{"class":45,"line":430},[43,3568,3569],{"class":1277},"COLORS ",[43,3571,1570],{"class":53},[43,3573,3518],{"class":53},[43,3575,3521],{"class":53},[43,3577,3578],{"class":57},"Red",[43,3580,3521],{"class":53},[43,3582,1598],{"class":53},[43,3584,299],{"class":53},[43,3586,3587],{"class":57},"Blue",[43,3589,3521],{"class":53},[43,3591,1598],{"class":53},[43,3593,299],{"class":53},[43,3595,3596],{"class":57},"Black",[43,3598,3521],{"class":53},[43,3600,1598],{"class":53},[43,3602,299],{"class":53},[43,3604,3605],{"class":57},"White",[43,3607,3521],{"class":53},[43,3609,1598],{"class":53},[43,3611,299],{"class":53},[43,3613,3614],{"class":57},"Green",[43,3616,3521],{"class":53},[43,3618,238],{"class":53},[43,3620,3621,3624,3626,3628,3630,3633,3635,3637,3639,3642,3644,3646,3648,3651,3653,3655,3657,3660,3662],{"class":45,"line":438},[43,3622,3623],{"class":1277},"SIZES_APPAREL ",[43,3625,1570],{"class":53},[43,3627,3518],{"class":53},[43,3629,3521],{"class":53},[43,3631,3632],{"class":57},"S",[43,3634,3521],{"class":53},[43,3636,1598],{"class":53},[43,3638,299],{"class":53},[43,3640,3641],{"class":57},"M",[43,3643,3521],{"class":53},[43,3645,1598],{"class":53},[43,3647,299],{"class":53},[43,3649,3650],{"class":57},"L",[43,3652,3521],{"class":53},[43,3654,1598],{"class":53},[43,3656,299],{"class":53},[43,3658,3659],{"class":57},"XL",[43,3661,3521],{"class":53},[43,3663,238],{"class":53},[43,3665,3666,3669,3671,3673,3676,3678,3681,3683,3686,3688,3691,3693,3696],{"class":45,"line":446},[43,3667,3668],{"class":1277},"SIZES_SHOES ",[43,3670,1570],{"class":53},[43,3672,3518],{"class":53},[43,3674,3675],{"class":148},"36",[43,3677,1598],{"class":53},[43,3679,3680],{"class":148}," 38",[43,3682,1598],{"class":53},[43,3684,3685],{"class":148}," 40",[43,3687,1598],{"class":53},[43,3689,3690],{"class":148}," 42",[43,3692,1598],{"class":53},[43,3694,3695],{"class":148}," 44",[43,3697,238],{"class":53},[43,3699,3700,3703,3705,3707,3709,3712,3714,3716,3718,3720,3722,3724,3726,3729,3731,3733,3735,3737,3739],{"class":45,"line":456},[43,3701,3702],{"class":1277},"ORDER_STATUSES ",[43,3704,1570],{"class":53},[43,3706,3518],{"class":53},[43,3708,3521],{"class":53},[43,3710,3711],{"class":57},"pending",[43,3713,3521],{"class":53},[43,3715,1598],{"class":53},[43,3717,299],{"class":53},[43,3719,1593],{"class":57},[43,3721,3521],{"class":53},[43,3723,1598],{"class":53},[43,3725,299],{"class":53},[43,3727,3728],{"class":57},"cancelled",[43,3730,3521],{"class":53},[43,3732,1598],{"class":53},[43,3734,299],{"class":53},[43,3736,1603],{"class":57},[43,3738,3521],{"class":53},[43,3740,238],{"class":53},[43,3742,3743,3746,3748,3750,3753,3755,3758,3760,3763,3765,3768],{"class":45,"line":464},[43,3744,3745],{"class":1277},"ORDER_STATUS_WEIGHTS ",[43,3747,1570],{"class":53},[43,3749,3518],{"class":53},[43,3751,3752],{"class":148},"0.2",[43,3754,1598],{"class":53},[43,3756,3757],{"class":148}," 0.5",[43,3759,1598],{"class":53},[43,3761,3762],{"class":148}," 0.1",[43,3764,1598],{"class":53},[43,3766,3767],{"class":148}," 0.2",[43,3769,238],{"class":53},[43,3771,3772],{"class":45,"line":472},[43,3773,244],{"emptyLinePlaceholder":243},[43,3775,3776],{"class":45,"line":483},[43,3777,3778],{"class":1006},"# --- SQL Statements ---\n",[43,3780,3781,3784,3786],{"class":45,"line":494},[43,3782,3783],{"class":1277},"SQL_INSERT_CUSTOMERS ",[43,3785,1570],{"class":53},[43,3787,3788],{"class":53}," \"\"\"\n",[43,3790,3791],{"class":45,"line":506},[43,3792,3793],{"class":57},"                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n",[43,3795,3796,3799,3802,3804,3806,3808,3810,3812,3814,3816,3818,3820,3822],{"class":45,"line":517},[43,3797,3798],{"class":57},"                       VALUES (",[43,3800,3801],{"class":148},"%s",[43,3803,2197],{"class":57},[43,3805,3801],{"class":148},[43,3807,2197],{"class":57},[43,3809,3801],{"class":148},[43,3811,2197],{"class":57},[43,3813,3801],{"class":148},[43,3815,2197],{"class":57},[43,3817,3801],{"class":148},[43,3819,2197],{"class":57},[43,3821,3801],{"class":148},[43,3823,3824],{"class":57},") ON CONFLICT (email) DO\n",[43,3826,3827],{"class":45,"line":525},[43,3828,3829],{"class":57},"                       UPDATE\n",[43,3831,3832],{"class":45,"line":538},[43,3833,3834],{"class":57},"                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n",[43,3836,3837,3840],{"class":45,"line":550},[43,3838,3839],{"class":57},"                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; ",[43,3841,3842],{"class":53},"\\\n",[43,3844,3845],{"class":45,"line":558},[43,3846,3847],{"class":53},"                       \"\"\"\n",[43,3849,3850],{"class":45,"line":568},[43,3851,244],{"emptyLinePlaceholder":243},[43,3853,3854,3857,3859],{"class":45,"line":578},[43,3855,3856],{"class":1277},"SQL_INSERT_PRODUCTS ",[43,3858,1570],{"class":53},[43,3860,3788],{"class":53},[43,3862,3863],{"class":45,"line":588},[43,3864,3865],{"class":57},"                      INSERT INTO products(name, category, sku, created_at, updated_at)\n",[43,3867,3868,3871,3873,3875,3877,3879,3881,3883,3885,3887,3889],{"class":45,"line":595},[43,3869,3870],{"class":57},"                      VALUES (",[43,3872,3801],{"class":148},[43,3874,2197],{"class":57},[43,3876,3801],{"class":148},[43,3878,2197],{"class":57},[43,3880,3801],{"class":148},[43,3882,2197],{"class":57},[43,3884,3801],{"class":148},[43,3886,2197],{"class":57},[43,3888,3801],{"class":148},[43,3890,3891],{"class":57},") ON CONFLICT (sku) DO\n",[43,3893,3894],{"class":45,"line":606},[43,3895,3896],{"class":57},"                      UPDATE\n",[43,3898,3899],{"class":45,"line":614},[43,3900,3901],{"class":57},"                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n",[43,3903,3904,3907],{"class":45,"line":624},[43,3905,3906],{"class":57},"                          updated_at=EXCLUDED.updated_at; ",[43,3908,3842],{"class":53},[43,3910,3911],{"class":45,"line":633},[43,3912,3913],{"class":53},"                      \"\"\"\n",[43,3915,3916],{"class":45,"line":643},[43,3917,244],{"emptyLinePlaceholder":243},[43,3919,3920,3923,3925],{"class":45,"line":650},[43,3921,3922],{"class":1277},"SQL_INSERT_VARIANTS ",[43,3924,1570],{"class":53},[43,3926,3788],{"class":53},[43,3928,3929],{"class":45,"line":661},[43,3930,3931],{"class":57},"                      INSERT INTO product_variants\n",[43,3933,3934],{"class":45,"line":669},[43,3935,3936],{"class":57},"                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n",[43,3938,3939],{"class":45,"line":679},[43,3940,3941],{"class":57},"                       stock_quantity, is_active, created_at, updated_at)\n",[43,3943,3944,3946,3948,3950,3952,3954,3956,3958,3960,3962,3964,3966,3968,3970,3972,3974,3976,3978,3980,3982,3984],{"class":45,"line":687},[43,3945,3870],{"class":57},[43,3947,3801],{"class":148},[43,3949,2197],{"class":57},[43,3951,3801],{"class":148},[43,3953,2197],{"class":57},[43,3955,3801],{"class":148},[43,3957,2197],{"class":57},[43,3959,3801],{"class":148},[43,3961,2197],{"class":57},[43,3963,3801],{"class":148},[43,3965,2197],{"class":57},[43,3967,3801],{"class":148},[43,3969,2197],{"class":57},[43,3971,3801],{"class":148},[43,3973,2197],{"class":57},[43,3975,3801],{"class":148},[43,3977,2197],{"class":57},[43,3979,3801],{"class":148},[43,3981,2197],{"class":57},[43,3983,3801],{"class":148},[43,3985,3986],{"class":57},") ON CONFLICT (variant_sku) DO\n",[43,3988,3989],{"class":45,"line":695},[43,3990,3896],{"class":57},[43,3992,3993],{"class":45,"line":702},[43,3994,3995],{"class":57},"                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n",[43,3997,3998],{"class":45,"line":709},[43,3999,4000],{"class":57},"                          manufacturing_price=EXCLUDED.manufacturing_price,\n",[43,4002,4003],{"class":45,"line":719},[43,4004,4005],{"class":57},"                          selling_price=EXCLUDED.selling_price,\n",[43,4007,4008],{"class":45,"line":728},[43,4009,4010],{"class":57},"                          stock_quantity=EXCLUDED.stock_quantity,\n",[43,4012,4013,4015],{"class":45,"line":735},[43,4014,3906],{"class":57},[43,4016,3842],{"class":53},[43,4018,4019],{"class":45,"line":746},[43,4020,3913],{"class":53},[43,4022,4023],{"class":45,"line":757},[43,4024,244],{"emptyLinePlaceholder":243},[43,4026,4027,4030,4032,4034,4037,4039,4042,4044,4047],{"class":45,"line":765},[43,4028,4029],{"class":1277},"SQL_DELETE_ORDERS_IN_WINDOW ",[43,4031,1570],{"class":53},[43,4033,299],{"class":53},[43,4035,4036],{"class":57},"DELETE FROM orders WHERE order_date BETWEEN ",[43,4038,3801],{"class":148},[43,4040,4041],{"class":57}," AND ",[43,4043,3801],{"class":148},[43,4045,4046],{"class":57},";",[43,4048,305],{"class":53},[43,4050,4051],{"class":45,"line":775},[43,4052,244],{"emptyLinePlaceholder":243},[43,4054,4055,4058,4060],{"class":45,"line":785},[43,4056,4057],{"class":1277},"SQL_INSERT_ORDERS ",[43,4059,1570],{"class":53},[43,4061,3788],{"class":53},[43,4063,4064],{"class":45,"line":792},[43,4065,4066],{"class":57},"                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n",[43,4068,4069,4072,4074,4076,4078,4080,4082,4084,4086,4088,4090,4092,4094,4097],{"class":45,"line":803},[43,4070,4071],{"class":57},"                    VALUES (",[43,4073,3801],{"class":148},[43,4075,2197],{"class":57},[43,4077,3801],{"class":148},[43,4079,2197],{"class":57},[43,4081,3801],{"class":148},[43,4083,2197],{"class":57},[43,4085,3801],{"class":148},[43,4087,2197],{"class":57},[43,4089,3801],{"class":148},[43,4091,2197],{"class":57},[43,4093,3801],{"class":148},[43,4095,4096],{"class":57},"); ",[43,4098,3842],{"class":53},[43,4100,4101],{"class":45,"line":811},[43,4102,4103],{"class":53},"                    \"\"\"\n",[43,4105,4106],{"class":45,"line":821},[43,4107,244],{"emptyLinePlaceholder":243},[43,4109,4110,4113,4115],{"class":45,"line":830},[43,4111,4112],{"class":1277},"SQL_INSERT_ORDER_ITEMS ",[43,4114,1570],{"class":53},[43,4116,3788],{"class":53},[43,4118,4119],{"class":45,"line":838},[43,4120,4121],{"class":57},"                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n",[43,4123,4124,4127,4129,4131,4133,4135,4137,4139,4141,4143,4145,4147],{"class":45,"line":848},[43,4125,4126],{"class":57},"                         VALUES (",[43,4128,3801],{"class":148},[43,4130,2197],{"class":57},[43,4132,3801],{"class":148},[43,4134,2197],{"class":57},[43,4136,3801],{"class":148},[43,4138,2197],{"class":57},[43,4140,3801],{"class":148},[43,4142,2197],{"class":57},[43,4144,3801],{"class":148},[43,4146,4096],{"class":57},[43,4148,3842],{"class":53},[43,4150,4151],{"class":45,"line":857},[43,4152,4153],{"class":53},"                         \"\"\"\n",[43,4155,4156],{"class":45,"line":865},[43,4157,244],{"emptyLinePlaceholder":243},[43,4159,4160,4163,4165],{"class":45,"line":875},[43,4161,4162],{"class":1277},"SQL_UPDATE_ORDER_TOTALS ",[43,4164,1570],{"class":53},[43,4166,3788],{"class":53},[43,4168,4169],{"class":45,"line":884},[43,4170,4171],{"class":57},"                          UPDATE orders o\n",[43,4173,4174],{"class":45,"line":891},[43,4175,4176],{"class":57},"                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n",[43,4178,4179],{"class":45,"line":903},[43,4180,4181],{"class":57},"  SELECT order_id, SUM(total_price) sum_total\n",[43,4183,4185],{"class":45,"line":4184},74,[43,4186,4187],{"class":57},"  FROM order_items GROUP BY order_id\n",[43,4189,4191],{"class":45,"line":4190},75,[43,4192,4193],{"class":57},") oi\n",[43,4195,4197],{"class":45,"line":4196},76,[43,4198,4199],{"class":57},"                          WHERE o.id = oi.order_id\n",[43,4201,4203,4206],{"class":45,"line":4202},77,[43,4204,4205],{"class":57},"                            AND o.order_date BETWEEN ",[43,4207,4208],{"class":148},"%s\n",[43,4210,4212,4215,4217,4220],{"class":45,"line":4211},78,[43,4213,4214],{"class":57},"                            AND ",[43,4216,3801],{"class":148},[43,4218,4219],{"class":57},"; ",[43,4221,3842],{"class":53},[43,4223,4225],{"class":45,"line":4224},79,[43,4226,4227],{"class":53},"                          \"\"\"\n",[43,4229,4231],{"class":45,"line":4230},80,[43,4232,244],{"emptyLinePlaceholder":243},[43,4234,4236,4239,4241],{"class":45,"line":4235},81,[43,4237,4238],{"class":1277},"SQL_STATS_COUNTS ",[43,4240,1570],{"class":53},[43,4242,4243],{"class":53}," {\n",[43,4245,4247,4250,4253,4255,4257,4259,4262,4264],{"class":45,"line":4246},82,[43,4248,4249],{"class":53},"    \"",[43,4251,4252],{"class":57},"customers",[43,4254,3521],{"class":53},[43,4256,54],{"class":53},[43,4258,299],{"class":53},[43,4260,4261],{"class":57},"SELECT COUNT(*) FROM customers",[43,4263,3521],{"class":53},[43,4265,2316],{"class":53},[43,4267,4269,4271,4274,4276,4278,4280,4283,4285],{"class":45,"line":4268},83,[43,4270,4249],{"class":53},[43,4272,4273],{"class":57},"products",[43,4275,3521],{"class":53},[43,4277,54],{"class":53},[43,4279,299],{"class":53},[43,4281,4282],{"class":57},"SELECT COUNT(*) FROM products",[43,4284,3521],{"class":53},[43,4286,2316],{"class":53},[43,4288,4290,4292,4295,4297,4299,4301,4304,4306],{"class":45,"line":4289},84,[43,4291,4249],{"class":53},[43,4293,4294],{"class":57},"variants",[43,4296,3521],{"class":53},[43,4298,54],{"class":53},[43,4300,299],{"class":53},[43,4302,4303],{"class":57},"SELECT COUNT(*) FROM product_variants",[43,4305,3521],{"class":53},[43,4307,2316],{"class":53},[43,4309,4311,4313,4316,4318,4320,4322,4325,4327,4329,4331,4333],{"class":45,"line":4310},85,[43,4312,4249],{"class":53},[43,4314,4315],{"class":57},"orders",[43,4317,3521],{"class":53},[43,4319,54],{"class":53},[43,4321,299],{"class":53},[43,4323,4324],{"class":57},"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN ",[43,4326,3801],{"class":148},[43,4328,4041],{"class":57},[43,4330,3801],{"class":148},[43,4332,3521],{"class":53},[43,4334,2316],{"class":53},[43,4336,4338,4340,4343,4345,4347],{"class":45,"line":4337},86,[43,4339,4249],{"class":53},[43,4341,4342],{"class":57},"items",[43,4344,3521],{"class":53},[43,4346,54],{"class":53},[43,4348,3788],{"class":53},[43,4350,4352],{"class":45,"line":4351},87,[43,4353,4354],{"class":57},"             SELECT COUNT(*)\n",[43,4356,4358],{"class":45,"line":4357},88,[43,4359,4360],{"class":57},"             FROM order_items oi\n",[43,4362,4364],{"class":45,"line":4363},89,[43,4365,4366],{"class":57},"                      JOIN orders o ON o.id = oi.order_id\n",[43,4368,4370,4373,4375,4377,4379],{"class":45,"line":4369},90,[43,4371,4372],{"class":57},"             WHERE o.order_date BETWEEN ",[43,4374,3801],{"class":148},[43,4376,4041],{"class":57},[43,4378,3801],{"class":148},[43,4380,1462],{"class":57},[43,4382,4384,4387],{"class":45,"line":4383},91,[43,4385,4386],{"class":53},"             \"\"\"",[43,4388,2316],{"class":53},[43,4390,4392],{"class":45,"line":4391},92,[43,4393,4394],{"class":53},"}\n",[43,4396,4398],{"class":45,"line":4397},93,[43,4399,244],{"emptyLinePlaceholder":243},[43,4401,4403,4406,4408],{"class":45,"line":4402},94,[43,4404,4405],{"class":1277},"SQL_CHAOS_VALIDATION ",[43,4407,1570],{"class":53},[43,4409,3788],{"class":53},[43,4411,4413],{"class":45,"line":4412},95,[43,4414,4415],{"class":57},"                       SELECT p.category,\n",[43,4417,4419],{"class":45,"line":4418},96,[43,4420,4421],{"class":57},"                              SUM(CASE\n",[43,4423,4425],{"class":45,"line":4424},97,[43,4426,4427],{"class":57},"                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n",[43,4429,4431],{"class":45,"line":4430},98,[43,4432,4433],{"class":57},"                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n",[43,4435,4437],{"class":45,"line":4436},99,[43,4438,4439],{"class":57},"                                          THEN 1\n",[43,4441,4443],{"class":45,"line":4442},100,[43,4444,4445],{"class":57},"                                      ELSE 0 END) invalid\n",[43,4447,4449],{"class":45,"line":4448},101,[43,4450,4451],{"class":57},"                       FROM product_variants v\n",[43,4453,4455],{"class":45,"line":4454},102,[43,4456,4457],{"class":57},"                                JOIN products p ON p.id = v.product_id\n",[43,4459,4461],{"class":45,"line":4460},103,[43,4462,4463],{"class":57},"                       GROUP BY 1\n",[43,4465,4467,4470],{"class":45,"line":4466},104,[43,4468,4469],{"class":57},"                       ORDER BY 1; ",[43,4471,3842],{"class":53},[43,4473,4475],{"class":45,"line":4474},105,[43,4476,3847],{"class":53},[43,4478,4480],{"class":45,"line":4479},106,[43,4481,244],{"emptyLinePlaceholder":243},[43,4483,4485],{"class":45,"line":4484},107,[43,4486,244],{"emptyLinePlaceholder":243},[43,4488,4490,4493,4496],{"class":45,"line":4489},108,[43,4491,4492],{"class":1871},"def",[43,4494,4495],{"class":1418}," parse_args",[43,4497,4498],{"class":53},"():\n",[43,4500,4502,4505,4507,4509,4512,4515,4517,4520,4522,4525],{"class":45,"line":4501},109,[43,4503,4504],{"class":1277},"    now ",[43,4506,1570],{"class":53},[43,4508,3436],{"class":1277},[43,4510,4511],{"class":53},".",[43,4513,4514],{"class":1418},"now",[43,4516,1422],{"class":53},[43,4518,4519],{"class":1418},"timezone",[43,4521,4511],{"class":53},[43,4523,4524],{"class":49},"utc",[43,4526,1405],{"class":53},[43,4528,4530,4533,4535,4537,4539,4542,4544,4548,4550,4552,4554,4557,4559,4561,4563,4566,4568,4570,4572,4575,4577,4579],{"class":45,"line":4529},110,[43,4531,4532],{"class":1277},"    day_start ",[43,4534,1570],{"class":53},[43,4536,2395],{"class":1277},[43,4538,4511],{"class":53},[43,4540,4541],{"class":1418},"replace",[43,4543,1422],{"class":53},[43,4545,4547],{"class":4546},"sHdIc","hour",[43,4549,1570],{"class":53},[43,4551,1935],{"class":148},[43,4553,1598],{"class":53},[43,4555,4556],{"class":4546}," minute",[43,4558,1570],{"class":53},[43,4560,1935],{"class":148},[43,4562,1598],{"class":53},[43,4564,4565],{"class":4546}," second",[43,4567,1570],{"class":53},[43,4569,1935],{"class":148},[43,4571,1598],{"class":53},[43,4573,4574],{"class":4546}," microsecond",[43,4576,1570],{"class":53},[43,4578,1935],{"class":148},[43,4580,1405],{"class":53},[43,4582,4584,4587,4589,4591,4593,4595,4597,4599,4601,4604,4606,4608,4610,4613,4615,4617,4619,4621,4623,4625,4627,4630],{"class":45,"line":4583},111,[43,4585,4586],{"class":1277},"    day_end ",[43,4588,1570],{"class":53},[43,4590,2395],{"class":1277},[43,4592,4511],{"class":53},[43,4594,4541],{"class":1418},[43,4596,1422],{"class":53},[43,4598,4547],{"class":4546},[43,4600,1570],{"class":53},[43,4602,4603],{"class":148},"23",[43,4605,1598],{"class":53},[43,4607,4556],{"class":4546},[43,4609,1570],{"class":53},[43,4611,4612],{"class":148},"59",[43,4614,1598],{"class":53},[43,4616,4565],{"class":4546},[43,4618,1570],{"class":53},[43,4620,4612],{"class":148},[43,4622,1598],{"class":53},[43,4624,4574],{"class":4546},[43,4626,1570],{"class":53},[43,4628,4629],{"class":148},"999999",[43,4631,1405],{"class":53},[43,4633,4635],{"class":45,"line":4634},112,[43,4636,244],{"emptyLinePlaceholder":243},[43,4638,4640,4643,4645,4647,4649,4652,4654,4656,4658,4660,4663,4665],{"class":45,"line":4639},113,[43,4641,4642],{"class":1277},"    p ",[43,4644,1570],{"class":53},[43,4646,3418],{"class":1277},[43,4648,4511],{"class":53},[43,4650,4651],{"class":1418},"ArgumentParser",[43,4653,1422],{"class":53},[43,4655,1041],{"class":4546},[43,4657,1570],{"class":53},[43,4659,3521],{"class":53},[43,4661,4662],{"class":57},"Generate demo ecommerce data (idempotent).",[43,4664,3521],{"class":53},[43,4666,1405],{"class":53},[43,4668,4670,4673,4675,4678,4680,4682,4685,4687,4689,4692,4695,4698,4700,4702,4705,4707],{"class":45,"line":4669},114,[43,4671,4672],{"class":1277},"    p",[43,4674,4511],{"class":53},[43,4676,4677],{"class":1418},"add_argument",[43,4679,1422],{"class":53},[43,4681,3521],{"class":53},[43,4683,4684],{"class":57},"--dsn",[43,4686,3521],{"class":53},[43,4688,1598],{"class":53},[43,4690,4691],{"class":4546}," required",[43,4693,4694],{"class":53},"=True,",[43,4696,4697],{"class":4546}," help",[43,4699,1570],{"class":53},[43,4701,3521],{"class":53},[43,4703,4704],{"class":57},"PostgreSQL DSN",[43,4706,3521],{"class":53},[43,4708,1405],{"class":53},[43,4710,4712,4714,4716,4718,4720,4722,4725,4727,4729,4732,4734,4737,4739,4742,4744,4747],{"class":45,"line":4711},115,[43,4713,4672],{"class":1277},[43,4715,4511],{"class":53},[43,4717,4677],{"class":1418},[43,4719,1422],{"class":53},[43,4721,3521],{"class":53},[43,4723,4724],{"class":57},"--customers",[43,4726,3521],{"class":53},[43,4728,1598],{"class":53},[43,4730,4731],{"class":4546}," type",[43,4733,1570],{"class":53},[43,4735,4736],{"class":2063},"int",[43,4738,1598],{"class":53},[43,4740,4741],{"class":4546}," default",[43,4743,1570],{"class":53},[43,4745,4746],{"class":148},"100",[43,4748,1405],{"class":53},[43,4750,4752,4754,4756,4758,4760,4762,4765,4767,4769,4771,4773,4775,4777,4779,4781,4784],{"class":45,"line":4751},116,[43,4753,4672],{"class":1277},[43,4755,4511],{"class":53},[43,4757,4677],{"class":1418},[43,4759,1422],{"class":53},[43,4761,3521],{"class":53},[43,4763,4764],{"class":57},"--products",[43,4766,3521],{"class":53},[43,4768,1598],{"class":53},[43,4770,4731],{"class":4546},[43,4772,1570],{"class":53},[43,4774,4736],{"class":2063},[43,4776,1598],{"class":53},[43,4778,4741],{"class":4546},[43,4780,1570],{"class":53},[43,4782,4783],{"class":148},"50",[43,4785,1405],{"class":53},[43,4787,4789,4791,4793,4795,4797,4799,4802,4804,4806,4808,4810,4812,4814,4816,4818,4821],{"class":45,"line":4788},117,[43,4790,4672],{"class":1277},[43,4792,4511],{"class":53},[43,4794,4677],{"class":1418},[43,4796,1422],{"class":53},[43,4798,3521],{"class":53},[43,4800,4801],{"class":57},"--orders",[43,4803,3521],{"class":53},[43,4805,1598],{"class":53},[43,4807,4731],{"class":4546},[43,4809,1570],{"class":53},[43,4811,4736],{"class":2063},[43,4813,1598],{"class":53},[43,4815,4741],{"class":4546},[43,4817,1570],{"class":53},[43,4819,4820],{"class":148},"500",[43,4822,1405],{"class":53},[43,4824,4826,4828,4830,4832,4834,4836,4839,4841,4843,4845,4847,4849,4851,4853,4855,4858],{"class":45,"line":4825},118,[43,4827,4672],{"class":1277},[43,4829,4511],{"class":53},[43,4831,4677],{"class":1418},[43,4833,1422],{"class":53},[43,4835,3521],{"class":53},[43,4837,4838],{"class":57},"--max-items-per-order",[43,4840,3521],{"class":53},[43,4842,1598],{"class":53},[43,4844,4731],{"class":4546},[43,4846,1570],{"class":53},[43,4848,4736],{"class":2063},[43,4850,1598],{"class":53},[43,4852,4741],{"class":4546},[43,4854,1570],{"class":53},[43,4856,4857],{"class":148},"5",[43,4859,1405],{"class":53},[43,4861,4863,4865,4867,4869,4871,4873,4876,4878,4880,4882,4884,4887,4889,4891,4893,4896,4898,4900,4902,4904,4907,4910,4912],{"class":45,"line":4862},119,[43,4864,4672],{"class":1277},[43,4866,4511],{"class":53},[43,4868,4677],{"class":1418},[43,4870,1422],{"class":53},[43,4872,3521],{"class":53},[43,4874,4875],{"class":57},"--chaos-percent",[43,4877,3521],{"class":53},[43,4879,1598],{"class":53},[43,4881,4731],{"class":4546},[43,4883,1570],{"class":53},[43,4885,4886],{"class":2063},"float",[43,4888,1598],{"class":53},[43,4890,4741],{"class":4546},[43,4892,1570],{"class":53},[43,4894,4895],{"class":148},"0.0",[43,4897,1598],{"class":53},[43,4899,4697],{"class":4546},[43,4901,1570],{"class":53},[43,4903,3521],{"class":53},[43,4905,4906],{"class":148},"%%",[43,4908,4909],{"class":57}," of variants with invalid sizes",[43,4911,3521],{"class":53},[43,4913,1405],{"class":53},[43,4915,4917,4919,4921,4923,4925,4927,4930,4932,4934,4936,4938,4940,4942,4944,4946,4949,4951,4953,4955,4957,4960,4962],{"class":45,"line":4916},120,[43,4918,4672],{"class":1277},[43,4920,4511],{"class":53},[43,4922,4677],{"class":1418},[43,4924,1422],{"class":53},[43,4926,3521],{"class":53},[43,4928,4929],{"class":57},"--scale",[43,4931,3521],{"class":53},[43,4933,1598],{"class":53},[43,4935,4731],{"class":4546},[43,4937,1570],{"class":53},[43,4939,4736],{"class":2063},[43,4941,1598],{"class":53},[43,4943,4741],{"class":4546},[43,4945,1570],{"class":53},[43,4947,4948],{"class":148},"1",[43,4950,1598],{"class":53},[43,4952,4697],{"class":4546},[43,4954,1570],{"class":53},[43,4956,3521],{"class":53},[43,4958,4959],{"class":57},"Multiply base volumes",[43,4961,3521],{"class":53},[43,4963,1405],{"class":53},[43,4965,4967,4969,4971,4973,4975,4977,4980,4982,4984,4986,4988,4990,4992,4994,4996,4999,5001,5003,5005,5007,5010,5012],{"class":45,"line":4966},121,[43,4968,4672],{"class":1277},[43,4970,4511],{"class":53},[43,4972,4677],{"class":1418},[43,4974,1422],{"class":53},[43,4976,3521],{"class":53},[43,4978,4979],{"class":57},"--seed",[43,4981,3521],{"class":53},[43,4983,1598],{"class":53},[43,4985,4731],{"class":4546},[43,4987,1570],{"class":53},[43,4989,4736],{"class":2063},[43,4991,1598],{"class":53},[43,4993,4741],{"class":4546},[43,4995,1570],{"class":53},[43,4997,4998],{"class":148},"42",[43,5000,1598],{"class":53},[43,5002,4697],{"class":4546},[43,5004,1570],{"class":53},[43,5006,3521],{"class":53},[43,5008,5009],{"class":57},"Deterministic RNG seed",[43,5011,3521],{"class":53},[43,5013,1405],{"class":53},[43,5015,5017,5019,5021,5023,5025,5027,5030,5032,5034,5036,5038,5041,5043,5045,5047,5049,5052,5054],{"class":45,"line":5016},122,[43,5018,4672],{"class":1277},[43,5020,4511],{"class":53},[43,5022,4677],{"class":1418},[43,5024,1422],{"class":53},[43,5026,3521],{"class":53},[43,5028,5029],{"class":57},"--starting-at",[43,5031,3521],{"class":53},[43,5033,1598],{"class":53},[43,5035,4731],{"class":4546},[43,5037,1570],{"class":53},[43,5039,5040],{"class":2063},"str",[43,5042,1598],{"class":53},[43,5044,4697],{"class":4546},[43,5046,1570],{"class":53},[43,5048,3521],{"class":53},[43,5050,5051],{"class":57},"ISO start (e.g. 2024-01-01)",[43,5053,3521],{"class":53},[43,5055,1405],{"class":53},[43,5057,5059,5061,5063,5065,5067,5069,5072,5074,5076,5078,5080,5082,5084,5086,5088,5090,5093,5095],{"class":45,"line":5058},123,[43,5060,4672],{"class":1277},[43,5062,4511],{"class":53},[43,5064,4677],{"class":1418},[43,5066,1422],{"class":53},[43,5068,3521],{"class":53},[43,5070,5071],{"class":57},"--ending-at",[43,5073,3521],{"class":53},[43,5075,1598],{"class":53},[43,5077,4731],{"class":4546},[43,5079,1570],{"class":53},[43,5081,5040],{"class":2063},[43,5083,1598],{"class":53},[43,5085,4697],{"class":4546},[43,5087,1570],{"class":53},[43,5089,3521],{"class":53},[43,5091,5092],{"class":57},"ISO end (e.g. 2024-06-30)",[43,5094,3521],{"class":53},[43,5096,1405],{"class":53},[43,5098,5100],{"class":45,"line":5099},124,[43,5101,244],{"emptyLinePlaceholder":243},[43,5103,5105,5108,5110,5113,5115,5118],{"class":45,"line":5104},125,[43,5106,5107],{"class":1277},"    a ",[43,5109,1570],{"class":53},[43,5111,5112],{"class":1277}," p",[43,5114,4511],{"class":53},[43,5116,5117],{"class":1418},"parse_args",[43,5119,2416],{"class":53},[43,5121,5123,5126,5128,5131,5134,5137,5139,5141,5144,5147,5149,5152],{"class":45,"line":5122},126,[43,5124,5125],{"class":1277},"    a",[43,5127,4511],{"class":53},[43,5129,5130],{"class":49},"starting_at",[43,5132,5133],{"class":53}," =",[43,5135,5136],{"class":1277}," a",[43,5138,4511],{"class":53},[43,5140,5130],{"class":49},[43,5142,5143],{"class":53}," or",[43,5145,5146],{"class":1277}," day_start",[43,5148,4511],{"class":53},[43,5150,5151],{"class":1418},"isoformat",[43,5153,2416],{"class":53},[43,5155,5157,5159,5161,5164,5166,5168,5170,5172,5174,5177,5179,5181],{"class":45,"line":5156},127,[43,5158,5125],{"class":1277},[43,5160,4511],{"class":53},[43,5162,5163],{"class":49},"ending_at",[43,5165,5133],{"class":53},[43,5167,5136],{"class":1277},[43,5169,4511],{"class":53},[43,5171,5163],{"class":49},[43,5173,5143],{"class":53},[43,5175,5176],{"class":1277}," day_end",[43,5178,4511],{"class":53},[43,5180,5151],{"class":1418},[43,5182,2416],{"class":53},[43,5184,5186,5189],{"class":45,"line":5185},128,[43,5187,5188],{"class":3382},"    return",[43,5190,5191],{"class":1277}," a\n",[43,5193,5195],{"class":45,"line":5194},129,[43,5196,244],{"emptyLinePlaceholder":243},[43,5198,5200],{"class":45,"line":5199},130,[43,5201,244],{"emptyLinePlaceholder":243},[43,5203,5205,5207,5210,5212,5215],{"class":45,"line":5204},131,[43,5206,4492],{"class":1871},[43,5208,5209],{"class":1418}," iso",[43,5211,1422],{"class":53},[43,5213,5214],{"class":4546},"dt",[43,5216,5217],{"class":53},"):\n",[43,5219,5221,5223,5225,5227,5230,5232,5234,5237,5240,5242,5244,5246,5248],{"class":45,"line":5220},132,[43,5222,5188],{"class":3382},[43,5224,3436],{"class":1277},[43,5226,4511],{"class":53},[43,5228,5229],{"class":1418},"fromisoformat",[43,5231,1422],{"class":53},[43,5233,5214],{"class":1418},[43,5235,5236],{"class":53},").",[43,5238,5239],{"class":1418},"astimezone",[43,5241,1422],{"class":53},[43,5243,4519],{"class":1418},[43,5245,4511],{"class":53},[43,5247,4524],{"class":49},[43,5249,1405],{"class":53},[43,5251,5253],{"class":45,"line":5252},133,[43,5254,244],{"emptyLinePlaceholder":243},[43,5256,5258],{"class":45,"line":5257},134,[43,5259,244],{"emptyLinePlaceholder":243},[43,5261,5263,5265,5268,5270,5273,5275,5278],{"class":45,"line":5262},135,[43,5264,4492],{"class":1871},[43,5266,5267],{"class":1418}," rdate",[43,5269,1422],{"class":53},[43,5271,5272],{"class":4546},"s",[43,5274,1598],{"class":53},[43,5276,5277],{"class":4546}," e",[43,5279,5217],{"class":53},[43,5281,5283,5286,5289],{"class":45,"line":5282},136,[43,5284,5285],{"class":3382},"    \"\"\"",[43,5287,5288],{"class":1006},"Return random datetime between s and e.",[43,5290,3383],{"class":3382},[43,5292,5294,5296,5299,5302,5304,5306,5309,5311,5314,5316,5319,5321,5323,5325,5328,5331,5334,5337,5340,5342,5345],{"class":45,"line":5293},137,[43,5295,5188],{"class":3382},[43,5297,5298],{"class":1277}," s ",[43,5300,5301],{"class":53},"+",[43,5303,3441],{"class":1418},[43,5305,1422],{"class":53},[43,5307,5308],{"class":4546},"seconds",[43,5310,1570],{"class":53},[43,5312,5313],{"class":1418},"random",[43,5315,4511],{"class":53},[43,5317,5318],{"class":1418},"randint",[43,5320,1422],{"class":53},[43,5322,1935],{"class":148},[43,5324,1598],{"class":53},[43,5326,5327],{"class":2063}," int",[43,5329,5330],{"class":53},"((",[43,5332,5333],{"class":1418},"e ",[43,5335,5336],{"class":53},"-",[43,5338,5339],{"class":1418}," s",[43,5341,5236],{"class":53},[43,5343,5344],{"class":1418},"total_seconds",[43,5346,5347],{"class":53},"())))\n",[43,5349,5351],{"class":45,"line":5350},138,[43,5352,244],{"emptyLinePlaceholder":243},[43,5354,5356],{"class":45,"line":5355},139,[43,5357,244],{"emptyLinePlaceholder":243},[43,5359,5361,5363,5366,5368,5371,5373,5376,5378,5381],{"class":45,"line":5360},140,[43,5362,4492],{"class":1871},[43,5364,5365],{"class":1418}," execmany",[43,5367,1422],{"class":53},[43,5369,5370],{"class":4546},"conn",[43,5372,1598],{"class":53},[43,5374,5375],{"class":4546}," sql",[43,5377,1598],{"class":53},[43,5379,5380],{"class":4546}," rows",[43,5382,5217],{"class":53},[43,5384,5386,5389,5392,5394,5397,5399,5402,5405],{"class":45,"line":5385},141,[43,5387,5388],{"class":3382},"    with",[43,5390,5391],{"class":1277}," conn",[43,5393,4511],{"class":53},[43,5395,5396],{"class":1418},"cursor",[43,5398,2398],{"class":53},[43,5400,5401],{"class":3382}," as",[43,5403,5404],{"class":1277}," cur",[43,5406,67],{"class":53},[43,5408,5410,5413,5415,5418,5420,5422,5424,5426],{"class":45,"line":5409},142,[43,5411,5412],{"class":1277},"        cur",[43,5414,4511],{"class":53},[43,5416,5417],{"class":1418},"executemany",[43,5419,1422],{"class":53},[43,5421,1198],{"class":1418},[43,5423,1598],{"class":53},[43,5425,5380],{"class":1418},[43,5427,1405],{"class":53},[43,5429,5431,5434,5436,5439],{"class":45,"line":5430},143,[43,5432,5433],{"class":1277},"    conn",[43,5435,4511],{"class":53},[43,5437,5438],{"class":1418},"commit",[43,5440,2416],{"class":53},[43,5442,5444],{"class":45,"line":5443},144,[43,5445,244],{"emptyLinePlaceholder":243},[43,5447,5449,5451,5454,5456,5459],{"class":45,"line":5448},145,[43,5450,4492],{"class":1871},[43,5452,5453],{"class":1418}," gen_customers",[43,5455,1422],{"class":53},[43,5457,5458],{"class":4546},"n",[43,5460,5217],{"class":53},[43,5462,5464,5467,5470,5473,5476,5478,5480],{"class":45,"line":5463},146,[43,5465,5466],{"class":3382},"    for",[43,5468,5469],{"class":1277}," _ ",[43,5471,5472],{"class":3382},"in",[43,5474,5475],{"class":1418}," range",[43,5477,1422],{"class":53},[43,5479,5458],{"class":1418},[43,5481,5217],{"class":53},[43,5483,5485,5488],{"class":45,"line":5484},147,[43,5486,5487],{"class":3382},"        yield",[43,5489,1284],{"class":53},[43,5491,5493,5496,5498,5500],{"class":45,"line":5492},148,[43,5494,5495],{"class":1277},"            fake",[43,5497,4511],{"class":53},[43,5499,922],{"class":1418},[43,5501,5502],{"class":53},"(),\n",[43,5504,5506,5508,5510,5513,5515,5518],{"class":45,"line":5505},149,[43,5507,5495],{"class":1277},[43,5509,4511],{"class":53},[43,5511,5512],{"class":49},"unique",[43,5514,4511],{"class":53},[43,5516,5517],{"class":1418},"email",[43,5519,5502],{"class":53},[43,5521,5523,5525,5527,5530],{"class":45,"line":5522},150,[43,5524,5495],{"class":1277},[43,5526,4511],{"class":53},[43,5528,5529],{"class":1418},"country",[43,5531,5502],{"class":53},[43,5533,5535,5538,5540,5542,5544,5547,5549,5552],{"class":45,"line":5534},151,[43,5536,5537],{"class":1277},"            random",[43,5539,4511],{"class":53},[43,5541,5318],{"class":1418},[43,5543,1422],{"class":53},[43,5545,5546],{"class":148},"18",[43,5548,1598],{"class":53},[43,5550,5551],{"class":148}," 70",[43,5553,1612],{"class":53},[43,5555,5557,5560,5562,5564,5566,5568,5570,5572],{"class":45,"line":5556},152,[43,5558,5559],{"class":1277},"            datetime",[43,5561,4511],{"class":53},[43,5563,4514],{"class":1418},[43,5565,1422],{"class":53},[43,5567,4519],{"class":1418},[43,5569,4511],{"class":53},[43,5571,4524],{"class":49},[43,5573,1612],{"class":53},[43,5575,5577,5579,5581,5583,5585,5587,5589,5591],{"class":45,"line":5576},153,[43,5578,5559],{"class":1277},[43,5580,4511],{"class":53},[43,5582,4514],{"class":1418},[43,5584,1422],{"class":53},[43,5586,4519],{"class":1418},[43,5588,4511],{"class":53},[43,5590,4524],{"class":49},[43,5592,1612],{"class":53},[43,5594,5596],{"class":45,"line":5595},154,[43,5597,5598],{"class":53},"        )\n",[43,5600,5602],{"class":45,"line":5601},155,[43,5603,244],{"emptyLinePlaceholder":243},[43,5605,5607],{"class":45,"line":5606},156,[43,5608,244],{"emptyLinePlaceholder":243},[43,5610,5612,5614,5617,5619,5621],{"class":45,"line":5611},157,[43,5613,4492],{"class":1871},[43,5615,5616],{"class":1418}," gen_products",[43,5618,1422],{"class":53},[43,5620,5458],{"class":4546},[43,5622,5217],{"class":53},[43,5624,5626,5628,5630,5632,5634,5636,5638],{"class":45,"line":5625},158,[43,5627,5466],{"class":3382},[43,5629,5469],{"class":1277},[43,5631,5472],{"class":3382},[43,5633,5475],{"class":1418},[43,5635,1422],{"class":53},[43,5637,5458],{"class":1418},[43,5639,5217],{"class":53},[43,5641,5643,5646,5648,5651,5653,5656,5658,5661],{"class":45,"line":5642},159,[43,5644,5645],{"class":1277},"        cat ",[43,5647,1570],{"class":53},[43,5649,5650],{"class":1277}," random",[43,5652,4511],{"class":53},[43,5654,5655],{"class":1418},"choice",[43,5657,1422],{"class":53},[43,5659,5660],{"class":1418},"PRODUCT_CATEGORIES",[43,5662,1405],{"class":53},[43,5664,5666,5668],{"class":45,"line":5665},160,[43,5667,5487],{"class":3382},[43,5669,1284],{"class":53},[43,5671,5673,5676,5678,5681,5684,5686,5689,5692,5695,5697,5700,5703,5705,5707,5709],{"class":45,"line":5672},161,[43,5674,5675],{"class":1871},"            f",[43,5677,3521],{"class":57},[43,5679,5680],{"class":148},"{",[43,5682,5683],{"class":1277},"fake",[43,5685,4511],{"class":53},[43,5687,5688],{"class":1418},"word",[43,5690,5691],{"class":53},"().",[43,5693,5694],{"class":1418},"capitalize",[43,5696,2398],{"class":53},[43,5698,5699],{"class":148},"}",[43,5701,5702],{"class":148}," {",[43,5704,3271],{"class":1277},[43,5706,5699],{"class":148},[43,5708,3521],{"class":57},[43,5710,2316],{"class":53},[43,5712,5714,5717],{"class":45,"line":5713},162,[43,5715,5716],{"class":1277},"            cat",[43,5718,2316],{"class":53},[43,5720,5722,5724,5726,5728,5730,5733,5735,5737,5740,5742,5744,5747],{"class":45,"line":5721},163,[43,5723,5495],{"class":1277},[43,5725,4511],{"class":53},[43,5727,5512],{"class":49},[43,5729,4511],{"class":53},[43,5731,5732],{"class":1418},"bothify",[43,5734,1422],{"class":53},[43,5736,3521],{"class":53},[43,5738,5739],{"class":57},"SKU-####-??",[43,5741,3521],{"class":53},[43,5743,5236],{"class":53},[43,5745,5746],{"class":1418},"upper",[43,5748,5502],{"class":53},[43,5750,5752,5754,5756,5758,5760,5762,5764,5766],{"class":45,"line":5751},164,[43,5753,5559],{"class":1277},[43,5755,4511],{"class":53},[43,5757,4514],{"class":1418},[43,5759,1422],{"class":53},[43,5761,4519],{"class":1418},[43,5763,4511],{"class":53},[43,5765,4524],{"class":49},[43,5767,1612],{"class":53},[43,5769,5771,5773,5775,5777,5779,5781,5783,5785],{"class":45,"line":5770},165,[43,5772,5559],{"class":1277},[43,5774,4511],{"class":53},[43,5776,4514],{"class":1418},[43,5778,1422],{"class":53},[43,5780,4519],{"class":1418},[43,5782,4511],{"class":53},[43,5784,4524],{"class":49},[43,5786,1612],{"class":53},[43,5788,5790],{"class":45,"line":5789},166,[43,5791,5598],{"class":53},[43,5793,5795],{"class":45,"line":5794},167,[43,5796,244],{"emptyLinePlaceholder":243},[43,5798,5800],{"class":45,"line":5799},168,[43,5801,244],{"emptyLinePlaceholder":243},[43,5803,5805,5807,5810,5812,5815,5817,5820],{"class":45,"line":5804},169,[43,5806,4492],{"class":1871},[43,5808,5809],{"class":1418}," gen_variants",[43,5811,1422],{"class":53},[43,5813,5814],{"class":4546},"prod_rows",[43,5816,1598],{"class":53},[43,5818,5819],{"class":4546}," chaos",[43,5821,5217],{"class":53},[43,5823,5825,5827,5830,5832,5835,5837,5840],{"class":45,"line":5824},170,[43,5826,5466],{"class":3382},[43,5828,5829],{"class":1277}," pid",[43,5831,1598],{"class":53},[43,5833,5834],{"class":1277}," cat ",[43,5836,5472],{"class":3382},[43,5838,5839],{"class":1277}," prod_rows",[43,5841,67],{"class":53},[43,5843,5845,5848,5850,5852,5854,5856,5858,5860,5862,5864,5866,5868,5871],{"class":45,"line":5844},171,[43,5846,5847],{"class":3382},"        for",[43,5849,5469],{"class":1277},[43,5851,5472],{"class":3382},[43,5853,5475],{"class":1418},[43,5855,1422],{"class":53},[43,5857,5313],{"class":1418},[43,5859,4511],{"class":53},[43,5861,5318],{"class":1418},[43,5863,1422],{"class":53},[43,5865,4948],{"class":148},[43,5867,1598],{"class":53},[43,5869,5870],{"class":148}," 4",[43,5872,5873],{"class":53},")):\n",[43,5875,5877,5880,5882,5885,5887,5889,5891,5893,5895,5897,5900,5902,5904,5906],{"class":45,"line":5876},172,[43,5878,5879],{"class":1277},"            sku ",[43,5881,1570],{"class":53},[43,5883,5884],{"class":1277}," fake",[43,5886,4511],{"class":53},[43,5888,5512],{"class":49},[43,5890,4511],{"class":53},[43,5892,5732],{"class":1418},[43,5894,1422],{"class":53},[43,5896,3521],{"class":53},[43,5898,5899],{"class":57},"VAR-####-??",[43,5901,3521],{"class":53},[43,5903,5236],{"class":53},[43,5905,5746],{"class":1418},[43,5907,2416],{"class":53},[43,5909,5911,5914,5916,5918,5920,5922,5924,5927],{"class":45,"line":5910},173,[43,5912,5913],{"class":1277},"            color ",[43,5915,1570],{"class":53},[43,5917,5650],{"class":1277},[43,5919,4511],{"class":53},[43,5921,5655],{"class":1418},[43,5923,1422],{"class":53},[43,5925,5926],{"class":1418},"COLORS",[43,5928,1405],{"class":53},[43,5930,5932,5935,5937,5940,5942,5944,5946,5948,5950,5953,5956,5959,5961,5964,5966,5968,5970,5973,5975,5977,5979,5981,5984],{"class":45,"line":5931},174,[43,5933,5934],{"class":1277},"            size ",[43,5936,1570],{"class":53},[43,5938,5939],{"class":2063}," str",[43,5941,1422],{"class":53},[43,5943,5313],{"class":1418},[43,5945,4511],{"class":53},[43,5947,5655],{"class":1418},[43,5949,1422],{"class":53},[43,5951,5952],{"class":1418},"SIZES_SHOES",[43,5954,5955],{"class":53},"))",[43,5957,5958],{"class":3382}," if",[43,5960,5834],{"class":1277},[43,5962,5963],{"class":53},"==",[43,5965,299],{"class":53},[43,5967,3542],{"class":57},[43,5969,3521],{"class":53},[43,5971,5972],{"class":3382}," else",[43,5974,5650],{"class":1277},[43,5976,4511],{"class":53},[43,5978,5655],{"class":1418},[43,5980,1422],{"class":53},[43,5982,5983],{"class":1418},"SIZES_APPAREL",[43,5985,1405],{"class":53},[43,5987,5989],{"class":45,"line":5988},175,[43,5990,244],{"emptyLinePlaceholder":243},[43,5992,5994],{"class":45,"line":5993},176,[43,5995,5996],{"class":1006},"            # Chaos mode\n",[43,5998,6000,6003,6006,6009,6011,6014,6016,6018,6020,6022,6025,6027,6030,6032,6035],{"class":45,"line":5999},177,[43,6001,6002],{"class":3382},"            if",[43,6004,6005],{"class":1277}," chaos ",[43,6007,6008],{"class":53},">",[43,6010,1737],{"class":148},[43,6012,6013],{"class":53}," and",[43,6015,5650],{"class":1277},[43,6017,4511],{"class":53},[43,6019,5313],{"class":1418},[43,6021,2398],{"class":53},[43,6023,6024],{"class":53}," \u003C",[43,6026,1587],{"class":53},[43,6028,6029],{"class":1277},"chaos ",[43,6031,1751],{"class":53},[43,6033,6034],{"class":148}," 100",[43,6036,5217],{"class":53},[43,6038,6040,6043,6045,6047,6049,6051,6053],{"class":45,"line":6039},178,[43,6041,6042],{"class":3382},"                if",[43,6044,5834],{"class":1277},[43,6046,5963],{"class":53},[43,6048,299],{"class":53},[43,6050,3542],{"class":57},[43,6052,3521],{"class":53},[43,6054,67],{"class":53},[43,6056,6058,6061,6063,6065,6067,6069,6071,6073],{"class":45,"line":6057},179,[43,6059,6060],{"class":1277},"                    size ",[43,6062,1570],{"class":53},[43,6064,5650],{"class":1277},[43,6066,4511],{"class":53},[43,6068,5655],{"class":1418},[43,6070,1422],{"class":53},[43,6072,5983],{"class":1418},[43,6074,1405],{"class":53},[43,6076,6078,6081],{"class":45,"line":6077},180,[43,6079,6080],{"class":3382},"                else",[43,6082,67],{"class":53},[43,6084,6086,6088,6090,6092,6094,6096,6098,6100,6102,6104],{"class":45,"line":6085},181,[43,6087,6060],{"class":1277},[43,6089,1570],{"class":53},[43,6091,5939],{"class":2063},[43,6093,1422],{"class":53},[43,6095,5313],{"class":1418},[43,6097,4511],{"class":53},[43,6099,5655],{"class":1418},[43,6101,1422],{"class":53},[43,6103,5952],{"class":1418},[43,6105,6106],{"class":53},"))\n",[43,6108,6110],{"class":45,"line":6109},182,[43,6111,244],{"emptyLinePlaceholder":243},[43,6113,6115,6118,6120,6123,6125,6127,6129,6132,6134,6136,6138,6141,6144,6147],{"class":45,"line":6114},183,[43,6116,6117],{"class":1277},"            manuf ",[43,6119,1570],{"class":53},[43,6121,6122],{"class":1418}," round",[43,6124,1422],{"class":53},[43,6126,5313],{"class":1418},[43,6128,4511],{"class":53},[43,6130,6131],{"class":1418},"uniform",[43,6133,1422],{"class":53},[43,6135,2622],{"class":148},[43,6137,1598],{"class":53},[43,6139,6140],{"class":148}," 80",[43,6142,6143],{"class":53},"),",[43,6145,6146],{"class":148}," 2",[43,6148,1405],{"class":53},[43,6150,6152,6155,6157,6159,6161,6164,6166,6168,6170,6172,6174,6177,6179,6182,6184,6186],{"class":45,"line":6151},184,[43,6153,6154],{"class":1277},"            sell ",[43,6156,1570],{"class":53},[43,6158,6122],{"class":1418},[43,6160,1422],{"class":53},[43,6162,6163],{"class":1418},"manuf ",[43,6165,1425],{"class":53},[43,6167,5650],{"class":1418},[43,6169,4511],{"class":53},[43,6171,6131],{"class":1418},[43,6173,1422],{"class":53},[43,6175,6176],{"class":148},"1.2",[43,6178,1598],{"class":53},[43,6180,6181],{"class":148}," 2.0",[43,6183,6143],{"class":53},[43,6185,6146],{"class":148},[43,6187,1405],{"class":53},[43,6189,6191,6194],{"class":45,"line":6190},185,[43,6192,6193],{"class":3382},"            yield",[43,6195,1284],{"class":53},[43,6197,6199,6202,6204,6207,6209,6212,6214,6217,6219,6222,6224,6227],{"class":45,"line":6198},186,[43,6200,6201],{"class":1277},"                pid",[43,6203,1598],{"class":53},[43,6205,6206],{"class":1277}," sku",[43,6208,1598],{"class":53},[43,6210,6211],{"class":1277}," color",[43,6213,1598],{"class":53},[43,6215,6216],{"class":1277}," size",[43,6218,1598],{"class":53},[43,6220,6221],{"class":1277}," manuf",[43,6223,1598],{"class":53},[43,6225,6226],{"class":1277}," sell",[43,6228,2316],{"class":53},[43,6230,6232,6235,6237,6239,6241,6243,6245,6248,6250],{"class":45,"line":6231},187,[43,6233,6234],{"class":1277},"                random",[43,6236,4511],{"class":53},[43,6238,5318],{"class":1418},[43,6240,1422],{"class":53},[43,6242,1935],{"class":148},[43,6244,1598],{"class":53},[43,6246,6247],{"class":148}," 200",[43,6249,6143],{"class":53},[43,6251,6252],{"class":53}," True,\n",[43,6254,6256,6259,6261,6263,6265,6267,6269,6271,6273,6275,6277,6279,6281,6283,6285,6287],{"class":45,"line":6255},188,[43,6257,6258],{"class":1277},"                datetime",[43,6260,4511],{"class":53},[43,6262,4514],{"class":1418},[43,6264,1422],{"class":53},[43,6266,4519],{"class":1418},[43,6268,4511],{"class":53},[43,6270,4524],{"class":49},[43,6272,6143],{"class":53},[43,6274,3436],{"class":1277},[43,6276,4511],{"class":53},[43,6278,4514],{"class":1418},[43,6280,1422],{"class":53},[43,6282,4519],{"class":1418},[43,6284,4511],{"class":53},[43,6286,4524],{"class":49},[43,6288,1612],{"class":53},[43,6290,6292],{"class":45,"line":6291},189,[43,6293,6294],{"class":53},"            )\n",[43,6296,6298],{"class":45,"line":6297},190,[43,6299,244],{"emptyLinePlaceholder":243},[43,6301,6303],{"class":45,"line":6302},191,[43,6304,244],{"emptyLinePlaceholder":243},[43,6306,6308,6310,6313,6315,6318,6320,6323,6325,6327,6329,6331],{"class":45,"line":6307},192,[43,6309,4492],{"class":1871},[43,6311,6312],{"class":1418}," gen_orders",[43,6314,1422],{"class":53},[43,6316,6317],{"class":4546},"cust_ids",[43,6319,1598],{"class":53},[43,6321,6322],{"class":4546}," n",[43,6324,1598],{"class":53},[43,6326,5339],{"class":4546},[43,6328,1598],{"class":53},[43,6330,5277],{"class":4546},[43,6332,5217],{"class":53},[43,6334,6336,6338,6340,6342,6344,6346,6348],{"class":45,"line":6335},193,[43,6337,5466],{"class":3382},[43,6339,5469],{"class":1277},[43,6341,5472],{"class":3382},[43,6343,5475],{"class":1418},[43,6345,1422],{"class":53},[43,6347,5458],{"class":1418},[43,6349,5217],{"class":53},[43,6351,6353,6355,6357,6359,6361,6363,6365,6367,6369,6371,6373,6375,6377,6379,6381,6383,6385,6388,6390,6393,6395,6398,6401,6403,6406,6409],{"class":45,"line":6352},194,[43,6354,5487],{"class":3382},[43,6356,1587],{"class":53},[43,6358,5313],{"class":1277},[43,6360,4511],{"class":53},[43,6362,5655],{"class":1418},[43,6364,1422],{"class":53},[43,6366,6317],{"class":1418},[43,6368,6143],{"class":53},[43,6370,5267],{"class":1418},[43,6372,1422],{"class":53},[43,6374,5272],{"class":1418},[43,6376,1598],{"class":53},[43,6378,5277],{"class":1418},[43,6380,6143],{"class":53},[43,6382,5650],{"class":1277},[43,6384,4511],{"class":53},[43,6386,6387],{"class":1418},"choices",[43,6389,1422],{"class":53},[43,6391,6392],{"class":1418},"ORDER_STATUSES",[43,6394,1598],{"class":53},[43,6396,6397],{"class":1418}," ORDER_STATUS_WEIGHTS",[43,6399,6400],{"class":53},")[",[43,6402,1935],{"class":148},[43,6404,6405],{"class":53},"],",[43,6407,6408],{"class":148}," 0.0",[43,6410,2316],{"class":53},[43,6412,6414,6417,6419,6421,6423,6425,6427,6429,6431,6433,6435,6437,6439,6441,6443,6445],{"class":45,"line":6413},195,[43,6415,6416],{"class":1277},"               datetime",[43,6418,4511],{"class":53},[43,6420,4514],{"class":1418},[43,6422,1422],{"class":53},[43,6424,4519],{"class":1418},[43,6426,4511],{"class":53},[43,6428,4524],{"class":49},[43,6430,6143],{"class":53},[43,6432,3436],{"class":1277},[43,6434,4511],{"class":53},[43,6436,4514],{"class":1418},[43,6438,1422],{"class":53},[43,6440,4519],{"class":1418},[43,6442,4511],{"class":53},[43,6444,4524],{"class":49},[43,6446,6447],{"class":53},"),)\n",[43,6449,6451],{"class":45,"line":6450},196,[43,6452,244],{"emptyLinePlaceholder":243},[43,6454,6456],{"class":45,"line":6455},197,[43,6457,244],{"emptyLinePlaceholder":243},[43,6459,6461,6463,6466,6468,6471,6473,6476,6478,6481],{"class":45,"line":6460},198,[43,6462,4492],{"class":1871},[43,6464,6465],{"class":1418}," gen_items",[43,6467,1422],{"class":53},[43,6469,6470],{"class":4546},"order_ids",[43,6472,1598],{"class":53},[43,6474,6475],{"class":4546}," variant_ids",[43,6477,1598],{"class":53},[43,6479,6480],{"class":4546}," max_items",[43,6482,5217],{"class":53},[43,6484,6486,6488,6491,6493,6496],{"class":45,"line":6485},199,[43,6487,5466],{"class":3382},[43,6489,6490],{"class":1277}," oid ",[43,6492,5472],{"class":3382},[43,6494,6495],{"class":1277}," order_ids",[43,6497,67],{"class":53},[43,6499,6501,6503,6506,6508,6510,6512,6515,6517,6520,6522,6524,6526,6528,6530,6532,6534,6537,6539,6541,6543,6545],{"class":45,"line":6500},200,[43,6502,5847],{"class":3382},[43,6504,6505],{"class":1277}," vid ",[43,6507,5472],{"class":3382},[43,6509,5650],{"class":1277},[43,6511,4511],{"class":53},[43,6513,6514],{"class":1418},"sample",[43,6516,1422],{"class":53},[43,6518,6519],{"class":1418},"variant_ids",[43,6521,1598],{"class":53},[43,6523,5650],{"class":1418},[43,6525,4511],{"class":53},[43,6527,5318],{"class":1418},[43,6529,1422],{"class":53},[43,6531,4948],{"class":148},[43,6533,1598],{"class":53},[43,6535,6536],{"class":1418}," max",[43,6538,1422],{"class":53},[43,6540,4948],{"class":148},[43,6542,1598],{"class":53},[43,6544,6480],{"class":1418},[43,6546,6547],{"class":53},"))):\n",[43,6549,6551,6553,6555,6558,6560,6563,6565,6567,6569,6571,6573,6575,6577,6580,6582,6584,6586,6588,6590,6592,6594,6597,6599,6601,6603,6605,6607,6609,6611,6613,6615,6617,6619,6621],{"class":45,"line":6550},201,[43,6552,6193],{"class":3382},[43,6554,1587],{"class":53},[43,6556,6557],{"class":1277},"oid",[43,6559,1598],{"class":53},[43,6561,6562],{"class":1277}," vid",[43,6564,1598],{"class":53},[43,6566,5650],{"class":1277},[43,6568,4511],{"class":53},[43,6570,5318],{"class":1418},[43,6572,1422],{"class":53},[43,6574,4948],{"class":148},[43,6576,1598],{"class":53},[43,6578,6579],{"class":148}," 3",[43,6581,6143],{"class":53},[43,6583,6122],{"class":1418},[43,6585,1422],{"class":53},[43,6587,5313],{"class":1418},[43,6589,4511],{"class":53},[43,6591,6131],{"class":1418},[43,6593,1422],{"class":53},[43,6595,6596],{"class":148},"20",[43,6598,1598],{"class":53},[43,6600,6247],{"class":148},[43,6602,6143],{"class":53},[43,6604,6146],{"class":148},[43,6606,6143],{"class":53},[43,6608,3436],{"class":1277},[43,6610,4511],{"class":53},[43,6612,4514],{"class":1418},[43,6614,1422],{"class":53},[43,6616,4519],{"class":1418},[43,6618,4511],{"class":53},[43,6620,4524],{"class":49},[43,6622,6106],{"class":53},[43,6624,6626],{"class":45,"line":6625},202,[43,6627,244],{"emptyLinePlaceholder":243},[43,6629,6631],{"class":45,"line":6630},203,[43,6632,244],{"emptyLinePlaceholder":243},[43,6634,6636,6638,6641,6643,6645,6647,6650,6652,6655,6657,6660,6662,6665,6667,6670,6672,6675,6677,6679,6681,6684],{"class":45,"line":6635},204,[43,6637,4492],{"class":1871},[43,6639,6640],{"class":1418}," print_box_summary",[43,6642,1422],{"class":53},[43,6644,3632],{"class":4546},[43,6646,1598],{"class":53},[43,6648,6649],{"class":4546}," E",[43,6651,1598],{"class":53},[43,6653,6654],{"class":4546}," c_cnt",[43,6656,1598],{"class":53},[43,6658,6659],{"class":4546}," p_cnt",[43,6661,1598],{"class":53},[43,6663,6664],{"class":4546}," v_cnt",[43,6666,1598],{"class":53},[43,6668,6669],{"class":4546}," o_cnt",[43,6671,1598],{"class":53},[43,6673,6674],{"class":4546}," i_cnt",[43,6676,1598],{"class":53},[43,6678,6480],{"class":4546},[43,6680,1598],{"class":53},[43,6682,6683],{"class":4546}," bad_by_cat",[43,6685,5217],{"class":53},[43,6687,6689,6692,6694,6696,6699,6702,6704],{"class":45,"line":6688},205,[43,6690,6691],{"class":1418},"    print",[43,6693,1422],{"class":53},[43,6695,3521],{"class":53},[43,6697,6698],{"class":1277},"\\n",[43,6700,6701],{"class":57},"✅ Data generation complete (idempotent window load)",[43,6703,3521],{"class":53},[43,6705,1405],{"class":53},[43,6707,6709,6711,6713,6716,6719,6721,6723,6725,6727,6729,6731,6734,6736,6739,6741,6743,6745,6747,6749],{"class":45,"line":6708},206,[43,6710,6691],{"class":1418},[43,6712,1422],{"class":53},[43,6714,6715],{"class":1871},"f",[43,6717,6718],{"class":57},"\"Window: ",[43,6720,5680],{"class":148},[43,6722,3632],{"class":1418},[43,6724,4511],{"class":53},[43,6726,5151],{"class":1418},[43,6728,2398],{"class":53},[43,6730,5699],{"class":148},[43,6732,6733],{"class":57}," → ",[43,6735,5680],{"class":148},[43,6737,6738],{"class":1418},"E",[43,6740,4511],{"class":53},[43,6742,5151],{"class":1418},[43,6744,2398],{"class":53},[43,6746,5699],{"class":148},[43,6748,3521],{"class":57},[43,6750,1405],{"class":53},[43,6752,6754,6756,6758,6760,6763,6765,6768,6771,6773,6776,6778,6781,6783,6785,6788,6790,6793,6795,6797,6799],{"class":45,"line":6753},207,[43,6755,6691],{"class":1418},[43,6757,1422],{"class":53},[43,6759,6715],{"class":1871},[43,6761,6762],{"class":57},"\"Counts — Customers: ",[43,6764,5680],{"class":148},[43,6766,6767],{"class":1418},"c_cnt",[43,6769,6770],{"class":1871},":,",[43,6772,5699],{"class":148},[43,6774,6775],{"class":57}," | Products: ",[43,6777,5680],{"class":148},[43,6779,6780],{"class":1418},"p_cnt",[43,6782,6770],{"class":1871},[43,6784,5699],{"class":148},[43,6786,6787],{"class":57}," | Variants: ",[43,6789,5680],{"class":148},[43,6791,6792],{"class":1418},"v_cnt",[43,6794,6770],{"class":1871},[43,6796,5699],{"class":148},[43,6798,3521],{"class":57},[43,6800,1405],{"class":53},[43,6802,6804,6806,6808,6810,6813,6815,6818,6820,6822,6825,6827,6830,6832,6834,6837,6839,6842,6844,6846],{"class":45,"line":6803},208,[43,6805,6691],{"class":1418},[43,6807,1422],{"class":53},[43,6809,6715],{"class":1871},[43,6811,6812],{"class":57},"\"Window Facts — Orders: ",[43,6814,5680],{"class":148},[43,6816,6817],{"class":1418},"o_cnt",[43,6819,6770],{"class":1871},[43,6821,5699],{"class":148},[43,6823,6824],{"class":57}," | Items: ",[43,6826,5680],{"class":148},[43,6828,6829],{"class":1418},"i_cnt",[43,6831,6770],{"class":1871},[43,6833,5699],{"class":148},[43,6835,6836],{"class":57}," | MaxItems/Order: ",[43,6838,5680],{"class":148},[43,6840,6841],{"class":1418},"max_items",[43,6843,5699],{"class":148},[43,6845,3521],{"class":57},[43,6847,1405],{"class":53},[43,6849,6851,6853,6855,6857,6860,6862],{"class":45,"line":6850},209,[43,6852,6691],{"class":1418},[43,6854,1422],{"class":53},[43,6856,3521],{"class":53},[43,6858,6859],{"class":57},"Chaos check (invalid sizes per category):",[43,6861,3521],{"class":53},[43,6863,1405],{"class":53},[43,6865,6867,6869,6872,6874,6877,6879,6881],{"class":45,"line":6866},210,[43,6868,5466],{"class":3382},[43,6870,6871],{"class":1277}," cat",[43,6873,1598],{"class":53},[43,6875,6876],{"class":1277}," bad ",[43,6878,5472],{"class":3382},[43,6880,6683],{"class":1277},[43,6882,67],{"class":53},[43,6884,6886,6889,6891,6893,6896,6898,6900,6902,6905,6907,6910,6912,6914,6917],{"class":45,"line":6885},211,[43,6887,6888],{"class":1418},"        print",[43,6890,1422],{"class":53},[43,6892,6715],{"class":1871},[43,6894,6895],{"class":57},"\"  • ",[43,6897,5680],{"class":148},[43,6899,3271],{"class":1418},[43,6901,5699],{"class":148},[43,6903,6904],{"class":57},": ",[43,6906,5680],{"class":148},[43,6908,6909],{"class":1418},"bad",[43,6911,6770],{"class":1871},[43,6913,5699],{"class":148},[43,6915,6916],{"class":57}," invalid\"",[43,6918,1405],{"class":53},[43,6920,6922],{"class":45,"line":6921},212,[43,6923,244],{"emptyLinePlaceholder":243},[43,6925,6927],{"class":45,"line":6926},213,[43,6928,244],{"emptyLinePlaceholder":243},[43,6930,6932,6934,6937],{"class":45,"line":6931},214,[43,6933,4492],{"class":1871},[43,6935,6936],{"class":1418}," main",[43,6938,4498],{"class":53},[43,6940,6942,6945,6947,6949],{"class":45,"line":6941},215,[43,6943,6944],{"class":1277},"    args ",[43,6946,1570],{"class":53},[43,6948,4495],{"class":1418},[43,6950,2416],{"class":53},[43,6952,6954,6957,6959,6962,6964,6967,6969,6971],{"class":45,"line":6953},216,[43,6955,6956],{"class":1277},"    random",[43,6958,4511],{"class":53},[43,6960,6961],{"class":1418},"seed",[43,6963,1422],{"class":53},[43,6965,6966],{"class":1418},"args",[43,6968,4511],{"class":53},[43,6970,6961],{"class":49},[43,6972,1405],{"class":53},[43,6974,6976,6979,6981,6983,6985,6987,6989,6991],{"class":45,"line":6975},217,[43,6977,6978],{"class":1277},"    Faker",[43,6980,4511],{"class":53},[43,6982,6961],{"class":1418},[43,6984,1422],{"class":53},[43,6986,6966],{"class":1418},[43,6988,4511],{"class":53},[43,6990,6961],{"class":49},[43,6992,1405],{"class":53},[43,6994,6996,6999,7001,7004,7006,7008,7010,7012,7014,7016,7018,7020,7022,7024,7026,7028],{"class":45,"line":6995},218,[43,6997,6998],{"class":1277},"    S",[43,7000,1598],{"class":53},[43,7002,7003],{"class":1277}," E ",[43,7005,1570],{"class":53},[43,7007,5209],{"class":1418},[43,7009,1422],{"class":53},[43,7011,6966],{"class":1418},[43,7013,4511],{"class":53},[43,7015,5130],{"class":49},[43,7017,6143],{"class":53},[43,7019,5209],{"class":1418},[43,7021,1422],{"class":53},[43,7023,6966],{"class":1418},[43,7025,4511],{"class":53},[43,7027,5163],{"class":49},[43,7029,1405],{"class":53},[43,7031,7033],{"class":45,"line":7032},219,[43,7034,244],{"emptyLinePlaceholder":243},[43,7036,7038,7040,7042,7044,7046,7049,7051],{"class":45,"line":7037},220,[43,7039,6691],{"class":1418},[43,7041,1422],{"class":53},[43,7043,3521],{"class":53},[43,7045,6698],{"class":1277},[43,7047,7048],{"class":57},"=== Generating E-commerce Demo Data ===",[43,7050,3521],{"class":53},[43,7052,1405],{"class":53},[43,7054,7056,7058,7060,7062,7064,7066,7068,7070,7072,7074,7076,7078,7080,7082,7084,7086,7088,7090,7092],{"class":45,"line":7055},221,[43,7057,6691],{"class":1418},[43,7059,1422],{"class":53},[43,7061,6715],{"class":1871},[43,7063,6718],{"class":57},[43,7065,5680],{"class":148},[43,7067,3632],{"class":1418},[43,7069,4511],{"class":53},[43,7071,5151],{"class":1418},[43,7073,2398],{"class":53},[43,7075,5699],{"class":148},[43,7077,6733],{"class":57},[43,7079,5680],{"class":148},[43,7081,6738],{"class":1418},[43,7083,4511],{"class":53},[43,7085,5151],{"class":1418},[43,7087,2398],{"class":53},[43,7089,5699],{"class":148},[43,7091,3521],{"class":57},[43,7093,1405],{"class":53},[43,7095,7097,7099,7101,7103,7106,7108,7110,7112,7115,7117,7120,7122,7124,7126,7128,7130,7133,7135,7137,7139,7142,7145,7147,7150,7152,7154],{"class":45,"line":7096},222,[43,7098,6691],{"class":1418},[43,7100,1422],{"class":53},[43,7102,6715],{"class":1871},[43,7104,7105],{"class":57},"\"Scale x",[43,7107,5680],{"class":148},[43,7109,6966],{"class":1418},[43,7111,4511],{"class":53},[43,7113,7114],{"class":49},"scale",[43,7116,5699],{"class":148},[43,7118,7119],{"class":57}," | Seed ",[43,7121,5680],{"class":148},[43,7123,6966],{"class":1418},[43,7125,4511],{"class":53},[43,7127,6961],{"class":49},[43,7129,5699],{"class":148},[43,7131,7132],{"class":57}," | Chaos ",[43,7134,5680],{"class":148},[43,7136,6966],{"class":1418},[43,7138,4511],{"class":53},[43,7140,7141],{"class":49},"chaos_percent",[43,7143,7144],{"class":1871},":.1f",[43,7146,5699],{"class":148},[43,7148,7149],{"class":57},"%",[43,7151,6698],{"class":1277},[43,7153,3521],{"class":57},[43,7155,1405],{"class":53},[43,7157,7159],{"class":45,"line":7158},223,[43,7160,244],{"emptyLinePlaceholder":243},[43,7162,7164,7167,7169,7172,7174,7177,7179,7182,7184,7186,7188,7190,7192,7194,7196,7198,7200],{"class":45,"line":7163},224,[43,7165,7166],{"class":1277},"    base_c",[43,7168,1598],{"class":53},[43,7170,7171],{"class":1277}," base_p",[43,7173,1598],{"class":53},[43,7175,7176],{"class":1277}," base_o ",[43,7178,1570],{"class":53},[43,7180,7181],{"class":1277}," args",[43,7183,4511],{"class":53},[43,7185,4252],{"class":49},[43,7187,1598],{"class":53},[43,7189,7181],{"class":1277},[43,7191,4511],{"class":53},[43,7193,4273],{"class":49},[43,7195,1598],{"class":53},[43,7197,7181],{"class":1277},[43,7199,4511],{"class":53},[43,7201,7202],{"class":49},"orders\n",[43,7204,7206,7209,7211,7214,7216,7219,7221,7224,7226,7228,7230,7232,7234,7237,7239,7241,7243,7245,7247,7249,7251,7253,7255],{"class":45,"line":7205},225,[43,7207,7208],{"class":1277},"    n_c",[43,7210,1598],{"class":53},[43,7212,7213],{"class":1277}," n_p",[43,7215,1598],{"class":53},[43,7217,7218],{"class":1277}," n_o ",[43,7220,1570],{"class":53},[43,7222,7223],{"class":1277}," base_c ",[43,7225,1425],{"class":53},[43,7227,7181],{"class":1277},[43,7229,4511],{"class":53},[43,7231,7114],{"class":49},[43,7233,1598],{"class":53},[43,7235,7236],{"class":1277}," base_p ",[43,7238,1425],{"class":53},[43,7240,7181],{"class":1277},[43,7242,4511],{"class":53},[43,7244,7114],{"class":49},[43,7246,1598],{"class":53},[43,7248,7176],{"class":1277},[43,7250,1425],{"class":53},[43,7252,7181],{"class":1277},[43,7254,4511],{"class":53},[43,7256,7257],{"class":49},"scale\n",[43,7259,7261],{"class":45,"line":7260},226,[43,7262,244],{"emptyLinePlaceholder":243},[43,7264,7266,7268,7271,7273,7276,7278,7280,7282,7285,7288,7290,7292],{"class":45,"line":7265},227,[43,7267,5388],{"class":3382},[43,7269,7270],{"class":1277}," psycopg",[43,7272,4511],{"class":53},[43,7274,7275],{"class":1418},"connect",[43,7277,1422],{"class":53},[43,7279,6966],{"class":1418},[43,7281,4511],{"class":53},[43,7283,7284],{"class":49},"dsn",[43,7286,7287],{"class":53},")",[43,7289,5401],{"class":3382},[43,7291,5391],{"class":1277},[43,7293,67],{"class":53},[43,7295,7297,7300,7302,7304,7306,7309,7311,7313,7315,7318],{"class":45,"line":7296},228,[43,7298,7299],{"class":1418},"        execmany",[43,7301,1422],{"class":53},[43,7303,5370],{"class":1418},[43,7305,1598],{"class":53},[43,7307,7308],{"class":1418}," SQL_INSERT_CUSTOMERS",[43,7310,1598],{"class":53},[43,7312,5453],{"class":1418},[43,7314,1422],{"class":53},[43,7316,7317],{"class":1418},"n_c",[43,7319,6106],{"class":53},[43,7321,7323,7325,7327,7329,7331,7334,7336,7338,7340,7343],{"class":45,"line":7322},229,[43,7324,7299],{"class":1418},[43,7326,1422],{"class":53},[43,7328,5370],{"class":1418},[43,7330,1598],{"class":53},[43,7332,7333],{"class":1418}," SQL_INSERT_PRODUCTS",[43,7335,1598],{"class":53},[43,7337,5616],{"class":1418},[43,7339,1422],{"class":53},[43,7341,7342],{"class":1418},"n_p",[43,7344,6106],{"class":53},[43,7346,7348],{"class":45,"line":7347},230,[43,7349,244],{"emptyLinePlaceholder":243},[43,7351,7353,7356,7358,7361,7363,7365,7367,7370,7372,7374,7377,7379],{"class":45,"line":7352},231,[43,7354,7355],{"class":1277},"        prod_rows ",[43,7357,1570],{"class":53},[43,7359,7360],{"class":2063}," list",[43,7362,1422],{"class":53},[43,7364,5370],{"class":1418},[43,7366,4511],{"class":53},[43,7368,7369],{"class":1418},"execute",[43,7371,1422],{"class":53},[43,7373,3521],{"class":53},[43,7375,7376],{"class":57},"SELECT id, category FROM products",[43,7378,3521],{"class":53},[43,7380,6106],{"class":53},[43,7382,7384,7386,7388,7390,7392,7395,7397,7399,7401,7403,7405,7407,7409,7411],{"class":45,"line":7383},232,[43,7385,7299],{"class":1418},[43,7387,1422],{"class":53},[43,7389,5370],{"class":1418},[43,7391,1598],{"class":53},[43,7393,7394],{"class":1418}," SQL_INSERT_VARIANTS",[43,7396,1598],{"class":53},[43,7398,5809],{"class":1418},[43,7400,1422],{"class":53},[43,7402,5814],{"class":1418},[43,7404,1598],{"class":53},[43,7406,7181],{"class":1418},[43,7408,4511],{"class":53},[43,7410,7141],{"class":49},[43,7412,6106],{"class":53},[43,7414,7416],{"class":45,"line":7415},233,[43,7417,244],{"emptyLinePlaceholder":243},[43,7419,7421,7424,7426,7428,7430,7432,7434,7436],{"class":45,"line":7420},234,[43,7422,7423],{"class":3382},"        with",[43,7425,5391],{"class":1277},[43,7427,4511],{"class":53},[43,7429,5396],{"class":1418},[43,7431,2398],{"class":53},[43,7433,5401],{"class":3382},[43,7435,5404],{"class":1277},[43,7437,67],{"class":53},[43,7439,7441,7444,7446,7448,7450,7453,7455,7457,7459,7461,7463],{"class":45,"line":7440},235,[43,7442,7443],{"class":1277},"            cur",[43,7445,4511],{"class":53},[43,7447,7369],{"class":1418},[43,7449,1422],{"class":53},[43,7451,7452],{"class":1418},"SQL_DELETE_ORDERS_IN_WINDOW",[43,7454,1598],{"class":53},[43,7456,1587],{"class":53},[43,7458,3632],{"class":1418},[43,7460,1598],{"class":53},[43,7462,6649],{"class":1418},[43,7464,6106],{"class":53},[43,7466,7468,7471,7473,7475],{"class":45,"line":7467},236,[43,7469,7470],{"class":1277},"        conn",[43,7472,4511],{"class":53},[43,7474,5438],{"class":1418},[43,7476,2416],{"class":53},[43,7478,7480],{"class":45,"line":7479},237,[43,7481,244],{"emptyLinePlaceholder":243},[43,7483,7485,7488,7490,7492,7495,7498,7500,7503,7506,7509,7511,7513,7515,7517,7519,7521,7524,7526],{"class":45,"line":7484},238,[43,7486,7487],{"class":1277},"        cust_ids ",[43,7489,1570],{"class":53},[43,7491,3518],{"class":53},[43,7493,7494],{"class":1277},"r",[43,7496,7497],{"class":53},"[",[43,7499,1935],{"class":148},[43,7501,7502],{"class":53},"]",[43,7504,7505],{"class":3382}," for",[43,7507,7508],{"class":1277}," r ",[43,7510,5472],{"class":3382},[43,7512,5391],{"class":1277},[43,7514,4511],{"class":53},[43,7516,7369],{"class":1418},[43,7518,1422],{"class":53},[43,7520,3521],{"class":53},[43,7522,7523],{"class":57},"SELECT id FROM customers",[43,7525,3521],{"class":53},[43,7527,7528],{"class":53},")]\n",[43,7530,7532,7534,7536,7538,7540,7543,7545,7547,7549,7551,7553,7556,7558,7561,7563,7565],{"class":45,"line":7531},239,[43,7533,7299],{"class":1418},[43,7535,1422],{"class":53},[43,7537,5370],{"class":1418},[43,7539,1598],{"class":53},[43,7541,7542],{"class":1418}," SQL_INSERT_ORDERS",[43,7544,1598],{"class":53},[43,7546,6312],{"class":1418},[43,7548,1422],{"class":53},[43,7550,6317],{"class":1418},[43,7552,1598],{"class":53},[43,7554,7555],{"class":1418}," n_o",[43,7557,1598],{"class":53},[43,7559,7560],{"class":1418}," S",[43,7562,1598],{"class":53},[43,7564,6649],{"class":1418},[43,7566,6106],{"class":53},[43,7568,7570],{"class":45,"line":7569},240,[43,7571,244],{"emptyLinePlaceholder":243},[43,7573,7575,7578,7580,7582,7584,7586,7588,7590,7592,7594,7596,7598,7600,7602,7604,7606,7609,7611,7613,7615,7617,7619,7621,7623,7625,7627],{"class":45,"line":7574},241,[43,7576,7577],{"class":1277},"        order_ids ",[43,7579,1570],{"class":53},[43,7581,3518],{"class":53},[43,7583,7494],{"class":1277},[43,7585,7497],{"class":53},[43,7587,1935],{"class":148},[43,7589,7502],{"class":53},[43,7591,7505],{"class":3382},[43,7593,7508],{"class":1277},[43,7595,5472],{"class":3382},[43,7597,5391],{"class":1277},[43,7599,4511],{"class":53},[43,7601,7369],{"class":1418},[43,7603,1422],{"class":53},[43,7605,3521],{"class":53},[43,7607,7608],{"class":57},"SELECT id FROM orders WHERE order_date BETWEEN ",[43,7610,3801],{"class":148},[43,7612,4041],{"class":57},[43,7614,3801],{"class":148},[43,7616,3521],{"class":53},[43,7618,1598],{"class":53},[43,7620,1587],{"class":53},[43,7622,3632],{"class":1418},[43,7624,1598],{"class":53},[43,7626,6649],{"class":1418},[43,7628,7629],{"class":53},"))]\n",[43,7631,7633,7636,7638,7640,7642,7644,7646,7648,7650,7652,7654,7656,7658,7660,7662,7664,7667,7669],{"class":45,"line":7632},242,[43,7634,7635],{"class":1277},"        variant_ids ",[43,7637,1570],{"class":53},[43,7639,3518],{"class":53},[43,7641,7494],{"class":1277},[43,7643,7497],{"class":53},[43,7645,1935],{"class":148},[43,7647,7502],{"class":53},[43,7649,7505],{"class":3382},[43,7651,7508],{"class":1277},[43,7653,5472],{"class":3382},[43,7655,5391],{"class":1277},[43,7657,4511],{"class":53},[43,7659,7369],{"class":1418},[43,7661,1422],{"class":53},[43,7663,3521],{"class":53},[43,7665,7666],{"class":57},"SELECT id FROM product_variants",[43,7668,3521],{"class":53},[43,7670,7528],{"class":53},[43,7672,7674,7676,7678,7680,7682,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7706],{"class":45,"line":7673},243,[43,7675,7299],{"class":1418},[43,7677,1422],{"class":53},[43,7679,5370],{"class":1418},[43,7681,1598],{"class":53},[43,7683,7684],{"class":1418}," SQL_INSERT_ORDER_ITEMS",[43,7686,1598],{"class":53},[43,7688,6465],{"class":1418},[43,7690,1422],{"class":53},[43,7692,6470],{"class":1418},[43,7694,1598],{"class":53},[43,7696,6475],{"class":1418},[43,7698,1598],{"class":53},[43,7700,7181],{"class":1418},[43,7702,4511],{"class":53},[43,7704,7705],{"class":49},"max_items_per_order",[43,7707,6106],{"class":53},[43,7709,7711],{"class":45,"line":7710},244,[43,7712,244],{"emptyLinePlaceholder":243},[43,7714,7716,7718,7720,7722,7724,7726,7728,7730],{"class":45,"line":7715},245,[43,7717,7423],{"class":3382},[43,7719,5391],{"class":1277},[43,7721,4511],{"class":53},[43,7723,5396],{"class":1418},[43,7725,2398],{"class":53},[43,7727,5401],{"class":3382},[43,7729,5404],{"class":1277},[43,7731,67],{"class":53},[43,7733,7735,7737,7739,7741,7743,7746,7748,7750,7752,7754,7756],{"class":45,"line":7734},246,[43,7736,7443],{"class":1277},[43,7738,4511],{"class":53},[43,7740,7369],{"class":1418},[43,7742,1422],{"class":53},[43,7744,7745],{"class":1418},"SQL_UPDATE_ORDER_TOTALS",[43,7747,1598],{"class":53},[43,7749,1587],{"class":53},[43,7751,3632],{"class":1418},[43,7753,1598],{"class":53},[43,7755,6649],{"class":1418},[43,7757,6106],{"class":53},[43,7759,7761,7763,7765,7767],{"class":45,"line":7760},247,[43,7762,7470],{"class":1277},[43,7764,4511],{"class":53},[43,7766,5438],{"class":1418},[43,7768,2416],{"class":53},[43,7770,7772],{"class":45,"line":7771},248,[43,7773,244],{"emptyLinePlaceholder":243},[43,7775,7777,7779,7781,7783,7785,7787,7789,7791],{"class":45,"line":7776},249,[43,7778,7423],{"class":3382},[43,7780,5391],{"class":1277},[43,7782,4511],{"class":53},[43,7784,5396],{"class":1418},[43,7786,2398],{"class":53},[43,7788,5401],{"class":3382},[43,7790,5404],{"class":1277},[43,7792,67],{"class":53},[43,7794,7796,7798,7800,7802,7804,7807,7809,7811,7813,7815,7818],{"class":45,"line":7795},250,[43,7797,7443],{"class":1277},[43,7799,4511],{"class":53},[43,7801,7369],{"class":1418},[43,7803,1422],{"class":53},[43,7805,7806],{"class":1418},"SQL_STATS_COUNTS",[43,7808,7497],{"class":53},[43,7810,3521],{"class":53},[43,7812,4252],{"class":57},[43,7814,3521],{"class":53},[43,7816,7817],{"class":53},"])",[43,7819,1462],{"class":1277},[43,7821,7823,7826,7828,7830,7832,7835,7838,7840],{"class":45,"line":7822},251,[43,7824,7825],{"class":1277},"            c_cnt ",[43,7827,1570],{"class":53},[43,7829,5404],{"class":1277},[43,7831,4511],{"class":53},[43,7833,7834],{"class":1418},"fetchone",[43,7836,7837],{"class":53},"()[",[43,7839,1935],{"class":148},[43,7841,238],{"class":53},[43,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865],{"class":45,"line":7844},252,[43,7846,7443],{"class":1277},[43,7848,4511],{"class":53},[43,7850,7369],{"class":1418},[43,7852,1422],{"class":53},[43,7854,7806],{"class":1418},[43,7856,7497],{"class":53},[43,7858,3521],{"class":53},[43,7860,4273],{"class":57},[43,7862,3521],{"class":53},[43,7864,7817],{"class":53},[43,7866,1462],{"class":1277},[43,7868,7870,7873,7875,7877,7879,7881,7883,7885],{"class":45,"line":7869},253,[43,7871,7872],{"class":1277},"            p_cnt ",[43,7874,1570],{"class":53},[43,7876,5404],{"class":1277},[43,7878,4511],{"class":53},[43,7880,7834],{"class":1418},[43,7882,7837],{"class":53},[43,7884,1935],{"class":148},[43,7886,238],{"class":53},[43,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910],{"class":45,"line":7889},254,[43,7891,7443],{"class":1277},[43,7893,4511],{"class":53},[43,7895,7369],{"class":1418},[43,7897,1422],{"class":53},[43,7899,7806],{"class":1418},[43,7901,7497],{"class":53},[43,7903,3521],{"class":53},[43,7905,4294],{"class":57},[43,7907,3521],{"class":53},[43,7909,7817],{"class":53},[43,7911,1462],{"class":1277},[43,7913,7915,7918,7920,7922,7924,7926,7928,7930],{"class":45,"line":7914},255,[43,7916,7917],{"class":1277},"            v_cnt ",[43,7919,1570],{"class":53},[43,7921,5404],{"class":1277},[43,7923,4511],{"class":53},[43,7925,7834],{"class":1418},[43,7927,7837],{"class":53},[43,7929,1935],{"class":148},[43,7931,238],{"class":53},[43,7933,7935,7937,7939,7941,7943,7945,7947,7949,7951,7953,7955,7957,7959,7961,7963,7965],{"class":45,"line":7934},256,[43,7936,7443],{"class":1277},[43,7938,4511],{"class":53},[43,7940,7369],{"class":1418},[43,7942,1422],{"class":53},[43,7944,7806],{"class":1418},[43,7946,7497],{"class":53},[43,7948,3521],{"class":53},[43,7950,4315],{"class":57},[43,7952,3521],{"class":53},[43,7954,6405],{"class":53},[43,7956,1587],{"class":53},[43,7958,3632],{"class":1418},[43,7960,1598],{"class":53},[43,7962,6649],{"class":1418},[43,7964,5955],{"class":53},[43,7966,1462],{"class":1277},[43,7968,7970,7973,7975,7977,7979,7981,7983,7985],{"class":45,"line":7969},257,[43,7971,7972],{"class":1277},"            o_cnt ",[43,7974,1570],{"class":53},[43,7976,5404],{"class":1277},[43,7978,4511],{"class":53},[43,7980,7834],{"class":1418},[43,7982,7837],{"class":53},[43,7984,1935],{"class":148},[43,7986,238],{"class":53},[43,7988,7990,7992,7994,7996,7998,8000,8002,8004,8006,8008,8010,8012,8014,8016,8018,8020],{"class":45,"line":7989},258,[43,7991,7443],{"class":1277},[43,7993,4511],{"class":53},[43,7995,7369],{"class":1418},[43,7997,1422],{"class":53},[43,7999,7806],{"class":1418},[43,8001,7497],{"class":53},[43,8003,3521],{"class":53},[43,8005,4342],{"class":57},[43,8007,3521],{"class":53},[43,8009,6405],{"class":53},[43,8011,1587],{"class":53},[43,8013,3632],{"class":1418},[43,8015,1598],{"class":53},[43,8017,6649],{"class":1418},[43,8019,5955],{"class":53},[43,8021,1462],{"class":1277},[43,8023,8025,8028,8030,8032,8034,8036,8038,8040],{"class":45,"line":8024},259,[43,8026,8027],{"class":1277},"            i_cnt ",[43,8029,1570],{"class":53},[43,8031,5404],{"class":1277},[43,8033,4511],{"class":53},[43,8035,7834],{"class":1418},[43,8037,7837],{"class":53},[43,8039,1935],{"class":148},[43,8041,238],{"class":53},[43,8043,8045,8047,8049,8051,8053,8056,8058],{"class":45,"line":8044},260,[43,8046,7443],{"class":1277},[43,8048,4511],{"class":53},[43,8050,7369],{"class":1418},[43,8052,1422],{"class":53},[43,8054,8055],{"class":1418},"SQL_CHAOS_VALIDATION",[43,8057,7287],{"class":53},[43,8059,1462],{"class":1277},[43,8061,8063,8066,8068,8070,8072,8075],{"class":45,"line":8062},261,[43,8064,8065],{"class":1277},"            bad_by_cat ",[43,8067,1570],{"class":53},[43,8069,5404],{"class":1277},[43,8071,4511],{"class":53},[43,8073,8074],{"class":1418},"fetchall",[43,8076,2416],{"class":53},[43,8078,8080],{"class":45,"line":8079},262,[43,8081,244],{"emptyLinePlaceholder":243},[43,8083,8085,8088,8090,8092,8094,8096,8098,8100,8102,8104,8106,8108,8110,8112,8114,8116,8118,8120,8122,8124,8126,8128],{"class":45,"line":8084},263,[43,8086,8087],{"class":1418},"    print_box_summary",[43,8089,1422],{"class":53},[43,8091,3632],{"class":1418},[43,8093,1598],{"class":53},[43,8095,6649],{"class":1418},[43,8097,1598],{"class":53},[43,8099,6654],{"class":1418},[43,8101,1598],{"class":53},[43,8103,6659],{"class":1418},[43,8105,1598],{"class":53},[43,8107,6664],{"class":1418},[43,8109,1598],{"class":53},[43,8111,6669],{"class":1418},[43,8113,1598],{"class":53},[43,8115,6674],{"class":1418},[43,8117,1598],{"class":53},[43,8119,7181],{"class":1418},[43,8121,4511],{"class":53},[43,8123,7705],{"class":49},[43,8125,1598],{"class":53},[43,8127,6683],{"class":1418},[43,8129,1405],{"class":53},[43,8131,8133],{"class":45,"line":8132},264,[43,8134,244],{"emptyLinePlaceholder":243},[43,8136,8138],{"class":45,"line":8137},265,[43,8139,244],{"emptyLinePlaceholder":243},[43,8141,8143,8146,8149,8151,8153,8156,8158],{"class":45,"line":8142},266,[43,8144,8145],{"class":3382},"if",[43,8147,8148],{"class":1277}," __name__ ",[43,8150,5963],{"class":53},[43,8152,299],{"class":53},[43,8154,8155],{"class":57},"__main__",[43,8157,3521],{"class":53},[43,8159,67],{"class":53},[43,8161,8163,8166],{"class":45,"line":8162},267,[43,8164,8165],{"class":1418},"    main",[43,8167,2416],{"class":53},[1992,8169,8170],{},"After that, let's run the script and see if everything works as expected:",[3148,8172,8173,8194],{},[33,8174,8177],{"className":2054,"code":8175,"filename":8176,"language":2056,"meta":38,"style":38},"uv run generate_data.py --dsn postgresql://postgres:postgres@localhost:5432/postgres \n","Bash UV",[40,8178,8179],{"__ignoreMap":38},[43,8180,8181,8183,8185,8188,8191],{"class":45,"line":46},[43,8182,2041],{"class":2063},[43,8184,3163],{"class":57},[43,8186,8187],{"class":57}," generate_data.py",[43,8189,8190],{"class":57}," --dsn",[43,8192,8193],{"class":57}," postgresql://postgres:postgres@localhost:5432/postgres\n",[33,8195,8198],{"className":2054,"code":8196,"filename":8197,"language":2056,"meta":38,"style":38},"make generate-data \n","Bash Makefile",[40,8199,8200],{"__ignoreMap":38},[43,8201,8202,8204],{"class":45,"line":46},[43,8203,3252],{"class":2063},[43,8205,8206],{"class":57}," generate-data\n",[1992,8208,8209],{},"The output should look like this:",[33,8211,8214],{"className":2054,"code":8212,"filename":8213,"language":2056,"meta":38,"style":38},"=== Generating E-commerce Demo Data ===\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nScale x1 | Seed 42 | Chaos 0.0%\n\n\n✅ Data generation complete\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nCounts — Customers: 100 | Products: 50 | Variants: 144\nWindow Facts — Orders: 500 | Items: 1,487 | MaxItems/Order: 5\nChaos check (invalid sizes per category):\n  • accessories: 0 invalid\n  • hoodies: 0 invalid\n  • jackets: 0 invalid\n  • shoes: 0 invalid\n  • t-shirts: 0 invalid\n","Bash Output",[40,8215,8216,8236,8250,8273,8277,8281,8294,8304,8333,8365,8387,8400,8411,8422,8433],{"__ignoreMap":38},[43,8217,8218,8221,8224,8227,8230,8233],{"class":45,"line":46},[43,8219,8220],{"class":57},"===",[43,8222,8223],{"class":57}," Generating",[43,8225,8226],{"class":57}," E-commerce",[43,8228,8229],{"class":57}," Demo",[43,8231,8232],{"class":57}," Data",[43,8234,8235],{"class":57}," ===\n",[43,8237,8238,8241,8244,8247],{"class":45,"line":61},[43,8239,8240],{"class":2063},"Window:",[43,8242,8243],{"class":57}," 2025-10-19T00:00:00+00:00",[43,8245,8246],{"class":57}," →",[43,8248,8249],{"class":57}," 2025-10-19T23:59:59.999999+00:00\n",[43,8251,8252,8255,8258,8260,8263,8265,8267,8270],{"class":45,"line":70},[43,8253,8254],{"class":2063},"Scale",[43,8256,8257],{"class":57}," x1",[43,8259,3277],{"class":53},[43,8261,8262],{"class":2063}," Seed",[43,8264,3690],{"class":148},[43,8266,3277],{"class":53},[43,8268,8269],{"class":2063}," Chaos",[43,8271,8272],{"class":57}," 0.0%\n",[43,8274,8275],{"class":45,"line":78},[43,8276,244],{"emptyLinePlaceholder":243},[43,8278,8279],{"class":45,"line":86},[43,8280,244],{"emptyLinePlaceholder":243},[43,8282,8283,8286,8288,8291],{"class":45,"line":94},[43,8284,8285],{"class":2063},"✅",[43,8287,8232],{"class":57},[43,8289,8290],{"class":57}," generation",[43,8292,8293],{"class":57}," complete\n",[43,8295,8296,8298,8300,8302],{"class":45,"line":108},[43,8297,8240],{"class":2063},[43,8299,8243],{"class":57},[43,8301,8246],{"class":57},[43,8303,8249],{"class":57},[43,8305,8306,8309,8312,8315,8317,8319,8322,8325,8327,8330],{"class":45,"line":119},[43,8307,8308],{"class":2063},"Counts",[43,8310,8311],{"class":57}," —",[43,8313,8314],{"class":57}," Customers:",[43,8316,6034],{"class":148},[43,8318,3277],{"class":53},[43,8320,8321],{"class":2063}," Products:",[43,8323,8324],{"class":148}," 50",[43,8326,3277],{"class":53},[43,8328,8329],{"class":2063}," Variants:",[43,8331,8332],{"class":148}," 144\n",[43,8334,8335,8338,8341,8343,8346,8349,8351,8354,8357,8359,8362],{"class":45,"line":129},[43,8336,8337],{"class":2063},"Window",[43,8339,8340],{"class":57}," Facts",[43,8342,8311],{"class":57},[43,8344,8345],{"class":57}," Orders:",[43,8347,8348],{"class":148}," 500",[43,8350,3277],{"class":53},[43,8352,8353],{"class":2063}," Items:",[43,8355,8356],{"class":57}," 1,487",[43,8358,3277],{"class":53},[43,8360,8361],{"class":2063}," MaxItems/Order:",[43,8363,8364],{"class":148}," 5\n",[43,8366,8367,8370,8373,8376,8379,8382,8385],{"class":45,"line":140},[43,8368,8369],{"class":2063},"Chaos",[43,8371,8372],{"class":57}," check",[43,8374,8375],{"class":1277}," (invalid ",[43,8377,8378],{"class":57},"sizes",[43,8380,8381],{"class":57}," per",[43,8383,8384],{"class":57}," category",[43,8386,5217],{"class":1277},[43,8388,8389,8392,8395,8397],{"class":45,"line":152},[43,8390,8391],{"class":2063},"  •",[43,8393,8394],{"class":57}," accessories:",[43,8396,1737],{"class":148},[43,8398,8399],{"class":57}," invalid\n",[43,8401,8402,8404,8407,8409],{"class":45,"line":162},[43,8403,8391],{"class":2063},[43,8405,8406],{"class":57}," hoodies:",[43,8408,1737],{"class":148},[43,8410,8399],{"class":57},[43,8412,8413,8415,8418,8420],{"class":45,"line":170},[43,8414,8391],{"class":2063},[43,8416,8417],{"class":57}," jackets:",[43,8419,1737],{"class":148},[43,8421,8399],{"class":57},[43,8423,8424,8426,8429,8431],{"class":45,"line":182},[43,8425,8391],{"class":2063},[43,8427,8428],{"class":57}," shoes:",[43,8430,1737],{"class":148},[43,8432,8399],{"class":57},[43,8434,8435,8437,8440,8442],{"class":45,"line":374},[43,8436,8391],{"class":2063},[43,8438,8439],{"class":57}," t-shirts:",[43,8441,1737],{"class":148},[43,8443,8399],{"class":57},[1992,8445,8446],{},"Cool! Now we're ready to start our Bruin Pipeline!",[8448,8449,8450,8454],"details",{},[8451,8452,8453],"summary",{},"Click to expand the Script Argument List",[2135,8455,8456,8472],{},[2138,8457,8458],{},[2141,8459,8460,8463,8466,8469],{},[2144,8461,8462],{},"Argument",[2144,8464,8465],{},"Type",[2144,8467,8468],{},"Default",[2144,8470,8471],{},"Description",[2151,8473,8474,8495,8512,8529,8546,8563,8584,8606],{},[2141,8475,8476,8480,8484,8489],{},[2156,8477,8478],{},[40,8479,4684],{},[2156,8481,8482],{},[40,8483,5040],{},[2156,8485,8486],{},[1977,8487,8488],{},"(required)",[2156,8490,8491,8492],{},"PostgreSQL connection string (DSN). Example: ",[40,8493,8494],{},"postgresql://user:pass@localhost:5432/ecommerce",[2141,8496,8497,8501,8505,8509],{},[2156,8498,8499],{},[40,8500,4724],{},[2156,8502,8503],{},[40,8504,4736],{},[2156,8506,8507],{},[40,8508,4746],{},[2156,8510,8511],{},"Number of customers to generate.",[2141,8513,8514,8518,8522,8526],{},[2156,8515,8516],{},[40,8517,4764],{},[2156,8519,8520],{},[40,8521,4736],{},[2156,8523,8524],{},[40,8525,4783],{},[2156,8527,8528],{},"Number of products to generate.",[2141,8530,8531,8535,8539,8543],{},[2156,8532,8533],{},[40,8534,4801],{},[2156,8536,8537],{},[40,8538,4736],{},[2156,8540,8541],{},[40,8542,4820],{},[2156,8544,8545],{},"Number of orders to generate.",[2141,8547,8548,8552,8556,8560],{},[2156,8549,8550],{},[40,8551,4838],{},[2156,8553,8554],{},[40,8555,4736],{},[2156,8557,8558],{},[40,8559,4857],{},[2156,8561,8562],{},"Maximum number of items per order. Each order will have 1–N items.",[2141,8564,8565,8569,8573,8577],{},[2156,8566,8567],{},[40,8568,4875],{},[2156,8570,8571],{},[40,8572,4886],{},[2156,8574,8575],{},[40,8576,4895],{},[2156,8578,8579,8580,8583],{},"Percentage of product variants that should have ",[1977,8581,8582],{},"invalid sizes"," (used for validation testing).",[2141,8585,8586,8590,8595,8600],{},[2156,8587,8588],{},[40,8589,5029],{},[2156,8591,8592],{},[40,8593,8594],{},"str (ISO date)",[2156,8596,8597],{},[1977,8598,8599],{},"Yesterday at 00:00 UTC",[2156,8601,8602,8603,4511],{},"Beginning of the generated data window. Example: ",[40,8604,8605],{},"2024-01-01",[2141,8607,8608,8612,8616,8621],{},[2156,8609,8610],{},[40,8611,5071],{},[2156,8613,8614],{},[40,8615,8594],{},[2156,8617,8618],{},[1977,8619,8620],{},"Today at 23:59 UTC",[2156,8622,8623,8624,4511],{},"End of the generated data window. Example: ",[40,8625,8626],{},"2024-06-30",[8628,8629,8630],"blockquote",{},[1992,8631,8632,8635,8636,8639],{},[1977,8633,8634],{},"Note:"," You can also run the script with the ",[40,8637,8638],{},"--help"," flag to see the available arguments.",[1973,8641,8643],{"id":8642},"_5-creating-the-bruin-pipeline","5) Creating the Bruin Pipeline",[1992,8645,8646],{},"We have everything structured to start ingesting data into our Bruin Pipeline. So, first, we must create the assets.",[1992,8648,8649],{},"But before that, let's understand the structure of the Bruin Pipeline.",[1992,8651,8652],{},"A pipeline can be created using the Bruin CLI tool:",[33,8654,8657],{"className":2054,"code":8655,"filename":8656,"language":2056,"meta":38,"style":38},"# Example Command\nbruin init default some-feature\n","Bruin CLI",[40,8658,8659,8664],{"__ignoreMap":38},[43,8660,8661],{"class":45,"line":46},[43,8662,8663],{"class":1006},"# Example Command\n",[43,8665,8666,8668,8670,8672],{"class":45,"line":61},[43,8667,2091],{"class":2063},[43,8669,2094],{"class":57},[43,8671,4741],{"class":57},[43,8673,8674],{"class":57}," some-feature\n",[1992,8676,8677],{},"and it will always generate the same structure, where:",[2028,8679,8680,8706,8728],{},[2031,8681,8682,8686],{},[1977,8683,8684],{},[40,8685,31],{},[2028,8687,8688,8691],{},[2031,8689,8690],{},"The main configuration file for your Bruin environment.",[2031,8692,8693,8694,8697,8698,8701,8702,8705],{},"Defines ",[1977,8695,8696],{},"global settings"," like default ",[1977,8699,8700],{},"connections",", variables, and ",[1977,8703,8704],{},"behavior"," for all pipelines.",[2031,8707,8708,8713],{},[1977,8709,8710],{},[40,8711,8712],{},"some-feature/pipeline.yml",[2028,8714,8715,8722,8725],{},[2031,8716,8717,8718,5236],{},"Defines a specific pipeline for a domain or project (in this example, ",[8719,8720,8721],"em",{},"ecommerce",[2031,8723,8724],{},"Describes the end-to-end data flow — which assets to run, their dependencies, and schedules.",[2031,8726,8727],{},"Pipelines are modular, so you can maintain separate ones for different business domains.",[2031,8729,8730,8735],{},[1977,8731,8732],{},[40,8733,8734],{},"some-feature/assets/*",[2028,8736,8737,8740,8743],{},[2031,8738,8739],{},"Contains all the assets — the building blocks of your data pipelines.",[2031,8741,8742],{},"Each asset handles a distinct task: ingesting raw data, transforming it, or generating analytical tables.",[2031,8744,8745,8746,8749],{},"Since every asset is a file, it’s ",[1977,8747,8748],{},"version-controlled, testable, and reusable"," — just like code.",[1992,8751,8752,8753,8756,8757,8760,8761,4511],{},"The important thing to remember is that Bruin will check all files nested inside the ",[40,8754,8755],{},"assets"," folder for filenames with suffix ",[40,8758,8759],{},".asset.yml",", which can be any type of asset ",[40,8762,8763],{},".asset.*",[1992,8765,8766],{},"So, doesn't matter how you organize your pipeline assets, by nesting folders. If you follows the convention proposed, Bruin will understand automagically!",[1973,8768,8770],{"id":8769},"_6-raw-ingestion-assets","6. Raw Ingestion Assets",[1992,8772,8773,8774,8777],{},"Using ",[40,8775,8776],{},"ingestr",", we're able to retrieve data from a source database and ingest it into destination database.",[1992,8779,8780,8781,8784,8785,8788],{},"At our case, the goal is to ingest all the data generated from ",[40,8782,8783],{},"PostgresSQL"," to ",[40,8786,8787],{},"DuckDB",", which will act as our analytical database.",[1992,8790,8791,8792,8794],{},"Let's take a look at our ",[40,8793,8755],{}," and configuration.",[29,8796,8797,8919,8967,9053,9124,9232,9315],{"default-value":1011},[33,8798,8800],{"className":35,"code":8799,"filename":31,"language":37,"meta":38,"style":38},"default_environment: default\nenvironments:\n  default:\n    connections:\n      postgres:\n        - name: pg-default\n          username: postgres\n          password: postgres\n          host: localhost\n          port: 5432\n          database: postgres\n      duckdb:\n        - name: duckdb-default\n          path: duckdb.db\n\n",[40,8801,8802,8810,8816,8823,8830,8837,8848,8857,8866,8875,8884,8893,8900,8910],{"__ignoreMap":38},[43,8803,8804,8806,8808],{"class":45,"line":46},[43,8805,50],{"class":49},[43,8807,54],{"class":53},[43,8809,58],{"class":57},[43,8811,8812,8814],{"class":45,"line":61},[43,8813,64],{"class":49},[43,8815,67],{"class":53},[43,8817,8818,8821],{"class":45,"line":70},[43,8819,8820],{"class":49},"  default",[43,8822,67],{"class":53},[43,8824,8825,8828],{"class":45,"line":78},[43,8826,8827],{"class":49},"    connections",[43,8829,67],{"class":53},[43,8831,8832,8835],{"class":45,"line":86},[43,8833,8834],{"class":49},"      postgres",[43,8836,67],{"class":53},[43,8838,8839,8842,8844,8846],{"class":45,"line":94},[43,8840,8841],{"class":53},"        -",[43,8843,100],{"class":49},[43,8845,54],{"class":53},[43,8847,105],{"class":57},[43,8849,8850,8853,8855],{"class":45,"line":108},[43,8851,8852],{"class":49},"          username",[43,8854,54],{"class":53},[43,8856,116],{"class":57},[43,8858,8859,8862,8864],{"class":45,"line":119},[43,8860,8861],{"class":49},"          password",[43,8863,54],{"class":53},[43,8865,116],{"class":57},[43,8867,8868,8871,8873],{"class":45,"line":129},[43,8869,8870],{"class":49},"          host",[43,8872,54],{"class":53},[43,8874,137],{"class":57},[43,8876,8877,8880,8882],{"class":45,"line":140},[43,8878,8879],{"class":49},"          port",[43,8881,54],{"class":53},[43,8883,149],{"class":148},[43,8885,8886,8889,8891],{"class":45,"line":152},[43,8887,8888],{"class":49},"          database",[43,8890,54],{"class":53},[43,8892,116],{"class":57},[43,8894,8895,8898],{"class":45,"line":162},[43,8896,8897],{"class":49},"      duckdb",[43,8899,67],{"class":53},[43,8901,8902,8904,8906,8908],{"class":45,"line":170},[43,8903,8841],{"class":53},[43,8905,100],{"class":49},[43,8907,54],{"class":53},[43,8909,179],{"class":57},[43,8911,8912,8915,8917],{"class":45,"line":182},[43,8913,8914],{"class":49},"          path",[43,8916,54],{"class":53},[43,8918,190],{"class":57},[33,8920,8922],{"className":35,"code":8921,"filename":915,"language":37,"meta":38,"style":38},"name: ecommerce_pg_to_duckdb\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\n",[40,8923,8924,8933,8937,8943,8955],{"__ignoreMap":38},[43,8925,8926,8928,8930],{"class":45,"line":46},[43,8927,922],{"class":49},[43,8929,54],{"class":53},[43,8931,8932],{"class":57}," ecommerce_pg_to_duckdb\n",[43,8934,8935],{"class":45,"line":61},[43,8936,244],{"emptyLinePlaceholder":243},[43,8938,8939,8941],{"class":45,"line":70},[43,8940,936],{"class":49},[43,8942,67],{"class":53},[43,8944,8945,8947,8949,8951,8953],{"class":45,"line":78},[43,8946,943],{"class":49},[43,8948,54],{"class":53},[43,8950,299],{"class":53},[43,8952,950],{"class":57},[43,8954,305],{"class":53},[43,8956,8957,8959,8961,8963,8965],{"class":45,"line":86},[43,8958,957],{"class":49},[43,8960,54],{"class":53},[43,8962,299],{"class":53},[43,8964,964],{"class":57},[43,8966,305],{"class":53},[33,8968,8969],{"className":35,"code":1010,"filename":1011,"language":37,"meta":38,"style":38},[40,8970,8971,8979,8987,8991,8999,9003,9009,9015,9019,9025,9033,9045],{"__ignoreMap":38},[43,8972,8973,8975,8977],{"class":45,"line":46},[43,8974,922],{"class":49},[43,8976,54],{"class":53},[43,8978,1022],{"class":57},[43,8980,8981,8983,8985],{"class":45,"line":61},[43,8982,1027],{"class":49},[43,8984,54],{"class":53},[43,8986,1032],{"class":57},[43,8988,8989],{"class":45,"line":70},[43,8990,244],{"emptyLinePlaceholder":243},[43,8992,8993,8995,8997],{"class":45,"line":78},[43,8994,1041],{"class":49},[43,8996,54],{"class":53},[43,8998,1046],{"class":57},[43,9000,9001],{"class":45,"line":86},[43,9002,244],{"emptyLinePlaceholder":243},[43,9004,9005,9007],{"class":45,"line":94},[43,9006,1055],{"class":49},[43,9008,67],{"class":53},[43,9010,9011,9013],{"class":45,"line":108},[43,9012,1062],{"class":53},[43,9014,1065],{"class":57},[43,9016,9017],{"class":45,"line":119},[43,9018,244],{"emptyLinePlaceholder":243},[43,9020,9021,9023],{"class":45,"line":129},[43,9022,1074],{"class":49},[43,9024,67],{"class":53},[43,9026,9027,9029,9031],{"class":45,"line":140},[43,9028,1081],{"class":49},[43,9030,54],{"class":53},[43,9032,105],{"class":57},[43,9034,9035,9037,9039,9041,9043],{"class":45,"line":152},[43,9036,1090],{"class":49},[43,9038,54],{"class":53},[43,9040,299],{"class":53},[43,9042,1097],{"class":57},[43,9044,305],{"class":53},[43,9046,9047,9049,9051],{"class":45,"line":162},[43,9048,1104],{"class":49},[43,9050,54],{"class":53},[43,9052,1109],{"class":57},[33,9054,9056],{"className":35,"code":9055,"filename":1113,"language":37,"meta":38,"style":38},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\ntags:\n  - raw\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n",[40,9057,9058,9066,9074,9082,9088,9094,9100,9108,9116],{"__ignoreMap":38},[43,9059,9060,9062,9064],{"class":45,"line":46},[43,9061,922],{"class":49},[43,9063,54],{"class":53},[43,9065,1124],{"class":57},[43,9067,9068,9070,9072],{"class":45,"line":61},[43,9069,1027],{"class":49},[43,9071,54],{"class":53},[43,9073,1032],{"class":57},[43,9075,9076,9078,9080],{"class":45,"line":70},[43,9077,1041],{"class":49},[43,9079,54],{"class":53},[43,9081,1141],{"class":57},[43,9083,9084,9086],{"class":45,"line":78},[43,9085,1055],{"class":49},[43,9087,67],{"class":53},[43,9089,9090,9092],{"class":45,"line":86},[43,9091,1062],{"class":53},[43,9093,1065],{"class":57},[43,9095,9096,9098],{"class":45,"line":94},[43,9097,1074],{"class":49},[43,9099,67],{"class":53},[43,9101,9102,9104,9106],{"class":45,"line":108},[43,9103,1104],{"class":49},[43,9105,54],{"class":53},[43,9107,1109],{"class":57},[43,9109,9110,9112,9114],{"class":45,"line":119},[43,9111,1081],{"class":49},[43,9113,54],{"class":53},[43,9115,105],{"class":57},[43,9117,9118,9120,9122],{"class":45,"line":129},[43,9119,1090],{"class":49},[43,9121,54],{"class":53},[43,9123,1192],{"class":57},[33,9125,9128],{"className":35,"code":9126,"filename":9127,"language":37,"meta":38,"style":38},"name: raw.order_items\ntype: ingestr\n\ndescription: Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\ndepends:\n  - raw.orders\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.order_items\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.order_items.asset.yml",[40,9129,9130,9139,9147,9151,9160,9164,9170,9176,9180,9187,9193,9197,9203,9211,9224],{"__ignoreMap":38},[43,9131,9132,9134,9136],{"class":45,"line":46},[43,9133,922],{"class":49},[43,9135,54],{"class":53},[43,9137,9138],{"class":57}," raw.order_items\n",[43,9140,9141,9143,9145],{"class":45,"line":61},[43,9142,1027],{"class":49},[43,9144,54],{"class":53},[43,9146,1032],{"class":57},[43,9148,9149],{"class":45,"line":70},[43,9150,244],{"emptyLinePlaceholder":243},[43,9152,9153,9155,9157],{"class":45,"line":78},[43,9154,1041],{"class":49},[43,9156,54],{"class":53},[43,9158,9159],{"class":57}," Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n",[43,9161,9162],{"class":45,"line":86},[43,9163,244],{"emptyLinePlaceholder":243},[43,9165,9166,9168],{"class":45,"line":94},[43,9167,1055],{"class":49},[43,9169,67],{"class":53},[43,9171,9172,9174],{"class":45,"line":108},[43,9173,1062],{"class":53},[43,9175,1065],{"class":57},[43,9177,9178],{"class":45,"line":119},[43,9179,244],{"emptyLinePlaceholder":243},[43,9181,9182,9185],{"class":45,"line":129},[43,9183,9184],{"class":49},"depends",[43,9186,67],{"class":53},[43,9188,9189,9191],{"class":45,"line":140},[43,9190,1062],{"class":53},[43,9192,1124],{"class":57},[43,9194,9195],{"class":45,"line":152},[43,9196,244],{"emptyLinePlaceholder":243},[43,9198,9199,9201],{"class":45,"line":162},[43,9200,1074],{"class":49},[43,9202,67],{"class":53},[43,9204,9205,9207,9209],{"class":45,"line":170},[43,9206,1081],{"class":49},[43,9208,54],{"class":53},[43,9210,105],{"class":57},[43,9212,9213,9215,9217,9219,9222],{"class":45,"line":182},[43,9214,1090],{"class":49},[43,9216,54],{"class":53},[43,9218,299],{"class":53},[43,9220,9221],{"class":57},"public.order_items",[43,9223,305],{"class":53},[43,9225,9226,9228,9230],{"class":45,"line":374},[43,9227,1104],{"class":49},[43,9229,54],{"class":53},[43,9231,1109],{"class":57},[33,9233,9236],{"className":35,"code":9234,"filename":9235,"language":37,"meta":38,"style":38},"name: raw.product_variants\ntype: ingestr\ndescription: Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.product_variants\n","orders-performance/assets/ingestion/raw.product_variants.asset.yml",[40,9237,9238,9247,9255,9264,9268,9274,9280,9284,9290,9298,9306],{"__ignoreMap":38},[43,9239,9240,9242,9244],{"class":45,"line":46},[43,9241,922],{"class":49},[43,9243,54],{"class":53},[43,9245,9246],{"class":57}," raw.product_variants\n",[43,9248,9249,9251,9253],{"class":45,"line":61},[43,9250,1027],{"class":49},[43,9252,54],{"class":53},[43,9254,1032],{"class":57},[43,9256,9257,9259,9261],{"class":45,"line":70},[43,9258,1041],{"class":49},[43,9260,54],{"class":53},[43,9262,9263],{"class":57}," Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n",[43,9265,9266],{"class":45,"line":78},[43,9267,244],{"emptyLinePlaceholder":243},[43,9269,9270,9272],{"class":45,"line":86},[43,9271,1055],{"class":49},[43,9273,67],{"class":53},[43,9275,9276,9278],{"class":45,"line":94},[43,9277,1062],{"class":53},[43,9279,1065],{"class":57},[43,9281,9282],{"class":45,"line":108},[43,9283,244],{"emptyLinePlaceholder":243},[43,9285,9286,9288],{"class":45,"line":119},[43,9287,1074],{"class":49},[43,9289,67],{"class":53},[43,9291,9292,9294,9296],{"class":45,"line":129},[43,9293,1104],{"class":49},[43,9295,54],{"class":53},[43,9297,1109],{"class":57},[43,9299,9300,9302,9304],{"class":45,"line":140},[43,9301,1081],{"class":49},[43,9303,54],{"class":53},[43,9305,105],{"class":57},[43,9307,9308,9310,9312],{"class":45,"line":152},[43,9309,1090],{"class":49},[43,9311,54],{"class":53},[43,9313,9314],{"class":57}," public.product_variants\n",[33,9316,9319],{"className":35,"code":9317,"filename":9318,"language":37,"meta":38,"style":38},"name: raw.products\ntype: ingestr\n\ntags:\n  - raw\n\ndescription: Ingest OLTP products from Postgres into DuckDB raw layer.\n\nparameters:\n  source_connection: pg-default\n  source_table: public.products\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.products.asset.yml",[40,9320,9321,9330,9338,9342,9348,9354,9358,9367,9371,9377,9385,9394],{"__ignoreMap":38},[43,9322,9323,9325,9327],{"class":45,"line":46},[43,9324,922],{"class":49},[43,9326,54],{"class":53},[43,9328,9329],{"class":57}," raw.products\n",[43,9331,9332,9334,9336],{"class":45,"line":61},[43,9333,1027],{"class":49},[43,9335,54],{"class":53},[43,9337,1032],{"class":57},[43,9339,9340],{"class":45,"line":70},[43,9341,244],{"emptyLinePlaceholder":243},[43,9343,9344,9346],{"class":45,"line":78},[43,9345,1055],{"class":49},[43,9347,67],{"class":53},[43,9349,9350,9352],{"class":45,"line":86},[43,9351,1062],{"class":53},[43,9353,1065],{"class":57},[43,9355,9356],{"class":45,"line":94},[43,9357,244],{"emptyLinePlaceholder":243},[43,9359,9360,9362,9364],{"class":45,"line":108},[43,9361,1041],{"class":49},[43,9363,54],{"class":53},[43,9365,9366],{"class":57}," Ingest OLTP products from Postgres into DuckDB raw layer.\n",[43,9368,9369],{"class":45,"line":119},[43,9370,244],{"emptyLinePlaceholder":243},[43,9372,9373,9375],{"class":45,"line":129},[43,9374,1074],{"class":49},[43,9376,67],{"class":53},[43,9378,9379,9381,9383],{"class":45,"line":140},[43,9380,1081],{"class":49},[43,9382,54],{"class":53},[43,9384,105],{"class":57},[43,9386,9387,9389,9391],{"class":45,"line":152},[43,9388,1090],{"class":49},[43,9390,54],{"class":53},[43,9392,9393],{"class":57}," public.products\n",[43,9395,9396,9398,9400],{"class":45,"line":162},[43,9397,1104],{"class":49},[43,9399,54],{"class":53},[43,9401,1109],{"class":57},[1992,9403,9404],{},"The pipeline could run everything concurrently, but we're going to run it in a sequential way by awaiting the dependencies to be processed/resolved.",[33,9406,9410],{"className":9407,"code":9408,"language":9409,"meta":38,"style":38},"language-mermaid shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","flowchart TD\n    A[customers] -->|feeds| D[orders]\n    B[products] -->|defines| C[product_variants]\n    D -->|requires| E[order_items]\n    C -->|used by| E\n","mermaid",[40,9411,9412,9417,9422,9427,9432],{"__ignoreMap":38},[43,9413,9414],{"class":45,"line":46},[43,9415,9416],{"class":1277},"flowchart TD\n",[43,9418,9419],{"class":45,"line":61},[43,9420,9421],{"class":1277},"    A[customers] -->|feeds| D[orders]\n",[43,9423,9424],{"class":45,"line":70},[43,9425,9426],{"class":1277},"    B[products] -->|defines| C[product_variants]\n",[43,9428,9429],{"class":45,"line":78},[43,9430,9431],{"class":1277},"    D -->|requires| E[order_items]\n",[43,9433,9434],{"class":45,"line":86},[43,9435,9436],{"class":1277},"    C -->|used by| E\n",[1992,9438,9439],{},"In Airflow or Dagster, you write DAGs in Python — describing explicitly how tasks depend on one another.\nBruin takes a declarative approach: dependencies are simply listed in YAML under the depends: key, and the system automatically resolves execution order and lineage.",[1992,9441,9442],{},"Unlike Airflow (which just schedules tasks) or dbt (which only supports SQL), Bruin allows you to define transformations in both SQL and Python — directly tied to your ingestion assets.",[2135,9444,9445,9455],{},[2138,9446,9447],{},[2141,9448,9449,9452],{},[2144,9450,9451],{},"Pipeline Layer",[2144,9453,9454],{},"Bruin Equivalent",[2151,9456,9457,9468,9476],{},[2141,9458,9459,9462],{},[2156,9460,9461],{},"Ingestion (Airbyte, Fivetran)",[2156,9463,9464,9467],{},[40,9465,9466],{},"type: ingestr"," assets",[2141,9469,9470,9473],{},[2156,9471,9472],{},"Transformation (dbt)",[2156,9474,9475],{},"assets (YML,SQL or Python)",[2141,9477,9478,9481],{},[2156,9479,9480],{},"Orchestration (Airflow, Dagster)",[2156,9482,9483,9484],{},"Implicit asset graph with ",[40,9485,9486],{},"depends:",[1992,9488,9489],{},"Now, let's see if our ingestion layer is working as expected. Using the Bruin CLI, you must run the following command:",[33,9491,9493],{"className":2054,"code":9492,"filename":8656,"language":2056,"meta":38,"style":38},"bruin run orders-performance --tag raw\n",[40,9494,9495],{"__ignoreMap":38},[43,9496,9497,9499,9501,9504,9507],{"class":45,"line":46},[43,9498,2091],{"class":2063},[43,9500,3163],{"class":57},[43,9502,9503],{"class":57}," orders-performance",[43,9505,9506],{"class":57}," --tag",[43,9508,1065],{"class":57},[1992,9510,9511],{},"The output must be something like this:",[3364,9513,9514],{},[33,9515,9517],{"className":2054,"code":9516,"language":2056,"meta":38,"style":38},"Analyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\nStarting the pipeline execution...\n\n[20:24:23] Running:  raw.products\n[20:24:23] Running:  raw.customers\n[20:24:23] Running:  raw.orders\n[20:24:23] Running:  raw.product_variants\n\n...[logs]...\n\nPASS raw.products \nPASS raw.customers \nPASS raw.orders \nPASS raw.order_items \nPASS raw.product_variants \n\nbruin run completed successfully in 16.704s\n\n ✓ Assets executed      5 succeeded\n",[40,9518,9519,9546,9550,9561,9572,9576,9605,9609,9623,9635,9639,9651,9662,9673,9684,9688,9699,9703,9714,9723,9732,9741,9750,9754,9772,9776],{"__ignoreMap":38},[43,9520,9521,9524,9527,9530,9532,9535,9537,9540,9543],{"class":45,"line":46},[43,9522,9523],{"class":2063},"Analyzed",[43,9525,9526],{"class":57}," the",[43,9528,9529],{"class":57}," pipeline",[43,9531,1312],{"class":53},[43,9533,9534],{"class":57},"orders_performance",[43,9536,1590],{"class":53},[43,9538,9539],{"class":57}," with",[43,9541,9542],{"class":148}," 15",[43,9544,9545],{"class":57}," assets.\n",[43,9547,9548],{"class":45,"line":61},[43,9549,244],{"emptyLinePlaceholder":243},[43,9551,9552,9555,9558],{"class":45,"line":70},[43,9553,9554],{"class":2063},"Pipeline:",[43,9556,9557],{"class":57}," orders_performance",[43,9559,9560],{"class":1277}," (.)\n",[43,9562,9563,9566,9569],{"class":45,"line":78},[43,9564,9565],{"class":2063},"  No",[43,9567,9568],{"class":57}," issues",[43,9570,9571],{"class":57}," found\n",[43,9573,9574],{"class":45,"line":86},[43,9575,244],{"emptyLinePlaceholder":243},[43,9577,9578,9581,9584,9587,9589,9591,9594,9596,9599,9602],{"class":45,"line":94},[43,9579,9580],{"class":2063},"✓",[43,9582,9583],{"class":57}," Successfully",[43,9585,9586],{"class":57}," validated",[43,9588,9542],{"class":148},[43,9590,9467],{"class":57},[43,9592,9593],{"class":57}," across",[43,9595,1003],{"class":148},[43,9597,9598],{"class":57}," pipeline,",[43,9600,9601],{"class":57}," all",[43,9603,9604],{"class":57}," good.\n",[43,9606,9607],{"class":45,"line":108},[43,9608,244],{"emptyLinePlaceholder":243},[43,9610,9611,9614,9617,9620],{"class":45,"line":119},[43,9612,9613],{"class":2063},"Interval:",[43,9615,9616],{"class":57}," 2025-10-17T00:00:00Z",[43,9618,9619],{"class":57}," -",[43,9621,9622],{"class":57}," 2025-10-17T23:59:59Z\n",[43,9624,9625,9628,9630,9632],{"class":45,"line":129},[43,9626,9627],{"class":2063},"Starting",[43,9629,9526],{"class":57},[43,9631,9529],{"class":57},[43,9633,9634],{"class":57}," execution...\n",[43,9636,9637],{"class":45,"line":140},[43,9638,244],{"emptyLinePlaceholder":243},[43,9640,9641,9643,9646,9648],{"class":45,"line":152},[43,9642,7497],{"class":53},[43,9644,9645],{"class":1277},"20:24:23",[43,9647,7502],{"class":53},[43,9649,9650],{"class":1277}," Running:  raw.products\n",[43,9652,9653,9655,9657,9659],{"class":45,"line":162},[43,9654,7497],{"class":53},[43,9656,9645],{"class":1277},[43,9658,7502],{"class":53},[43,9660,9661],{"class":1277}," Running:  raw.customers\n",[43,9663,9664,9666,9668,9670],{"class":45,"line":170},[43,9665,7497],{"class":53},[43,9667,9645],{"class":1277},[43,9669,7502],{"class":53},[43,9671,9672],{"class":1277}," Running:  raw.orders\n",[43,9674,9675,9677,9679,9681],{"class":45,"line":182},[43,9676,7497],{"class":53},[43,9678,9645],{"class":1277},[43,9680,7502],{"class":53},[43,9682,9683],{"class":1277}," Running:  raw.product_variants\n",[43,9685,9686],{"class":45,"line":374},[43,9687,244],{"emptyLinePlaceholder":243},[43,9689,9690,9693,9696],{"class":45,"line":382},[43,9691,9692],{"class":1418},"...",[43,9694,9695],{"class":57},"[logs]",[43,9697,9698],{"class":1418},"...\n",[43,9700,9701],{"class":45,"line":392},[43,9702,244],{"emptyLinePlaceholder":243},[43,9704,9705,9708,9711],{"class":45,"line":399},[43,9706,9707],{"class":2063},"PASS",[43,9709,9710],{"class":57}," raw.products",[43,9712,9713],{"class":1277}," \n",[43,9715,9716,9718,9721],{"class":45,"line":410},[43,9717,9707],{"class":2063},[43,9719,9720],{"class":57}," raw.customers",[43,9722,9713],{"class":1277},[43,9724,9725,9727,9730],{"class":45,"line":417},[43,9726,9707],{"class":2063},[43,9728,9729],{"class":57}," raw.orders",[43,9731,9713],{"class":1277},[43,9733,9734,9736,9739],{"class":45,"line":425},[43,9735,9707],{"class":2063},[43,9737,9738],{"class":57}," raw.order_items",[43,9740,9713],{"class":1277},[43,9742,9743,9745,9748],{"class":45,"line":430},[43,9744,9707],{"class":2063},[43,9746,9747],{"class":57}," raw.product_variants",[43,9749,9713],{"class":1277},[43,9751,9752],{"class":45,"line":438},[43,9753,244],{"emptyLinePlaceholder":243},[43,9755,9756,9758,9760,9763,9766,9769],{"class":45,"line":446},[43,9757,2091],{"class":2063},[43,9759,3163],{"class":57},[43,9761,9762],{"class":57}," completed",[43,9764,9765],{"class":57}," successfully",[43,9767,9768],{"class":57}," in",[43,9770,9771],{"class":57}," 16.704s\n",[43,9773,9774],{"class":45,"line":456},[43,9775,244],{"emptyLinePlaceholder":243},[43,9777,9778,9781,9784,9787,9790],{"class":45,"line":464},[43,9779,9780],{"class":2063}," ✓",[43,9782,9783],{"class":57}," Assets",[43,9785,9786],{"class":57}," executed",[43,9788,9789],{"class":148},"      5",[43,9791,9792],{"class":57}," succeeded\n",[8628,9794,9795],{},[1992,9796,9797,9798,9801],{},"Note that using the ",[40,9799,9800],{},"--tag"," option we'll run only the assets that have the specified tag, avoiding the execution of unnecessary assets.",[1973,9803,9805],{"id":9804},"_7-implementing-quality-checks-staging-layer","7) Implementing Quality Checks (Staging layer)",[1992,9807,9808,9809,9812],{},"The staging layer is where raw data gets ",[1977,9810,9811],{},"cleaned, validated, and prepared"," for analytics. Unlike the raw layer (which mirrors source systems exactly), staging applies business rules, data quality checks, and standardized transformations that make downstream analysis reliable and consistent.",[1992,9814,9815,9816,9819,9820,9823,9824,9827],{},"In Bruin, the staging layer combines ",[1977,9817,9818],{},"SQL transformations"," with ",[1977,9821,9822],{},"declarative quality checks"," defined in your ",[40,9825,9826],{},"columns"," inside an asset.",[29,9829,9831,10011,10137,10481,10658,10841],{"default-value":9830},"stg.customers.asset.sql",[33,9832,9834],{"className":1195,"code":9833,"filename":1819,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns:\n  - extends: Customer.ID\n  - extends: Customer.Email\n  - extends: Customer.Country\n  - extends: Customer.Age\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[40,9835,9836,9840,9844,9848,9852,9856,9860,9864,9869,9873,9878,9883,9888,9893,9898,9903,9908,9912,9916,9922,9933,9951,9973,9987,9991,9995,10001],{"__ignoreMap":38},[43,9837,9838],{"class":45,"line":46},[43,9839,1205],{"class":1006},[43,9841,9842],{"class":45,"line":61},[43,9843,1830],{"class":1006},[43,9845,9846],{"class":45,"line":70},[43,9847,1215],{"class":1006},[43,9849,9850],{"class":45,"line":78},[43,9851,1235],{"class":1006},[43,9853,9854],{"class":45,"line":86},[43,9855,1240],{"class":1006},[43,9857,9858],{"class":45,"line":94},[43,9859,1250],{"class":1006},[43,9861,9862],{"class":45,"line":108},[43,9863,1851],{"class":1006},[43,9865,9866],{"class":45,"line":119},[43,9867,9868],{"class":1006},"owner: daniel@gmail.com\n",[43,9870,9871],{"class":45,"line":129},[43,9872,244],{"emptyLinePlaceholder":243},[43,9874,9875],{"class":45,"line":140},[43,9876,9877],{"class":1006},"columns:\n",[43,9879,9880],{"class":45,"line":152},[43,9881,9882],{"class":1006},"  - extends: Customer.ID\n",[43,9884,9885],{"class":45,"line":162},[43,9886,9887],{"class":1006},"  - extends: Customer.Email\n",[43,9889,9890],{"class":45,"line":170},[43,9891,9892],{"class":1006},"  - extends: Customer.Country\n",[43,9894,9895],{"class":45,"line":182},[43,9896,9897],{"class":1006},"  - extends: Customer.Age\n",[43,9899,9900],{"class":45,"line":374},[43,9901,9902],{"class":1006},"  - extends: Base.CreatedAt\n",[43,9904,9905],{"class":45,"line":382},[43,9906,9907],{"class":1006},"  - extends: Base.UpdatedAt\n",[43,9909,9910],{"class":45,"line":392},[43,9911,1265],{"class":1006},[43,9913,9914],{"class":45,"line":399},[43,9915,244],{"emptyLinePlaceholder":243},[43,9917,9918,9920],{"class":45,"line":410},[43,9919,1410],{"class":148},[43,9921,9713],{"class":1277},[43,9923,9924,9926,9928,9930],{"class":45,"line":417},[43,9925,1868],{"class":1277},[43,9927,1872],{"class":1871},[43,9929,1389],{"class":148},[43,9931,9932],{"class":1277}," customer_id, \n",[43,9934,9935,9937,9939,9941,9943,9945,9947,9949],{"class":45,"line":425},[43,9936,1882],{"class":1418},[43,9938,1422],{"class":1277},[43,9940,1887],{"class":1418},[43,9942,1890],{"class":1277},[43,9944,1893],{"class":53},[43,9946,1428],{"class":1277},[43,9948,1281],{"class":148},[43,9950,1900],{"class":1277},[43,9952,9953,9955,9957,9959,9961,9963,9965,9967,9969,9971],{"class":45,"line":430},[43,9954,1882],{"class":1418},[43,9956,1422],{"class":1277},[43,9958,1887],{"class":1418},[43,9960,1911],{"class":1277},[43,9962,1590],{"class":53},[43,9964,1916],{"class":57},[43,9966,1590],{"class":53},[43,9968,1428],{"class":1277},[43,9970,1281],{"class":148},[43,9972,1925],{"class":1277},[43,9974,9975,9977,9979,9981,9983,9985],{"class":45,"line":438},[43,9976,1882],{"class":1418},[43,9978,1932],{"class":1277},[43,9980,1935],{"class":148},[43,9982,1428],{"class":1277},[43,9984,1281],{"class":148},[43,9986,1942],{"class":1277},[43,9988,9989],{"class":45,"line":446},[43,9990,1947],{"class":1277},[43,9992,9993],{"class":45,"line":456},[43,9994,1952],{"class":1277},[43,9996,9997,9999],{"class":45,"line":464},[43,9998,1438],{"class":148},[43,10000,1022],{"class":1277},[43,10002,10003,10005,10007,10009],{"class":45,"line":472},[43,10004,1963],{"class":148},[43,10006,1966],{"class":1277},[43,10008,1969],{"class":148},[43,10010,1462],{"class":1277},[33,10012,10015],{"className":1195,"code":10013,"filename":10014,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.products\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.products\n\ncolumns:\n  - extends: Product.ID\n  - extends: Product.Name\n  - extends: Product.Category\n  - extends: Product.SKU\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT\n  id AS product_id,\n  name,\n  category,\n  sku,\n  created_at,\n  updated_at\nFROM raw.products;\n","orders-performance/assets/staging/stg.products.sql",[40,10016,10017,10021,10026,10030,10034,10038,10042,10047,10051,10055,10060,10065,10070,10075,10079,10083,10087,10091,10095,10105,10112,10117,10122,10126,10130],{"__ignoreMap":38},[43,10018,10019],{"class":45,"line":46},[43,10020,1205],{"class":1006},[43,10022,10023],{"class":45,"line":61},[43,10024,10025],{"class":1006},"name: stg.products\n",[43,10027,10028],{"class":45,"line":70},[43,10029,1215],{"class":1006},[43,10031,10032],{"class":45,"line":78},[43,10033,1235],{"class":1006},[43,10035,10036],{"class":45,"line":86},[43,10037,1240],{"class":1006},[43,10039,10040],{"class":45,"line":94},[43,10041,1250],{"class":1006},[43,10043,10044],{"class":45,"line":108},[43,10045,10046],{"class":1006},"  - raw.products\n",[43,10048,10049],{"class":45,"line":119},[43,10050,244],{"emptyLinePlaceholder":243},[43,10052,10053],{"class":45,"line":129},[43,10054,9877],{"class":1006},[43,10056,10057],{"class":45,"line":140},[43,10058,10059],{"class":1006},"  - extends: Product.ID\n",[43,10061,10062],{"class":45,"line":152},[43,10063,10064],{"class":1006},"  - extends: Product.Name\n",[43,10066,10067],{"class":45,"line":162},[43,10068,10069],{"class":1006},"  - extends: Product.Category\n",[43,10071,10072],{"class":45,"line":170},[43,10073,10074],{"class":1006},"  - extends: Product.SKU\n",[43,10076,10077],{"class":45,"line":182},[43,10078,9902],{"class":1006},[43,10080,10081],{"class":45,"line":374},[43,10082,9907],{"class":1006},[43,10084,10085],{"class":45,"line":382},[43,10086,1265],{"class":1006},[43,10088,10089],{"class":45,"line":392},[43,10090,244],{"emptyLinePlaceholder":243},[43,10092,10093],{"class":45,"line":399},[43,10094,1674],{"class":148},[43,10096,10097,10100,10102],{"class":45,"line":410},[43,10098,10099],{"class":1277},"  id ",[43,10101,1281],{"class":148},[43,10103,10104],{"class":1277}," product_id,\n",[43,10106,10107,10110],{"class":45,"line":417},[43,10108,10109],{"class":148},"  name",[43,10111,2316],{"class":1277},[43,10113,10114],{"class":45,"line":425},[43,10115,10116],{"class":1277},"  category,\n",[43,10118,10119],{"class":45,"line":430},[43,10120,10121],{"class":1277},"  sku,\n",[43,10123,10124],{"class":45,"line":438},[43,10125,1947],{"class":1277},[43,10127,10128],{"class":45,"line":446},[43,10129,1952],{"class":1277},[43,10131,10132,10134],{"class":45,"line":456},[43,10133,1438],{"class":148},[43,10135,10136],{"class":1277}," raw.products;\n",[33,10138,10141],{"className":1195,"code":10139,"filename":10140,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.product_variants\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.product_variants\n  - stg.products\n\ncolumns:\n  - extends: Variant.ID\n  - extends: Variant.ProductID\n  - extends: Variant.VariantSKU\n  - extends: Variant.Color\n  - extends: Variant.Size\n  - extends: Variant.ManufacturingPrice\n  - extends: Variant.SellingPrice\n  - extends: Variant.StockQuantity\n  - extends: Variant.IsActive\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n\ncustom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n@bruin */\n\nSELECT\n  pv.id AS variant_id,\n  pv.product_id,\n  pv.variant_sku,\n  pv.color,\n  pv.size,\n  CASE WHEN pv.manufacturing_price \u003C 0 THEN 0 ELSE pv.manufacturing_price END AS manufacturing_price,\n  CASE WHEN pv.selling_price \u003C 0 THEN 0 ELSE pv.selling_price END AS selling_price,\n  CASE WHEN pv.stock_quantity \u003C 0 THEN 0 ELSE pv.stock_quantity END AS stock_quantity,\n  COALESCE(pv.is_active, TRUE) AS is_active,\n  pv.created_at,\n  pv.updated_at\nFROM raw.product_variants pv\nJOIN stg.products p ON p.product_id = pv.product_id;\n","orders-performance/assets/staging/stg.product_variants.sql",[40,10142,10143,10147,10152,10156,10160,10164,10168,10172,10177,10181,10185,10189,10194,10199,10204,10209,10214,10219,10224,10229,10234,10238,10242,10246,10251,10256,10261,10266,10271,10276,10281,10286,10291,10296,10301,10306,10311,10315,10319,10323,10333,10338,10343,10348,10353,10381,10409,10437,10449,10454,10459,10466],{"__ignoreMap":38},[43,10144,10145],{"class":45,"line":46},[43,10146,1205],{"class":1006},[43,10148,10149],{"class":45,"line":61},[43,10150,10151],{"class":1006},"name: stg.product_variants\n",[43,10153,10154],{"class":45,"line":70},[43,10155,1215],{"class":1006},[43,10157,10158],{"class":45,"line":78},[43,10159,1235],{"class":1006},[43,10161,10162],{"class":45,"line":86},[43,10163,1240],{"class":1006},[43,10165,10166],{"class":45,"line":94},[43,10167,1245],{"class":1006},[43,10169,10170],{"class":45,"line":108},[43,10171,1250],{"class":1006},[43,10173,10174],{"class":45,"line":119},[43,10175,10176],{"class":1006},"  - raw.product_variants\n",[43,10178,10179],{"class":45,"line":129},[43,10180,1502],{"class":1006},[43,10182,10183],{"class":45,"line":140},[43,10184,244],{"emptyLinePlaceholder":243},[43,10186,10187],{"class":45,"line":152},[43,10188,9877],{"class":1006},[43,10190,10191],{"class":45,"line":162},[43,10192,10193],{"class":1006},"  - extends: Variant.ID\n",[43,10195,10196],{"class":45,"line":170},[43,10197,10198],{"class":1006},"  - extends: Variant.ProductID\n",[43,10200,10201],{"class":45,"line":182},[43,10202,10203],{"class":1006},"  - extends: Variant.VariantSKU\n",[43,10205,10206],{"class":45,"line":374},[43,10207,10208],{"class":1006},"  - extends: Variant.Color\n",[43,10210,10211],{"class":45,"line":382},[43,10212,10213],{"class":1006},"  - extends: Variant.Size\n",[43,10215,10216],{"class":45,"line":392},[43,10217,10218],{"class":1006},"  - extends: Variant.ManufacturingPrice\n",[43,10220,10221],{"class":45,"line":399},[43,10222,10223],{"class":1006},"  - extends: Variant.SellingPrice\n",[43,10225,10226],{"class":45,"line":410},[43,10227,10228],{"class":1006},"  - extends: Variant.StockQuantity\n",[43,10230,10231],{"class":45,"line":417},[43,10232,10233],{"class":1006},"  - extends: Variant.IsActive\n",[43,10235,10236],{"class":45,"line":425},[43,10237,9902],{"class":1006},[43,10239,10240],{"class":45,"line":430},[43,10241,9907],{"class":1006},[43,10243,10244],{"class":45,"line":438},[43,10245,244],{"emptyLinePlaceholder":243},[43,10247,10248],{"class":45,"line":446},[43,10249,10250],{"class":1006},"custom_checks:\n",[43,10252,10253],{"class":45,"line":456},[43,10254,10255],{"class":1006},"  - name: validate product variant sizes\n",[43,10257,10258],{"class":45,"line":464},[43,10259,10260],{"class":1006},"    description: |\n",[43,10262,10263],{"class":45,"line":472},[43,10264,10265],{"class":1006},"      Ensures that if the product category is 'shoes', the size must be numeric.\n",[43,10267,10268],{"class":45,"line":483},[43,10269,10270],{"class":1006},"      Otherwise, the size must be one of ['S', 'M', 'L'].\n",[43,10272,10273],{"class":45,"line":494},[43,10274,10275],{"class":1006},"    value: 0\n",[43,10277,10278],{"class":45,"line":506},[43,10279,10280],{"class":1006},"    query: |\n",[43,10282,10283],{"class":45,"line":517},[43,10284,10285],{"class":1006},"      SELECT COUNT(*) AS invalid_count\n",[43,10287,10288],{"class":45,"line":525},[43,10289,10290],{"class":1006},"      FROM raw.product_variants v\n",[43,10292,10293],{"class":45,"line":538},[43,10294,10295],{"class":1006},"      JOIN stg.products p ON p.product_id = v.product_id\n",[43,10297,10298],{"class":45,"line":550},[43,10299,10300],{"class":1006},"      WHERE\n",[43,10302,10303],{"class":45,"line":558},[43,10304,10305],{"class":1006},"        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n",[43,10307,10308],{"class":45,"line":568},[43,10309,10310],{"class":1006},"        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[43,10312,10313],{"class":45,"line":578},[43,10314,1265],{"class":1006},[43,10316,10317],{"class":45,"line":588},[43,10318,244],{"emptyLinePlaceholder":243},[43,10320,10321],{"class":45,"line":595},[43,10322,1674],{"class":148},[43,10324,10325,10328,10330],{"class":45,"line":606},[43,10326,10327],{"class":1277},"  pv.id ",[43,10329,1281],{"class":148},[43,10331,10332],{"class":1277}," variant_id,\n",[43,10334,10335],{"class":45,"line":614},[43,10336,10337],{"class":1277},"  pv.product_id,\n",[43,10339,10340],{"class":45,"line":624},[43,10341,10342],{"class":1277},"  pv.variant_sku,\n",[43,10344,10345],{"class":45,"line":633},[43,10346,10347],{"class":1277},"  pv.color,\n",[43,10349,10350],{"class":45,"line":643},[43,10351,10352],{"class":1277},"  pv.size,\n",[43,10354,10355,10357,10359,10362,10364,10366,10368,10370,10372,10374,10376,10378],{"class":45,"line":650},[43,10356,1724],{"class":148},[43,10358,1727],{"class":148},[43,10360,10361],{"class":1277}," pv.manufacturing_price ",[43,10363,1303],{"class":53},[43,10365,1737],{"class":148},[43,10367,1309],{"class":148},[43,10369,1737],{"class":148},[43,10371,1744],{"class":148},[43,10373,10361],{"class":1277},[43,10375,1758],{"class":148},[43,10377,1389],{"class":148},[43,10379,10380],{"class":1277}," manufacturing_price,\n",[43,10382,10383,10385,10387,10390,10392,10394,10396,10398,10400,10402,10404,10406],{"class":45,"line":661},[43,10384,1724],{"class":148},[43,10386,1727],{"class":148},[43,10388,10389],{"class":1277}," pv.selling_price ",[43,10391,1303],{"class":53},[43,10393,1737],{"class":148},[43,10395,1309],{"class":148},[43,10397,1737],{"class":148},[43,10399,1744],{"class":148},[43,10401,10389],{"class":1277},[43,10403,1758],{"class":148},[43,10405,1389],{"class":148},[43,10407,10408],{"class":1277}," selling_price,\n",[43,10410,10411,10413,10415,10418,10420,10422,10424,10426,10428,10430,10432,10434],{"class":45,"line":669},[43,10412,1724],{"class":148},[43,10414,1727],{"class":148},[43,10416,10417],{"class":1277}," pv.stock_quantity ",[43,10419,1303],{"class":53},[43,10421,1737],{"class":148},[43,10423,1309],{"class":148},[43,10425,1737],{"class":148},[43,10427,1744],{"class":148},[43,10429,10417],{"class":1277},[43,10431,1758],{"class":148},[43,10433,1389],{"class":148},[43,10435,10436],{"class":1277}," stock_quantity,\n",[43,10438,10439,10441,10444,10446],{"class":45,"line":679},[43,10440,1882],{"class":1418},[43,10442,10443],{"class":1277},"(pv.is_active, TRUE) ",[43,10445,1281],{"class":148},[43,10447,10448],{"class":1277}," is_active,\n",[43,10450,10451],{"class":45,"line":687},[43,10452,10453],{"class":1277},"  pv.created_at,\n",[43,10455,10456],{"class":45,"line":695},[43,10457,10458],{"class":1277},"  pv.updated_at\n",[43,10460,10461,10463],{"class":45,"line":702},[43,10462,1438],{"class":148},[43,10464,10465],{"class":1277}," raw.product_variants pv\n",[43,10467,10468,10470,10472,10474,10476,10478],{"class":45,"line":709},[43,10469,1775],{"class":148},[43,10471,1778],{"class":1277},[43,10473,1564],{"class":148},[43,10475,1783],{"class":1277},[43,10477,1570],{"class":53},[43,10479,10480],{"class":1277}," pv.product_id;\n",[33,10482,10485],{"className":1195,"code":10483,"filename":10484,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.orders\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.orders\n  - raw.customers\n\ncolumns:\n  - extends: Order.ID\n  - extends: Order.CustomerID\n  - extends: Order.OrderDate\n  - extends: Order.Status\n  - extends: Order.TotalAmount\n@bruin */\n\nWITH src AS (\n  SELECT\n    o.id              AS order_id,\n    o.customer_id,\n    o.order_date,\n    o.status,\n    CASE WHEN o.total_amount \u003C 0 THEN 0 ELSE o.total_amount END AS total_amount\n  FROM raw.orders o\n)\nSELECT * FROM src;\n","orders-performance/assets/staging/stg.orders.sql",[40,10486,10487,10491,10496,10500,10504,10508,10512,10516,10521,10525,10529,10533,10538,10543,10548,10553,10558,10562,10566,10576,10580,10590,10595,10600,10605,10634,10641,10645],{"__ignoreMap":38},[43,10488,10489],{"class":45,"line":46},[43,10490,1205],{"class":1006},[43,10492,10493],{"class":45,"line":61},[43,10494,10495],{"class":1006},"name: stg.orders\n",[43,10497,10498],{"class":45,"line":70},[43,10499,1215],{"class":1006},[43,10501,10502],{"class":45,"line":78},[43,10503,1235],{"class":1006},[43,10505,10506],{"class":45,"line":86},[43,10507,1240],{"class":1006},[43,10509,10510],{"class":45,"line":94},[43,10511,1245],{"class":1006},[43,10513,10514],{"class":45,"line":108},[43,10515,1250],{"class":1006},[43,10517,10518],{"class":45,"line":119},[43,10519,10520],{"class":1006},"  - raw.orders\n",[43,10522,10523],{"class":45,"line":129},[43,10524,1851],{"class":1006},[43,10526,10527],{"class":45,"line":140},[43,10528,244],{"emptyLinePlaceholder":243},[43,10530,10531],{"class":45,"line":152},[43,10532,9877],{"class":1006},[43,10534,10535],{"class":45,"line":162},[43,10536,10537],{"class":1006},"  - extends: Order.ID\n",[43,10539,10540],{"class":45,"line":170},[43,10541,10542],{"class":1006},"  - extends: Order.CustomerID\n",[43,10544,10545],{"class":45,"line":182},[43,10546,10547],{"class":1006},"  - extends: Order.OrderDate\n",[43,10549,10550],{"class":45,"line":374},[43,10551,10552],{"class":1006},"  - extends: Order.Status\n",[43,10554,10555],{"class":45,"line":382},[43,10556,10557],{"class":1006},"  - extends: Order.TotalAmount\n",[43,10559,10560],{"class":45,"line":392},[43,10561,1265],{"class":1006},[43,10563,10564],{"class":45,"line":399},[43,10565,244],{"emptyLinePlaceholder":243},[43,10567,10568,10570,10572,10574],{"class":45,"line":410},[43,10569,1274],{"class":148},[43,10571,1278],{"class":1277},[43,10573,1281],{"class":148},[43,10575,1284],{"class":1277},[43,10577,10578],{"class":45,"line":417},[43,10579,1626],{"class":148},[43,10581,10582,10585,10587],{"class":45,"line":425},[43,10583,10584],{"class":1277},"    o.id              ",[43,10586,1281],{"class":148},[43,10588,10589],{"class":1277}," order_id,\n",[43,10591,10592],{"class":45,"line":430},[43,10593,10594],{"class":1277},"    o.customer_id,\n",[43,10596,10597],{"class":45,"line":438},[43,10598,10599],{"class":1277},"    o.order_date,\n",[43,10601,10602],{"class":45,"line":446},[43,10603,10604],{"class":1277},"    o.status,\n",[43,10606,10607,10610,10612,10615,10617,10619,10621,10623,10625,10627,10629,10631],{"class":45,"line":456},[43,10608,10609],{"class":148},"    CASE",[43,10611,1727],{"class":148},[43,10613,10614],{"class":1277}," o.total_amount ",[43,10616,1303],{"class":53},[43,10618,1737],{"class":148},[43,10620,1309],{"class":148},[43,10622,1737],{"class":148},[43,10624,1744],{"class":148},[43,10626,10614],{"class":1277},[43,10628,1758],{"class":148},[43,10630,1389],{"class":148},[43,10632,10633],{"class":1277}," total_amount\n",[43,10635,10636,10638],{"class":45,"line":464},[43,10637,1397],{"class":148},[43,10639,10640],{"class":1277}," raw.orders o\n",[43,10642,10643],{"class":45,"line":472},[43,10644,1405],{"class":1277},[43,10646,10647,10649,10652,10655],{"class":45,"line":483},[43,10648,1410],{"class":148},[43,10650,10651],{"class":53}," *",[43,10653,10654],{"class":148}," FROM",[43,10656,10657],{"class":1277}," src;\n",[33,10659,10662],{"className":1195,"code":10660,"filename":10661,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.order_items\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.order_items\n\ncolumns:\n  - extends: OrderItem.ID\n  - extends: OrderItem.OrderID\n  - extends: OrderItem.VariantID\n  - extends: OrderItem.Quantity\n  - extends: OrderItem.UnitPrice\n  - extends: OrderItem.TotalPrice\n  - extends: Base.CreatedAt\n@bruin */\n\nSELECT\n  oi.id AS order_item_id,\n  oi.order_id,\n  oi.variant_id,\n  oi.quantity,\n  CASE WHEN oi.unit_price \u003C 0 THEN 0 ELSE oi.unit_price END AS unit_price,\n  CASE WHEN oi.total_price \u003C 0 THEN 0 ELSE oi.total_price END AS total_price,\n  oi.created_at\nFROM raw.order_items oi;\n","orders-performance/assets/staging/stg.order_items.sql",[40,10663,10664,10668,10673,10677,10681,10685,10689,10694,10698,10702,10707,10712,10717,10722,10727,10732,10736,10740,10744,10748,10758,10763,10768,10773,10801,10829,10834],{"__ignoreMap":38},[43,10665,10666],{"class":45,"line":46},[43,10667,1205],{"class":1006},[43,10669,10670],{"class":45,"line":61},[43,10671,10672],{"class":1006},"name: stg.order_items\n",[43,10674,10675],{"class":45,"line":70},[43,10676,1215],{"class":1006},[43,10678,10679],{"class":45,"line":78},[43,10680,1235],{"class":1006},[43,10682,10683],{"class":45,"line":86},[43,10684,1240],{"class":1006},[43,10686,10687],{"class":45,"line":94},[43,10688,1250],{"class":1006},[43,10690,10691],{"class":45,"line":108},[43,10692,10693],{"class":1006},"  - raw.order_items\n",[43,10695,10696],{"class":45,"line":119},[43,10697,244],{"emptyLinePlaceholder":243},[43,10699,10700],{"class":45,"line":129},[43,10701,9877],{"class":1006},[43,10703,10704],{"class":45,"line":140},[43,10705,10706],{"class":1006},"  - extends: OrderItem.ID\n",[43,10708,10709],{"class":45,"line":152},[43,10710,10711],{"class":1006},"  - extends: OrderItem.OrderID\n",[43,10713,10714],{"class":45,"line":162},[43,10715,10716],{"class":1006},"  - extends: OrderItem.VariantID\n",[43,10718,10719],{"class":45,"line":170},[43,10720,10721],{"class":1006},"  - extends: OrderItem.Quantity\n",[43,10723,10724],{"class":45,"line":182},[43,10725,10726],{"class":1006},"  - extends: OrderItem.UnitPrice\n",[43,10728,10729],{"class":45,"line":374},[43,10730,10731],{"class":1006},"  - extends: OrderItem.TotalPrice\n",[43,10733,10734],{"class":45,"line":382},[43,10735,9902],{"class":1006},[43,10737,10738],{"class":45,"line":392},[43,10739,1265],{"class":1006},[43,10741,10742],{"class":45,"line":399},[43,10743,244],{"emptyLinePlaceholder":243},[43,10745,10746],{"class":45,"line":410},[43,10747,1674],{"class":148},[43,10749,10750,10753,10755],{"class":45,"line":417},[43,10751,10752],{"class":1277},"  oi.id ",[43,10754,1281],{"class":148},[43,10756,10757],{"class":1277}," order_item_id,\n",[43,10759,10760],{"class":45,"line":425},[43,10761,10762],{"class":1277},"  oi.order_id,\n",[43,10764,10765],{"class":45,"line":430},[43,10766,10767],{"class":1277},"  oi.variant_id,\n",[43,10769,10770],{"class":45,"line":438},[43,10771,10772],{"class":1277},"  oi.quantity,\n",[43,10774,10775,10777,10779,10782,10784,10786,10788,10790,10792,10794,10796,10798],{"class":45,"line":446},[43,10776,1724],{"class":148},[43,10778,1727],{"class":148},[43,10780,10781],{"class":1277}," oi.unit_price ",[43,10783,1303],{"class":53},[43,10785,1737],{"class":148},[43,10787,1309],{"class":148},[43,10789,1737],{"class":148},[43,10791,1744],{"class":148},[43,10793,10781],{"class":1277},[43,10795,1758],{"class":148},[43,10797,1389],{"class":148},[43,10799,10800],{"class":1277}," unit_price,\n",[43,10802,10803,10805,10807,10810,10812,10814,10816,10818,10820,10822,10824,10826],{"class":45,"line":456},[43,10804,1724],{"class":148},[43,10806,1727],{"class":148},[43,10808,10809],{"class":1277}," oi.total_price ",[43,10811,1303],{"class":53},[43,10813,1737],{"class":148},[43,10815,1309],{"class":148},[43,10817,1737],{"class":148},[43,10819,1744],{"class":148},[43,10821,10809],{"class":1277},[43,10823,1758],{"class":148},[43,10825,1389],{"class":148},[43,10827,10828],{"class":1277}," total_price,\n",[43,10830,10831],{"class":45,"line":464},[43,10832,10833],{"class":1277},"  oi.created_at\n",[43,10835,10836,10838],{"class":45,"line":472},[43,10837,1438],{"class":148},[43,10839,10840],{"class":1277}," raw.order_items oi;\n",[33,10842,10844],{"className":35,"code":10843,"filename":258,"language":37,"meta":38,"style":38},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fieds for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      \n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        description: Surrogate key for customer in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n        description: Full name of the customer.\n      Country:\n        name: country\n        type: string\n        description: Country of residence.\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n\n  Product:\n    description: A product offered for sale.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: product_id\n        type: integer\n        description: Surrogate key for product in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Name:\n        name: name\n        type: string\n        description: Product display name.\n        checks:\n          - name: not_null\n      Category:\n        name: category\n        type: string\n        description: Product category.\n        checks:\n          - name: not_null\n      SKU:\n        name: sku\n        type: string\n        description: Stock keeping unit for the product.\n        checks:\n          - name: not_null\n          - name: unique\n\n  Variant:\n    description: A specific variation of a product.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: variant_id\n        type: integer\n        description: Surrogate key for variant in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      ProductID:\n        name: product_id\n        type: integer\n        description: Reference to Product.ID.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantSKU:\n        name: variant_sku\n        type: string\n        description: SKU for the variant.\n        checks:\n          - name: not_null\n          - name: unique\n      Color:\n        name: color\n        type: string\n        description: Variant color.\n      Size:\n        name: size\n        type: string\n        description: Variant size.\n      ManufacturingPrice:\n        name: manufacturing_price\n        type: numeric\n        description: Manufacturing cost per unit.\n        checks:\n          - name: not_null\n      SellingPrice:\n        name: selling_price\n        type: numeric\n        description: Selling price per unit.\n        checks:\n          - name: not_null\n      StockQuantity:\n        name: stock_quantity\n        type: integer\n        description: Available stock quantity.\n        checks:\n          - name: not_null\n      IsActive:\n        name: is_active\n        type: boolean\n        description: Whether the variant is active.\n        checks:\n          - name: not_null\n\n  Order:\n    description: A purchase order placed by a customer.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_id\n        type: integer\n        description: Surrogate key for order in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      CustomerID:\n        name: customer_id\n        type: integer\n        description: Reference to Customer.ID for the purchaser.\n        checks:\n          - name: not_null\n          - name: positive\n      OrderNumber:\n        name: order_number\n        type: string\n        description: Human-readable order number.\n      OrderDate:\n        name: order_date\n        type: timestamp\n        description: When the order was placed.\n        checks:\n          - name: not_null\n      Status:\n        name: status\n        type: string\n        description: Order lifecycle status.\n        checks:\n          - name: not_null\n          - name: accepted_values\n            value:\n              - pending\n              - paid\n              - cancelled\n              - shipped\n      TotalAmount:\n        name: total_amount\n        type: numeric\n        description: Total order amount.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n  OrderItem:\n    description: A line item in an order.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_item_id\n        type: integer\n        description: Surrogate key for order item in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      OrderID:\n        name: order_id\n        type: integer\n        description: Reference to Order.ID this item belongs to.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantID:\n        name: variant_id\n        type: integer\n        description: Reference to Variant.ID purchased.\n        checks:\n          - name: not_null\n          - name: positive\n      Quantity:\n        name: quantity\n        type: integer\n        description: Quantity purchased (must be positive).\n        checks:\n          - name: not_null\n          - name: range\n            min: 1\n      UnitPrice:\n        name: unit_price\n        type: numeric\n        description: Price per unit at purchase time.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n      TotalPrice:\n        name: total_price\n        type: numeric\n        description: Total price for the line (Quantity * UnitPrice).\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n",[40,10845,10846,10852,10858,10866,10872,10882,10888,10894,10900,10908,10914,10924,10930,10936,10942,10948,10956,10962,10972,10978,10984,10988,10994,11000,11009,11015,11021,11029,11037,11045,11053,11059,11069,11079,11084,11090,11098,11106,11114,11120,11130,11134,11140,11148,11156,11164,11170,11180,11184,11190,11198,11204,11210,11216,11222,11230,11238,11247,11253,11263,11273,11279,11287,11295,11304,11310,11320,11326,11334,11342,11351,11357,11365,11373,11382,11388,11396,11404,11413,11419,11429,11437,11441,11448,11457,11463,11470,11476,11482,11491,11499,11508,11514,11524,11534,11541,11550,11558,11567,11573,11583,11590,11599,11607,11616,11622,11632,11639,11648,11656,11665,11671,11681,11691,11695,11702,11711,11717,11723,11729,11735,11744,11752,11761,11767,11777,11787,11794,11802,11810,11819,11825,11835,11846,11853,11862,11870,11879,11885,11895,11905,11912,11921,11929,11938,11945,11954,11962,11971,11978,11987,11996,12005,12011,12021,12028,12037,12045,12054,12060,12070,12077,12086,12094,12103,12109,12119,12126,12135,12144,12153,12159,12169,12173,12180,12189,12195,12201,12207,12213,12222,12230,12239,12245,12255,12265,12272,12280,12288,12297,12303,12313,12323,12330,12339,12347,12356,12363,12372,12380,12389,12395,12405,12412,12421,12429,12438,12444,12454,12465,12472,12480,12487,12494,12501,12508,12516,12524,12533,12539,12549,12559,12567,12571,12578,12587,12593,12599,12605,12611,12620,12628,12637,12643,12653,12663,12670,12678,12686,12695,12701,12711,12721,12728,12736,12744,12753,12759,12769,12779,12786,12795,12803,12812,12818,12828,12838,12847,12854,12863,12871,12880,12886,12896,12906,12914,12921,12930,12939,12949,12956,12967,12978],{"__ignoreMap":38},[43,10847,10848,10850],{"class":45,"line":46},[43,10849,265],{"class":49},[43,10851,67],{"class":53},[43,10853,10854,10856],{"class":45,"line":61},[43,10855,272],{"class":49},[43,10857,67],{"class":53},[43,10859,10860,10862,10864],{"class":45,"line":70},[43,10861,279],{"class":49},[43,10863,54],{"class":53},[43,10865,284],{"class":57},[43,10867,10868,10870],{"class":45,"line":78},[43,10869,289],{"class":49},[43,10871,67],{"class":53},[43,10873,10874,10876,10878,10880],{"class":45,"line":86},[43,10875,296],{"class":53},[43,10877,299],{"class":53},[43,10879,302],{"class":57},[43,10881,305],{"class":53},[43,10883,10884,10886],{"class":45,"line":94},[43,10885,310],{"class":49},[43,10887,67],{"class":53},[43,10889,10890,10892],{"class":45,"line":108},[43,10891,296],{"class":53},[43,10893,319],{"class":57},[43,10895,10896,10898],{"class":45,"line":119},[43,10897,324],{"class":49},[43,10899,67],{"class":53},[43,10901,10902,10904,10906],{"class":45,"line":129},[43,10903,279],{"class":49},[43,10905,54],{"class":53},[43,10907,335],{"class":57},[43,10909,10910,10912],{"class":45,"line":140},[43,10911,289],{"class":49},[43,10913,67],{"class":53},[43,10915,10916,10918,10920,10922],{"class":45,"line":152},[43,10917,296],{"class":53},[43,10919,299],{"class":53},[43,10921,302],{"class":57},[43,10923,305],{"class":53},[43,10925,10926,10928],{"class":45,"line":162},[43,10927,310],{"class":49},[43,10929,67],{"class":53},[43,10931,10932,10934],{"class":45,"line":170},[43,10933,296],{"class":53},[43,10935,364],{"class":57},[43,10937,10938,10940],{"class":45,"line":182},[43,10939,296],{"class":53},[43,10941,371],{"class":57},[43,10943,10944,10946],{"class":45,"line":374},[43,10945,377],{"class":49},[43,10947,67],{"class":53},[43,10949,10950,10952,10954],{"class":45,"line":382},[43,10951,279],{"class":49},[43,10953,54],{"class":53},[43,10955,389],{"class":57},[43,10957,10958,10960],{"class":45,"line":392},[43,10959,289],{"class":49},[43,10961,67],{"class":53},[43,10963,10964,10966,10968,10970],{"class":45,"line":399},[43,10965,296],{"class":53},[43,10967,299],{"class":53},[43,10969,302],{"class":57},[43,10971,305],{"class":53},[43,10973,10974,10976],{"class":45,"line":410},[43,10975,310],{"class":49},[43,10977,67],{"class":53},[43,10979,10980,10982],{"class":45,"line":417},[43,10981,296],{"class":53},[43,10983,422],{"class":57},[43,10985,10986],{"class":45,"line":425},[43,10987,244],{"emptyLinePlaceholder":243},[43,10989,10990,10992],{"class":45,"line":430},[43,10991,433],{"class":49},[43,10993,67],{"class":53},[43,10995,10996,10998],{"class":45,"line":438},[43,10997,441],{"class":49},[43,10999,67],{"class":53},[43,11001,11002,11004,11006],{"class":45,"line":446},[43,11003,279],{"class":49},[43,11005,54],{"class":53},[43,11007,11008],{"class":57}," Required fieds for every Ingestion/Staging step.\n",[43,11010,11011,11013],{"class":45,"line":456},[43,11012,459],{"class":49},[43,11014,67],{"class":53},[43,11016,11017,11019],{"class":45,"line":464},[43,11018,467],{"class":49},[43,11020,67],{"class":53},[43,11022,11023,11025,11027],{"class":45,"line":472},[43,11024,475],{"class":49},[43,11026,54],{"class":53},[43,11028,480],{"class":57},[43,11030,11031,11033,11035],{"class":45,"line":483},[43,11032,486],{"class":49},[43,11034,54],{"class":53},[43,11036,491],{"class":57},[43,11038,11039,11041,11043],{"class":45,"line":494},[43,11040,497],{"class":49},[43,11042,54],{"class":53},[43,11044,503],{"class":502},[43,11046,11047,11049,11051],{"class":45,"line":506},[43,11048,509],{"class":49},[43,11050,54],{"class":53},[43,11052,514],{"class":57},[43,11054,11055,11057],{"class":45,"line":517},[43,11056,520],{"class":49},[43,11058,67],{"class":53},[43,11060,11061,11063,11065,11067],{"class":45,"line":525},[43,11062,528],{"class":53},[43,11064,100],{"class":49},[43,11066,54],{"class":53},[43,11068,535],{"class":57},[43,11070,11071,11073,11075,11077],{"class":45,"line":538},[43,11072,528],{"class":53},[43,11074,100],{"class":49},[43,11076,54],{"class":53},[43,11078,547],{"class":57},[43,11080,11081],{"class":45,"line":550},[43,11082,11083],{"class":1277},"      \n",[43,11085,11086,11088],{"class":45,"line":558},[43,11087,553],{"class":49},[43,11089,67],{"class":53},[43,11091,11092,11094,11096],{"class":45,"line":568},[43,11093,475],{"class":49},[43,11095,54],{"class":53},[43,11097,565],{"class":57},[43,11099,11100,11102,11104],{"class":45,"line":578},[43,11101,486],{"class":49},[43,11103,54],{"class":53},[43,11105,575],{"class":57},[43,11107,11108,11110,11112],{"class":45,"line":588},[43,11109,509],{"class":49},[43,11111,54],{"class":53},[43,11113,585],{"class":57},[43,11115,11116,11118],{"class":45,"line":595},[43,11117,520],{"class":49},[43,11119,67],{"class":53},[43,11121,11122,11124,11126,11128],{"class":45,"line":606},[43,11123,528],{"class":53},[43,11125,100],{"class":49},[43,11127,54],{"class":53},[43,11129,535],{"class":57},[43,11131,11132],{"class":45,"line":614},[43,11133,244],{"emptyLinePlaceholder":243},[43,11135,11136,11138],{"class":45,"line":624},[43,11137,609],{"class":49},[43,11139,67],{"class":53},[43,11141,11142,11144,11146],{"class":45,"line":633},[43,11143,475],{"class":49},[43,11145,54],{"class":53},[43,11147,621],{"class":57},[43,11149,11150,11152,11154],{"class":45,"line":643},[43,11151,486],{"class":49},[43,11153,54],{"class":53},[43,11155,575],{"class":57},[43,11157,11158,11160,11162],{"class":45,"line":650},[43,11159,509],{"class":49},[43,11161,54],{"class":53},[43,11163,640],{"class":57},[43,11165,11166,11168],{"class":45,"line":661},[43,11167,520],{"class":49},[43,11169,67],{"class":53},[43,11171,11172,11174,11176,11178],{"class":45,"line":669},[43,11173,528],{"class":53},[43,11175,100],{"class":49},[43,11177,54],{"class":53},[43,11179,535],{"class":57},[43,11181,11182],{"class":45,"line":679},[43,11183,244],{"emptyLinePlaceholder":243},[43,11185,11186,11188],{"class":45,"line":687},[43,11187,664],{"class":49},[43,11189,67],{"class":53},[43,11191,11192,11194,11196],{"class":45,"line":695},[43,11193,279],{"class":49},[43,11195,54],{"class":53},[43,11197,676],{"class":57},[43,11199,11200,11202],{"class":45,"line":702},[43,11201,682],{"class":49},[43,11203,67],{"class":53},[43,11205,11206,11208],{"class":45,"line":709},[43,11207,296],{"class":53},[43,11209,692],{"class":57},[43,11211,11212,11214],{"class":45,"line":719},[43,11213,459],{"class":49},[43,11215,67],{"class":53},[43,11217,11218,11220],{"class":45,"line":728},[43,11219,467],{"class":49},[43,11221,67],{"class":53},[43,11223,11224,11226,11228],{"class":45,"line":735},[43,11225,475],{"class":49},[43,11227,54],{"class":53},[43,11229,716],{"class":57},[43,11231,11232,11234,11236],{"class":45,"line":746},[43,11233,486],{"class":49},[43,11235,54],{"class":53},[43,11237,491],{"class":57},[43,11239,11240,11242,11244],{"class":45,"line":757},[43,11241,509],{"class":49},[43,11243,54],{"class":53},[43,11245,11246],{"class":57}," Surrogate key for customer in staging.\n",[43,11248,11249,11251],{"class":45,"line":765},[43,11250,520],{"class":49},[43,11252,67],{"class":53},[43,11254,11255,11257,11259,11261],{"class":45,"line":775},[43,11256,528],{"class":53},[43,11258,100],{"class":49},[43,11260,54],{"class":53},[43,11262,535],{"class":57},[43,11264,11265,11267,11269,11271],{"class":45,"line":785},[43,11266,528],{"class":53},[43,11268,100],{"class":49},[43,11270,54],{"class":53},[43,11272,547],{"class":57},[43,11274,11275,11277],{"class":45,"line":792},[43,11276,760],{"class":49},[43,11278,67],{"class":53},[43,11280,11281,11283,11285],{"class":45,"line":803},[43,11282,475],{"class":49},[43,11284,54],{"class":53},[43,11286,772],{"class":57},[43,11288,11289,11291,11293],{"class":45,"line":811},[43,11290,486],{"class":49},[43,11292,54],{"class":53},[43,11294,782],{"class":57},[43,11296,11297,11299,11301],{"class":45,"line":821},[43,11298,509],{"class":49},[43,11300,54],{"class":53},[43,11302,11303],{"class":57}," E-mail address used during registration.\n",[43,11305,11306,11308],{"class":45,"line":830},[43,11307,520],{"class":49},[43,11309,67],{"class":53},[43,11311,11312,11314,11316,11318],{"class":45,"line":838},[43,11313,528],{"class":53},[43,11315,100],{"class":49},[43,11317,54],{"class":53},[43,11319,535],{"class":57},[43,11321,11322,11324],{"class":45,"line":848},[43,11323,806],{"class":49},[43,11325,67],{"class":53},[43,11327,11328,11330,11332],{"class":45,"line":857},[43,11329,475],{"class":49},[43,11331,54],{"class":53},[43,11333,818],{"class":57},[43,11335,11336,11338,11340],{"class":45,"line":865},[43,11337,486],{"class":49},[43,11339,54],{"class":53},[43,11341,782],{"class":57},[43,11343,11344,11346,11348],{"class":45,"line":875},[43,11345,509],{"class":49},[43,11347,54],{"class":53},[43,11349,11350],{"class":57}," Full name of the customer.\n",[43,11352,11353,11355],{"class":45,"line":884},[43,11354,833],{"class":49},[43,11356,67],{"class":53},[43,11358,11359,11361,11363],{"class":45,"line":891},[43,11360,475],{"class":49},[43,11362,54],{"class":53},[43,11364,845],{"class":57},[43,11366,11367,11369,11371],{"class":45,"line":903},[43,11368,486],{"class":49},[43,11370,54],{"class":53},[43,11372,782],{"class":57},[43,11374,11375,11377,11379],{"class":45,"line":4184},[43,11376,509],{"class":49},[43,11378,54],{"class":53},[43,11380,11381],{"class":57}," Country of residence.\n",[43,11383,11384,11386],{"class":45,"line":4190},[43,11385,860],{"class":49},[43,11387,67],{"class":53},[43,11389,11390,11392,11394],{"class":45,"line":4196},[43,11391,475],{"class":49},[43,11393,54],{"class":53},[43,11395,872],{"class":57},[43,11397,11398,11400,11402],{"class":45,"line":4202},[43,11399,486],{"class":49},[43,11401,54],{"class":53},[43,11403,491],{"class":57},[43,11405,11406,11408,11410],{"class":45,"line":4211},[43,11407,509],{"class":49},[43,11409,54],{"class":53},[43,11411,11412],{"class":57}," Age of the customer.\n",[43,11414,11415,11417],{"class":45,"line":4224},[43,11416,520],{"class":49},[43,11418,67],{"class":53},[43,11420,11421,11423,11425,11427],{"class":45,"line":4230},[43,11422,528],{"class":53},[43,11424,100],{"class":49},[43,11426,54],{"class":53},[43,11428,900],{"class":57},[43,11430,11431,11433,11435],{"class":45,"line":4235},[43,11432,906],{"class":49},[43,11434,54],{"class":53},[43,11436,911],{"class":148},[43,11438,11439],{"class":45,"line":4246},[43,11440,244],{"emptyLinePlaceholder":243},[43,11442,11443,11446],{"class":45,"line":4268},[43,11444,11445],{"class":49},"  Product",[43,11447,67],{"class":53},[43,11449,11450,11452,11454],{"class":45,"line":4289},[43,11451,279],{"class":49},[43,11453,54],{"class":53},[43,11455,11456],{"class":57}," A product offered for sale.\n",[43,11458,11459,11461],{"class":45,"line":4310},[43,11460,682],{"class":49},[43,11462,67],{"class":53},[43,11464,11465,11467],{"class":45,"line":4337},[43,11466,296],{"class":53},[43,11468,11469],{"class":57}," product-catalog\n",[43,11471,11472,11474],{"class":45,"line":4351},[43,11473,459],{"class":49},[43,11475,67],{"class":53},[43,11477,11478,11480],{"class":45,"line":4357},[43,11479,467],{"class":49},[43,11481,67],{"class":53},[43,11483,11484,11486,11488],{"class":45,"line":4363},[43,11485,475],{"class":49},[43,11487,54],{"class":53},[43,11489,11490],{"class":57}," product_id\n",[43,11492,11493,11495,11497],{"class":45,"line":4369},[43,11494,486],{"class":49},[43,11496,54],{"class":53},[43,11498,491],{"class":57},[43,11500,11501,11503,11505],{"class":45,"line":4383},[43,11502,509],{"class":49},[43,11504,54],{"class":53},[43,11506,11507],{"class":57}," Surrogate key for product in staging.\n",[43,11509,11510,11512],{"class":45,"line":4391},[43,11511,520],{"class":49},[43,11513,67],{"class":53},[43,11515,11516,11518,11520,11522],{"class":45,"line":4397},[43,11517,528],{"class":53},[43,11519,100],{"class":49},[43,11521,54],{"class":53},[43,11523,535],{"class":57},[43,11525,11526,11528,11530,11532],{"class":45,"line":4402},[43,11527,528],{"class":53},[43,11529,100],{"class":49},[43,11531,54],{"class":53},[43,11533,547],{"class":57},[43,11535,11536,11539],{"class":45,"line":4412},[43,11537,11538],{"class":49},"      Name",[43,11540,67],{"class":53},[43,11542,11543,11545,11547],{"class":45,"line":4418},[43,11544,475],{"class":49},[43,11546,54],{"class":53},[43,11548,11549],{"class":57}," name\n",[43,11551,11552,11554,11556],{"class":45,"line":4424},[43,11553,486],{"class":49},[43,11555,54],{"class":53},[43,11557,782],{"class":57},[43,11559,11560,11562,11564],{"class":45,"line":4430},[43,11561,509],{"class":49},[43,11563,54],{"class":53},[43,11565,11566],{"class":57}," Product display name.\n",[43,11568,11569,11571],{"class":45,"line":4436},[43,11570,520],{"class":49},[43,11572,67],{"class":53},[43,11574,11575,11577,11579,11581],{"class":45,"line":4442},[43,11576,528],{"class":53},[43,11578,100],{"class":49},[43,11580,54],{"class":53},[43,11582,535],{"class":57},[43,11584,11585,11588],{"class":45,"line":4448},[43,11586,11587],{"class":49},"      Category",[43,11589,67],{"class":53},[43,11591,11592,11594,11596],{"class":45,"line":4454},[43,11593,475],{"class":49},[43,11595,54],{"class":53},[43,11597,11598],{"class":57}," category\n",[43,11600,11601,11603,11605],{"class":45,"line":4460},[43,11602,486],{"class":49},[43,11604,54],{"class":53},[43,11606,782],{"class":57},[43,11608,11609,11611,11613],{"class":45,"line":4466},[43,11610,509],{"class":49},[43,11612,54],{"class":53},[43,11614,11615],{"class":57}," Product category.\n",[43,11617,11618,11620],{"class":45,"line":4474},[43,11619,520],{"class":49},[43,11621,67],{"class":53},[43,11623,11624,11626,11628,11630],{"class":45,"line":4479},[43,11625,528],{"class":53},[43,11627,100],{"class":49},[43,11629,54],{"class":53},[43,11631,535],{"class":57},[43,11633,11634,11637],{"class":45,"line":4484},[43,11635,11636],{"class":49},"      SKU",[43,11638,67],{"class":53},[43,11640,11641,11643,11645],{"class":45,"line":4489},[43,11642,475],{"class":49},[43,11644,54],{"class":53},[43,11646,11647],{"class":57}," sku\n",[43,11649,11650,11652,11654],{"class":45,"line":4501},[43,11651,486],{"class":49},[43,11653,54],{"class":53},[43,11655,782],{"class":57},[43,11657,11658,11660,11662],{"class":45,"line":4529},[43,11659,509],{"class":49},[43,11661,54],{"class":53},[43,11663,11664],{"class":57}," Stock keeping unit for the product.\n",[43,11666,11667,11669],{"class":45,"line":4583},[43,11668,520],{"class":49},[43,11670,67],{"class":53},[43,11672,11673,11675,11677,11679],{"class":45,"line":4634},[43,11674,528],{"class":53},[43,11676,100],{"class":49},[43,11678,54],{"class":53},[43,11680,535],{"class":57},[43,11682,11683,11685,11687,11689],{"class":45,"line":4639},[43,11684,528],{"class":53},[43,11686,100],{"class":49},[43,11688,54],{"class":53},[43,11690,547],{"class":57},[43,11692,11693],{"class":45,"line":4669},[43,11694,244],{"emptyLinePlaceholder":243},[43,11696,11697,11700],{"class":45,"line":4711},[43,11698,11699],{"class":49},"  Variant",[43,11701,67],{"class":53},[43,11703,11704,11706,11708],{"class":45,"line":4751},[43,11705,279],{"class":49},[43,11707,54],{"class":53},[43,11709,11710],{"class":57}," A specific variation of a product.\n",[43,11712,11713,11715],{"class":45,"line":4788},[43,11714,682],{"class":49},[43,11716,67],{"class":53},[43,11718,11719,11721],{"class":45,"line":4825},[43,11720,296],{"class":53},[43,11722,11469],{"class":57},[43,11724,11725,11727],{"class":45,"line":4862},[43,11726,459],{"class":49},[43,11728,67],{"class":53},[43,11730,11731,11733],{"class":45,"line":4916},[43,11732,467],{"class":49},[43,11734,67],{"class":53},[43,11736,11737,11739,11741],{"class":45,"line":4966},[43,11738,475],{"class":49},[43,11740,54],{"class":53},[43,11742,11743],{"class":57}," variant_id\n",[43,11745,11746,11748,11750],{"class":45,"line":5016},[43,11747,486],{"class":49},[43,11749,54],{"class":53},[43,11751,491],{"class":57},[43,11753,11754,11756,11758],{"class":45,"line":5058},[43,11755,509],{"class":49},[43,11757,54],{"class":53},[43,11759,11760],{"class":57}," Surrogate key for variant in staging.\n",[43,11762,11763,11765],{"class":45,"line":5099},[43,11764,520],{"class":49},[43,11766,67],{"class":53},[43,11768,11769,11771,11773,11775],{"class":45,"line":5104},[43,11770,528],{"class":53},[43,11772,100],{"class":49},[43,11774,54],{"class":53},[43,11776,535],{"class":57},[43,11778,11779,11781,11783,11785],{"class":45,"line":5122},[43,11780,528],{"class":53},[43,11782,100],{"class":49},[43,11784,54],{"class":53},[43,11786,547],{"class":57},[43,11788,11789,11792],{"class":45,"line":5156},[43,11790,11791],{"class":49},"      ProductID",[43,11793,67],{"class":53},[43,11795,11796,11798,11800],{"class":45,"line":5185},[43,11797,475],{"class":49},[43,11799,54],{"class":53},[43,11801,11490],{"class":57},[43,11803,11804,11806,11808],{"class":45,"line":5194},[43,11805,486],{"class":49},[43,11807,54],{"class":53},[43,11809,491],{"class":57},[43,11811,11812,11814,11816],{"class":45,"line":5199},[43,11813,509],{"class":49},[43,11815,54],{"class":53},[43,11817,11818],{"class":57}," Reference to Product.ID.\n",[43,11820,11821,11823],{"class":45,"line":5204},[43,11822,520],{"class":49},[43,11824,67],{"class":53},[43,11826,11827,11829,11831,11833],{"class":45,"line":5220},[43,11828,528],{"class":53},[43,11830,100],{"class":49},[43,11832,54],{"class":53},[43,11834,535],{"class":57},[43,11836,11837,11839,11841,11843],{"class":45,"line":5252},[43,11838,528],{"class":53},[43,11840,100],{"class":49},[43,11842,54],{"class":53},[43,11844,11845],{"class":57}," positive\n",[43,11847,11848,11851],{"class":45,"line":5257},[43,11849,11850],{"class":49},"      VariantSKU",[43,11852,67],{"class":53},[43,11854,11855,11857,11859],{"class":45,"line":5262},[43,11856,475],{"class":49},[43,11858,54],{"class":53},[43,11860,11861],{"class":57}," variant_sku\n",[43,11863,11864,11866,11868],{"class":45,"line":5282},[43,11865,486],{"class":49},[43,11867,54],{"class":53},[43,11869,782],{"class":57},[43,11871,11872,11874,11876],{"class":45,"line":5293},[43,11873,509],{"class":49},[43,11875,54],{"class":53},[43,11877,11878],{"class":57}," SKU for the variant.\n",[43,11880,11881,11883],{"class":45,"line":5350},[43,11882,520],{"class":49},[43,11884,67],{"class":53},[43,11886,11887,11889,11891,11893],{"class":45,"line":5355},[43,11888,528],{"class":53},[43,11890,100],{"class":49},[43,11892,54],{"class":53},[43,11894,535],{"class":57},[43,11896,11897,11899,11901,11903],{"class":45,"line":5360},[43,11898,528],{"class":53},[43,11900,100],{"class":49},[43,11902,54],{"class":53},[43,11904,547],{"class":57},[43,11906,11907,11910],{"class":45,"line":5385},[43,11908,11909],{"class":49},"      Color",[43,11911,67],{"class":53},[43,11913,11914,11916,11918],{"class":45,"line":5409},[43,11915,475],{"class":49},[43,11917,54],{"class":53},[43,11919,11920],{"class":57}," color\n",[43,11922,11923,11925,11927],{"class":45,"line":5430},[43,11924,486],{"class":49},[43,11926,54],{"class":53},[43,11928,782],{"class":57},[43,11930,11931,11933,11935],{"class":45,"line":5443},[43,11932,509],{"class":49},[43,11934,54],{"class":53},[43,11936,11937],{"class":57}," Variant color.\n",[43,11939,11940,11943],{"class":45,"line":5448},[43,11941,11942],{"class":49},"      Size",[43,11944,67],{"class":53},[43,11946,11947,11949,11951],{"class":45,"line":5463},[43,11948,475],{"class":49},[43,11950,54],{"class":53},[43,11952,11953],{"class":57}," size\n",[43,11955,11956,11958,11960],{"class":45,"line":5484},[43,11957,486],{"class":49},[43,11959,54],{"class":53},[43,11961,782],{"class":57},[43,11963,11964,11966,11968],{"class":45,"line":5492},[43,11965,509],{"class":49},[43,11967,54],{"class":53},[43,11969,11970],{"class":57}," Variant size.\n",[43,11972,11973,11976],{"class":45,"line":5505},[43,11974,11975],{"class":49},"      ManufacturingPrice",[43,11977,67],{"class":53},[43,11979,11980,11982,11984],{"class":45,"line":5522},[43,11981,475],{"class":49},[43,11983,54],{"class":53},[43,11985,11986],{"class":57}," manufacturing_price\n",[43,11988,11989,11991,11993],{"class":45,"line":5534},[43,11990,486],{"class":49},[43,11992,54],{"class":53},[43,11994,11995],{"class":57}," numeric\n",[43,11997,11998,12000,12002],{"class":45,"line":5556},[43,11999,509],{"class":49},[43,12001,54],{"class":53},[43,12003,12004],{"class":57}," Manufacturing cost per unit.\n",[43,12006,12007,12009],{"class":45,"line":5576},[43,12008,520],{"class":49},[43,12010,67],{"class":53},[43,12012,12013,12015,12017,12019],{"class":45,"line":5595},[43,12014,528],{"class":53},[43,12016,100],{"class":49},[43,12018,54],{"class":53},[43,12020,535],{"class":57},[43,12022,12023,12026],{"class":45,"line":5601},[43,12024,12025],{"class":49},"      SellingPrice",[43,12027,67],{"class":53},[43,12029,12030,12032,12034],{"class":45,"line":5606},[43,12031,475],{"class":49},[43,12033,54],{"class":53},[43,12035,12036],{"class":57}," selling_price\n",[43,12038,12039,12041,12043],{"class":45,"line":5611},[43,12040,486],{"class":49},[43,12042,54],{"class":53},[43,12044,11995],{"class":57},[43,12046,12047,12049,12051],{"class":45,"line":5625},[43,12048,509],{"class":49},[43,12050,54],{"class":53},[43,12052,12053],{"class":57}," Selling price per unit.\n",[43,12055,12056,12058],{"class":45,"line":5642},[43,12057,520],{"class":49},[43,12059,67],{"class":53},[43,12061,12062,12064,12066,12068],{"class":45,"line":5665},[43,12063,528],{"class":53},[43,12065,100],{"class":49},[43,12067,54],{"class":53},[43,12069,535],{"class":57},[43,12071,12072,12075],{"class":45,"line":5672},[43,12073,12074],{"class":49},"      StockQuantity",[43,12076,67],{"class":53},[43,12078,12079,12081,12083],{"class":45,"line":5713},[43,12080,475],{"class":49},[43,12082,54],{"class":53},[43,12084,12085],{"class":57}," stock_quantity\n",[43,12087,12088,12090,12092],{"class":45,"line":5721},[43,12089,486],{"class":49},[43,12091,54],{"class":53},[43,12093,491],{"class":57},[43,12095,12096,12098,12100],{"class":45,"line":5751},[43,12097,509],{"class":49},[43,12099,54],{"class":53},[43,12101,12102],{"class":57}," Available stock quantity.\n",[43,12104,12105,12107],{"class":45,"line":5770},[43,12106,520],{"class":49},[43,12108,67],{"class":53},[43,12110,12111,12113,12115,12117],{"class":45,"line":5789},[43,12112,528],{"class":53},[43,12114,100],{"class":49},[43,12116,54],{"class":53},[43,12118,535],{"class":57},[43,12120,12121,12124],{"class":45,"line":5794},[43,12122,12123],{"class":49},"      IsActive",[43,12125,67],{"class":53},[43,12127,12128,12130,12132],{"class":45,"line":5799},[43,12129,475],{"class":49},[43,12131,54],{"class":53},[43,12133,12134],{"class":57}," is_active\n",[43,12136,12137,12139,12141],{"class":45,"line":5804},[43,12138,486],{"class":49},[43,12140,54],{"class":53},[43,12142,12143],{"class":57}," boolean\n",[43,12145,12146,12148,12150],{"class":45,"line":5824},[43,12147,509],{"class":49},[43,12149,54],{"class":53},[43,12151,12152],{"class":57}," Whether the variant is active.\n",[43,12154,12155,12157],{"class":45,"line":5844},[43,12156,520],{"class":49},[43,12158,67],{"class":53},[43,12160,12161,12163,12165,12167],{"class":45,"line":5876},[43,12162,528],{"class":53},[43,12164,100],{"class":49},[43,12166,54],{"class":53},[43,12168,535],{"class":57},[43,12170,12171],{"class":45,"line":5910},[43,12172,244],{"emptyLinePlaceholder":243},[43,12174,12175,12178],{"class":45,"line":5931},[43,12176,12177],{"class":49},"  Order",[43,12179,67],{"class":53},[43,12181,12182,12184,12186],{"class":45,"line":5988},[43,12183,279],{"class":49},[43,12185,54],{"class":53},[43,12187,12188],{"class":57}," A purchase order placed by a customer.\n",[43,12190,12191,12193],{"class":45,"line":5993},[43,12192,682],{"class":49},[43,12194,67],{"class":53},[43,12196,12197,12199],{"class":45,"line":5999},[43,12198,296],{"class":53},[43,12200,422],{"class":57},[43,12202,12203,12205],{"class":45,"line":6039},[43,12204,459],{"class":49},[43,12206,67],{"class":53},[43,12208,12209,12211],{"class":45,"line":6057},[43,12210,467],{"class":49},[43,12212,67],{"class":53},[43,12214,12215,12217,12219],{"class":45,"line":6077},[43,12216,475],{"class":49},[43,12218,54],{"class":53},[43,12220,12221],{"class":57}," order_id\n",[43,12223,12224,12226,12228],{"class":45,"line":6085},[43,12225,486],{"class":49},[43,12227,54],{"class":53},[43,12229,491],{"class":57},[43,12231,12232,12234,12236],{"class":45,"line":6109},[43,12233,509],{"class":49},[43,12235,54],{"class":53},[43,12237,12238],{"class":57}," Surrogate key for order in staging.\n",[43,12240,12241,12243],{"class":45,"line":6114},[43,12242,520],{"class":49},[43,12244,67],{"class":53},[43,12246,12247,12249,12251,12253],{"class":45,"line":6151},[43,12248,528],{"class":53},[43,12250,100],{"class":49},[43,12252,54],{"class":53},[43,12254,535],{"class":57},[43,12256,12257,12259,12261,12263],{"class":45,"line":6190},[43,12258,528],{"class":53},[43,12260,100],{"class":49},[43,12262,54],{"class":53},[43,12264,547],{"class":57},[43,12266,12267,12270],{"class":45,"line":6198},[43,12268,12269],{"class":49},"      CustomerID",[43,12271,67],{"class":53},[43,12273,12274,12276,12278],{"class":45,"line":6231},[43,12275,475],{"class":49},[43,12277,54],{"class":53},[43,12279,716],{"class":57},[43,12281,12282,12284,12286],{"class":45,"line":6255},[43,12283,486],{"class":49},[43,12285,54],{"class":53},[43,12287,491],{"class":57},[43,12289,12290,12292,12294],{"class":45,"line":6291},[43,12291,509],{"class":49},[43,12293,54],{"class":53},[43,12295,12296],{"class":57}," Reference to Customer.ID for the purchaser.\n",[43,12298,12299,12301],{"class":45,"line":6297},[43,12300,520],{"class":49},[43,12302,67],{"class":53},[43,12304,12305,12307,12309,12311],{"class":45,"line":6302},[43,12306,528],{"class":53},[43,12308,100],{"class":49},[43,12310,54],{"class":53},[43,12312,535],{"class":57},[43,12314,12315,12317,12319,12321],{"class":45,"line":6307},[43,12316,528],{"class":53},[43,12318,100],{"class":49},[43,12320,54],{"class":53},[43,12322,11845],{"class":57},[43,12324,12325,12328],{"class":45,"line":6335},[43,12326,12327],{"class":49},"      OrderNumber",[43,12329,67],{"class":53},[43,12331,12332,12334,12336],{"class":45,"line":6352},[43,12333,475],{"class":49},[43,12335,54],{"class":53},[43,12337,12338],{"class":57}," order_number\n",[43,12340,12341,12343,12345],{"class":45,"line":6413},[43,12342,486],{"class":49},[43,12344,54],{"class":53},[43,12346,782],{"class":57},[43,12348,12349,12351,12353],{"class":45,"line":6450},[43,12350,509],{"class":49},[43,12352,54],{"class":53},[43,12354,12355],{"class":57}," Human-readable order number.\n",[43,12357,12358,12361],{"class":45,"line":6455},[43,12359,12360],{"class":49},"      OrderDate",[43,12362,67],{"class":53},[43,12364,12365,12367,12369],{"class":45,"line":6460},[43,12366,475],{"class":49},[43,12368,54],{"class":53},[43,12370,12371],{"class":57}," order_date\n",[43,12373,12374,12376,12378],{"class":45,"line":6485},[43,12375,486],{"class":49},[43,12377,54],{"class":53},[43,12379,575],{"class":57},[43,12381,12382,12384,12386],{"class":45,"line":6500},[43,12383,509],{"class":49},[43,12385,54],{"class":53},[43,12387,12388],{"class":57}," When the order was placed.\n",[43,12390,12391,12393],{"class":45,"line":6550},[43,12392,520],{"class":49},[43,12394,67],{"class":53},[43,12396,12397,12399,12401,12403],{"class":45,"line":6625},[43,12398,528],{"class":53},[43,12400,100],{"class":49},[43,12402,54],{"class":53},[43,12404,535],{"class":57},[43,12406,12407,12410],{"class":45,"line":6630},[43,12408,12409],{"class":49},"      Status",[43,12411,67],{"class":53},[43,12413,12414,12416,12418],{"class":45,"line":6635},[43,12415,475],{"class":49},[43,12417,54],{"class":53},[43,12419,12420],{"class":57}," status\n",[43,12422,12423,12425,12427],{"class":45,"line":6688},[43,12424,486],{"class":49},[43,12426,54],{"class":53},[43,12428,782],{"class":57},[43,12430,12431,12433,12435],{"class":45,"line":6708},[43,12432,509],{"class":49},[43,12434,54],{"class":53},[43,12436,12437],{"class":57}," Order lifecycle status.\n",[43,12439,12440,12442],{"class":45,"line":6753},[43,12441,520],{"class":49},[43,12443,67],{"class":53},[43,12445,12446,12448,12450,12452],{"class":45,"line":6803},[43,12447,528],{"class":53},[43,12449,100],{"class":49},[43,12451,54],{"class":53},[43,12453,535],{"class":57},[43,12455,12456,12458,12460,12462],{"class":45,"line":6850},[43,12457,528],{"class":53},[43,12459,100],{"class":49},[43,12461,54],{"class":53},[43,12463,12464],{"class":57}," accepted_values\n",[43,12466,12467,12470],{"class":45,"line":6866},[43,12468,12469],{"class":49},"            value",[43,12471,67],{"class":53},[43,12473,12474,12477],{"class":45,"line":6885},[43,12475,12476],{"class":53},"              -",[43,12478,12479],{"class":57}," pending\n",[43,12481,12482,12484],{"class":45,"line":6921},[43,12483,12476],{"class":53},[43,12485,12486],{"class":57}," paid\n",[43,12488,12489,12491],{"class":45,"line":6926},[43,12490,12476],{"class":53},[43,12492,12493],{"class":57}," cancelled\n",[43,12495,12496,12498],{"class":45,"line":6931},[43,12497,12476],{"class":53},[43,12499,12500],{"class":57}," shipped\n",[43,12502,12503,12506],{"class":45,"line":6941},[43,12504,12505],{"class":49},"      TotalAmount",[43,12507,67],{"class":53},[43,12509,12510,12512,12514],{"class":45,"line":6953},[43,12511,475],{"class":49},[43,12513,54],{"class":53},[43,12515,10633],{"class":57},[43,12517,12518,12520,12522],{"class":45,"line":6975},[43,12519,486],{"class":49},[43,12521,54],{"class":53},[43,12523,11995],{"class":57},[43,12525,12526,12528,12530],{"class":45,"line":6995},[43,12527,509],{"class":49},[43,12529,54],{"class":53},[43,12531,12532],{"class":57}," Total order amount.\n",[43,12534,12535,12537],{"class":45,"line":7032},[43,12536,520],{"class":49},[43,12538,67],{"class":53},[43,12540,12541,12543,12545,12547],{"class":45,"line":7037},[43,12542,528],{"class":53},[43,12544,100],{"class":49},[43,12546,54],{"class":53},[43,12548,535],{"class":57},[43,12550,12551,12553,12555,12557],{"class":45,"line":7055},[43,12552,528],{"class":53},[43,12554,100],{"class":49},[43,12556,54],{"class":53},[43,12558,900],{"class":57},[43,12560,12561,12563,12565],{"class":45,"line":7096},[43,12562,906],{"class":49},[43,12564,54],{"class":53},[43,12566,911],{"class":148},[43,12568,12569],{"class":45,"line":7158},[43,12570,244],{"emptyLinePlaceholder":243},[43,12572,12573,12576],{"class":45,"line":7163},[43,12574,12575],{"class":49},"  OrderItem",[43,12577,67],{"class":53},[43,12579,12580,12582,12584],{"class":45,"line":7205},[43,12581,279],{"class":49},[43,12583,54],{"class":53},[43,12585,12586],{"class":57}," A line item in an order.\n",[43,12588,12589,12591],{"class":45,"line":7260},[43,12590,682],{"class":49},[43,12592,67],{"class":53},[43,12594,12595,12597],{"class":45,"line":7265},[43,12596,296],{"class":53},[43,12598,422],{"class":57},[43,12600,12601,12603],{"class":45,"line":7296},[43,12602,459],{"class":49},[43,12604,67],{"class":53},[43,12606,12607,12609],{"class":45,"line":7322},[43,12608,467],{"class":49},[43,12610,67],{"class":53},[43,12612,12613,12615,12617],{"class":45,"line":7347},[43,12614,475],{"class":49},[43,12616,54],{"class":53},[43,12618,12619],{"class":57}," order_item_id\n",[43,12621,12622,12624,12626],{"class":45,"line":7352},[43,12623,486],{"class":49},[43,12625,54],{"class":53},[43,12627,491],{"class":57},[43,12629,12630,12632,12634],{"class":45,"line":7383},[43,12631,509],{"class":49},[43,12633,54],{"class":53},[43,12635,12636],{"class":57}," Surrogate key for order item in staging.\n",[43,12638,12639,12641],{"class":45,"line":7415},[43,12640,520],{"class":49},[43,12642,67],{"class":53},[43,12644,12645,12647,12649,12651],{"class":45,"line":7420},[43,12646,528],{"class":53},[43,12648,100],{"class":49},[43,12650,54],{"class":53},[43,12652,535],{"class":57},[43,12654,12655,12657,12659,12661],{"class":45,"line":7440},[43,12656,528],{"class":53},[43,12658,100],{"class":49},[43,12660,54],{"class":53},[43,12662,547],{"class":57},[43,12664,12665,12668],{"class":45,"line":7467},[43,12666,12667],{"class":49},"      OrderID",[43,12669,67],{"class":53},[43,12671,12672,12674,12676],{"class":45,"line":7479},[43,12673,475],{"class":49},[43,12675,54],{"class":53},[43,12677,12221],{"class":57},[43,12679,12680,12682,12684],{"class":45,"line":7484},[43,12681,486],{"class":49},[43,12683,54],{"class":53},[43,12685,491],{"class":57},[43,12687,12688,12690,12692],{"class":45,"line":7531},[43,12689,509],{"class":49},[43,12691,54],{"class":53},[43,12693,12694],{"class":57}," Reference to Order.ID this item belongs to.\n",[43,12696,12697,12699],{"class":45,"line":7569},[43,12698,520],{"class":49},[43,12700,67],{"class":53},[43,12702,12703,12705,12707,12709],{"class":45,"line":7574},[43,12704,528],{"class":53},[43,12706,100],{"class":49},[43,12708,54],{"class":53},[43,12710,535],{"class":57},[43,12712,12713,12715,12717,12719],{"class":45,"line":7632},[43,12714,528],{"class":53},[43,12716,100],{"class":49},[43,12718,54],{"class":53},[43,12720,11845],{"class":57},[43,12722,12723,12726],{"class":45,"line":7673},[43,12724,12725],{"class":49},"      VariantID",[43,12727,67],{"class":53},[43,12729,12730,12732,12734],{"class":45,"line":7710},[43,12731,475],{"class":49},[43,12733,54],{"class":53},[43,12735,11743],{"class":57},[43,12737,12738,12740,12742],{"class":45,"line":7715},[43,12739,486],{"class":49},[43,12741,54],{"class":53},[43,12743,491],{"class":57},[43,12745,12746,12748,12750],{"class":45,"line":7734},[43,12747,509],{"class":49},[43,12749,54],{"class":53},[43,12751,12752],{"class":57}," Reference to Variant.ID purchased.\n",[43,12754,12755,12757],{"class":45,"line":7760},[43,12756,520],{"class":49},[43,12758,67],{"class":53},[43,12760,12761,12763,12765,12767],{"class":45,"line":7771},[43,12762,528],{"class":53},[43,12764,100],{"class":49},[43,12766,54],{"class":53},[43,12768,535],{"class":57},[43,12770,12771,12773,12775,12777],{"class":45,"line":7776},[43,12772,528],{"class":53},[43,12774,100],{"class":49},[43,12776,54],{"class":53},[43,12778,11845],{"class":57},[43,12780,12781,12784],{"class":45,"line":7795},[43,12782,12783],{"class":49},"      Quantity",[43,12785,67],{"class":53},[43,12787,12788,12790,12792],{"class":45,"line":7822},[43,12789,475],{"class":49},[43,12791,54],{"class":53},[43,12793,12794],{"class":57}," quantity\n",[43,12796,12797,12799,12801],{"class":45,"line":7844},[43,12798,486],{"class":49},[43,12800,54],{"class":53},[43,12802,491],{"class":57},[43,12804,12805,12807,12809],{"class":45,"line":7869},[43,12806,509],{"class":49},[43,12808,54],{"class":53},[43,12810,12811],{"class":57}," Quantity purchased (must be positive).\n",[43,12813,12814,12816],{"class":45,"line":7889},[43,12815,520],{"class":49},[43,12817,67],{"class":53},[43,12819,12820,12822,12824,12826],{"class":45,"line":7914},[43,12821,528],{"class":53},[43,12823,100],{"class":49},[43,12825,54],{"class":53},[43,12827,535],{"class":57},[43,12829,12830,12832,12834,12836],{"class":45,"line":7934},[43,12831,528],{"class":53},[43,12833,100],{"class":49},[43,12835,54],{"class":53},[43,12837,900],{"class":57},[43,12839,12840,12842,12844],{"class":45,"line":7969},[43,12841,906],{"class":49},[43,12843,54],{"class":53},[43,12845,12846],{"class":148}," 1\n",[43,12848,12849,12852],{"class":45,"line":7989},[43,12850,12851],{"class":49},"      UnitPrice",[43,12853,67],{"class":53},[43,12855,12856,12858,12860],{"class":45,"line":8024},[43,12857,475],{"class":49},[43,12859,54],{"class":53},[43,12861,12862],{"class":57}," unit_price\n",[43,12864,12865,12867,12869],{"class":45,"line":8044},[43,12866,486],{"class":49},[43,12868,54],{"class":53},[43,12870,11995],{"class":57},[43,12872,12873,12875,12877],{"class":45,"line":8062},[43,12874,509],{"class":49},[43,12876,54],{"class":53},[43,12878,12879],{"class":57}," Price per unit at purchase time.\n",[43,12881,12882,12884],{"class":45,"line":8079},[43,12883,520],{"class":49},[43,12885,67],{"class":53},[43,12887,12888,12890,12892,12894],{"class":45,"line":8084},[43,12889,528],{"class":53},[43,12891,100],{"class":49},[43,12893,54],{"class":53},[43,12895,535],{"class":57},[43,12897,12898,12900,12902,12904],{"class":45,"line":8132},[43,12899,528],{"class":53},[43,12901,100],{"class":49},[43,12903,54],{"class":53},[43,12905,900],{"class":57},[43,12907,12908,12910,12912],{"class":45,"line":8137},[43,12909,906],{"class":49},[43,12911,54],{"class":53},[43,12913,911],{"class":148},[43,12915,12916,12919],{"class":45,"line":8142},[43,12917,12918],{"class":49},"      TotalPrice",[43,12920,67],{"class":53},[43,12922,12923,12925,12927],{"class":45,"line":8162},[43,12924,475],{"class":49},[43,12926,54],{"class":53},[43,12928,12929],{"class":57}," total_price\n",[43,12931,12933,12935,12937],{"class":45,"line":12932},268,[43,12934,486],{"class":49},[43,12936,54],{"class":53},[43,12938,11995],{"class":57},[43,12940,12942,12944,12946],{"class":45,"line":12941},269,[43,12943,509],{"class":49},[43,12945,54],{"class":53},[43,12947,12948],{"class":57}," Total price for the line (Quantity * UnitPrice).\n",[43,12950,12952,12954],{"class":45,"line":12951},270,[43,12953,520],{"class":49},[43,12955,67],{"class":53},[43,12957,12959,12961,12963,12965],{"class":45,"line":12958},271,[43,12960,528],{"class":53},[43,12962,100],{"class":49},[43,12964,54],{"class":53},[43,12966,535],{"class":57},[43,12968,12970,12972,12974,12976],{"class":45,"line":12969},272,[43,12971,528],{"class":53},[43,12973,100],{"class":49},[43,12975,54],{"class":53},[43,12977,900],{"class":57},[43,12979,12981,12983,12985],{"class":45,"line":12980},273,[43,12982,906],{"class":49},[43,12984,54],{"class":53},[43,12986,911],{"class":148},[1992,12988,12989,12990,12992],{},"You can work with column check by adding inside your asset the ",[40,12991,9826],{}," the needed definitions for the output of the column that you will materialize:",[33,12994,12997],{"className":1195,"code":12995,"filename":1819,"highlights":12996,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns: \n  - name: customer_id \n    type: integer\n    primary_key: true\n    checks:\n      - name: unique\n      - name: not_null\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[162,170,182,374,382,392,399],[40,12998,12999,13003,13007,13011,13015,13019,13023,13027,13031,13035,13039,13043,13050,13056,13062,13068,13074,13080,13086,13090,13094,13100,13110,13128,13150,13164,13168,13172,13178],{"__ignoreMap":38},[43,13000,13001],{"class":45,"line":46},[43,13002,1205],{"class":1006},[43,13004,13005],{"class":45,"line":61},[43,13006,1830],{"class":1006},[43,13008,13009],{"class":45,"line":70},[43,13010,1215],{"class":1006},[43,13012,13013],{"class":45,"line":78},[43,13014,244],{"emptyLinePlaceholder":243},[43,13016,13017],{"class":45,"line":86},[43,13018,1235],{"class":1006},[43,13020,13021],{"class":45,"line":94},[43,13022,1240],{"class":1006},[43,13024,13025],{"class":45,"line":108},[43,13026,244],{"emptyLinePlaceholder":243},[43,13028,13029],{"class":45,"line":119},[43,13030,1250],{"class":1006},[43,13032,13033],{"class":45,"line":129},[43,13034,1851],{"class":1006},[43,13036,13037],{"class":45,"line":140},[43,13038,9868],{"class":1006},[43,13040,13041],{"class":45,"line":152},[43,13042,244],{"emptyLinePlaceholder":243},[43,13044,13047],{"class":13045,"line":162},[45,13046],"highlight",[43,13048,13049],{"class":1006},"columns: \n",[43,13051,13053],{"class":13052,"line":170},[45,13046],[43,13054,13055],{"class":1006},"  - name: customer_id \n",[43,13057,13059],{"class":13058,"line":182},[45,13046],[43,13060,13061],{"class":1006},"    type: integer\n",[43,13063,13065],{"class":13064,"line":374},[45,13046],[43,13066,13067],{"class":1006},"    primary_key: true\n",[43,13069,13071],{"class":13070,"line":382},[45,13046],[43,13072,13073],{"class":1006},"    checks:\n",[43,13075,13077],{"class":13076,"line":392},[45,13046],[43,13078,13079],{"class":1006},"      - name: unique\n",[43,13081,13083],{"class":13082,"line":399},[45,13046],[43,13084,13085],{"class":1006},"      - name: not_null\n",[43,13087,13088],{"class":45,"line":410},[43,13089,1265],{"class":1006},[43,13091,13092],{"class":45,"line":417},[43,13093,244],{"emptyLinePlaceholder":243},[43,13095,13096,13098],{"class":45,"line":425},[43,13097,1410],{"class":148},[43,13099,9713],{"class":1277},[43,13101,13102,13104,13106,13108],{"class":45,"line":430},[43,13103,1868],{"class":1277},[43,13105,1872],{"class":1871},[43,13107,1389],{"class":148},[43,13109,9932],{"class":1277},[43,13111,13112,13114,13116,13118,13120,13122,13124,13126],{"class":45,"line":438},[43,13113,1882],{"class":1418},[43,13115,1422],{"class":1277},[43,13117,1887],{"class":1418},[43,13119,1890],{"class":1277},[43,13121,1893],{"class":53},[43,13123,1428],{"class":1277},[43,13125,1281],{"class":148},[43,13127,1900],{"class":1277},[43,13129,13130,13132,13134,13136,13138,13140,13142,13144,13146,13148],{"class":45,"line":446},[43,13131,1882],{"class":1418},[43,13133,1422],{"class":1277},[43,13135,1887],{"class":1418},[43,13137,1911],{"class":1277},[43,13139,1590],{"class":53},[43,13141,1916],{"class":57},[43,13143,1590],{"class":53},[43,13145,1428],{"class":1277},[43,13147,1281],{"class":148},[43,13149,1925],{"class":1277},[43,13151,13152,13154,13156,13158,13160,13162],{"class":45,"line":456},[43,13153,1882],{"class":1418},[43,13155,1932],{"class":1277},[43,13157,1935],{"class":148},[43,13159,1428],{"class":1277},[43,13161,1281],{"class":148},[43,13163,1942],{"class":1277},[43,13165,13166],{"class":45,"line":464},[43,13167,1947],{"class":1277},[43,13169,13170],{"class":45,"line":472},[43,13171,1952],{"class":1277},[43,13173,13174,13176],{"class":45,"line":483},[43,13175,1438],{"class":148},[43,13177,1022],{"class":1277},[43,13179,13180,13182,13184,13186],{"class":45,"line":494},[43,13181,1963],{"class":148},[43,13183,1966],{"class":1277},[43,13185,1969],{"class":148},[43,13187,1462],{"class":1277},[1992,13189,13190],{},[1977,13191,13192],{},"Available Check Types",[2135,13194,13195,13208],{},[2138,13196,13197],{},[2141,13198,13199,13202,13205],{},[2144,13200,13201],{},"Check Type",[2144,13203,13204],{},"Purpose",[2144,13206,13207],{},"Example Configuration",[2151,13209,13210,13225,13239,13265,13295,13310],{},[2141,13211,13212,13217,13220],{},[2156,13213,13214],{},[40,13215,13216],{},"not_null",[2156,13218,13219],{},"Ensures no NULL values",[2156,13221,13222],{},[40,13223,13224],{},"- name: not_null",[2141,13226,13227,13231,13234],{},[2156,13228,13229],{},[40,13230,5512],{},[2156,13232,13233],{},"Ensures no duplicate values",[2156,13235,13236],{},[40,13237,13238],{},"- name: unique",[2141,13240,13241,13246,13249],{},[2156,13242,13243],{},[40,13244,13245],{},"range",[2156,13247,13248],{},"Validates numeric ranges",[2156,13250,13251,13254,13257,13260,13262],{},[40,13252,13253],{},"- name: range",[13255,13256],"br",{},[40,13258,13259],{},"  min: 0",[13255,13261],{},[40,13263,13264],{},"  max: 100",[2141,13266,13267,13272,13275],{},[2156,13268,13269],{},[40,13270,13271],{},"accepted_values",[2156,13273,13274],{},"Validates against allowed values",[2156,13276,13277,13280,13282,13285,13287,13290,13292],{},[40,13278,13279],{},"- name: accepted_values",[13255,13281],{},[40,13283,13284],{},"  value:",[13255,13286],{},[40,13288,13289],{},"    - pending",[13255,13291],{},[40,13293,13294],{},"    - paid",[2141,13296,13297,13302,13305],{},[2156,13298,13299],{},[40,13300,13301],{},"positive",[2156,13303,13304],{},"Ensures positive numbers",[2156,13306,13307],{},[40,13308,13309],{},"- name: positive",[2141,13311,13312,13317,13320],{},[2156,13313,13314],{},[40,13315,13316],{},"regex",[2156,13318,13319],{},"Pattern matching validation",[2156,13321,13322,13325,13327],{},[40,13323,13324],{},"- name: regex",[13255,13326],{},[40,13328,13329],{},"  pattern: '^[A-Z]{3}-\\d{4}$'",[1992,13331,13332,13333,13336,13337,13340,13341,13343,13344,13347],{},"Bruin's approach to data quality is ",[1977,13334,13335],{},"declarative and reusable",". Instead of writing custom validation SQL for every table, you define ",[1977,13338,13339],{},"entities and attributes"," in ",[40,13342,258],{},", then reference them in your staging assets using the ",[40,13345,13346],{},"extends:"," keyword.",[1992,13349,13350],{},"Here's how the column check system works:",[1992,13352,13353],{},[1977,13354,13355],{},"Entity Definition in glossary.yml:",[33,13357,13359],{"className":35,"code":13358,"language":37,"meta":38,"style":38},"entities:\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n",[40,13360,13361,13367,13373,13381,13387,13393,13399,13405,13413,13421,13429,13435,13445,13451,13459,13467,13475,13481,13491],{"__ignoreMap":38},[43,13362,13363,13365],{"class":45,"line":46},[43,13364,433],{"class":49},[43,13366,67],{"class":53},[43,13368,13369,13371],{"class":45,"line":61},[43,13370,664],{"class":49},[43,13372,67],{"class":53},[43,13374,13375,13377,13379],{"class":45,"line":70},[43,13376,279],{"class":49},[43,13378,54],{"class":53},[43,13380,676],{"class":57},[43,13382,13383,13385],{"class":45,"line":78},[43,13384,682],{"class":49},[43,13386,67],{"class":53},[43,13388,13389,13391],{"class":45,"line":86},[43,13390,296],{"class":53},[43,13392,692],{"class":57},[43,13394,13395,13397],{"class":45,"line":94},[43,13396,459],{"class":49},[43,13398,67],{"class":53},[43,13400,13401,13403],{"class":45,"line":108},[43,13402,760],{"class":49},[43,13404,67],{"class":53},[43,13406,13407,13409,13411],{"class":45,"line":119},[43,13408,475],{"class":49},[43,13410,54],{"class":53},[43,13412,772],{"class":57},[43,13414,13415,13417,13419],{"class":45,"line":129},[43,13416,486],{"class":49},[43,13418,54],{"class":53},[43,13420,782],{"class":57},[43,13422,13423,13425,13427],{"class":45,"line":140},[43,13424,509],{"class":49},[43,13426,54],{"class":53},[43,13428,11303],{"class":57},[43,13430,13431,13433],{"class":45,"line":152},[43,13432,520],{"class":49},[43,13434,67],{"class":53},[43,13436,13437,13439,13441,13443],{"class":45,"line":162},[43,13438,528],{"class":53},[43,13440,100],{"class":49},[43,13442,54],{"class":53},[43,13444,535],{"class":57},[43,13446,13447,13449],{"class":45,"line":170},[43,13448,860],{"class":49},[43,13450,67],{"class":53},[43,13452,13453,13455,13457],{"class":45,"line":182},[43,13454,475],{"class":49},[43,13456,54],{"class":53},[43,13458,872],{"class":57},[43,13460,13461,13463,13465],{"class":45,"line":374},[43,13462,486],{"class":49},[43,13464,54],{"class":53},[43,13466,491],{"class":57},[43,13468,13469,13471,13473],{"class":45,"line":382},[43,13470,509],{"class":49},[43,13472,54],{"class":53},[43,13474,11412],{"class":57},[43,13476,13477,13479],{"class":45,"line":392},[43,13478,520],{"class":49},[43,13480,67],{"class":53},[43,13482,13483,13485,13487,13489],{"class":45,"line":399},[43,13484,528],{"class":53},[43,13486,100],{"class":49},[43,13488,54],{"class":53},[43,13490,900],{"class":57},[43,13492,13493,13495,13497],{"class":45,"line":410},[43,13494,906],{"class":49},[43,13496,54],{"class":53},[43,13498,911],{"class":148},[1992,13500,13501],{},"Then, at your asset you could easily just extends it, avoiding duplicate validations across other assets:",[33,13503,13505],{"className":1195,"code":13504,"language":1198,"meta":38,"style":38},"/* @bruin\ncolumns:\n  - extends: Customer.Email    # Inherits not_null check\n  - extends: Customer.Age      # Inherits range check (min: 0)\n@bruin */\n",[40,13506,13507,13511,13515,13520,13525],{"__ignoreMap":38},[43,13508,13509],{"class":45,"line":46},[43,13510,1205],{"class":1006},[43,13512,13513],{"class":45,"line":61},[43,13514,9877],{"class":1006},[43,13516,13517],{"class":45,"line":70},[43,13518,13519],{"class":1006},"  - extends: Customer.Email    # Inherits not_null check\n",[43,13521,13522],{"class":45,"line":78},[43,13523,13524],{"class":1006},"  - extends: Customer.Age      # Inherits range check (min: 0)\n",[43,13526,13527],{"class":45,"line":86},[43,13528,1265],{"class":1006},[1992,13530,13531,13532,13535],{},"For complex validations that go beyond column-level checks, Bruin supports ",[1977,13533,13534],{},"custom checks"," with SQL queries:",[33,13537,13539],{"className":35,"code":13538,"language":37,"meta":38,"style":38},"custom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0  # Expected result (0 = no violations)\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[40,13540,13541,13548,13559,13568,13572,13576,13588,13597,13601,13605,13609,13613,13617],{"__ignoreMap":38},[43,13542,13543,13546],{"class":45,"line":46},[43,13544,13545],{"class":49},"custom_checks",[43,13547,67],{"class":53},[43,13549,13550,13552,13554,13556],{"class":45,"line":61},[43,13551,1062],{"class":53},[43,13553,100],{"class":49},[43,13555,54],{"class":53},[43,13557,13558],{"class":57}," validate product variant sizes\n",[43,13560,13561,13563,13565],{"class":45,"line":70},[43,13562,279],{"class":49},[43,13564,54],{"class":53},[43,13566,13567],{"class":3382}," |\n",[43,13569,13570],{"class":45,"line":78},[43,13571,10265],{"class":57},[43,13573,13574],{"class":45,"line":86},[43,13575,10270],{"class":57},[43,13577,13578,13581,13583,13585],{"class":45,"line":94},[43,13579,13580],{"class":49},"    value",[43,13582,54],{"class":53},[43,13584,1737],{"class":148},[43,13586,13587],{"class":1006},"  # Expected result (0 = no violations)\n",[43,13589,13590,13593,13595],{"class":45,"line":108},[43,13591,13592],{"class":49},"    query",[43,13594,54],{"class":53},[43,13596,13567],{"class":3382},[43,13598,13599],{"class":45,"line":119},[43,13600,10285],{"class":57},[43,13602,13603],{"class":45,"line":129},[43,13604,10290],{"class":57},[43,13606,13607],{"class":45,"line":140},[43,13608,10295],{"class":57},[43,13610,13611],{"class":45,"line":152},[43,13612,10300],{"class":57},[43,13614,13615],{"class":45,"line":162},[43,13616,10305],{"class":57},[43,13618,13619],{"class":45,"line":170},[43,13620,10310],{"class":57},[1992,13622,13623],{},"Now that we understood the basics of Bruin's data quality system, let's run the staging pipeline:",[33,13625,13627],{"className":2054,"code":13626,"language":2056,"meta":38,"style":38},"# Run all staging assets\nbruin run orders-performance --tag staging\n",[40,13628,13629,13634],{"__ignoreMap":38},[43,13630,13631],{"class":45,"line":46},[43,13632,13633],{"class":1006},"# Run all staging assets\n",[43,13635,13636,13638,13640,13642,13644],{"class":45,"line":61},[43,13637,2091],{"class":2063},[43,13639,3163],{"class":57},[43,13641,9503],{"class":57},[43,13643,9506],{"class":57},[43,13645,13646],{"class":57}," staging\n",[1992,13648,13649],{},"The output must be like:",[3364,13651,13652],{},[33,13653,13655],{"className":2054,"code":13654,"language":2056,"meta":38,"style":38},"\nAnalyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\n\nStarting the pipeline execution...\n\n[20:59:31] Running:  stg.products\n[20:59:31] Running:  stg.order_items\n[20:59:31] Running:  stg.orders\n[20:59:31] Running:  stg.customers\n[20:59:31] Finished: stg.products (28ms)\n[20:59:31] Running:  stg.product_variants\n[20:59:31] Finished: stg.orders (57ms)\n[20:59:31] Finished: stg.order_items (78ms)\n[20:59:31] Finished: stg.customers (101ms)\n[20:59:31] Finished: stg.product_variants (89ms)\n[20:59:31] Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n[20:59:31] Finished: stg.product_variants:custom-check:validate_product_variant_sizes (6ms)\n\n==================================================\n\nPASS stg.products \nPASS stg.orders \nPASS stg.order_items \nPASS stg.customers \nPASS stg.product_variants .\n\n\nbruin run completed successfully in 125ms\n\n ✓ Assets executed      5 succeeded\n ✓ Quality checks       1 succeeded\n\n",[40,13656,13657,13661,13681,13685,13693,13701,13705,13727,13731,13741,13745,13755,13759,13771,13782,13793,13804,13820,13831,13847,13863,13879,13895,13906,13922,13926,13931,13935,13944,13953,13962,13971,13981,13985,13989,14004,14008,14020],{"__ignoreMap":38},[43,13658,13659],{"class":45,"line":46},[43,13660,244],{"emptyLinePlaceholder":243},[43,13662,13663,13665,13667,13669,13671,13673,13675,13677,13679],{"class":45,"line":61},[43,13664,9523],{"class":2063},[43,13666,9526],{"class":57},[43,13668,9529],{"class":57},[43,13670,1312],{"class":53},[43,13672,9534],{"class":57},[43,13674,1590],{"class":53},[43,13676,9539],{"class":57},[43,13678,9542],{"class":148},[43,13680,9545],{"class":57},[43,13682,13683],{"class":45,"line":70},[43,13684,244],{"emptyLinePlaceholder":243},[43,13686,13687,13689,13691],{"class":45,"line":78},[43,13688,9554],{"class":2063},[43,13690,9557],{"class":57},[43,13692,9560],{"class":1277},[43,13694,13695,13697,13699],{"class":45,"line":86},[43,13696,9565],{"class":2063},[43,13698,9568],{"class":57},[43,13700,9571],{"class":57},[43,13702,13703],{"class":45,"line":94},[43,13704,244],{"emptyLinePlaceholder":243},[43,13706,13707,13709,13711,13713,13715,13717,13719,13721,13723,13725],{"class":45,"line":108},[43,13708,9580],{"class":2063},[43,13710,9583],{"class":57},[43,13712,9586],{"class":57},[43,13714,9542],{"class":148},[43,13716,9467],{"class":57},[43,13718,9593],{"class":57},[43,13720,1003],{"class":148},[43,13722,9598],{"class":57},[43,13724,9601],{"class":57},[43,13726,9604],{"class":57},[43,13728,13729],{"class":45,"line":119},[43,13730,244],{"emptyLinePlaceholder":243},[43,13732,13733,13735,13737,13739],{"class":45,"line":129},[43,13734,9613],{"class":2063},[43,13736,9616],{"class":57},[43,13738,9619],{"class":57},[43,13740,9622],{"class":57},[43,13742,13743],{"class":45,"line":140},[43,13744,244],{"emptyLinePlaceholder":243},[43,13746,13747,13749,13751,13753],{"class":45,"line":152},[43,13748,9627],{"class":2063},[43,13750,9526],{"class":57},[43,13752,9529],{"class":57},[43,13754,9634],{"class":57},[43,13756,13757],{"class":45,"line":162},[43,13758,244],{"emptyLinePlaceholder":243},[43,13760,13761,13763,13766,13768],{"class":45,"line":170},[43,13762,7497],{"class":53},[43,13764,13765],{"class":1277},"20:59:31",[43,13767,7502],{"class":53},[43,13769,13770],{"class":1277}," Running:  stg.products\n",[43,13772,13773,13775,13777,13779],{"class":45,"line":182},[43,13774,7497],{"class":53},[43,13776,13765],{"class":1277},[43,13778,7502],{"class":53},[43,13780,13781],{"class":1277}," Running:  stg.order_items\n",[43,13783,13784,13786,13788,13790],{"class":45,"line":374},[43,13785,7497],{"class":53},[43,13787,13765],{"class":1277},[43,13789,7502],{"class":53},[43,13791,13792],{"class":1277}," Running:  stg.orders\n",[43,13794,13795,13797,13799,13801],{"class":45,"line":382},[43,13796,7497],{"class":53},[43,13798,13765],{"class":1277},[43,13800,7502],{"class":53},[43,13802,13803],{"class":1277}," Running:  stg.customers\n",[43,13805,13806,13808,13810,13812,13815,13818],{"class":45,"line":392},[43,13807,7497],{"class":53},[43,13809,13765],{"class":1277},[43,13811,7502],{"class":53},[43,13813,13814],{"class":1277}," Finished: stg.products (",[43,13816,13817],{"class":2063},"28ms",[43,13819,1405],{"class":1277},[43,13821,13822,13824,13826,13828],{"class":45,"line":399},[43,13823,7497],{"class":53},[43,13825,13765],{"class":1277},[43,13827,7502],{"class":53},[43,13829,13830],{"class":1277}," Running:  stg.product_variants\n",[43,13832,13833,13835,13837,13839,13842,13845],{"class":45,"line":410},[43,13834,7497],{"class":53},[43,13836,13765],{"class":1277},[43,13838,7502],{"class":53},[43,13840,13841],{"class":1277}," Finished: stg.orders (",[43,13843,13844],{"class":2063},"57ms",[43,13846,1405],{"class":1277},[43,13848,13849,13851,13853,13855,13858,13861],{"class":45,"line":417},[43,13850,7497],{"class":53},[43,13852,13765],{"class":1277},[43,13854,7502],{"class":53},[43,13856,13857],{"class":1277}," Finished: stg.order_items (",[43,13859,13860],{"class":2063},"78ms",[43,13862,1405],{"class":1277},[43,13864,13865,13867,13869,13871,13874,13877],{"class":45,"line":425},[43,13866,7497],{"class":53},[43,13868,13765],{"class":1277},[43,13870,7502],{"class":53},[43,13872,13873],{"class":1277}," Finished: stg.customers (",[43,13875,13876],{"class":2063},"101ms",[43,13878,1405],{"class":1277},[43,13880,13881,13883,13885,13887,13890,13893],{"class":45,"line":430},[43,13882,7497],{"class":53},[43,13884,13765],{"class":1277},[43,13886,7502],{"class":53},[43,13888,13889],{"class":1277}," Finished: stg.product_variants (",[43,13891,13892],{"class":2063},"89ms",[43,13894,1405],{"class":1277},[43,13896,13897,13899,13901,13903],{"class":45,"line":438},[43,13898,7497],{"class":53},[43,13900,13765],{"class":1277},[43,13902,7502],{"class":53},[43,13904,13905],{"class":1277}," Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n",[43,13907,13908,13910,13912,13914,13917,13920],{"class":45,"line":446},[43,13909,7497],{"class":53},[43,13911,13765],{"class":1277},[43,13913,7502],{"class":53},[43,13915,13916],{"class":1277}," Finished: stg.product_variants:custom-check:validate_product_variant_sizes (",[43,13918,13919],{"class":2063},"6ms",[43,13921,1405],{"class":1277},[43,13923,13924],{"class":45,"line":456},[43,13925,244],{"emptyLinePlaceholder":243},[43,13927,13928],{"class":45,"line":464},[43,13929,13930],{"class":57},"==================================================\n",[43,13932,13933],{"class":45,"line":472},[43,13934,244],{"emptyLinePlaceholder":243},[43,13936,13937,13939,13942],{"class":45,"line":483},[43,13938,9707],{"class":2063},[43,13940,13941],{"class":57}," stg.products",[43,13943,9713],{"class":1277},[43,13945,13946,13948,13951],{"class":45,"line":494},[43,13947,9707],{"class":2063},[43,13949,13950],{"class":57}," stg.orders",[43,13952,9713],{"class":1277},[43,13954,13955,13957,13960],{"class":45,"line":506},[43,13956,9707],{"class":2063},[43,13958,13959],{"class":57}," stg.order_items",[43,13961,9713],{"class":1277},[43,13963,13964,13966,13969],{"class":45,"line":517},[43,13965,9707],{"class":2063},[43,13967,13968],{"class":57}," stg.customers",[43,13970,9713],{"class":1277},[43,13972,13973,13975,13978],{"class":45,"line":525},[43,13974,9707],{"class":2063},[43,13976,13977],{"class":57}," stg.product_variants",[43,13979,13980],{"class":57}," .\n",[43,13982,13983],{"class":45,"line":538},[43,13984,244],{"emptyLinePlaceholder":243},[43,13986,13987],{"class":45,"line":550},[43,13988,244],{"emptyLinePlaceholder":243},[43,13990,13991,13993,13995,13997,13999,14001],{"class":45,"line":558},[43,13992,2091],{"class":2063},[43,13994,3163],{"class":57},[43,13996,9762],{"class":57},[43,13998,9765],{"class":57},[43,14000,9768],{"class":57},[43,14002,14003],{"class":57}," 125ms\n",[43,14005,14006],{"class":45,"line":568},[43,14007,244],{"emptyLinePlaceholder":243},[43,14009,14010,14012,14014,14016,14018],{"class":45,"line":578},[43,14011,9780],{"class":2063},[43,14013,9783],{"class":57},[43,14015,9786],{"class":57},[43,14017,9789],{"class":148},[43,14019,9792],{"class":57},[43,14021,14022,14024,14027,14030,14033],{"class":45,"line":588},[43,14023,9780],{"class":2063},[43,14025,14026],{"class":57}," Quality",[43,14028,14029],{"class":57}," checks",[43,14031,14032],{"class":148},"       1",[43,14034,9792],{"class":57},[1992,14036,14037],{},"Each asset runs its quality checks alongside transformations, keeping data accurate at every step. You can reuse validation rules across assets, add business context through glossaries, and rely on incremental checks that catch issues early.",[1973,14039,14041],{"id":14040},"_8-designing-your-analytics-layer-mart","8) Designing Your Analytics Layer (Mart)",[1992,14043,14044],{},"The analytics (mart) layer turns curated staging tables into business-ready, well-structured datasets. Here we define models with a clear grain, apply final business rules, and expose KPIs for decision-making. These models typically power dashboards and self-service exploration.",[1992,14046,14047],{},"Just like in the Raw and Staging sections above, below is a code tree that shows how the mart is structured in our orders-performance pipeline. Each model consumes stg.* tables and produces clean, documented outputs.",[29,14049,14051,14485,14929,15503,15728],{"default-value":14050},"mart.sales_daily.asset.sql",[33,14052,14054],{"className":1195,"code":14053,"filename":14050,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.sales_daily\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: append\n\ndepends:\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: sale_date\n    type: date\n    checks:\n      - name: not_null\n  - name: orders_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: total revenue non-negative\n    value: 0\n    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n\n@bruin */\n\nWITH daily_orders AS (SELECT CAST(CAST(order_date AS TIMESTAMP) AS DATE)                               AS sale_date,\n                             COUNT(*)                                                                  AS orders_count,\n                             SUM(CASE WHEN status IN ('paid', 'shipped') THEN total_amount ELSE 0 END) AS revenue\n                      FROM stg.orders\n                      GROUP BY 1),\n     daily_items AS (SELECT CAST(CAST(o.order_date AS TIMESTAMP) AS DATE) AS sale_date,\n                            COUNT(*)                                      AS items_count\n                     FROM stg.order_items oi\n                            JOIN stg.orders o ON o.order_id = oi.order_id\n                     GROUP BY 1)\nSELECT d.sale_date,\n       d.orders_count,\n       COALESCE(i.items_count, 0) AS items_count,\n       d.revenue\nFROM daily_orders d\nORDER BY sale_date;\n",[40,14055,14056,14060,14064,14069,14073,14077,14081,14085,14090,14094,14098,14102,14106,14110,14114,14119,14124,14128,14132,14137,14141,14145,14149,14154,14158,14162,14166,14171,14176,14180,14184,14188,14192,14197,14201,14206,14210,14214,14218,14262,14279,14336,14344,14353,14389,14406,14413,14428,14437,14444,14449,14466,14471,14478],{"__ignoreMap":38},[43,14057,14058],{"class":45,"line":46},[43,14059,1205],{"class":1006},[43,14061,14062],{"class":45,"line":61},[43,14063,244],{"emptyLinePlaceholder":243},[43,14065,14066],{"class":45,"line":70},[43,14067,14068],{"class":1006},"name: mart.sales_daily\n",[43,14070,14071],{"class":45,"line":78},[43,14072,1215],{"class":1006},[43,14074,14075],{"class":45,"line":86},[43,14076,244],{"emptyLinePlaceholder":243},[43,14078,14079],{"class":45,"line":94},[43,14080,1235],{"class":1006},[43,14082,14083],{"class":45,"line":108},[43,14084,1240],{"class":1006},[43,14086,14087],{"class":45,"line":119},[43,14088,14089],{"class":1006},"  strategy: append\n",[43,14091,14092],{"class":45,"line":129},[43,14093,244],{"emptyLinePlaceholder":243},[43,14095,14096],{"class":45,"line":140},[43,14097,1250],{"class":1006},[43,14099,14100],{"class":45,"line":152},[43,14101,1512],{"class":1006},[43,14103,14104],{"class":45,"line":162},[43,14105,1517],{"class":1006},[43,14107,14108],{"class":45,"line":170},[43,14109,244],{"emptyLinePlaceholder":243},[43,14111,14112],{"class":45,"line":182},[43,14113,9877],{"class":1006},[43,14115,14116],{"class":45,"line":374},[43,14117,14118],{"class":1006},"  - name: sale_date\n",[43,14120,14121],{"class":45,"line":382},[43,14122,14123],{"class":1006},"    type: date\n",[43,14125,14126],{"class":45,"line":392},[43,14127,13073],{"class":1006},[43,14129,14130],{"class":45,"line":399},[43,14131,13085],{"class":1006},[43,14133,14134],{"class":45,"line":410},[43,14135,14136],{"class":1006},"  - name: orders_count\n",[43,14138,14139],{"class":45,"line":417},[43,14140,13061],{"class":1006},[43,14142,14143],{"class":45,"line":425},[43,14144,13073],{"class":1006},[43,14146,14147],{"class":45,"line":430},[43,14148,13085],{"class":1006},[43,14150,14151],{"class":45,"line":438},[43,14152,14153],{"class":1006},"  - name: items_count\n",[43,14155,14156],{"class":45,"line":446},[43,14157,13061],{"class":1006},[43,14159,14160],{"class":45,"line":456},[43,14161,13073],{"class":1006},[43,14163,14164],{"class":45,"line":464},[43,14165,13085],{"class":1006},[43,14167,14168],{"class":45,"line":472},[43,14169,14170],{"class":1006},"  - name: revenue\n",[43,14172,14173],{"class":45,"line":483},[43,14174,14175],{"class":1006},"    type: numeric\n",[43,14177,14178],{"class":45,"line":494},[43,14179,13073],{"class":1006},[43,14181,14182],{"class":45,"line":506},[43,14183,13085],{"class":1006},[43,14185,14186],{"class":45,"line":517},[43,14187,244],{"emptyLinePlaceholder":243},[43,14189,14190],{"class":45,"line":525},[43,14191,10250],{"class":1006},[43,14193,14194],{"class":45,"line":538},[43,14195,14196],{"class":1006},"  - name: total revenue non-negative\n",[43,14198,14199],{"class":45,"line":550},[43,14200,10275],{"class":1006},[43,14202,14203],{"class":45,"line":558},[43,14204,14205],{"class":1006},"    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n",[43,14207,14208],{"class":45,"line":568},[43,14209,244],{"emptyLinePlaceholder":243},[43,14211,14212],{"class":45,"line":578},[43,14213,1265],{"class":1006},[43,14215,14216],{"class":45,"line":588},[43,14217,244],{"emptyLinePlaceholder":243},[43,14219,14220,14222,14225,14227,14229,14231,14234,14236,14239,14242,14244,14247,14249,14251,14254,14257,14259],{"class":45,"line":595},[43,14221,1274],{"class":148},[43,14223,14224],{"class":1277}," daily_orders ",[43,14226,1281],{"class":148},[43,14228,1587],{"class":1277},[43,14230,1410],{"class":148},[43,14232,14233],{"class":1418}," CAST",[43,14235,1422],{"class":1277},[43,14237,14238],{"class":1418},"CAST",[43,14240,14241],{"class":1277},"(order_date ",[43,14243,1281],{"class":148},[43,14245,14246],{"class":1871}," TIMESTAMP",[43,14248,1428],{"class":1277},[43,14250,1281],{"class":148},[43,14252,14253],{"class":1871}," DATE",[43,14255,14256],{"class":1277},")                               ",[43,14258,1281],{"class":148},[43,14260,14261],{"class":1277}," sale_date,\n",[43,14263,14264,14267,14269,14271,14274,14276],{"class":45,"line":606},[43,14265,14266],{"class":1418},"                             COUNT",[43,14268,1422],{"class":1277},[43,14270,1425],{"class":53},[43,14272,14273],{"class":1277},")                                                                  ",[43,14275,1281],{"class":148},[43,14277,14278],{"class":1277}," orders_count,\n",[43,14280,14281,14284,14286,14289,14291,14294,14297,14299,14301,14303,14305,14307,14309,14311,14313,14315,14318,14321,14324,14326,14329,14331,14333],{"class":45,"line":614},[43,14282,14283],{"class":1418},"                             SUM",[43,14285,1422],{"class":1277},[43,14287,14288],{"class":148},"CASE",[43,14290,1727],{"class":148},[43,14292,14293],{"class":148}," status",[43,14295,14296],{"class":148}," IN",[43,14298,1587],{"class":1277},[43,14300,1590],{"class":53},[43,14302,1593],{"class":57},[43,14304,1590],{"class":53},[43,14306,2197],{"class":1277},[43,14308,1590],{"class":53},[43,14310,1603],{"class":57},[43,14312,1590],{"class":53},[43,14314,1428],{"class":1277},[43,14316,14317],{"class":148},"THEN",[43,14319,14320],{"class":1277}," total_amount ",[43,14322,14323],{"class":148},"ELSE",[43,14325,1737],{"class":148},[43,14327,14328],{"class":148}," END",[43,14330,1428],{"class":1277},[43,14332,1281],{"class":148},[43,14334,14335],{"class":1277}," revenue\n",[43,14337,14338,14341],{"class":45,"line":624},[43,14339,14340],{"class":148},"                      FROM",[43,14342,14343],{"class":1277}," stg.orders\n",[43,14345,14346,14349,14351],{"class":45,"line":633},[43,14347,14348],{"class":148},"                      GROUP BY",[43,14350,1003],{"class":148},[43,14352,1612],{"class":1277},[43,14354,14355,14358,14360,14362,14364,14366,14368,14370,14373,14375,14377,14379,14381,14383,14385,14387],{"class":45,"line":643},[43,14356,14357],{"class":1277},"     daily_items ",[43,14359,1281],{"class":148},[43,14361,1587],{"class":1277},[43,14363,1410],{"class":148},[43,14365,14233],{"class":1418},[43,14367,1422],{"class":1277},[43,14369,14238],{"class":1418},[43,14371,14372],{"class":1277},"(o.order_date ",[43,14374,1281],{"class":148},[43,14376,14246],{"class":1871},[43,14378,1428],{"class":1277},[43,14380,1281],{"class":148},[43,14382,14253],{"class":1871},[43,14384,1428],{"class":1277},[43,14386,1281],{"class":148},[43,14388,14261],{"class":1277},[43,14390,14391,14394,14396,14398,14401,14403],{"class":45,"line":650},[43,14392,14393],{"class":1418},"                            COUNT",[43,14395,1422],{"class":1277},[43,14397,1425],{"class":53},[43,14399,14400],{"class":1277},")                                      ",[43,14402,1281],{"class":148},[43,14404,14405],{"class":1277}," items_count\n",[43,14407,14408,14411],{"class":45,"line":661},[43,14409,14410],{"class":148},"                     FROM",[43,14412,1553],{"class":1277},[43,14414,14415,14418,14420,14422,14424,14426],{"class":45,"line":669},[43,14416,14417],{"class":148},"                            JOIN",[43,14419,1561],{"class":1277},[43,14421,1564],{"class":148},[43,14423,1567],{"class":1277},[43,14425,1570],{"class":53},[43,14427,1573],{"class":1277},[43,14429,14430,14433,14435],{"class":45,"line":679},[43,14431,14432],{"class":148},"                     GROUP BY",[43,14434,1003],{"class":148},[43,14436,1405],{"class":1277},[43,14438,14439,14441],{"class":45,"line":687},[43,14440,1410],{"class":148},[43,14442,14443],{"class":1277}," d.sale_date,\n",[43,14445,14446],{"class":45,"line":695},[43,14447,14448],{"class":1277},"       d.orders_count,\n",[43,14450,14451,14454,14457,14459,14461,14463],{"class":45,"line":702},[43,14452,14453],{"class":1418},"       COALESCE",[43,14455,14456],{"class":1277},"(i.items_count, ",[43,14458,1935],{"class":148},[43,14460,1428],{"class":1277},[43,14462,1281],{"class":148},[43,14464,14465],{"class":1277}," items_count,\n",[43,14467,14468],{"class":45,"line":709},[43,14469,14470],{"class":1277},"       d.revenue\n",[43,14472,14473,14475],{"class":45,"line":719},[43,14474,1438],{"class":148},[43,14476,14477],{"class":1277}," daily_orders d\n",[43,14479,14480,14482],{"class":45,"line":728},[43,14481,1453],{"class":148},[43,14483,14484],{"class":1277}," sale_date;\n",[33,14486,14489],{"className":1195,"code":14487,"filename":14488,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.product_performance\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: product_id\n    type: BIGINT\n    checks:\n      - name: not_null\n  - name: product_name\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: category\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: HUGEINT\n    checks:\n      - name: not_null\n  - name: gross_revenue\n    type: DECIMAL(38,2)\n    checks:\n      - name: not_null\n  - name: avg_item_price\n    type: DOUBLE\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: no negative prices or revenue\n    value: 0\n    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), items_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","mart.product_performance.asset.sql",[40,14490,14491,14495,14499,14503,14507,14511,14515,14519,14523,14527,14531,14535,14539,14543,14547,14551,14555,14560,14565,14569,14573,14578,14583,14587,14591,14596,14600,14604,14608,14613,14618,14622,14626,14631,14636,14640,14644,14649,14654,14658,14662,14666,14670,14675,14679,14684,14688,14692,14696,14706,14714,14720,14734,14760,14769,14773,14777,14781,14785,14791,14805,14809,14813,14817,14825,14829,14839,14849,14885,14891,14905,14919],{"__ignoreMap":38},[43,14492,14493],{"class":45,"line":46},[43,14494,1205],{"class":1006},[43,14496,14497],{"class":45,"line":61},[43,14498,244],{"emptyLinePlaceholder":243},[43,14500,14501],{"class":45,"line":70},[43,14502,1477],{"class":1006},[43,14504,14505],{"class":45,"line":78},[43,14506,1215],{"class":1006},[43,14508,14509],{"class":45,"line":86},[43,14510,244],{"emptyLinePlaceholder":243},[43,14512,14513],{"class":45,"line":94},[43,14514,1235],{"class":1006},[43,14516,14517],{"class":45,"line":108},[43,14518,1240],{"class":1006},[43,14520,14521],{"class":45,"line":119},[43,14522,1245],{"class":1006},[43,14524,14525],{"class":45,"line":129},[43,14526,244],{"emptyLinePlaceholder":243},[43,14528,14529],{"class":45,"line":140},[43,14530,1250],{"class":1006},[43,14532,14533],{"class":45,"line":152},[43,14534,1502],{"class":1006},[43,14536,14537],{"class":45,"line":162},[43,14538,1507],{"class":1006},[43,14540,14541],{"class":45,"line":170},[43,14542,1512],{"class":1006},[43,14544,14545],{"class":45,"line":182},[43,14546,1517],{"class":1006},[43,14548,14549],{"class":45,"line":374},[43,14550,244],{"emptyLinePlaceholder":243},[43,14552,14553],{"class":45,"line":382},[43,14554,9877],{"class":1006},[43,14556,14557],{"class":45,"line":392},[43,14558,14559],{"class":1006},"  - name: product_id\n",[43,14561,14562],{"class":45,"line":399},[43,14563,14564],{"class":1006},"    type: BIGINT\n",[43,14566,14567],{"class":45,"line":410},[43,14568,13073],{"class":1006},[43,14570,14571],{"class":45,"line":417},[43,14572,13085],{"class":1006},[43,14574,14575],{"class":45,"line":425},[43,14576,14577],{"class":1006},"  - name: product_name\n",[43,14579,14580],{"class":45,"line":430},[43,14581,14582],{"class":1006},"    type: VARCHAR\n",[43,14584,14585],{"class":45,"line":438},[43,14586,13073],{"class":1006},[43,14588,14589],{"class":45,"line":446},[43,14590,13085],{"class":1006},[43,14592,14593],{"class":45,"line":456},[43,14594,14595],{"class":1006},"  - name: category\n",[43,14597,14598],{"class":45,"line":464},[43,14599,14582],{"class":1006},[43,14601,14602],{"class":45,"line":472},[43,14603,13073],{"class":1006},[43,14605,14606],{"class":45,"line":483},[43,14607,13085],{"class":1006},[43,14609,14610],{"class":45,"line":494},[43,14611,14612],{"class":1006},"  - name: items_sold\n",[43,14614,14615],{"class":45,"line":506},[43,14616,14617],{"class":1006},"    type: HUGEINT\n",[43,14619,14620],{"class":45,"line":517},[43,14621,13073],{"class":1006},[43,14623,14624],{"class":45,"line":525},[43,14625,13085],{"class":1006},[43,14627,14628],{"class":45,"line":538},[43,14629,14630],{"class":1006},"  - name: gross_revenue\n",[43,14632,14633],{"class":45,"line":550},[43,14634,14635],{"class":1006},"    type: DECIMAL(38,2)\n",[43,14637,14638],{"class":45,"line":558},[43,14639,13073],{"class":1006},[43,14641,14642],{"class":45,"line":568},[43,14643,13085],{"class":1006},[43,14645,14646],{"class":45,"line":578},[43,14647,14648],{"class":1006},"  - name: avg_item_price\n",[43,14650,14651],{"class":45,"line":588},[43,14652,14653],{"class":1006},"    type: DOUBLE\n",[43,14655,14656],{"class":45,"line":595},[43,14657,13073],{"class":1006},[43,14659,14660],{"class":45,"line":606},[43,14661,13085],{"class":1006},[43,14663,14664],{"class":45,"line":614},[43,14665,244],{"emptyLinePlaceholder":243},[43,14667,14668],{"class":45,"line":624},[43,14669,10250],{"class":1006},[43,14671,14672],{"class":45,"line":633},[43,14673,14674],{"class":1006},"  - name: no negative prices or revenue\n",[43,14676,14677],{"class":45,"line":643},[43,14678,10275],{"class":1006},[43,14680,14681],{"class":45,"line":650},[43,14682,14683],{"class":1006},"    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n",[43,14685,14686],{"class":45,"line":661},[43,14687,244],{"emptyLinePlaceholder":243},[43,14689,14690],{"class":45,"line":669},[43,14691,1265],{"class":1006},[43,14693,14694],{"class":45,"line":679},[43,14695,244],{"emptyLinePlaceholder":243},[43,14697,14698,14700,14702,14704],{"class":45,"line":687},[43,14699,1274],{"class":148},[43,14701,1532],{"class":1277},[43,14703,1281],{"class":148},[43,14705,1284],{"class":1277},[43,14707,14708,14710,14712],{"class":45,"line":695},[43,14709,1289],{"class":148},[43,14711,1543],{"class":1277},[43,14713,1546],{"class":53},[43,14715,14716,14718],{"class":45,"line":702},[43,14717,1397],{"class":148},[43,14719,1553],{"class":1277},[43,14721,14722,14724,14726,14728,14730,14732],{"class":45,"line":709},[43,14723,1558],{"class":148},[43,14725,1561],{"class":1277},[43,14727,1564],{"class":148},[43,14729,1567],{"class":1277},[43,14731,1570],{"class":53},[43,14733,1573],{"class":1277},[43,14735,14736,14738,14740,14742,14744,14746,14748,14750,14752,14754,14756,14758],{"class":45,"line":719},[43,14737,1578],{"class":148},[43,14739,1581],{"class":1277},[43,14741,1584],{"class":148},[43,14743,1587],{"class":1277},[43,14745,1590],{"class":53},[43,14747,1593],{"class":57},[43,14749,1590],{"class":53},[43,14751,1598],{"class":1277},[43,14753,1590],{"class":53},[43,14755,1603],{"class":57},[43,14757,1590],{"class":53},[43,14759,1405],{"class":1277},[43,14761,14762,14765,14767],{"class":45,"line":728},[43,14763,14764],{"class":1277},"), items_with_product ",[43,14766,1281],{"class":148},[43,14768,1284],{"class":1277},[43,14770,14771],{"class":45,"line":735},[43,14772,1626],{"class":148},[43,14774,14775],{"class":45,"line":746},[43,14776,1631],{"class":1277},[43,14778,14779],{"class":45,"line":757},[43,14780,1636],{"class":1277},[43,14782,14783],{"class":45,"line":765},[43,14784,1641],{"class":1277},[43,14786,14787,14789],{"class":45,"line":775},[43,14788,1397],{"class":148},[43,14790,1648],{"class":1277},[43,14792,14793,14795,14797,14799,14801,14803],{"class":45,"line":785},[43,14794,1558],{"class":148},[43,14796,1655],{"class":1277},[43,14798,1564],{"class":148},[43,14800,1660],{"class":1277},[43,14802,1570],{"class":53},[43,14804,1665],{"class":1277},[43,14806,14807],{"class":45,"line":792},[43,14808,1405],{"class":1277},[43,14810,14811],{"class":45,"line":803},[43,14812,1674],{"class":148},[43,14814,14815],{"class":45,"line":811},[43,14816,1679],{"class":1277},[43,14818,14819,14821,14823],{"class":45,"line":821},[43,14820,1684],{"class":1277},[43,14822,1281],{"class":148},[43,14824,1689],{"class":1277},[43,14826,14827],{"class":45,"line":830},[43,14828,1694],{"class":1277},[43,14830,14831,14833,14835,14837],{"class":45,"line":838},[43,14832,1699],{"class":1418},[43,14834,1702],{"class":1277},[43,14836,1281],{"class":148},[43,14838,1707],{"class":1277},[43,14840,14841,14843,14845,14847],{"class":45,"line":848},[43,14842,1699],{"class":1418},[43,14844,1714],{"class":1277},[43,14846,1281],{"class":148},[43,14848,1719],{"class":1277},[43,14850,14851,14853,14855,14857,14859,14861,14863,14865,14867,14869,14871,14873,14875,14877,14879,14881,14883],{"class":45,"line":857},[43,14852,1724],{"class":148},[43,14854,1727],{"class":148},[43,14856,1730],{"class":1418},[43,14858,1702],{"class":1277},[43,14860,1570],{"class":53},[43,14862,1737],{"class":148},[43,14864,1309],{"class":148},[43,14866,1737],{"class":148},[43,14868,1744],{"class":148},[43,14870,1730],{"class":1418},[43,14872,1714],{"class":1277},[43,14874,1751],{"class":53},[43,14876,1730],{"class":1418},[43,14878,1702],{"class":1277},[43,14880,1758],{"class":148},[43,14882,1389],{"class":148},[43,14884,1763],{"class":1277},[43,14886,14887,14889],{"class":45,"line":865},[43,14888,1438],{"class":148},[43,14890,1770],{"class":1277},[43,14892,14893,14895,14897,14899,14901,14903],{"class":45,"line":875},[43,14894,1775],{"class":148},[43,14896,1778],{"class":1277},[43,14898,1564],{"class":148},[43,14900,1783],{"class":1277},[43,14902,1570],{"class":53},[43,14904,1788],{"class":1277},[43,14906,14907,14909,14911,14913,14915,14917],{"class":45,"line":884},[43,14908,1446],{"class":148},[43,14910,1003],{"class":148},[43,14912,1598],{"class":1277},[43,14914,1799],{"class":148},[43,14916,1598],{"class":1277},[43,14918,1804],{"class":148},[43,14920,14921,14923,14925,14927],{"class":45,"line":891},[43,14922,1453],{"class":148},[43,14924,1811],{"class":1277},[43,14926,1459],{"class":148},[43,14928,1462],{"class":1277},[33,14930,14933],{"className":1195,"code":14931,"filename":14932,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.variant_profitability\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n  - stg.products\n\ncolumns:\n  - name: variant_id\n    type: integer\n    checks:\n      - name: not_null\n      - name: unique\n  - name: variant_sku\n    type: string\n    checks:\n      - name: not_null\n  - name: product_id\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n  - name: cost\n    type: numeric\n    checks:\n      - name: not_null\n  - name: profit\n    type: numeric\n    checks:\n      - name: not_null\n  - name: margin_pct\n    type: numeric\n    checks:\n      - name: not_null\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), joined AS (\n  SELECT\n    v.variant_id,\n    p.name as product_name,\n    v.variant_sku,\n    v.product_id,\n    v.manufacturing_price,\n    v.selling_price,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n  JOIN stg.products p ON p.product_id = v.product_id\n)\nSELECT\n    j.product_name,\n  j.variant_id,\n  j.variant_sku,\n  j.product_id,\n  SUM(j.quantity) AS items_sold,\n  SUM(j.total_price) AS revenue,\n  SUM(j.quantity * j.manufacturing_price) AS cost,\n  SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price) AS profit,\n  CASE WHEN SUM(j.total_price) = 0 THEN 0\n       ELSE (SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price)) / SUM(j.total_price)\n  END AS margin_pct,\n  BOOL_OR(j.selling_price \u003C j.manufacturing_price) AS selling_price_below_cost\nFROM joined j\nGROUP BY 1,2,3,4\nORDER BY profit DESC;\n","mart.variant_profitability.asset.sql",[40,14934,14935,14939,14943,14948,14952,14956,14960,14964,14968,14972,14976,14980,14984,14988,14992,14996,15000,15005,15009,15013,15017,15021,15026,15031,15035,15039,15043,15047,15051,15055,15059,15063,15067,15071,15075,15079,15083,15087,15092,15096,15100,15104,15109,15113,15117,15121,15126,15130,15134,15138,15142,15146,15150,15160,15168,15174,15188,15214,15223,15227,15232,15242,15247,15251,15256,15261,15265,15269,15275,15289,15304,15308,15312,15317,15322,15327,15332,15343,15355,15372,15393,15411,15441,15451,15465,15472,15492],{"__ignoreMap":38},[43,14936,14937],{"class":45,"line":46},[43,14938,1205],{"class":1006},[43,14940,14941],{"class":45,"line":61},[43,14942,244],{"emptyLinePlaceholder":243},[43,14944,14945],{"class":45,"line":70},[43,14946,14947],{"class":1006},"name: mart.variant_profitability\n",[43,14949,14950],{"class":45,"line":78},[43,14951,1215],{"class":1006},[43,14953,14954],{"class":45,"line":86},[43,14955,244],{"emptyLinePlaceholder":243},[43,14957,14958],{"class":45,"line":94},[43,14959,1235],{"class":1006},[43,14961,14962],{"class":45,"line":108},[43,14963,1240],{"class":1006},[43,14965,14966],{"class":45,"line":119},[43,14967,1245],{"class":1006},[43,14969,14970],{"class":45,"line":129},[43,14971,244],{"emptyLinePlaceholder":243},[43,14973,14974],{"class":45,"line":140},[43,14975,1250],{"class":1006},[43,14977,14978],{"class":45,"line":152},[43,14979,1507],{"class":1006},[43,14981,14982],{"class":45,"line":162},[43,14983,1512],{"class":1006},[43,14985,14986],{"class":45,"line":170},[43,14987,1517],{"class":1006},[43,14989,14990],{"class":45,"line":182},[43,14991,1502],{"class":1006},[43,14993,14994],{"class":45,"line":374},[43,14995,244],{"emptyLinePlaceholder":243},[43,14997,14998],{"class":45,"line":382},[43,14999,9877],{"class":1006},[43,15001,15002],{"class":45,"line":392},[43,15003,15004],{"class":1006},"  - name: variant_id\n",[43,15006,15007],{"class":45,"line":399},[43,15008,13061],{"class":1006},[43,15010,15011],{"class":45,"line":410},[43,15012,13073],{"class":1006},[43,15014,15015],{"class":45,"line":417},[43,15016,13085],{"class":1006},[43,15018,15019],{"class":45,"line":425},[43,15020,13079],{"class":1006},[43,15022,15023],{"class":45,"line":430},[43,15024,15025],{"class":1006},"  - name: variant_sku\n",[43,15027,15028],{"class":45,"line":438},[43,15029,15030],{"class":1006},"    type: string\n",[43,15032,15033],{"class":45,"line":446},[43,15034,13073],{"class":1006},[43,15036,15037],{"class":45,"line":456},[43,15038,13085],{"class":1006},[43,15040,15041],{"class":45,"line":464},[43,15042,14559],{"class":1006},[43,15044,15045],{"class":45,"line":472},[43,15046,13061],{"class":1006},[43,15048,15049],{"class":45,"line":483},[43,15050,13073],{"class":1006},[43,15052,15053],{"class":45,"line":494},[43,15054,13085],{"class":1006},[43,15056,15057],{"class":45,"line":506},[43,15058,14612],{"class":1006},[43,15060,15061],{"class":45,"line":517},[43,15062,13061],{"class":1006},[43,15064,15065],{"class":45,"line":525},[43,15066,13073],{"class":1006},[43,15068,15069],{"class":45,"line":538},[43,15070,13085],{"class":1006},[43,15072,15073],{"class":45,"line":550},[43,15074,14170],{"class":1006},[43,15076,15077],{"class":45,"line":558},[43,15078,14175],{"class":1006},[43,15080,15081],{"class":45,"line":568},[43,15082,13073],{"class":1006},[43,15084,15085],{"class":45,"line":578},[43,15086,13085],{"class":1006},[43,15088,15089],{"class":45,"line":588},[43,15090,15091],{"class":1006},"  - name: cost\n",[43,15093,15094],{"class":45,"line":595},[43,15095,14175],{"class":1006},[43,15097,15098],{"class":45,"line":606},[43,15099,13073],{"class":1006},[43,15101,15102],{"class":45,"line":614},[43,15103,13085],{"class":1006},[43,15105,15106],{"class":45,"line":624},[43,15107,15108],{"class":1006},"  - name: profit\n",[43,15110,15111],{"class":45,"line":633},[43,15112,14175],{"class":1006},[43,15114,15115],{"class":45,"line":643},[43,15116,13073],{"class":1006},[43,15118,15119],{"class":45,"line":650},[43,15120,13085],{"class":1006},[43,15122,15123],{"class":45,"line":661},[43,15124,15125],{"class":1006},"  - name: margin_pct\n",[43,15127,15128],{"class":45,"line":669},[43,15129,14175],{"class":1006},[43,15131,15132],{"class":45,"line":679},[43,15133,13073],{"class":1006},[43,15135,15136],{"class":45,"line":687},[43,15137,13085],{"class":1006},[43,15139,15140],{"class":45,"line":695},[43,15141,244],{"emptyLinePlaceholder":243},[43,15143,15144],{"class":45,"line":702},[43,15145,1265],{"class":1006},[43,15147,15148],{"class":45,"line":709},[43,15149,244],{"emptyLinePlaceholder":243},[43,15151,15152,15154,15156,15158],{"class":45,"line":719},[43,15153,1274],{"class":148},[43,15155,1532],{"class":1277},[43,15157,1281],{"class":148},[43,15159,1284],{"class":1277},[43,15161,15162,15164,15166],{"class":45,"line":728},[43,15163,1289],{"class":148},[43,15165,1543],{"class":1277},[43,15167,1546],{"class":53},[43,15169,15170,15172],{"class":45,"line":735},[43,15171,1397],{"class":148},[43,15173,1553],{"class":1277},[43,15175,15176,15178,15180,15182,15184,15186],{"class":45,"line":746},[43,15177,1558],{"class":148},[43,15179,1561],{"class":1277},[43,15181,1564],{"class":148},[43,15183,1567],{"class":1277},[43,15185,1570],{"class":53},[43,15187,1573],{"class":1277},[43,15189,15190,15192,15194,15196,15198,15200,15202,15204,15206,15208,15210,15212],{"class":45,"line":757},[43,15191,1578],{"class":148},[43,15193,1581],{"class":1277},[43,15195,1584],{"class":148},[43,15197,1587],{"class":1277},[43,15199,1590],{"class":53},[43,15201,1593],{"class":57},[43,15203,1590],{"class":53},[43,15205,1598],{"class":1277},[43,15207,1590],{"class":53},[43,15209,1603],{"class":57},[43,15211,1590],{"class":53},[43,15213,1405],{"class":1277},[43,15215,15216,15219,15221],{"class":45,"line":765},[43,15217,15218],{"class":1277},"), joined ",[43,15220,1281],{"class":148},[43,15222,1284],{"class":1277},[43,15224,15225],{"class":45,"line":775},[43,15226,1626],{"class":148},[43,15228,15229],{"class":45,"line":785},[43,15230,15231],{"class":1277},"    v.variant_id,\n",[43,15233,15234,15237,15240],{"class":45,"line":792},[43,15235,15236],{"class":1277},"    p.name ",[43,15238,15239],{"class":148},"as",[43,15241,1689],{"class":1277},[43,15243,15244],{"class":45,"line":803},[43,15245,15246],{"class":1277},"    v.variant_sku,\n",[43,15248,15249],{"class":45,"line":811},[43,15250,1631],{"class":1277},[43,15252,15253],{"class":45,"line":821},[43,15254,15255],{"class":1277},"    v.manufacturing_price,\n",[43,15257,15258],{"class":45,"line":830},[43,15259,15260],{"class":1277},"    v.selling_price,\n",[43,15262,15263],{"class":45,"line":838},[43,15264,1636],{"class":1277},[43,15266,15267],{"class":45,"line":848},[43,15268,1641],{"class":1277},[43,15270,15271,15273],{"class":45,"line":857},[43,15272,1397],{"class":148},[43,15274,1648],{"class":1277},[43,15276,15277,15279,15281,15283,15285,15287],{"class":45,"line":865},[43,15278,1558],{"class":148},[43,15280,1655],{"class":1277},[43,15282,1564],{"class":148},[43,15284,1660],{"class":1277},[43,15286,1570],{"class":53},[43,15288,1665],{"class":1277},[43,15290,15291,15293,15295,15297,15299,15301],{"class":45,"line":875},[43,15292,1558],{"class":148},[43,15294,1778],{"class":1277},[43,15296,1564],{"class":148},[43,15298,1783],{"class":1277},[43,15300,1570],{"class":53},[43,15302,15303],{"class":1277}," v.product_id\n",[43,15305,15306],{"class":45,"line":884},[43,15307,1405],{"class":1277},[43,15309,15310],{"class":45,"line":891},[43,15311,1674],{"class":148},[43,15313,15314],{"class":45,"line":903},[43,15315,15316],{"class":1277},"    j.product_name,\n",[43,15318,15319],{"class":45,"line":4184},[43,15320,15321],{"class":1277},"  j.variant_id,\n",[43,15323,15324],{"class":45,"line":4190},[43,15325,15326],{"class":1277},"  j.variant_sku,\n",[43,15328,15329],{"class":45,"line":4196},[43,15330,15331],{"class":1277},"  j.product_id,\n",[43,15333,15334,15336,15339,15341],{"class":45,"line":4202},[43,15335,1699],{"class":1418},[43,15337,15338],{"class":1277},"(j.quantity) ",[43,15340,1281],{"class":148},[43,15342,1707],{"class":1277},[43,15344,15345,15347,15350,15352],{"class":45,"line":4211},[43,15346,1699],{"class":1418},[43,15348,15349],{"class":1277},"(j.total_price) ",[43,15351,1281],{"class":148},[43,15353,15354],{"class":1277}," revenue,\n",[43,15356,15357,15359,15362,15364,15367,15369],{"class":45,"line":4224},[43,15358,1699],{"class":1418},[43,15360,15361],{"class":1277},"(j.quantity ",[43,15363,1425],{"class":53},[43,15365,15366],{"class":1277}," j.manufacturing_price) ",[43,15368,1281],{"class":148},[43,15370,15371],{"class":1277}," cost,\n",[43,15373,15374,15376,15378,15380,15382,15384,15386,15388,15390],{"class":45,"line":4230},[43,15375,1699],{"class":1418},[43,15377,15349],{"class":1277},[43,15379,5336],{"class":53},[43,15381,1730],{"class":1418},[43,15383,15361],{"class":1277},[43,15385,1425],{"class":53},[43,15387,15366],{"class":1277},[43,15389,1281],{"class":148},[43,15391,15392],{"class":1277}," profit,\n",[43,15394,15395,15397,15399,15401,15403,15405,15407,15409],{"class":45,"line":4235},[43,15396,1724],{"class":148},[43,15398,1727],{"class":148},[43,15400,1730],{"class":1418},[43,15402,15349],{"class":1277},[43,15404,1570],{"class":53},[43,15406,1737],{"class":148},[43,15408,1309],{"class":148},[43,15410,911],{"class":148},[43,15412,15413,15416,15418,15421,15423,15425,15427,15429,15431,15434,15436,15438],{"class":45,"line":4246},[43,15414,15415],{"class":148},"       ELSE",[43,15417,1587],{"class":1277},[43,15419,15420],{"class":1418},"SUM",[43,15422,15349],{"class":1277},[43,15424,5336],{"class":53},[43,15426,1730],{"class":1418},[43,15428,15361],{"class":1277},[43,15430,1425],{"class":53},[43,15432,15433],{"class":1277}," j.manufacturing_price)) ",[43,15435,1751],{"class":53},[43,15437,1730],{"class":1418},[43,15439,15440],{"class":1277},"(j.total_price)\n",[43,15442,15443,15446,15448],{"class":45,"line":4268},[43,15444,15445],{"class":148},"  END",[43,15447,1389],{"class":148},[43,15449,15450],{"class":1277}," margin_pct,\n",[43,15452,15453,15456,15458,15460,15462],{"class":45,"line":4289},[43,15454,15455],{"class":1277},"  BOOL_OR(j.selling_price ",[43,15457,1303],{"class":53},[43,15459,15366],{"class":1277},[43,15461,1281],{"class":148},[43,15463,15464],{"class":1277}," selling_price_below_cost\n",[43,15466,15467,15469],{"class":45,"line":4310},[43,15468,1438],{"class":148},[43,15470,15471],{"class":1277}," joined j\n",[43,15473,15474,15476,15478,15480,15482,15484,15487,15489],{"class":45,"line":4337},[43,15475,1446],{"class":148},[43,15477,1003],{"class":148},[43,15479,1598],{"class":1277},[43,15481,1799],{"class":148},[43,15483,1598],{"class":1277},[43,15485,15486],{"class":148},"3",[43,15488,1598],{"class":1277},[43,15490,15491],{"class":148},"4\n",[43,15493,15494,15496,15499,15501],{"class":45,"line":4351},[43,15495,1453],{"class":148},[43,15497,15498],{"class":1277}," profit ",[43,15500,1459],{"class":148},[43,15502,1462],{"class":1277},[33,15504,15507],{"className":1195,"code":15505,"filename":15506,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n\n@bruin */\n\nWITH src AS (SELECT CASE\n                        WHEN age \u003C 25 THEN '18-24'\n                        WHEN age BETWEEN 25 AND 34 THEN '25-34'\n                        WHEN age BETWEEN 35 AND 49 THEN '35-49'\n                        ELSE '50+'\n                        END AS age_group\n             FROM stg.customers)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","mart.customers_by_age.asset.sql",[40,15508,15509,15513,15517,15521,15525,15529,15533,15537,15541,15545,15549,15553,15557,15561,15565,15569,15573,15577,15581,15595,15614,15636,15658,15669,15678,15686,15692,15706,15712,15718],{"__ignoreMap":38},[43,15510,15511],{"class":45,"line":46},[43,15512,1205],{"class":1006},[43,15514,15515],{"class":45,"line":61},[43,15516,244],{"emptyLinePlaceholder":243},[43,15518,15519],{"class":45,"line":70},[43,15520,1210],{"class":1006},[43,15522,15523],{"class":45,"line":78},[43,15524,1215],{"class":1006},[43,15526,15527],{"class":45,"line":86},[43,15528,1220],{"class":1006},[43,15530,15531],{"class":45,"line":94},[43,15532,1225],{"class":1006},[43,15534,15535],{"class":45,"line":108},[43,15536,1230],{"class":1006},[43,15538,15539],{"class":45,"line":119},[43,15540,244],{"emptyLinePlaceholder":243},[43,15542,15543],{"class":45,"line":129},[43,15544,1235],{"class":1006},[43,15546,15547],{"class":45,"line":140},[43,15548,1240],{"class":1006},[43,15550,15551],{"class":45,"line":152},[43,15552,1245],{"class":1006},[43,15554,15555],{"class":45,"line":162},[43,15556,244],{"emptyLinePlaceholder":243},[43,15558,15559],{"class":45,"line":170},[43,15560,1250],{"class":1006},[43,15562,15563],{"class":45,"line":182},[43,15564,1255],{"class":1006},[43,15566,15567],{"class":45,"line":374},[43,15568,1260],{"class":1006},[43,15570,15571],{"class":45,"line":382},[43,15572,244],{"emptyLinePlaceholder":243},[43,15574,15575],{"class":45,"line":392},[43,15576,1265],{"class":1006},[43,15578,15579],{"class":45,"line":399},[43,15580,244],{"emptyLinePlaceholder":243},[43,15582,15583,15585,15587,15589,15591,15593],{"class":45,"line":410},[43,15584,1274],{"class":148},[43,15586,1278],{"class":1277},[43,15588,1281],{"class":148},[43,15590,1587],{"class":1277},[43,15592,1410],{"class":148},[43,15594,1292],{"class":148},[43,15596,15597,15600,15602,15604,15606,15608,15610,15612],{"class":45,"line":417},[43,15598,15599],{"class":148},"                        WHEN",[43,15601,1300],{"class":1277},[43,15603,1303],{"class":53},[43,15605,1306],{"class":148},[43,15607,1309],{"class":148},[43,15609,1312],{"class":53},[43,15611,1315],{"class":57},[43,15613,1318],{"class":53},[43,15615,15616,15618,15620,15622,15624,15626,15628,15630,15632,15634],{"class":45,"line":425},[43,15617,15599],{"class":148},[43,15619,1300],{"class":1277},[43,15621,1327],{"class":148},[43,15623,1306],{"class":148},[43,15625,1332],{"class":148},[43,15627,1335],{"class":148},[43,15629,1309],{"class":148},[43,15631,1312],{"class":53},[43,15633,1342],{"class":57},[43,15635,1318],{"class":53},[43,15637,15638,15640,15642,15644,15646,15648,15650,15652,15654,15656],{"class":45,"line":430},[43,15639,15599],{"class":148},[43,15641,1300],{"class":1277},[43,15643,1327],{"class":148},[43,15645,1355],{"class":148},[43,15647,1332],{"class":148},[43,15649,1360],{"class":148},[43,15651,1309],{"class":148},[43,15653,1312],{"class":53},[43,15655,1367],{"class":57},[43,15657,1318],{"class":53},[43,15659,15660,15663,15665,15667],{"class":45,"line":438},[43,15661,15662],{"class":148},"                        ELSE",[43,15664,1312],{"class":53},[43,15666,1379],{"class":57},[43,15668,1318],{"class":53},[43,15670,15671,15674,15676],{"class":45,"line":446},[43,15672,15673],{"class":148},"                        END",[43,15675,1389],{"class":148},[43,15677,1392],{"class":1277},[43,15679,15680,15683],{"class":45,"line":456},[43,15681,15682],{"class":148},"             FROM",[43,15684,15685],{"class":1277}," stg.customers)\n",[43,15687,15688,15690],{"class":45,"line":464},[43,15689,1410],{"class":148},[43,15691,1413],{"class":1277},[43,15693,15694,15696,15698,15700,15702,15704],{"class":45,"line":472},[43,15695,1419],{"class":1418},[43,15697,1422],{"class":1277},[43,15699,1425],{"class":53},[43,15701,1428],{"class":1277},[43,15703,1281],{"class":148},[43,15705,1433],{"class":1277},[43,15707,15708,15710],{"class":45,"line":483},[43,15709,1438],{"class":148},[43,15711,1441],{"class":1277},[43,15713,15714,15716],{"class":45,"line":494},[43,15715,1446],{"class":148},[43,15717,1392],{"class":1277},[43,15719,15720,15722,15724,15726],{"class":45,"line":506},[43,15721,1453],{"class":148},[43,15723,1456],{"class":1277},[43,15725,1459],{"class":148},[43,15727,1462],{"class":1277},[33,15729,15732],{"className":1195,"code":15730,"filename":15731,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.customers_by_country\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\n\n@bruin */\n\nSELECT\n    country,\n    COUNT(*) AS total_customers\n  FROM stg.customers\n  GROUP BY country\n  ORDER BY total_customers DESC\n","mart.customers_by_county.asset.sql",[40,15733,15734,15738,15742,15747,15751,15755,15759,15763,15767,15771,15775,15779,15783,15787,15791,15795,15800,15815,15821,15828],{"__ignoreMap":38},[43,15735,15736],{"class":45,"line":46},[43,15737,1205],{"class":1006},[43,15739,15740],{"class":45,"line":61},[43,15741,244],{"emptyLinePlaceholder":243},[43,15743,15744],{"class":45,"line":70},[43,15745,15746],{"class":1006},"name: mart.customers_by_country\n",[43,15748,15749],{"class":45,"line":78},[43,15750,1215],{"class":1006},[43,15752,15753],{"class":45,"line":86},[43,15754,244],{"emptyLinePlaceholder":243},[43,15756,15757],{"class":45,"line":94},[43,15758,1235],{"class":1006},[43,15760,15761],{"class":45,"line":108},[43,15762,1240],{"class":1006},[43,15764,15765],{"class":45,"line":119},[43,15766,1245],{"class":1006},[43,15768,15769],{"class":45,"line":129},[43,15770,244],{"emptyLinePlaceholder":243},[43,15772,15773],{"class":45,"line":140},[43,15774,1250],{"class":1006},[43,15776,15777],{"class":45,"line":152},[43,15778,1255],{"class":1006},[43,15780,15781],{"class":45,"line":162},[43,15782,244],{"emptyLinePlaceholder":243},[43,15784,15785],{"class":45,"line":170},[43,15786,1265],{"class":1006},[43,15788,15789],{"class":45,"line":182},[43,15790,244],{"emptyLinePlaceholder":243},[43,15792,15793],{"class":45,"line":374},[43,15794,1674],{"class":148},[43,15796,15797],{"class":45,"line":382},[43,15798,15799],{"class":1277},"    country,\n",[43,15801,15802,15805,15807,15809,15811,15813],{"class":45,"line":392},[43,15803,15804],{"class":1418},"    COUNT",[43,15806,1422],{"class":1277},[43,15808,1425],{"class":53},[43,15810,1428],{"class":1277},[43,15812,1281],{"class":148},[43,15814,1433],{"class":1277},[43,15816,15817,15819],{"class":45,"line":399},[43,15818,1397],{"class":148},[43,15820,1400],{"class":1277},[43,15822,15823,15826],{"class":45,"line":410},[43,15824,15825],{"class":148},"  GROUP BY",[43,15827,845],{"class":1277},[43,15829,15830,15833,15835],{"class":45,"line":417},[43,15831,15832],{"class":148},"  ORDER BY",[43,15834,1456],{"class":1277},[43,15836,15837],{"class":148},"DESC\n",[15839,15840,15841],"style",{},"html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}",{"title":38,"searchDepth":46,"depth":61,"links":15843},[15844,15845,15846,15847,15848,15849,15850,15851,15852],{"id":1975,"depth":61,"text":1979},{"id":2025,"depth":61,"text":2026},{"id":2114,"depth":61,"text":2115},{"id":3142,"depth":61,"text":3143},{"id":3328,"depth":61,"text":3329},{"id":8642,"depth":61,"text":8643},{"id":8769,"depth":61,"text":8770},{"id":9804,"depth":61,"text":9805},{"id":14040,"depth":61,"text":14041},"Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB","md",null,{},{"icon":22},{"title":19,"description":15853},"VbcV5up_ssGVRQYkUqo6Y8AhpHKKH_c_aeCVQn1IApU",[15861,15855],{"title":10,"path":6,"stem":7,"description":15862,"icon":11,"children":-1},"Welcome to Bruin University.",1760925588452]