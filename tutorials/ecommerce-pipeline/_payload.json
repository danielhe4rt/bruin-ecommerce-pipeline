[{"data":1,"prerenderedAt":19682},["ShallowReactive",2],{"navigation":3,"/tutorials/ecommerce-pipeline":23,"/tutorials/ecommerce-pipeline-surround":19679},[4,13],{"title":5,"path":6,"stem":7,"children":8,"icon":12},"Getting Started","/getting-started","1.getting-started/1.index",[9],{"title":10,"path":6,"stem":7,"icon":11},"Introduction","i-lucide-house",false,{"title":14,"path":15,"stem":16,"children":17,"page":12},"Tutorials","/tutorials","2.tutorials",[18],{"title":19,"path":20,"stem":21,"icon":22},"E-commerce Showcase","/tutorials/ecommerce-pipeline","2.tutorials/1.ecommerce-pipeline","i-lucide-shopping-cart",{"id":24,"title":19,"body":25,"description":19672,"extension":19673,"links":19674,"meta":19675,"navigation":19676,"path":20,"seo":19677,"stem":21,"__hash__":19678},"docs/2.tutorials/1.ecommerce-pipeline.md",{"type":26,"value":27,"toc":19658},"minimark",[28,1972,1980,2016,2023,2027,2052,2079,2082,2109,2112,2116,2127,2134,2208,2211,2214,2217,2275,2996,2999,3013,3016,3137,3140,3144,3147,3256,3259,3363,3374,3378,3385,3388,3405,3408,8213,8216,8490,8493,8673,8686,8690,8693,8696,8699,8721,8724,8796,8810,8813,8817,8824,8835,8841,9448,9451,9454,9457,9501,9504,9808,9817,9821,9828,9843,13001,13007,13202,13207,13344,13362,13365,13370,13513,13516,13543,13550,13635,13638,14047,14050,14054,14057,14060,15850,15853,15856,16821,16824,18338,18342,18353,18385,18394,18649,18656,18686,18696,18704,19020,19023,19473,19480,19496,19499,19531,19536,19638,19654],[29,30,32,191,255,912,1008,1110,1193,1463,1816],"code-tree",{"default-value":31},".bruin.yml",[33,34,39],"pre",{"className":35,"code":36,"filename":31,"language":37,"meta":38,"style":38},"language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","default_environment: default\nenvironments:\n    default:\n        connections:\n            postgres:\n                - name: pg-default\n                  username: postgres\n                  password: postgres\n                  host: localhost\n                  port: 5432\n                  database: postgres\n            duckdb:\n                - name: duckdb-default\n                  path: duckdb.db\n","yaml","",[40,41,42,59,68,76,84,92,106,117,127,138,150,160,168,180],"code",{"__ignoreMap":38},[43,44,47,51,55],"span",{"class":45,"line":46},"line",1,[43,48,50],{"class":49},"swJcz","default_environment",[43,52,54],{"class":53},"sMK4o",":",[43,56,58],{"class":57},"sfazB"," default\n",[43,60,62,65],{"class":45,"line":61},2,[43,63,64],{"class":49},"environments",[43,66,67],{"class":53},":\n",[43,69,71,74],{"class":45,"line":70},3,[43,72,73],{"class":49},"    default",[43,75,67],{"class":53},[43,77,79,82],{"class":45,"line":78},4,[43,80,81],{"class":49},"        connections",[43,83,67],{"class":53},[43,85,87,90],{"class":45,"line":86},5,[43,88,89],{"class":49},"            postgres",[43,91,67],{"class":53},[43,93,95,98,101,103],{"class":45,"line":94},6,[43,96,97],{"class":53},"                -",[43,99,100],{"class":49}," name",[43,102,54],{"class":53},[43,104,105],{"class":57}," pg-default\n",[43,107,109,112,114],{"class":45,"line":108},7,[43,110,111],{"class":49},"                  username",[43,113,54],{"class":53},[43,115,116],{"class":57}," postgres\n",[43,118,120,123,125],{"class":45,"line":119},8,[43,121,122],{"class":49},"                  password",[43,124,54],{"class":53},[43,126,116],{"class":57},[43,128,130,133,135],{"class":45,"line":129},9,[43,131,132],{"class":49},"                  host",[43,134,54],{"class":53},[43,136,137],{"class":57}," localhost\n",[43,139,141,144,146],{"class":45,"line":140},10,[43,142,143],{"class":49},"                  port",[43,145,54],{"class":53},[43,147,149],{"class":148},"sbssI"," 5432\n",[43,151,153,156,158],{"class":45,"line":152},11,[43,154,155],{"class":49},"                  database",[43,157,54],{"class":53},[43,159,116],{"class":57},[43,161,163,166],{"class":45,"line":162},12,[43,164,165],{"class":49},"            duckdb",[43,167,67],{"class":53},[43,169,171,173,175,177],{"class":45,"line":170},13,[43,172,97],{"class":53},[43,174,100],{"class":49},[43,176,54],{"class":53},[43,178,179],{"class":57}," duckdb-default\n",[43,181,183,186,188],{"class":45,"line":182},14,[43,184,185],{"class":49},"                  path",[43,187,54],{"class":53},[43,189,190],{"class":57}," duckdb.db\n",[33,192,197],{"className":193,"code":194,"filename":195,"language":196,"meta":38,"style":38},"language-toml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","[project]\nname = \"bruin\"\nversion = \"0.1.0\"\nrequires-python = \">=3.13\"\ndependencies = [\n    \"faker>=37.11.0\",\n    \"psycopg>=3.2.10\",\n]\n\n[project.scripts]\ngenerate-data = \"generate_data:main\"\n","pyproject.toml","toml",[40,198,199,204,209,214,219,224,229,234,239,245,250],{"__ignoreMap":38},[43,200,201],{"class":45,"line":46},[43,202,203],{},"[project]\n",[43,205,206],{"class":45,"line":61},[43,207,208],{},"name = \"bruin\"\n",[43,210,211],{"class":45,"line":70},[43,212,213],{},"version = \"0.1.0\"\n",[43,215,216],{"class":45,"line":78},[43,217,218],{},"requires-python = \">=3.13\"\n",[43,220,221],{"class":45,"line":86},[43,222,223],{},"dependencies = [\n",[43,225,226],{"class":45,"line":94},[43,227,228],{},"    \"faker>=37.11.0\",\n",[43,230,231],{"class":45,"line":108},[43,232,233],{},"    \"psycopg>=3.2.10\",\n",[43,235,236],{"class":45,"line":119},[43,237,238],{},"]\n",[43,240,241],{"class":45,"line":129},[43,242,244],{"emptyLinePlaceholder":243},true,"\n",[43,246,247],{"class":45,"line":140},[43,248,249],{},"[project.scripts]\n",[43,251,252],{"class":45,"line":152},[43,253,254],{},"generate-data = \"generate_data:main\"\n",[33,256,259],{"className":35,"code":257,"filename":258,"language":37,"meta":38,"style":38},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fields for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n      Country:\n        name: country\n        type: string\n      Age:\n        name: age\n        type: integer\n        checks:\n          - name: range\n            min: 0\n","glossary.yml",[40,260,261,268,275,285,292,306,313,320,327,336,342,352,358,365,372,380,390,397,408,415,423,428,436,444,454,462,470,481,492,504,515,523,536,548,556,566,576,586,593,604,612,622,631,641,648,659,667,677,685,693,700,707,717,726,733,744,755,763,773,783,790,801,809,819,828,836,846,855,863,873,882,889,901],{"__ignoreMap":38},[43,262,263,266],{"class":45,"line":46},[43,264,265],{"class":49},"domains",[43,267,67],{"class":53},[43,269,270,273],{"class":45,"line":61},[43,271,272],{"class":49},"  customer-management",[43,274,67],{"class":53},[43,276,277,280,282],{"class":45,"line":70},[43,278,279],{"class":49},"    description",[43,281,54],{"class":53},[43,283,284],{"class":57}," All aspects related to customer data, registration, and account management\n",[43,286,287,290],{"class":45,"line":78},[43,288,289],{"class":49},"    owners",[43,291,67],{"class":53},[43,293,294,297,300,303],{"class":45,"line":86},[43,295,296],{"class":53},"      -",[43,298,299],{"class":53}," \"",[43,301,302],{"class":57},"Data Team",[43,304,305],{"class":53},"\"\n",[43,307,308,311],{"class":45,"line":94},[43,309,310],{"class":49},"    tags",[43,312,67],{"class":53},[43,314,315,317],{"class":45,"line":108},[43,316,296],{"class":53},[43,318,319],{"class":57}," customer\n",[43,321,322,325],{"class":45,"line":119},[43,323,324],{"class":49},"  product-catalog",[43,326,67],{"class":53},[43,328,329,331,333],{"class":45,"line":129},[43,330,279],{"class":49},[43,332,54],{"class":53},[43,334,335],{"class":57}," Product and catalog data including variants and SKUs\n",[43,337,338,340],{"class":45,"line":140},[43,339,289],{"class":49},[43,341,67],{"class":53},[43,343,344,346,348,350],{"class":45,"line":152},[43,345,296],{"class":53},[43,347,299],{"class":53},[43,349,302],{"class":57},[43,351,305],{"class":53},[43,353,354,356],{"class":45,"line":162},[43,355,310],{"class":49},[43,357,67],{"class":53},[43,359,360,362],{"class":45,"line":170},[43,361,296],{"class":53},[43,363,364],{"class":57}," product\n",[43,366,367,369],{"class":45,"line":182},[43,368,296],{"class":53},[43,370,371],{"class":57}," catalog\n",[43,373,375,378],{"class":45,"line":374},15,[43,376,377],{"class":49},"  sales",[43,379,67],{"class":53},[43,381,383,385,387],{"class":45,"line":382},16,[43,384,279],{"class":49},[43,386,54],{"class":53},[43,388,389],{"class":57}," Orders and order items lifecycle data\n",[43,391,393,395],{"class":45,"line":392},17,[43,394,289],{"class":49},[43,396,67],{"class":53},[43,398,400,402,404,406],{"class":45,"line":399},18,[43,401,296],{"class":53},[43,403,299],{"class":53},[43,405,302],{"class":57},[43,407,305],{"class":53},[43,409,411,413],{"class":45,"line":410},19,[43,412,310],{"class":49},[43,414,67],{"class":53},[43,416,418,420],{"class":45,"line":417},20,[43,419,296],{"class":53},[43,421,422],{"class":57}," sales\n",[43,424,426],{"class":45,"line":425},21,[43,427,244],{"emptyLinePlaceholder":243},[43,429,431,434],{"class":45,"line":430},22,[43,432,433],{"class":49},"entities",[43,435,67],{"class":53},[43,437,439,442],{"class":45,"line":438},23,[43,440,441],{"class":49},"  Base",[43,443,67],{"class":53},[43,445,447,449,451],{"class":45,"line":446},24,[43,448,279],{"class":49},[43,450,54],{"class":53},[43,452,453],{"class":57}," Required fields for every Ingestion/Staging step.\n",[43,455,457,460],{"class":45,"line":456},25,[43,458,459],{"class":49},"    attributes",[43,461,67],{"class":53},[43,463,465,468],{"class":45,"line":464},26,[43,466,467],{"class":49},"      ID",[43,469,67],{"class":53},[43,471,473,476,478],{"class":45,"line":472},27,[43,474,475],{"class":49},"        name",[43,477,54],{"class":53},[43,479,480],{"class":57}," id\n",[43,482,484,487,489],{"class":45,"line":483},28,[43,485,486],{"class":49},"        type",[43,488,54],{"class":53},[43,490,491],{"class":57}," integer\n",[43,493,495,498,500],{"class":45,"line":494},29,[43,496,497],{"class":49},"        primary_key",[43,499,54],{"class":53},[43,501,503],{"class":502},"sfNiH"," true\n",[43,505,507,510,512],{"class":45,"line":506},30,[43,508,509],{"class":49},"        description",[43,511,54],{"class":53},[43,513,514],{"class":57}," The unique identifier in our systems.\n",[43,516,518,521],{"class":45,"line":517},31,[43,519,520],{"class":49},"        checks",[43,522,67],{"class":53},[43,524,526,529,531,533],{"class":45,"line":525},32,[43,527,528],{"class":53},"          -",[43,530,100],{"class":49},[43,532,54],{"class":53},[43,534,535],{"class":57}," not_null\n",[43,537,539,541,543,545],{"class":45,"line":538},33,[43,540,528],{"class":53},[43,542,100],{"class":49},[43,544,54],{"class":53},[43,546,547],{"class":57}," unique\n",[43,549,551,554],{"class":45,"line":550},34,[43,552,553],{"class":49},"      CreatedAt",[43,555,67],{"class":53},[43,557,559,561,563],{"class":45,"line":558},35,[43,560,475],{"class":49},[43,562,54],{"class":53},[43,564,565],{"class":57}," created_at\n",[43,567,569,571,573],{"class":45,"line":568},36,[43,570,486],{"class":49},[43,572,54],{"class":53},[43,574,575],{"class":57}," timestamp\n",[43,577,579,581,583],{"class":45,"line":578},37,[43,580,509],{"class":49},[43,582,54],{"class":53},[43,584,585],{"class":57}," Timestamp when the record was created.\n",[43,587,589,591],{"class":45,"line":588},38,[43,590,520],{"class":49},[43,592,67],{"class":53},[43,594,596,598,600,602],{"class":45,"line":595},39,[43,597,528],{"class":53},[43,599,100],{"class":49},[43,601,54],{"class":53},[43,603,535],{"class":57},[43,605,607,610],{"class":45,"line":606},40,[43,608,609],{"class":49},"      UpdatedAt",[43,611,67],{"class":53},[43,613,615,617,619],{"class":45,"line":614},41,[43,616,475],{"class":49},[43,618,54],{"class":53},[43,620,621],{"class":57}," updated_at\n",[43,623,625,627,629],{"class":45,"line":624},42,[43,626,486],{"class":49},[43,628,54],{"class":53},[43,630,575],{"class":57},[43,632,634,636,638],{"class":45,"line":633},43,[43,635,509],{"class":49},[43,637,54],{"class":53},[43,639,640],{"class":57}," Timestamp when the record was last updated.\n",[43,642,644,646],{"class":45,"line":643},44,[43,645,520],{"class":49},[43,647,67],{"class":53},[43,649,651,653,655,657],{"class":45,"line":650},45,[43,652,528],{"class":53},[43,654,100],{"class":49},[43,656,54],{"class":53},[43,658,535],{"class":57},[43,660,662,665],{"class":45,"line":661},46,[43,663,664],{"class":49},"  Customer",[43,666,67],{"class":53},[43,668,670,672,674],{"class":45,"line":669},47,[43,671,279],{"class":49},[43,673,54],{"class":53},[43,675,676],{"class":57}," Customer is an individual/business registered on our platform.\n",[43,678,680,683],{"class":45,"line":679},48,[43,681,682],{"class":49},"    domains",[43,684,67],{"class":53},[43,686,688,690],{"class":45,"line":687},49,[43,689,296],{"class":53},[43,691,692],{"class":57}," customer-management\n",[43,694,696,698],{"class":45,"line":695},50,[43,697,459],{"class":49},[43,699,67],{"class":53},[43,701,703,705],{"class":45,"line":702},51,[43,704,467],{"class":49},[43,706,67],{"class":53},[43,708,710,712,714],{"class":45,"line":709},52,[43,711,475],{"class":49},[43,713,54],{"class":53},[43,715,716],{"class":57}," customer_id\n",[43,718,720,722,724],{"class":45,"line":719},53,[43,721,486],{"class":49},[43,723,54],{"class":53},[43,725,491],{"class":57},[43,727,729,731],{"class":45,"line":728},54,[43,730,520],{"class":49},[43,732,67],{"class":53},[43,734,736,738,740,742],{"class":45,"line":735},55,[43,737,528],{"class":53},[43,739,100],{"class":49},[43,741,54],{"class":53},[43,743,535],{"class":57},[43,745,747,749,751,753],{"class":45,"line":746},56,[43,748,528],{"class":53},[43,750,100],{"class":49},[43,752,54],{"class":53},[43,754,547],{"class":57},[43,756,758,761],{"class":45,"line":757},57,[43,759,760],{"class":49},"      Email",[43,762,67],{"class":53},[43,764,766,768,770],{"class":45,"line":765},58,[43,767,475],{"class":49},[43,769,54],{"class":53},[43,771,772],{"class":57}," email\n",[43,774,776,778,780],{"class":45,"line":775},59,[43,777,486],{"class":49},[43,779,54],{"class":53},[43,781,782],{"class":57}," string\n",[43,784,786,788],{"class":45,"line":785},60,[43,787,520],{"class":49},[43,789,67],{"class":53},[43,791,793,795,797,799],{"class":45,"line":792},61,[43,794,528],{"class":53},[43,796,100],{"class":49},[43,798,54],{"class":53},[43,800,535],{"class":57},[43,802,804,807],{"class":45,"line":803},62,[43,805,806],{"class":49},"      FullName",[43,808,67],{"class":53},[43,810,812,814,816],{"class":45,"line":811},63,[43,813,475],{"class":49},[43,815,54],{"class":53},[43,817,818],{"class":57}," full_name\n",[43,820,822,824,826],{"class":45,"line":821},64,[43,823,486],{"class":49},[43,825,54],{"class":53},[43,827,782],{"class":57},[43,829,831,834],{"class":45,"line":830},65,[43,832,833],{"class":49},"      Country",[43,835,67],{"class":53},[43,837,839,841,843],{"class":45,"line":838},66,[43,840,475],{"class":49},[43,842,54],{"class":53},[43,844,845],{"class":57}," country\n",[43,847,849,851,853],{"class":45,"line":848},67,[43,850,486],{"class":49},[43,852,54],{"class":53},[43,854,782],{"class":57},[43,856,858,861],{"class":45,"line":857},68,[43,859,860],{"class":49},"      Age",[43,862,67],{"class":53},[43,864,866,868,870],{"class":45,"line":865},69,[43,867,475],{"class":49},[43,869,54],{"class":53},[43,871,872],{"class":57}," age\n",[43,874,876,878,880],{"class":45,"line":875},70,[43,877,486],{"class":49},[43,879,54],{"class":53},[43,881,491],{"class":57},[43,883,885,887],{"class":45,"line":884},71,[43,886,520],{"class":49},[43,888,67],{"class":53},[43,890,892,894,896,898],{"class":45,"line":891},72,[43,893,528],{"class":53},[43,895,100],{"class":49},[43,897,54],{"class":53},[43,899,900],{"class":57}," range\n",[43,902,904,907,909],{"class":45,"line":903},73,[43,905,906],{"class":49},"            min",[43,908,54],{"class":53},[43,910,911],{"class":148}," 0\n",[33,913,916],{"className":35,"code":914,"filename":915,"language":37,"meta":38,"style":38},"name: orders_performance\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\nvariables:\n  all_time:\n    type: int\n    default: 1 # 0 for all time - 1 to enable start_date and end_date\n","orders-performance/pipeline.yml",[40,917,918,928,932,939,953,967,971,978,985,995],{"__ignoreMap":38},[43,919,920,923,925],{"class":45,"line":46},[43,921,922],{"class":49},"name",[43,924,54],{"class":53},[43,926,927],{"class":57}," orders_performance\n",[43,929,930],{"class":45,"line":61},[43,931,244],{"emptyLinePlaceholder":243},[43,933,934,937],{"class":45,"line":70},[43,935,936],{"class":49},"default_connections",[43,938,67],{"class":53},[43,940,941,944,946,948,951],{"class":45,"line":78},[43,942,943],{"class":49},"  duckdb",[43,945,54],{"class":53},[43,947,299],{"class":53},[43,949,950],{"class":57},"duckdb-default",[43,952,305],{"class":53},[43,954,955,958,960,962,965],{"class":45,"line":86},[43,956,957],{"class":49},"  postgres",[43,959,54],{"class":53},[43,961,299],{"class":53},[43,963,964],{"class":57},"pg-default",[43,966,305],{"class":53},[43,968,969],{"class":45,"line":94},[43,970,244],{"emptyLinePlaceholder":243},[43,972,973,976],{"class":45,"line":108},[43,974,975],{"class":49},"variables",[43,977,67],{"class":53},[43,979,980,983],{"class":45,"line":119},[43,981,982],{"class":49},"  all_time",[43,984,67],{"class":53},[43,986,987,990,992],{"class":45,"line":129},[43,988,989],{"class":49},"    type",[43,991,54],{"class":53},[43,993,994],{"class":57}," int\n",[43,996,997,999,1001,1004],{"class":45,"line":140},[43,998,73],{"class":49},[43,1000,54],{"class":53},[43,1002,1003],{"class":148}," 1",[43,1005,1007],{"class":1006},"sHwdD"," # 0 for all time - 1 to enable start_date and end_date\n",[33,1009,1012],{"className":35,"code":1010,"filename":1011,"language":37,"meta":38,"style":38},"name: raw.customers\ntype: ingestr\n\ndescription: Ingest OLTP customers from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.customers\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.customers.asset.yml",[40,1013,1014,1023,1033,1037,1047,1051,1058,1066,1070,1077,1086,1100],{"__ignoreMap":38},[43,1015,1016,1018,1020],{"class":45,"line":46},[43,1017,922],{"class":49},[43,1019,54],{"class":53},[43,1021,1022],{"class":57}," raw.customers\n",[43,1024,1025,1028,1030],{"class":45,"line":61},[43,1026,1027],{"class":49},"type",[43,1029,54],{"class":53},[43,1031,1032],{"class":57}," ingestr\n",[43,1034,1035],{"class":45,"line":70},[43,1036,244],{"emptyLinePlaceholder":243},[43,1038,1039,1042,1044],{"class":45,"line":78},[43,1040,1041],{"class":49},"description",[43,1043,54],{"class":53},[43,1045,1046],{"class":57}," Ingest OLTP customers from Postgres into DuckDB raw layer.\n",[43,1048,1049],{"class":45,"line":86},[43,1050,244],{"emptyLinePlaceholder":243},[43,1052,1053,1056],{"class":45,"line":94},[43,1054,1055],{"class":49},"tags",[43,1057,67],{"class":53},[43,1059,1060,1063],{"class":45,"line":108},[43,1061,1062],{"class":53},"  -",[43,1064,1065],{"class":57}," raw\n",[43,1067,1068],{"class":45,"line":119},[43,1069,244],{"emptyLinePlaceholder":243},[43,1071,1072,1075],{"class":45,"line":129},[43,1073,1074],{"class":49},"parameters",[43,1076,67],{"class":53},[43,1078,1079,1082,1084],{"class":45,"line":140},[43,1080,1081],{"class":49},"  source_connection",[43,1083,54],{"class":53},[43,1085,105],{"class":57},[43,1087,1088,1091,1093,1095,1098],{"class":45,"line":152},[43,1089,1090],{"class":49},"  source_table",[43,1092,54],{"class":53},[43,1094,299],{"class":53},[43,1096,1097],{"class":57},"public.customers",[43,1099,305],{"class":53},[43,1101,1102,1105,1107],{"class":45,"line":162},[43,1103,1104],{"class":49},"  destination",[43,1106,54],{"class":53},[43,1108,1109],{"class":57}," duckdb\n",[33,1111,1114],{"className":35,"code":1112,"filename":1113,"language":37,"meta":38,"style":38},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n","orders-performance/assets/ingestion/raw.orders.asset.yml",[40,1115,1116,1125,1133,1142,1146,1152,1158,1162,1168,1176,1184],{"__ignoreMap":38},[43,1117,1118,1120,1122],{"class":45,"line":46},[43,1119,922],{"class":49},[43,1121,54],{"class":53},[43,1123,1124],{"class":57}," raw.orders\n",[43,1126,1127,1129,1131],{"class":45,"line":61},[43,1128,1027],{"class":49},[43,1130,54],{"class":53},[43,1132,1032],{"class":57},[43,1134,1135,1137,1139],{"class":45,"line":70},[43,1136,1041],{"class":49},[43,1138,54],{"class":53},[43,1140,1141],{"class":57}," Ingest OLTP orders from Postgres into DuckDB raw layer.\n",[43,1143,1144],{"class":45,"line":78},[43,1145,244],{"emptyLinePlaceholder":243},[43,1147,1148,1150],{"class":45,"line":86},[43,1149,1055],{"class":49},[43,1151,67],{"class":53},[43,1153,1154,1156],{"class":45,"line":94},[43,1155,1062],{"class":53},[43,1157,1065],{"class":57},[43,1159,1160],{"class":45,"line":108},[43,1161,244],{"emptyLinePlaceholder":243},[43,1163,1164,1166],{"class":45,"line":119},[43,1165,1074],{"class":49},[43,1167,67],{"class":53},[43,1169,1170,1172,1174],{"class":45,"line":129},[43,1171,1104],{"class":49},[43,1173,54],{"class":53},[43,1175,1109],{"class":57},[43,1177,1178,1180,1182],{"class":45,"line":140},[43,1179,1081],{"class":49},[43,1181,54],{"class":53},[43,1183,105],{"class":57},[43,1185,1186,1188,1190],{"class":45,"line":152},[43,1187,1090],{"class":49},[43,1189,54],{"class":53},[43,1191,1192],{"class":57}," public.orders\n",[33,1194,1199],{"className":1195,"code":1196,"filename":1197,"language":1198,"meta":38,"style":38},"language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","/* @bruin\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n@bruin */\n\nWITH src AS (\n  SELECT CASE\n            WHEN age \u003C 25 THEN '18-24'\n            WHEN age BETWEEN 25 AND 34 THEN '25-34'\n            WHEN age BETWEEN 35 AND 49 THEN '35-49'\n            ELSE '50+'\n         END AS age_group\n  FROM stg.customers\n)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","orders-performance/assets/mart/customers/mart.customers_by_age.asset.sql","sql",[40,1200,1201,1206,1211,1216,1221,1226,1231,1236,1241,1246,1251,1256,1261,1266,1270,1285,1293,1319,1345,1370,1382,1393,1401,1406,1414,1434,1442,1449],{"__ignoreMap":38},[43,1202,1203],{"class":45,"line":46},[43,1204,1205],{"class":1006},"/* @bruin\n",[43,1207,1208],{"class":45,"line":61},[43,1209,1210],{"class":1006},"name: mart.customers_by_age\n",[43,1212,1213],{"class":45,"line":70},[43,1214,1215],{"class":1006},"type: duckdb.sql\n",[43,1217,1218],{"class":45,"line":78},[43,1219,1220],{"class":1006},"tags:\n",[43,1222,1223],{"class":45,"line":86},[43,1224,1225],{"class":1006},"  - mart\n",[43,1227,1228],{"class":45,"line":94},[43,1229,1230],{"class":1006},"  - amazing-tag\n",[43,1232,1233],{"class":45,"line":108},[43,1234,1235],{"class":1006},"materialization:\n",[43,1237,1238],{"class":45,"line":119},[43,1239,1240],{"class":1006},"  type: table\n",[43,1242,1243],{"class":45,"line":129},[43,1244,1245],{"class":1006},"  strategy: create+replace\n",[43,1247,1248],{"class":45,"line":140},[43,1249,1250],{"class":1006},"depends:\n",[43,1252,1253],{"class":45,"line":152},[43,1254,1255],{"class":1006},"  - stg.customers\n",[43,1257,1258],{"class":45,"line":162},[43,1259,1260],{"class":1006},"owner: danielhe4rt@gmail.com\n",[43,1262,1263],{"class":45,"line":170},[43,1264,1265],{"class":1006},"@bruin */\n",[43,1267,1268],{"class":45,"line":182},[43,1269,244],{"emptyLinePlaceholder":243},[43,1271,1272,1275,1279,1282],{"class":45,"line":374},[43,1273,1274],{"class":148},"WITH",[43,1276,1278],{"class":1277},"sTEyZ"," src ",[43,1280,1281],{"class":148},"AS",[43,1283,1284],{"class":1277}," (\n",[43,1286,1287,1290],{"class":45,"line":382},[43,1288,1289],{"class":148},"  SELECT",[43,1291,1292],{"class":148}," CASE\n",[43,1294,1295,1298,1301,1304,1307,1310,1313,1316],{"class":45,"line":392},[43,1296,1297],{"class":148},"            WHEN",[43,1299,1300],{"class":1277}," age ",[43,1302,1303],{"class":53},"\u003C",[43,1305,1306],{"class":148}," 25",[43,1308,1309],{"class":148}," THEN",[43,1311,1312],{"class":53}," '",[43,1314,1315],{"class":57},"18-24",[43,1317,1318],{"class":53},"'\n",[43,1320,1321,1323,1325,1328,1330,1333,1336,1338,1340,1343],{"class":45,"line":399},[43,1322,1297],{"class":148},[43,1324,1300],{"class":1277},[43,1326,1327],{"class":148},"BETWEEN",[43,1329,1306],{"class":148},[43,1331,1332],{"class":148}," AND",[43,1334,1335],{"class":148}," 34",[43,1337,1309],{"class":148},[43,1339,1312],{"class":53},[43,1341,1342],{"class":57},"25-34",[43,1344,1318],{"class":53},[43,1346,1347,1349,1351,1353,1356,1358,1361,1363,1365,1368],{"class":45,"line":410},[43,1348,1297],{"class":148},[43,1350,1300],{"class":1277},[43,1352,1327],{"class":148},[43,1354,1355],{"class":148}," 35",[43,1357,1332],{"class":148},[43,1359,1360],{"class":148}," 49",[43,1362,1309],{"class":148},[43,1364,1312],{"class":53},[43,1366,1367],{"class":57},"35-49",[43,1369,1318],{"class":53},[43,1371,1372,1375,1377,1380],{"class":45,"line":417},[43,1373,1374],{"class":148},"            ELSE",[43,1376,1312],{"class":53},[43,1378,1379],{"class":57},"50+",[43,1381,1318],{"class":53},[43,1383,1384,1387,1390],{"class":45,"line":425},[43,1385,1386],{"class":148},"         END",[43,1388,1389],{"class":148}," AS",[43,1391,1392],{"class":1277}," age_group\n",[43,1394,1395,1398],{"class":45,"line":430},[43,1396,1397],{"class":148},"  FROM",[43,1399,1400],{"class":1277}," stg.customers\n",[43,1402,1403],{"class":45,"line":438},[43,1404,1405],{"class":1277},")\n",[43,1407,1408,1411],{"class":45,"line":446},[43,1409,1410],{"class":148},"SELECT",[43,1412,1413],{"class":1277}," age_group,\n",[43,1415,1416,1420,1423,1426,1429,1431],{"class":45,"line":456},[43,1417,1419],{"class":1418},"s2Zo4","       COUNT",[43,1421,1422],{"class":1277},"(",[43,1424,1425],{"class":53},"*",[43,1427,1428],{"class":1277},") ",[43,1430,1281],{"class":148},[43,1432,1433],{"class":1277}," total_customers\n",[43,1435,1436,1439],{"class":45,"line":464},[43,1437,1438],{"class":148},"FROM",[43,1440,1441],{"class":1277}," src\n",[43,1443,1444,1447],{"class":45,"line":472},[43,1445,1446],{"class":148},"GROUP BY",[43,1448,1392],{"class":1277},[43,1450,1451,1454,1457,1460],{"class":45,"line":483},[43,1452,1453],{"class":148},"ORDER BY",[43,1455,1456],{"class":1277}," total_customers ",[43,1458,1459],{"class":148},"DESC",[43,1461,1462],{"class":1277},";\n",[33,1464,1467],{"className":1195,"code":1465,"filename":1466,"language":1198,"meta":38,"style":38},"/* @bruin\nname: mart.product_performance\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n),\nitems_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","orders-performance/assets/mart/products/mart.product_performance.asset.sql",[40,1468,1469,1473,1478,1482,1486,1490,1494,1498,1503,1508,1513,1518,1522,1526,1537,1547,1554,1574,1608,1613,1622,1627,1632,1637,1642,1649,1666,1670,1675,1680,1690,1695,1708,1720,1764,1771,1789,1805],{"__ignoreMap":38},[43,1470,1471],{"class":45,"line":46},[43,1472,1205],{"class":1006},[43,1474,1475],{"class":45,"line":61},[43,1476,1477],{"class":1006},"name: mart.product_performance\n",[43,1479,1480],{"class":45,"line":70},[43,1481,1215],{"class":1006},[43,1483,1484],{"class":45,"line":78},[43,1485,1235],{"class":1006},[43,1487,1488],{"class":45,"line":86},[43,1489,1240],{"class":1006},[43,1491,1492],{"class":45,"line":94},[43,1493,1245],{"class":1006},[43,1495,1496],{"class":45,"line":108},[43,1497,1250],{"class":1006},[43,1499,1500],{"class":45,"line":119},[43,1501,1502],{"class":1006},"  - stg.products\n",[43,1504,1505],{"class":45,"line":129},[43,1506,1507],{"class":1006},"  - stg.product_variants\n",[43,1509,1510],{"class":45,"line":140},[43,1511,1512],{"class":1006},"  - stg.order_items\n",[43,1514,1515],{"class":45,"line":152},[43,1516,1517],{"class":1006},"  - stg.orders\n",[43,1519,1520],{"class":45,"line":162},[43,1521,1265],{"class":1006},[43,1523,1524],{"class":45,"line":170},[43,1525,244],{"emptyLinePlaceholder":243},[43,1527,1528,1530,1533,1535],{"class":45,"line":182},[43,1529,1274],{"class":148},[43,1531,1532],{"class":1277}," paid_items ",[43,1534,1281],{"class":148},[43,1536,1284],{"class":1277},[43,1538,1539,1541,1544],{"class":45,"line":374},[43,1540,1289],{"class":148},[43,1542,1543],{"class":1277}," oi.",[43,1545,1546],{"class":53},"*\n",[43,1548,1549,1551],{"class":45,"line":382},[43,1550,1397],{"class":148},[43,1552,1553],{"class":1277}," stg.order_items oi\n",[43,1555,1556,1559,1562,1565,1568,1571],{"class":45,"line":392},[43,1557,1558],{"class":148},"  JOIN",[43,1560,1561],{"class":1277}," stg.orders o ",[43,1563,1564],{"class":148},"ON",[43,1566,1567],{"class":1277}," o.order_id ",[43,1569,1570],{"class":53},"=",[43,1572,1573],{"class":1277}," oi.order_id\n",[43,1575,1576,1579,1582,1585,1588,1591,1594,1596,1599,1601,1604,1606],{"class":45,"line":399},[43,1577,1578],{"class":148},"  WHERE",[43,1580,1581],{"class":1277}," o.status ",[43,1583,1584],{"class":148},"IN",[43,1586,1587],{"class":1277}," (",[43,1589,1590],{"class":53},"'",[43,1592,1593],{"class":57},"paid",[43,1595,1590],{"class":53},[43,1597,1598],{"class":1277},",",[43,1600,1590],{"class":53},[43,1602,1603],{"class":57},"shipped",[43,1605,1590],{"class":53},[43,1607,1405],{"class":1277},[43,1609,1610],{"class":45,"line":410},[43,1611,1612],{"class":1277},"),\n",[43,1614,1615,1618,1620],{"class":45,"line":417},[43,1616,1617],{"class":1277},"items_with_product ",[43,1619,1281],{"class":148},[43,1621,1284],{"class":1277},[43,1623,1624],{"class":45,"line":425},[43,1625,1626],{"class":148},"  SELECT\n",[43,1628,1629],{"class":45,"line":430},[43,1630,1631],{"class":1277},"    v.product_id,\n",[43,1633,1634],{"class":45,"line":438},[43,1635,1636],{"class":1277},"    oi.quantity,\n",[43,1638,1639],{"class":45,"line":446},[43,1640,1641],{"class":1277},"    oi.total_price\n",[43,1643,1644,1646],{"class":45,"line":456},[43,1645,1397],{"class":148},[43,1647,1648],{"class":1277}," paid_items oi\n",[43,1650,1651,1653,1656,1658,1661,1663],{"class":45,"line":464},[43,1652,1558],{"class":148},[43,1654,1655],{"class":1277}," stg.product_variants v ",[43,1657,1564],{"class":148},[43,1659,1660],{"class":1277}," v.variant_id ",[43,1662,1570],{"class":53},[43,1664,1665],{"class":1277}," oi.variant_id\n",[43,1667,1668],{"class":45,"line":472},[43,1669,1405],{"class":1277},[43,1671,1672],{"class":45,"line":483},[43,1673,1674],{"class":148},"SELECT\n",[43,1676,1677],{"class":45,"line":494},[43,1678,1679],{"class":1277},"  p.product_id,\n",[43,1681,1682,1685,1687],{"class":45,"line":506},[43,1683,1684],{"class":1277},"  p.name ",[43,1686,1281],{"class":148},[43,1688,1689],{"class":1277}," product_name,\n",[43,1691,1692],{"class":45,"line":517},[43,1693,1694],{"class":1277},"  p.category,\n",[43,1696,1697,1700,1703,1705],{"class":45,"line":525},[43,1698,1699],{"class":1418},"  SUM",[43,1701,1702],{"class":1277},"(i.quantity) ",[43,1704,1281],{"class":148},[43,1706,1707],{"class":1277}," items_sold,\n",[43,1709,1710,1712,1715,1717],{"class":45,"line":538},[43,1711,1699],{"class":1418},[43,1713,1714],{"class":1277},"(i.total_price) ",[43,1716,1281],{"class":148},[43,1718,1719],{"class":1277}," gross_revenue,\n",[43,1721,1722,1725,1728,1731,1733,1735,1738,1740,1742,1745,1747,1749,1752,1754,1756,1759,1761],{"class":45,"line":550},[43,1723,1724],{"class":148},"  CASE",[43,1726,1727],{"class":148}," WHEN",[43,1729,1730],{"class":1418}," SUM",[43,1732,1702],{"class":1277},[43,1734,1570],{"class":53},[43,1736,1737],{"class":148}," 0",[43,1739,1309],{"class":148},[43,1741,1737],{"class":148},[43,1743,1744],{"class":148}," ELSE",[43,1746,1730],{"class":1418},[43,1748,1714],{"class":1277},[43,1750,1751],{"class":53},"/",[43,1753,1730],{"class":1418},[43,1755,1702],{"class":1277},[43,1757,1758],{"class":148},"END",[43,1760,1389],{"class":148},[43,1762,1763],{"class":1277}," avg_item_price\n",[43,1765,1766,1768],{"class":45,"line":558},[43,1767,1438],{"class":148},[43,1769,1770],{"class":1277}," items_with_product i\n",[43,1772,1773,1776,1779,1781,1784,1786],{"class":45,"line":568},[43,1774,1775],{"class":148},"JOIN",[43,1777,1778],{"class":1277}," stg.products p ",[43,1780,1564],{"class":148},[43,1782,1783],{"class":1277}," p.product_id ",[43,1785,1570],{"class":53},[43,1787,1788],{"class":1277}," i.product_id\n",[43,1790,1791,1793,1795,1797,1800,1802],{"class":45,"line":578},[43,1792,1446],{"class":148},[43,1794,1003],{"class":148},[43,1796,1598],{"class":1277},[43,1798,1799],{"class":148},"2",[43,1801,1598],{"class":1277},[43,1803,1804],{"class":148},"3\n",[43,1806,1807,1809,1812,1814],{"class":45,"line":588},[43,1808,1453],{"class":148},[43,1810,1811],{"class":1277}," gross_revenue ",[43,1813,1459],{"class":148},[43,1815,1462],{"class":1277},[33,1817,1820],{"className":1195,"code":1818,"filename":1819,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\n@bruin */\n\nSELECT\n  id::INT AS customer_id,\n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n","orders-performance/assets/staging/stg.customers.asset.sql",[40,1821,1822,1826,1831,1835,1839,1843,1847,1852,1856,1860,1864,1878,1901,1926,1943,1948,1953,1959],{"__ignoreMap":38},[43,1823,1824],{"class":45,"line":46},[43,1825,1205],{"class":1006},[43,1827,1828],{"class":45,"line":61},[43,1829,1830],{"class":1006},"name: stg.customers\n",[43,1832,1833],{"class":45,"line":70},[43,1834,1215],{"class":1006},[43,1836,1837],{"class":45,"line":78},[43,1838,1235],{"class":1006},[43,1840,1841],{"class":45,"line":86},[43,1842,1240],{"class":1006},[43,1844,1845],{"class":45,"line":94},[43,1846,1250],{"class":1006},[43,1848,1849],{"class":45,"line":108},[43,1850,1851],{"class":1006},"  - raw.customers\n",[43,1853,1854],{"class":45,"line":119},[43,1855,1265],{"class":1006},[43,1857,1858],{"class":45,"line":129},[43,1859,244],{"emptyLinePlaceholder":243},[43,1861,1862],{"class":45,"line":140},[43,1863,1674],{"class":148},[43,1865,1866,1869,1873,1875],{"class":45,"line":152},[43,1867,1868],{"class":1277},"  id::",[43,1870,1872],{"class":1871},"spNyl","INT",[43,1874,1389],{"class":148},[43,1876,1877],{"class":1277}," customer_id,\n",[43,1879,1880,1883,1885,1888,1891,1894,1896,1898],{"class":45,"line":162},[43,1881,1882],{"class":1418},"  COALESCE",[43,1884,1422],{"class":1277},[43,1886,1887],{"class":1418},"TRIM",[43,1889,1890],{"class":1277},"(email), ",[43,1892,1893],{"class":53},"''",[43,1895,1428],{"class":1277},[43,1897,1281],{"class":148},[43,1899,1900],{"class":1277}," email,\n",[43,1902,1903,1905,1907,1909,1912,1914,1917,1919,1921,1923],{"class":45,"line":170},[43,1904,1882],{"class":1418},[43,1906,1422],{"class":1277},[43,1908,1887],{"class":1418},[43,1910,1911],{"class":1277},"(country), ",[43,1913,1590],{"class":53},[43,1915,1916],{"class":57},"Unknown",[43,1918,1590],{"class":53},[43,1920,1428],{"class":1277},[43,1922,1281],{"class":148},[43,1924,1925],{"class":1277}," country,\n",[43,1927,1928,1930,1933,1936,1938,1940],{"class":45,"line":182},[43,1929,1882],{"class":1418},[43,1931,1932],{"class":1277},"(age, ",[43,1934,1935],{"class":148},"0",[43,1937,1428],{"class":1277},[43,1939,1281],{"class":148},[43,1941,1942],{"class":1277}," age,\n",[43,1944,1945],{"class":45,"line":374},[43,1946,1947],{"class":1277},"  created_at,\n",[43,1949,1950],{"class":45,"line":382},[43,1951,1952],{"class":1277},"  updated_at\n",[43,1954,1955,1957],{"class":45,"line":392},[43,1956,1438],{"class":148},[43,1958,1022],{"class":1277},[43,1960,1961,1964,1967,1970],{"class":45,"line":399},[43,1962,1963],{"class":148},"WHERE",[43,1965,1966],{"class":1277}," email ",[43,1968,1969],{"class":148},"IS NOT NULL",[43,1971,1462],{"class":1277},[1973,1974,1976],"h2",{"id":1975},"what-this-hands-on-tutorial-covers",[1977,1978,1979],"strong",{},"What this hands-on tutorial covers",[1981,1982,1985,1995,2002,2009],"card-group",{"className":1983},[1984],"w-full",[1986,1987,1991],"card",{"icon":1988,"target":1989,"title":1990},"i-tabler-database-import","_blank","Ingestion Layer",[1992,1993,1994],"p",{},"Learn how to configure Bruin assets for incremental ingestion from Postgres into DuckDB.",[1986,1996,1999],{"icon":1997,"target":1989,"title":1998},"i-tabler-transform","Transformation Layer",[1992,2000,2001],{},"Explore staging and mart patterns that turn raw e-commerce data into usable analytics.",[1986,2003,2006],{"icon":2004,"target":1989,"title":2005},"i-tabler-shield-check","Quality Checks",[1992,2007,2008],{},"Implement column-level and business logic validations to ensure data integrity.",[1986,2010,2013],{"icon":2011,"target":1989,"title":2012},"i-tabler-chart-bar","Analytics & Insights",[1992,2014,2015],{},"Build daily revenue and customer lifetime value dashboards from validated datasets.",[1992,2017,2018,2019,2022],{},"This tutorial is structured to give you a ",[1977,2020,2021],{},"straightforward, engineering-first path"," to building a production-ready analytics pipeline. It’s about understanding how each component — ingestion, transformation, validation, and analysis — fits together under Bruin’s unified workflow.",[1973,2024,2026],{"id":2025},"_1-prerequisites-setup","1) Prerequisites & Setup",[2028,2029,2030,2034,2037,2049],"ul",{},[2031,2032,2033],"li",{},"Docker (for Postgres)",[2031,2035,2036],{},"Python 3.11+",[2031,2038,2039,2042,2043],{},[40,2040,2041],{},"uv"," (fast Python toolchain manager) → ",[2044,2045,2046],"a",{"href":2046,"rel":2047},"https://docs.astral.sh/uv/",[2048],"nofollow",[2031,2050,2051],{},"Git, Bash",[33,2053,2057],{"className":2054,"code":2055,"language":2056,"meta":38,"style":38},"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","git clone https://github.com/danielhe4rt/bruin-ecommerce-pipeline\ncd bruin-ecommerce-pipeline\n","bash",[40,2058,2059,2071],{"__ignoreMap":38},[43,2060,2061,2065,2068],{"class":45,"line":46},[43,2062,2064],{"class":2063},"sBMFI","git",[43,2066,2067],{"class":57}," clone",[43,2069,2070],{"class":57}," https://github.com/danielhe4rt/bruin-ecommerce-pipeline\n",[43,2072,2073,2076],{"class":45,"line":61},[43,2074,2075],{"class":1418},"cd",[43,2077,2078],{"class":57}," bruin-ecommerce-pipeline\n",[1992,2080,2081],{},"Or use the bruin templates directly from the CLI:",[33,2083,2085],{"className":2054,"code":2084,"language":2056,"meta":38,"style":38},"bruin init ecommerce\n\ncd bruin\n",[40,2086,2087,2098,2102],{"__ignoreMap":38},[43,2088,2089,2092,2095],{"class":45,"line":46},[43,2090,2091],{"class":2063},"bruin",[43,2093,2094],{"class":57}," init",[43,2096,2097],{"class":57}," ecommerce\n",[43,2099,2100],{"class":45,"line":61},[43,2101,244],{"emptyLinePlaceholder":243},[43,2103,2104,2106],{"class":45,"line":70},[43,2105,2075],{"class":1418},[43,2107,2108],{"class":57}," bruin\n",[1992,2110,2111],{},"Then, open the project in your favorite code editor and let's get started!",[1973,2113,2115],{"id":2114},"_2-understanding-the-data-model-oltp-analytics","2) Understanding the Data Model (OLTP → Analytics)",[1992,2117,2118,2119,2122,2123,2126],{},"In e-commerce — and most analytics-driven businesses — data pipelines are typically organized into ",[1977,2120,2121],{},"layers",", each\nserving a specific purpose. This layered structure keeps data ",[1977,2124,2125],{},"reliable, interpretable, and adaptable"," as the business\nscales.",[1992,2128,2129,2130,2133],{},"The ultimate goal is to make data analysis effortless and focused on ",[1977,2131,2132],{},"answering real business questions"," across key\ndomains, such as:",[2135,2136,2137,2150],"table",{},[2138,2139,2140],"thead",{},[2141,2142,2143,2147],"tr",{},[2144,2145,2146],"th",{},"Domain",[2144,2148,2149],{},"Analysis Focus",[2151,2152,2153,2164,2174,2184],"tbody",{},[2141,2154,2155,2161],{},[2156,2157,2158],"td",{},[1977,2159,2160],{},"Customers",[2156,2162,2163],{},"Segmentation by age, geography, and behavior patterns",[2141,2165,2166,2171],{},[2156,2167,2168],{},[1977,2169,2170],{},"Products and Product Variants",[2156,2172,2173],{},"Performance by category, profitability, and pricing insights",[2141,2175,2176,2181],{},[2156,2177,2178],{},[1977,2179,2180],{},"Orders and Order Items",[2156,2182,2183],{},"Daily revenue, order volume, and purchasing trends",[2141,2185,2186,2191],{},[2156,2187,2188],{},[1977,2189,2190],{},"KPI layer",[2156,2192,2193,2194,2197,2198,2197,2201,2204,2205],{},"Metrics like ",[1977,2195,2196],{},"AOV",", ",[1977,2199,2200],{},"units per order",[1977,2202,2203],{},"top SKUs",", and ",[1977,2206,2207],{},"repeat purchase rate",[1992,2209,2210],{},"By structuring data this way, teams can move from raw information to actionable insights with clarity and confidence.",[1992,2212,2213],{},"At this tutorial, it's important to understand the data relationships that form the backbone of most e-commerce\nsystems. These relationships define how information flows across entities — from customers placing orders to\nproducts being sold and analyzed.",[1992,2215,2216],{},"Here’s the simplified schema we’ll use throughout this tutorial:",[2135,2218,2219,2232],{},[2138,2220,2221],{},[2141,2222,2223,2226,2229],{},[2144,2224,2225],{},"From",[2144,2227,2228],{},"To",[2144,2230,2231],{},"Relationship Type",[2151,2233,2234,2245,2255,2265],{},[2141,2235,2236,2239,2242],{},[2156,2237,2238],{},"customers(id)",[2156,2240,2241],{},"orders(customer_id)",[2156,2243,2244],{},"1:N (One-to-Many)",[2141,2246,2247,2250,2253],{},[2156,2248,2249],{},"orders(id)",[2156,2251,2252],{},"order_items(order_id)",[2156,2254,2244],{},[2141,2256,2257,2260,2263],{},[2156,2258,2259],{},"products(id)",[2156,2261,2262],{},"product_variants(product_id)",[2156,2264,2244],{},[2141,2266,2267,2270,2273],{},[2156,2268,2269],{},"product_variants(id)",[2156,2271,2272],{},"order_items(variant_id)",[2156,2274,2244],{},[29,2276,2278,2422,2523,2719,2848],{"default-value":2277},"customers.sql",[33,2279,2281],{"className":1195,"code":2280,"filename":2277,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS customers (\n    id          BIGSERIAL PRIMARY KEY,\n    full_name   TEXT        NOT NULL,\n    email       TEXT        NOT NULL UNIQUE,\n    country     TEXT        NOT NULL,\n    age         INTEGER     NOT NULL CHECK (age >= 0),\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n",[40,2282,2283,2303,2317,2330,2344,2355,2379,2401,2417],{"__ignoreMap":38},[43,2284,2285,2288,2291,2294,2297,2300],{"class":45,"line":46},[43,2286,2287],{"class":148},"CREATE",[43,2289,2290],{"class":148}," TABLE",[43,2292,2293],{"class":1418}," IF",[43,2295,2296],{"class":148}," NOT",[43,2298,2299],{"class":148}," EXISTS",[43,2301,2302],{"class":1277}," customers (\n",[43,2304,2305,2308,2311,2314],{"class":45,"line":61},[43,2306,2307],{"class":1277},"    id          ",[43,2309,2310],{"class":1871},"BIGSERIAL",[43,2312,2313],{"class":1871}," PRIMARY KEY",[43,2315,2316],{"class":1277},",\n",[43,2318,2319,2322,2325,2328],{"class":45,"line":70},[43,2320,2321],{"class":1277},"    full_name   ",[43,2323,2324],{"class":1871},"TEXT",[43,2326,2327],{"class":148},"        NOT NULL",[43,2329,2316],{"class":1277},[43,2331,2332,2335,2337,2339,2342],{"class":45,"line":78},[43,2333,2334],{"class":1277},"    email       ",[43,2336,2324],{"class":1871},[43,2338,2327],{"class":148},[43,2340,2341],{"class":148}," UNIQUE",[43,2343,2316],{"class":1277},[43,2345,2346,2349,2351,2353],{"class":45,"line":86},[43,2347,2348],{"class":1277},"    country     ",[43,2350,2324],{"class":1871},[43,2352,2327],{"class":148},[43,2354,2316],{"class":1277},[43,2356,2357,2360,2363,2366,2369,2372,2375,2377],{"class":45,"line":94},[43,2358,2359],{"class":1277},"    age         ",[43,2361,2362],{"class":1871},"INTEGER",[43,2364,2365],{"class":148},"     NOT NULL",[43,2367,2368],{"class":1871}," CHECK",[43,2370,2371],{"class":1277}," (age ",[43,2373,2374],{"class":53},">=",[43,2376,1737],{"class":148},[43,2378,1612],{"class":1277},[43,2380,2381,2384,2387,2390,2393,2396,2399],{"class":45,"line":108},[43,2382,2383],{"class":1277},"    created_at  ",[43,2385,2386],{"class":1871},"TIMESTAMPTZ",[43,2388,2389],{"class":148}," NOT NULL",[43,2391,2392],{"class":1871}," DEFAULT",[43,2394,2395],{"class":148}," now",[43,2397,2398],{"class":53},"()",[43,2400,2316],{"class":1277},[43,2402,2403,2406,2408,2410,2412,2414],{"class":45,"line":119},[43,2404,2405],{"class":1277},"    updated_at  ",[43,2407,2386],{"class":1871},[43,2409,2389],{"class":148},[43,2411,2392],{"class":1871},[43,2413,2395],{"class":148},[43,2415,2416],{"class":53},"()\n",[43,2418,2419],{"class":45,"line":129},[43,2420,2421],{"class":1277},");\n",[33,2423,2426],{"className":1195,"code":2424,"filename":2425,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS products (\n    id          BIGSERIAL PRIMARY KEY,\n    name        TEXT        NOT NULL,\n    category    TEXT        NOT NULL,\n    sku         TEXT        NOT NULL UNIQUE,\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","products.sql",[40,2427,2428,2443,2453,2465,2476,2489,2505,2519],{"__ignoreMap":38},[43,2429,2430,2432,2434,2436,2438,2440],{"class":45,"line":46},[43,2431,2287],{"class":148},[43,2433,2290],{"class":148},[43,2435,2293],{"class":1418},[43,2437,2296],{"class":148},[43,2439,2299],{"class":148},[43,2441,2442],{"class":1277}," products (\n",[43,2444,2445,2447,2449,2451],{"class":45,"line":61},[43,2446,2307],{"class":1277},[43,2448,2310],{"class":1871},[43,2450,2313],{"class":1871},[43,2452,2316],{"class":1277},[43,2454,2455,2458,2461,2463],{"class":45,"line":70},[43,2456,2457],{"class":148},"    name",[43,2459,2460],{"class":1871},"        TEXT",[43,2462,2327],{"class":148},[43,2464,2316],{"class":1277},[43,2466,2467,2470,2472,2474],{"class":45,"line":78},[43,2468,2469],{"class":1277},"    category    ",[43,2471,2324],{"class":1871},[43,2473,2327],{"class":148},[43,2475,2316],{"class":1277},[43,2477,2478,2481,2483,2485,2487],{"class":45,"line":86},[43,2479,2480],{"class":1277},"    sku         ",[43,2482,2324],{"class":1871},[43,2484,2327],{"class":148},[43,2486,2341],{"class":148},[43,2488,2316],{"class":1277},[43,2490,2491,2493,2495,2497,2499,2501,2503],{"class":45,"line":94},[43,2492,2383],{"class":1277},[43,2494,2386],{"class":1871},[43,2496,2389],{"class":148},[43,2498,2392],{"class":1871},[43,2500,2395],{"class":148},[43,2502,2398],{"class":53},[43,2504,2316],{"class":1277},[43,2506,2507,2509,2511,2513,2515,2517],{"class":45,"line":108},[43,2508,2405],{"class":1277},[43,2510,2386],{"class":1871},[43,2512,2389],{"class":148},[43,2514,2392],{"class":1871},[43,2516,2395],{"class":148},[43,2518,2416],{"class":53},[43,2520,2521],{"class":45,"line":119},[43,2522,2421],{"class":1277},[33,2524,2527],{"className":1195,"code":2525,"filename":2526,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS product_variants (\n    id                  BIGSERIAL PRIMARY KEY,\n    product_id          BIGINT         NOT NULL REFERENCES products(id) ON DELETE CASCADE,\n    variant_sku         TEXT           NOT NULL UNIQUE,\n    color               TEXT,\n    size                TEXT,\n    manufacturing_price NUMERIC(10,2)  NOT NULL,\n    selling_price       NUMERIC(10,2)  NOT NULL,\n    stock_quantity      INTEGER        NOT NULL,\n    is_active           BOOLEAN        NOT NULL DEFAULT TRUE,\n    created_at          TIMESTAMPTZ    NOT NULL DEFAULT now(),\n    updated_at          TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","product_variants.sql",[40,2528,2529,2544,2555,2577,2591,2600,2610,2635,2656,2667,2682,2700,2715],{"__ignoreMap":38},[43,2530,2531,2533,2535,2537,2539,2541],{"class":45,"line":46},[43,2532,2287],{"class":148},[43,2534,2290],{"class":148},[43,2536,2293],{"class":1418},[43,2538,2296],{"class":148},[43,2540,2299],{"class":148},[43,2542,2543],{"class":1277}," product_variants (\n",[43,2545,2546,2549,2551,2553],{"class":45,"line":61},[43,2547,2548],{"class":1277},"    id                  ",[43,2550,2310],{"class":1871},[43,2552,2313],{"class":1871},[43,2554,2316],{"class":1277},[43,2556,2557,2560,2563,2566,2569,2572,2575],{"class":45,"line":70},[43,2558,2559],{"class":1277},"    product_id          ",[43,2561,2562],{"class":1871},"BIGINT",[43,2564,2565],{"class":148},"         NOT NULL",[43,2567,2568],{"class":1871}," REFERENCES",[43,2570,2571],{"class":1277}," products(id) ",[43,2573,2574],{"class":1871},"ON DELETE CASCADE",[43,2576,2316],{"class":1277},[43,2578,2579,2582,2584,2587,2589],{"class":45,"line":78},[43,2580,2581],{"class":1277},"    variant_sku         ",[43,2583,2324],{"class":1871},[43,2585,2586],{"class":148},"           NOT NULL",[43,2588,2341],{"class":148},[43,2590,2316],{"class":1277},[43,2592,2593,2596,2598],{"class":45,"line":86},[43,2594,2595],{"class":1277},"    color               ",[43,2597,2324],{"class":1871},[43,2599,2316],{"class":1277},[43,2601,2602,2605,2608],{"class":45,"line":94},[43,2603,2604],{"class":148},"    size",[43,2606,2607],{"class":1871},"                TEXT",[43,2609,2316],{"class":1277},[43,2611,2612,2615,2618,2620,2623,2625,2627,2630,2633],{"class":45,"line":108},[43,2613,2614],{"class":1277},"    manufacturing_price ",[43,2616,2617],{"class":1871},"NUMERIC",[43,2619,1422],{"class":1277},[43,2621,2622],{"class":148},"10",[43,2624,1598],{"class":1277},[43,2626,1799],{"class":148},[43,2628,2629],{"class":1277},")  ",[43,2631,2632],{"class":148},"NOT NULL",[43,2634,2316],{"class":1277},[43,2636,2637,2640,2642,2644,2646,2648,2650,2652,2654],{"class":45,"line":119},[43,2638,2639],{"class":1277},"    selling_price       ",[43,2641,2617],{"class":1871},[43,2643,1422],{"class":1277},[43,2645,2622],{"class":148},[43,2647,1598],{"class":1277},[43,2649,1799],{"class":148},[43,2651,2629],{"class":1277},[43,2653,2632],{"class":148},[43,2655,2316],{"class":1277},[43,2657,2658,2661,2663,2665],{"class":45,"line":129},[43,2659,2660],{"class":1277},"    stock_quantity      ",[43,2662,2362],{"class":1871},[43,2664,2327],{"class":148},[43,2666,2316],{"class":1277},[43,2668,2669,2672,2675,2677,2679],{"class":45,"line":140},[43,2670,2671],{"class":1277},"    is_active           ",[43,2673,2674],{"class":1871},"BOOLEAN",[43,2676,2327],{"class":148},[43,2678,2392],{"class":1871},[43,2680,2681],{"class":1277}," TRUE,\n",[43,2683,2684,2687,2689,2692,2694,2696,2698],{"class":45,"line":152},[43,2685,2686],{"class":1277},"    created_at          ",[43,2688,2386],{"class":1871},[43,2690,2691],{"class":148},"    NOT NULL",[43,2693,2392],{"class":1871},[43,2695,2395],{"class":148},[43,2697,2398],{"class":53},[43,2699,2316],{"class":1277},[43,2701,2702,2705,2707,2709,2711,2713],{"class":45,"line":162},[43,2703,2704],{"class":1277},"    updated_at          ",[43,2706,2386],{"class":1871},[43,2708,2691],{"class":148},[43,2710,2392],{"class":1871},[43,2712,2395],{"class":148},[43,2714,2416],{"class":53},[43,2716,2717],{"class":45,"line":170},[43,2718,2421],{"class":1277},[33,2720,2723],{"className":1195,"code":2721,"filename":2722,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS orders (\n    id            BIGSERIAL PRIMARY KEY,\n    customer_id   BIGINT      NOT NULL REFERENCES customers(id),\n    order_date    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    status        TEXT        NOT NULL,\n    total_amount  NUMERIC(12,2),\n    created_at    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at    TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","orders.sql",[40,2724,2725,2740,2751,2766,2783,2794,2812,2829,2844],{"__ignoreMap":38},[43,2726,2727,2729,2731,2733,2735,2737],{"class":45,"line":46},[43,2728,2287],{"class":148},[43,2730,2290],{"class":148},[43,2732,2293],{"class":1418},[43,2734,2296],{"class":148},[43,2736,2299],{"class":148},[43,2738,2739],{"class":1277}," orders (\n",[43,2741,2742,2745,2747,2749],{"class":45,"line":61},[43,2743,2744],{"class":1277},"    id            ",[43,2746,2310],{"class":1871},[43,2748,2313],{"class":1871},[43,2750,2316],{"class":1277},[43,2752,2753,2756,2758,2761,2763],{"class":45,"line":70},[43,2754,2755],{"class":1277},"    customer_id   ",[43,2757,2562],{"class":1871},[43,2759,2760],{"class":148},"      NOT NULL",[43,2762,2568],{"class":1871},[43,2764,2765],{"class":1277}," customers(id),\n",[43,2767,2768,2771,2773,2775,2777,2779,2781],{"class":45,"line":78},[43,2769,2770],{"class":1277},"    order_date    ",[43,2772,2386],{"class":1871},[43,2774,2389],{"class":148},[43,2776,2392],{"class":1871},[43,2778,2395],{"class":148},[43,2780,2398],{"class":53},[43,2782,2316],{"class":1277},[43,2784,2785,2788,2790,2792],{"class":45,"line":86},[43,2786,2787],{"class":148},"    status",[43,2789,2460],{"class":1871},[43,2791,2327],{"class":148},[43,2793,2316],{"class":1277},[43,2795,2796,2799,2801,2803,2806,2808,2810],{"class":45,"line":94},[43,2797,2798],{"class":1277},"    total_amount  ",[43,2800,2617],{"class":1871},[43,2802,1422],{"class":1277},[43,2804,2805],{"class":148},"12",[43,2807,1598],{"class":1277},[43,2809,1799],{"class":148},[43,2811,1612],{"class":1277},[43,2813,2814,2817,2819,2821,2823,2825,2827],{"class":45,"line":108},[43,2815,2816],{"class":1277},"    created_at    ",[43,2818,2386],{"class":1871},[43,2820,2389],{"class":148},[43,2822,2392],{"class":1871},[43,2824,2395],{"class":148},[43,2826,2398],{"class":53},[43,2828,2316],{"class":1277},[43,2830,2831,2834,2836,2838,2840,2842],{"class":45,"line":119},[43,2832,2833],{"class":1277},"    updated_at    ",[43,2835,2386],{"class":1871},[43,2837,2389],{"class":148},[43,2839,2392],{"class":1871},[43,2841,2395],{"class":148},[43,2843,2416],{"class":53},[43,2845,2846],{"class":45,"line":129},[43,2847,2421],{"class":1277},[33,2849,2852],{"className":1195,"code":2850,"filename":2851,"language":1198,"meta":38,"style":38},"CREATE TABLE IF NOT EXISTS order_items (\n    id           BIGSERIAL PRIMARY KEY,\n    order_id     BIGINT         NOT NULL REFERENCES orders(id) ON DELETE CASCADE,\n    variant_id   BIGINT         NOT NULL REFERENCES product_variants(id),\n    quantity     INTEGER        NOT NULL,\n    unit_price   NUMERIC(10,2)  NOT NULL,\n    total_price  NUMERIC(12,2)  GENERATED ALWAYS AS (quantity * unit_price) STORED,\n    created_at   TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","order_items.sql",[40,2853,2854,2869,2880,2898,2912,2923,2944,2977,2992],{"__ignoreMap":38},[43,2855,2856,2858,2860,2862,2864,2866],{"class":45,"line":46},[43,2857,2287],{"class":148},[43,2859,2290],{"class":148},[43,2861,2293],{"class":1418},[43,2863,2296],{"class":148},[43,2865,2299],{"class":148},[43,2867,2868],{"class":1277}," order_items (\n",[43,2870,2871,2874,2876,2878],{"class":45,"line":61},[43,2872,2873],{"class":1277},"    id           ",[43,2875,2310],{"class":1871},[43,2877,2313],{"class":1871},[43,2879,2316],{"class":1277},[43,2881,2882,2885,2887,2889,2891,2894,2896],{"class":45,"line":70},[43,2883,2884],{"class":1277},"    order_id     ",[43,2886,2562],{"class":1871},[43,2888,2565],{"class":148},[43,2890,2568],{"class":1871},[43,2892,2893],{"class":1277}," orders(id) ",[43,2895,2574],{"class":1871},[43,2897,2316],{"class":1277},[43,2899,2900,2903,2905,2907,2909],{"class":45,"line":78},[43,2901,2902],{"class":1277},"    variant_id   ",[43,2904,2562],{"class":1871},[43,2906,2565],{"class":148},[43,2908,2568],{"class":1871},[43,2910,2911],{"class":1277}," product_variants(id),\n",[43,2913,2914,2917,2919,2921],{"class":45,"line":86},[43,2915,2916],{"class":1277},"    quantity     ",[43,2918,2362],{"class":1871},[43,2920,2327],{"class":148},[43,2922,2316],{"class":1277},[43,2924,2925,2928,2930,2932,2934,2936,2938,2940,2942],{"class":45,"line":94},[43,2926,2927],{"class":1277},"    unit_price   ",[43,2929,2617],{"class":1871},[43,2931,1422],{"class":1277},[43,2933,2622],{"class":148},[43,2935,1598],{"class":1277},[43,2937,1799],{"class":148},[43,2939,2629],{"class":1277},[43,2941,2632],{"class":148},[43,2943,2316],{"class":1277},[43,2945,2946,2949,2951,2953,2955,2957,2959,2961,2964,2967,2969,2972,2974],{"class":45,"line":108},[43,2947,2948],{"class":1277},"    total_price  ",[43,2950,2617],{"class":1871},[43,2952,1422],{"class":1277},[43,2954,2805],{"class":148},[43,2956,1598],{"class":1277},[43,2958,1799],{"class":148},[43,2960,2629],{"class":1277},[43,2962,2963],{"class":148},"GENERATED",[43,2965,2966],{"class":148}," ALWAYS",[43,2968,1389],{"class":148},[43,2970,2971],{"class":1277}," (quantity ",[43,2973,1425],{"class":53},[43,2975,2976],{"class":1277}," unit_price) STORED,\n",[43,2978,2979,2982,2984,2986,2988,2990],{"class":45,"line":119},[43,2980,2981],{"class":1277},"    created_at   ",[43,2983,2386],{"class":1871},[43,2985,2691],{"class":148},[43,2987,2392],{"class":1871},[43,2989,2395],{"class":148},[43,2991,2416],{"class":53},[43,2993,2994],{"class":45,"line":129},[43,2995,2421],{"class":1277},[1992,2997,2998],{},"This model mirrors a real-world e-commerce workflow:",[2028,3000,3001,3004,3007,3010],{},[2031,3002,3003],{},"A customer makes one or more orders.",[2031,3005,3006],{},"Each order contains one or more items.",[2031,3008,3009],{},"Each item points to a specific product variant (like a red T-shirt, size M).",[2031,3011,3012],{},"Each variant belongs to a broader product (e.g., “Classic T-Shirt”).",[1992,3014,3015],{},"These foreign key relationships allow us to join datasets efficiently and enable downstream analytics like:",[2135,3017,3018,3031],{},[2138,3019,3020],{},[2141,3021,3022,3025,3028],{},[2144,3023,2146],{"align":3024},"left",[2144,3026,3027],{},"Materialized Table",[2144,3029,3030],{},"Depends On",[2151,3032,3033,3047,3060,3081,3098,3121],{},[2141,3034,3035,3037,3042],{},[2156,3036,2160],{"align":3024},[2156,3038,3039],{},[40,3040,3041],{},"mart.customers_by_age",[2156,3043,3044],{},[40,3045,3046],{},"stg.customers",[2141,3048,3049,3051,3056],{},[2156,3050,2160],{"align":3024},[2156,3052,3053],{},[40,3054,3055],{},"mart.customers_by_country",[2156,3057,3058],{},[40,3059,3046],{},[2141,3061,3062,3065,3070],{},[2156,3063,3064],{"align":3024},"Products",[2156,3066,3067],{},[40,3068,3069],{},"mart.revenue_by_product",[2156,3071,3072,2197,3075,2197,3078],{},[40,3073,3074],{},"raw.order_items",[40,3076,3077],{},"raw.product_variants",[40,3079,3080],{},"raw.products",[2141,3082,3083,3085,3090],{},[2156,3084,3064],{"align":3024},[2156,3086,3087],{},[40,3088,3089],{},"mart.revenue_by_category",[2156,3091,3092,2197,3094,2197,3096],{},[40,3093,3074],{},[40,3095,3077],{},[40,3097,3080],{},[2141,3099,3100,3102,3107],{},[2156,3101,3064],{"align":3024},[2156,3103,3104],{},[40,3105,3106],{},"mart.revenue_by_product_variant",[2156,3108,3109,2197,3112,2197,3115,2197,3118],{},[40,3110,3111],{},"stg.product_variants",[40,3113,3114],{},"stg.order_items",[40,3116,3117],{},"stg.orders",[40,3119,3120],{},"stg.products",[2141,3122,3123,3126,3131],{},[2156,3124,3125],{"align":3024},"Sales",[2156,3127,3128],{},[40,3129,3130],{},"mart.sales_daily",[2156,3132,3133,2197,3135],{},[40,3134,3114],{},[40,3136,3117],{},[1992,3138,3139],{},"By establishing these links early, every layer of the pipeline — raw, staging, and mart — can remain consistent and\ntraceable across transformations.",[1973,3141,3143],{"id":3142},"_3-setting-up-the-source-database-docker-postgres","3) Setting Up the Source Database (Docker + Postgres)",[1992,3145,3146],{},"First, let's spin up our PostgreSQL instance:",[3148,3149,3150,3223,3242],"code-group",{},[33,3151,3154],{"className":2054,"code":3152,"filename":3153,"language":2056,"meta":38,"style":38},"docker run -d \\\n  --name bruin-ecommerce \\\n  -e POSTGRES_USER=postgres \\\n  -e POSTGRES_PASSWORD=postgres \\\n  -e POSTGRES_DB=postgres \\\n  -p 5432:5432 \\\n  postgres:18-alpine\n","Docker Run",[40,3155,3156,3170,3180,3190,3199,3208,3218],{"__ignoreMap":38},[43,3157,3158,3161,3164,3167],{"class":45,"line":46},[43,3159,3160],{"class":2063},"docker",[43,3162,3163],{"class":57}," run",[43,3165,3166],{"class":57}," -d",[43,3168,3169],{"class":1277}," \\\n",[43,3171,3172,3175,3178],{"class":45,"line":61},[43,3173,3174],{"class":57},"  --name",[43,3176,3177],{"class":57}," bruin-ecommerce",[43,3179,3169],{"class":1277},[43,3181,3182,3185,3188],{"class":45,"line":70},[43,3183,3184],{"class":57},"  -e",[43,3186,3187],{"class":57}," POSTGRES_USER=postgres",[43,3189,3169],{"class":1277},[43,3191,3192,3194,3197],{"class":45,"line":78},[43,3193,3184],{"class":57},[43,3195,3196],{"class":57}," POSTGRES_PASSWORD=postgres",[43,3198,3169],{"class":1277},[43,3200,3201,3203,3206],{"class":45,"line":86},[43,3202,3184],{"class":57},[43,3204,3205],{"class":57}," POSTGRES_DB=postgres",[43,3207,3169],{"class":1277},[43,3209,3210,3213,3216],{"class":45,"line":94},[43,3211,3212],{"class":57},"  -p",[43,3214,3215],{"class":57}," 5432:5432",[43,3217,3169],{"class":1277},[43,3219,3220],{"class":45,"line":108},[43,3221,3222],{"class":57},"  postgres:18-alpine\n",[33,3224,3227],{"className":2054,"code":3225,"filename":3226,"language":2056,"meta":38,"style":38},"docker compose up -d\n","Docker Compose",[40,3228,3229],{"__ignoreMap":38},[43,3230,3231,3233,3236,3239],{"class":45,"line":46},[43,3232,3160],{"class":2063},[43,3234,3235],{"class":57}," compose",[43,3237,3238],{"class":57}," up",[43,3240,3241],{"class":57}," -d\n",[33,3243,3246],{"className":2054,"code":3244,"filename":3245,"language":2056,"meta":38,"style":38},"make docker-up\n","Makefile",[40,3247,3248],{"__ignoreMap":38},[43,3249,3250,3253],{"class":45,"line":46},[43,3251,3252],{"class":2063},"make",[43,3254,3255],{"class":57}," docker-up\n",[1992,3257,3258],{},"Now, we must ingest the DDL inside the PostgresSQL instance:",[3260,3261,3262,3307,3322],"tabs",{},[3263,3264,3267],"tabs-item",{"icon":3265,"label":3266},"i-lucide-terminal","Terminal",[33,3268,3270],{"className":2054,"code":3269,"language":2056,"meta":38,"style":38},"cat sql/ddl.sql | docker exec -i bruin-ecommerce psql -U postgres -d postgres\n",[40,3271,3272],{"__ignoreMap":38},[43,3273,3274,3277,3280,3283,3286,3289,3292,3294,3297,3300,3303,3305],{"class":45,"line":46},[43,3275,3276],{"class":2063},"cat",[43,3278,3279],{"class":57}," sql/ddl.sql",[43,3281,3282],{"class":53}," |",[43,3284,3285],{"class":2063}," docker",[43,3287,3288],{"class":57}," exec",[43,3290,3291],{"class":57}," -i",[43,3293,3177],{"class":57},[43,3295,3296],{"class":57}," psql",[43,3298,3299],{"class":57}," -U",[43,3301,3302],{"class":57}," postgres",[43,3304,3166],{"class":57},[43,3306,116],{"class":57},[3263,3308,3310],{"icon":3265,"label":3309},"Terminal (Makefile)",[33,3311,3313],{"className":2054,"code":3312,"language":2056,"meta":38,"style":38},"make db-migrate\n",[40,3314,3315],{"__ignoreMap":38},[43,3316,3317,3319],{"class":45,"line":46},[43,3318,3252],{"class":2063},[43,3320,3321],{"class":57}," db-migrate\n",[3263,3323,3326],{"icon":3324,"label":3325},"i-lucide-eye","Output",[33,3327,3330],{"className":2054,"code":3328,"filename":3329,"language":2056,"meta":38,"style":38},"CREATE TABLE\nCREATE TABLE\nCREATE TABLE\nCREATE TABLE\nCREATE TABLE\n","Docker Exec",[40,3331,3332,3339,3345,3351,3357],{"__ignoreMap":38},[43,3333,3334,3336],{"class":45,"line":46},[43,3335,2287],{"class":2063},[43,3337,3338],{"class":57}," TABLE\n",[43,3340,3341,3343],{"class":45,"line":61},[43,3342,2287],{"class":2063},[43,3344,3338],{"class":57},[43,3346,3347,3349],{"class":45,"line":70},[43,3348,2287],{"class":2063},[43,3350,3338],{"class":57},[43,3352,3353,3355],{"class":45,"line":78},[43,3354,2287],{"class":2063},[43,3356,3338],{"class":57},[43,3358,3359,3361],{"class":45,"line":86},[43,3360,2287],{"class":2063},[43,3362,3338],{"class":57},[3364,3365,3368],"note",{"className":3366},[1984,3367],"my-0",[1992,3369,3370,3371],{},"If you're using Makefile, check the commands available using ",[40,3372,3373],{},"make help",[1973,3375,3377],{"id":3376},"_4-populating-test-data","4) Populating Test Data",[1992,3379,3380,3381,3384],{},"Inside the project, you’ll find a script called ",[40,3382,3383],{},"generate_data.py",".\nThis script populates our five main tables (customers, products, product_variants, orders, and order_items) with realistic, time-distributed data that mimics an actual e-commerce platform.",[1992,3386,3387],{},"To make this possible, we rely on two lightweight Python libraries:",[33,3389,3393],{"className":3390,"code":3391,"language":3392,"meta":38,"style":38},"language-diff shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","+ faker==37     # For realistic names, emails, and categorical data\n+ psycopg==3    # For direct PostgreSQL database access\n","diff",[40,3394,3395,3400],{"__ignoreMap":38},[43,3396,3397],{"class":45,"line":46},[43,3398,3399],{},"+ faker==37     # For realistic names, emails, and categorical data\n",[43,3401,3402],{"class":45,"line":61},[43,3403,3404],{},"+ psycopg==3    # For direct PostgreSQL database access\n",[1992,3406,3407],{},"These are automatically handled when running with uv. Here's the script:",[3409,3410,3411],"code-collapse",{},[33,3412,3416],{"className":3413,"code":3414,"filename":3383,"language":3415,"meta":38,"style":38},"language-python shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","#!/usr/bin/env python3\n\"\"\"\nE-commerce demo data generator (Postgres).\n\nUsage:\n    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n\"\"\"\n\nimport argparse, random\nfrom datetime import datetime, timedelta, timezone\nfrom faker import Faker\nimport psycopg\n\n# -------------------------------------------------------------------\n# GLOBAL CONFIGURATION\n# -------------------------------------------------------------------\n\nfake = Faker()\n\n# --- Static categorical constants ---\nPRODUCT_CATEGORIES = [\"t-shirts\", \"hoodies\", \"shoes\", \"accessories\", \"jackets\"]\nCOLORS = [\"Red\", \"Blue\", \"Black\", \"White\", \"Green\"]\nSIZES_APPAREL = [\"S\", \"M\", \"L\", \"XL\"]\nSIZES_SHOES = [36, 38, 40, 42, 44]\nORDER_STATUSES = [\"pending\", \"paid\", \"cancelled\", \"shipped\"]\nORDER_STATUS_WEIGHTS = [0.2, 0.5, 0.1, 0.2]\n\n# --- SQL Statements ---\nSQL_INSERT_CUSTOMERS = \"\"\"\n                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n                       VALUES (%s, %s, %s, %s, %s, %s) ON CONFLICT (email) DO\n                       UPDATE\n                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; \\\n                       \"\"\"\n\nSQL_INSERT_PRODUCTS = \"\"\"\n                      INSERT INTO products(name, category, sku, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s) ON CONFLICT (sku) DO\n                      UPDATE\n                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_INSERT_VARIANTS = \"\"\"\n                      INSERT INTO product_variants\n                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n                       stock_quantity, is_active, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT (variant_sku) DO\n                      UPDATE\n                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n                          manufacturing_price=EXCLUDED.manufacturing_price,\n                          selling_price=EXCLUDED.selling_price,\n                          stock_quantity=EXCLUDED.stock_quantity,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_DELETE_ORDERS_IN_WINDOW = \"DELETE FROM orders WHERE order_date BETWEEN %s AND %s;\"\n\nSQL_INSERT_ORDERS = \"\"\"\n                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n                    VALUES (%s, %s, %s, %s, %s, %s); \\\n                    \"\"\"\n\nSQL_INSERT_ORDER_ITEMS = \"\"\"\n                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n                         VALUES (%s, %s, %s, %s, %s); \\\n                         \"\"\"\n\nSQL_UPDATE_ORDER_TOTALS = \"\"\"\n                          UPDATE orders o\n                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n  SELECT order_id, SUM(total_price) sum_total\n  FROM order_items GROUP BY order_id\n) oi\n                          WHERE o.id = oi.order_id\n                            AND o.order_date BETWEEN %s\n                            AND %s; \\\n                          \"\"\"\n\nSQL_STATS_COUNTS = {\n    \"customers\": \"SELECT COUNT(*) FROM customers\",\n    \"products\": \"SELECT COUNT(*) FROM products\",\n    \"variants\": \"SELECT COUNT(*) FROM product_variants\",\n    \"orders\": \"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN %s AND %s\",\n    \"items\": \"\"\"\n             SELECT COUNT(*)\n             FROM order_items oi\n                      JOIN orders o ON o.id = oi.order_id\n             WHERE o.order_date BETWEEN %s AND %s;\n             \"\"\",\n}\n\nSQL_CHAOS_VALIDATION = \"\"\"\n                       SELECT p.category,\n                              SUM(CASE\n                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n                                          THEN 1\n                                      ELSE 0 END) invalid\n                       FROM product_variants v\n                                JOIN products p ON p.id = v.product_id\n                       GROUP BY 1\n                       ORDER BY 1; \\\n                       \"\"\"\n\n\ndef parse_args():\n    now = datetime.now(timezone.utc)\n    day_start = now.replace(hour=0, minute=0, second=0, microsecond=0)\n    day_end = now.replace(hour=23, minute=59, second=59, microsecond=999999)\n\n    p = argparse.ArgumentParser(description=\"Generate demo ecommerce data (idempotent).\")\n    p.add_argument(\"--dsn\", required=True, help=\"PostgreSQL DSN\")\n    p.add_argument(\"--customers\", type=int, default=100)\n    p.add_argument(\"--products\", type=int, default=50)\n    p.add_argument(\"--orders\", type=int, default=500)\n    p.add_argument(\"--max-items-per-order\", type=int, default=5)\n    p.add_argument(\"--chaos-percent\", type=float, default=0.0, help=\"%% of variants with invalid sizes\")\n    p.add_argument(\"--scale\", type=int, default=1, help=\"Multiply base volumes\")\n    p.add_argument(\"--seed\", type=int, default=42, help=\"Deterministic RNG seed\")\n    p.add_argument(\"--starting-at\", type=str, help=\"ISO start (e.g. 2024-01-01)\")\n    p.add_argument(\"--ending-at\", type=str, help=\"ISO end (e.g. 2024-06-30)\")\n\n    a = p.parse_args()\n    a.starting_at = a.starting_at or day_start.isoformat()\n    a.ending_at = a.ending_at or day_end.isoformat()\n    return a\n\n\ndef iso(dt):\n    return datetime.fromisoformat(dt).astimezone(timezone.utc)\n\n\ndef rdate(s, e):\n    \"\"\"Return random datetime between s and e.\"\"\"\n    return s + timedelta(seconds=random.randint(0, int((e - s).total_seconds())))\n\n\ndef execmany(conn, sql, rows):\n    with conn.cursor() as cur:\n        cur.executemany(sql, rows)\n    conn.commit()\n\ndef gen_customers(n):\n    for _ in range(n):\n        yield (\n            fake.name(),\n            fake.unique.email(),\n            fake.country(),\n            random.randint(18, 70),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_products(n):\n    for _ in range(n):\n        cat = random.choice(PRODUCT_CATEGORIES)\n        yield (\n            f\"{fake.word().capitalize()} {cat}\",\n            cat,\n            fake.unique.bothify(\"SKU-####-??\").upper(),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_variants(prod_rows, chaos):\n    for pid, cat in prod_rows:\n        for _ in range(random.randint(1, 4)):\n            sku = fake.unique.bothify(\"VAR-####-??\").upper()\n            color = random.choice(COLORS)\n            size = str(random.choice(SIZES_SHOES)) if cat == \"shoes\" else random.choice(SIZES_APPAREL)\n\n            # Chaos mode\n            if chaos > 0 and random.random() \u003C (chaos / 100):\n                if cat == \"shoes\":\n                    size = random.choice(SIZES_APPAREL)\n                else:\n                    size = str(random.choice(SIZES_SHOES))\n\n            manuf = round(random.uniform(10, 80), 2)\n            sell = round(manuf * random.uniform(1.2, 2.0), 2)\n            yield (\n                pid, sku, color, size, manuf, sell,\n                random.randint(0, 200), True,\n                datetime.now(timezone.utc), datetime.now(timezone.utc),\n            )\n\n\ndef gen_orders(cust_ids, n, s, e):\n    for _ in range(n):\n        yield (random.choice(cust_ids), rdate(s, e), random.choices(ORDER_STATUSES, ORDER_STATUS_WEIGHTS)[0], 0.0,\n               datetime.now(timezone.utc), datetime.now(timezone.utc),)\n\n\ndef gen_items(order_ids, variant_ids, max_items):\n    for oid in order_ids:\n        for vid in random.sample(variant_ids, random.randint(1, max(1, max_items))):\n            yield (oid, vid, random.randint(1, 3), round(random.uniform(20, 200), 2), datetime.now(timezone.utc))\n\n\ndef print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, max_items, bad_by_cat):\n    print(\"\\n✅ Data generation complete (idempotent window load)\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Counts — Customers: {c_cnt:,} | Products: {p_cnt:,} | Variants: {v_cnt:,}\")\n    print(f\"Window Facts — Orders: {o_cnt:,} | Items: {i_cnt:,} | MaxItems/Order: {max_items}\")\n    print(\"Chaos check (invalid sizes per category):\")\n    for cat, bad in bad_by_cat:\n        print(f\"  • {cat}: {bad:,} invalid\")\n\n\ndef main():\n    args = parse_args()\n    random.seed(args.seed)\n    Faker.seed(args.seed)\n    S, E = iso(args.starting_at), iso(args.ending_at)\n\n    print(\"\\n=== Generating E-commerce Demo Data ===\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Scale x{args.scale} | Seed {args.seed} | Chaos {args.chaos_percent:.1f}%\\n\")\n\n    base_c, base_p, base_o = args.customers, args.products, args.orders\n    n_c, n_p, n_o = base_c * args.scale, base_p * args.scale, base_o * args.scale\n\n    with psycopg.connect(args.dsn) as conn:\n        execmany(conn, SQL_INSERT_CUSTOMERS, gen_customers(n_c))\n        execmany(conn, SQL_INSERT_PRODUCTS, gen_products(n_p))\n\n        prod_rows = list(conn.execute(\"SELECT id, category FROM products\"))\n        execmany(conn, SQL_INSERT_VARIANTS, gen_variants(prod_rows, args.chaos_percent))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_DELETE_ORDERS_IN_WINDOW, (S, E))\n        conn.commit()\n\n        cust_ids = [r[0] for r in conn.execute(\"SELECT id FROM customers\")]\n        execmany(conn, SQL_INSERT_ORDERS, gen_orders(cust_ids, n_o, S, E))\n\n        order_ids = [r[0] for r in conn.execute(\"SELECT id FROM orders WHERE order_date BETWEEN %s AND %s\", (S, E))]\n        variant_ids = [r[0] for r in conn.execute(\"SELECT id FROM product_variants\")]\n        execmany(conn, SQL_INSERT_ORDER_ITEMS, gen_items(order_ids, variant_ids, args.max_items_per_order))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_UPDATE_ORDER_TOTALS, (S, E))\n        conn.commit()\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_STATS_COUNTS[\"customers\"]);\n            c_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"products\"]);\n            p_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"variants\"]);\n            v_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"orders\"], (S, E));\n            o_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"items\"], (S, E));\n            i_cnt = cur.fetchone()[0]\n            cur.execute(SQL_CHAOS_VALIDATION);\n            bad_by_cat = cur.fetchall()\n\n    print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, args.max_items_per_order, bad_by_cat)\n\n\nif __name__ == \"__main__\":\n    main()\n","python",[40,3417,3418,3423,3429,3434,3438,3443,3448,3452,3456,3469,3492,3504,3511,3515,3520,3525,3529,3533,3545,3549,3554,3610,3664,3709,3743,3786,3815,3819,3824,3834,3839,3870,3875,3880,3888,3893,3897,3906,3911,3937,3942,3947,3954,3959,3963,3972,3977,3982,3987,4032,4036,4041,4046,4051,4056,4062,4066,4070,4094,4098,4107,4112,4144,4149,4153,4162,4167,4194,4199,4203,4212,4217,4222,4227,4233,4239,4245,4254,4267,4273,4278,4289,4311,4332,4353,4380,4394,4400,4406,4412,4426,4434,4440,4445,4455,4461,4467,4473,4479,4485,4491,4497,4503,4509,4517,4522,4527,4532,4544,4572,4626,4677,4682,4712,4754,4794,4831,4868,4905,4959,5009,5059,5101,5142,5147,5165,5199,5228,5237,5242,5247,5263,5295,5300,5305,5325,5336,5393,5398,5403,5428,5452,5473,5486,5491,5506,5527,5535,5548,5565,5577,5599,5619,5638,5644,5649,5654,5668,5685,5708,5715,5756,5764,5794,5813,5832,5837,5842,5847,5867,5887,5919,5953,5974,6031,6036,6042,6082,6100,6120,6128,6152,6157,6194,6233,6241,6274,6298,6334,6340,6345,6350,6378,6395,6456,6493,6498,6503,6528,6543,6593,6668,6673,6678,6731,6751,6796,6846,6893,6909,6928,6964,6969,6974,6984,6996,7018,7038,7075,7080,7098,7139,7201,7206,7248,7303,7308,7339,7365,7390,7395,7426,7458,7463,7483,7510,7522,7527,7574,7612,7617,7675,7716,7753,7758,7777,7803,7814,7819,7838,7865,7887,7912,7932,7957,7977,8012,8032,8067,8087,8105,8122,8127,8175,8180,8185,8205],{"__ignoreMap":38},[43,3419,3420],{"class":45,"line":46},[43,3421,3422],{"class":1006},"#!/usr/bin/env python3\n",[43,3424,3425],{"class":45,"line":61},[43,3426,3428],{"class":3427},"s7zQu","\"\"\"\n",[43,3430,3431],{"class":45,"line":70},[43,3432,3433],{"class":1006},"E-commerce demo data generator (Postgres).\n",[43,3435,3436],{"class":45,"line":78},[43,3437,244],{"emptyLinePlaceholder":243},[43,3439,3440],{"class":45,"line":86},[43,3441,3442],{"class":1006},"Usage:\n",[43,3444,3445],{"class":45,"line":94},[43,3446,3447],{"class":1006},"    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n",[43,3449,3450],{"class":45,"line":108},[43,3451,3428],{"class":3427},[43,3453,3454],{"class":45,"line":119},[43,3455,244],{"emptyLinePlaceholder":243},[43,3457,3458,3461,3464,3466],{"class":45,"line":129},[43,3459,3460],{"class":3427},"import",[43,3462,3463],{"class":1277}," argparse",[43,3465,1598],{"class":53},[43,3467,3468],{"class":1277}," random\n",[43,3470,3471,3474,3477,3479,3482,3484,3487,3489],{"class":45,"line":140},[43,3472,3473],{"class":3427},"from",[43,3475,3476],{"class":1277}," datetime ",[43,3478,3460],{"class":3427},[43,3480,3481],{"class":1277}," datetime",[43,3483,1598],{"class":53},[43,3485,3486],{"class":1277}," timedelta",[43,3488,1598],{"class":53},[43,3490,3491],{"class":1277}," timezone\n",[43,3493,3494,3496,3499,3501],{"class":45,"line":152},[43,3495,3473],{"class":3427},[43,3497,3498],{"class":1277}," faker ",[43,3500,3460],{"class":3427},[43,3502,3503],{"class":1277}," Faker\n",[43,3505,3506,3508],{"class":45,"line":162},[43,3507,3460],{"class":3427},[43,3509,3510],{"class":1277}," psycopg\n",[43,3512,3513],{"class":45,"line":170},[43,3514,244],{"emptyLinePlaceholder":243},[43,3516,3517],{"class":45,"line":182},[43,3518,3519],{"class":1006},"# -------------------------------------------------------------------\n",[43,3521,3522],{"class":45,"line":374},[43,3523,3524],{"class":1006},"# GLOBAL CONFIGURATION\n",[43,3526,3527],{"class":45,"line":382},[43,3528,3519],{"class":1006},[43,3530,3531],{"class":45,"line":392},[43,3532,244],{"emptyLinePlaceholder":243},[43,3534,3535,3538,3540,3543],{"class":45,"line":399},[43,3536,3537],{"class":1277},"fake ",[43,3539,1570],{"class":53},[43,3541,3542],{"class":1418}," Faker",[43,3544,2416],{"class":53},[43,3546,3547],{"class":45,"line":410},[43,3548,244],{"emptyLinePlaceholder":243},[43,3550,3551],{"class":45,"line":417},[43,3552,3553],{"class":1006},"# --- Static categorical constants ---\n",[43,3555,3556,3559,3561,3564,3567,3570,3572,3574,3576,3579,3581,3583,3585,3588,3590,3592,3594,3597,3599,3601,3603,3606,3608],{"class":45,"line":425},[43,3557,3558],{"class":1277},"PRODUCT_CATEGORIES ",[43,3560,1570],{"class":53},[43,3562,3563],{"class":53}," [",[43,3565,3566],{"class":53},"\"",[43,3568,3569],{"class":57},"t-shirts",[43,3571,3566],{"class":53},[43,3573,1598],{"class":53},[43,3575,299],{"class":53},[43,3577,3578],{"class":57},"hoodies",[43,3580,3566],{"class":53},[43,3582,1598],{"class":53},[43,3584,299],{"class":53},[43,3586,3587],{"class":57},"shoes",[43,3589,3566],{"class":53},[43,3591,1598],{"class":53},[43,3593,299],{"class":53},[43,3595,3596],{"class":57},"accessories",[43,3598,3566],{"class":53},[43,3600,1598],{"class":53},[43,3602,299],{"class":53},[43,3604,3605],{"class":57},"jackets",[43,3607,3566],{"class":53},[43,3609,238],{"class":53},[43,3611,3612,3615,3617,3619,3621,3624,3626,3628,3630,3633,3635,3637,3639,3642,3644,3646,3648,3651,3653,3655,3657,3660,3662],{"class":45,"line":430},[43,3613,3614],{"class":1277},"COLORS ",[43,3616,1570],{"class":53},[43,3618,3563],{"class":53},[43,3620,3566],{"class":53},[43,3622,3623],{"class":57},"Red",[43,3625,3566],{"class":53},[43,3627,1598],{"class":53},[43,3629,299],{"class":53},[43,3631,3632],{"class":57},"Blue",[43,3634,3566],{"class":53},[43,3636,1598],{"class":53},[43,3638,299],{"class":53},[43,3640,3641],{"class":57},"Black",[43,3643,3566],{"class":53},[43,3645,1598],{"class":53},[43,3647,299],{"class":53},[43,3649,3650],{"class":57},"White",[43,3652,3566],{"class":53},[43,3654,1598],{"class":53},[43,3656,299],{"class":53},[43,3658,3659],{"class":57},"Green",[43,3661,3566],{"class":53},[43,3663,238],{"class":53},[43,3665,3666,3669,3671,3673,3675,3678,3680,3682,3684,3687,3689,3691,3693,3696,3698,3700,3702,3705,3707],{"class":45,"line":438},[43,3667,3668],{"class":1277},"SIZES_APPAREL ",[43,3670,1570],{"class":53},[43,3672,3563],{"class":53},[43,3674,3566],{"class":53},[43,3676,3677],{"class":57},"S",[43,3679,3566],{"class":53},[43,3681,1598],{"class":53},[43,3683,299],{"class":53},[43,3685,3686],{"class":57},"M",[43,3688,3566],{"class":53},[43,3690,1598],{"class":53},[43,3692,299],{"class":53},[43,3694,3695],{"class":57},"L",[43,3697,3566],{"class":53},[43,3699,1598],{"class":53},[43,3701,299],{"class":53},[43,3703,3704],{"class":57},"XL",[43,3706,3566],{"class":53},[43,3708,238],{"class":53},[43,3710,3711,3714,3716,3718,3721,3723,3726,3728,3731,3733,3736,3738,3741],{"class":45,"line":446},[43,3712,3713],{"class":1277},"SIZES_SHOES ",[43,3715,1570],{"class":53},[43,3717,3563],{"class":53},[43,3719,3720],{"class":148},"36",[43,3722,1598],{"class":53},[43,3724,3725],{"class":148}," 38",[43,3727,1598],{"class":53},[43,3729,3730],{"class":148}," 40",[43,3732,1598],{"class":53},[43,3734,3735],{"class":148}," 42",[43,3737,1598],{"class":53},[43,3739,3740],{"class":148}," 44",[43,3742,238],{"class":53},[43,3744,3745,3748,3750,3752,3754,3757,3759,3761,3763,3765,3767,3769,3771,3774,3776,3778,3780,3782,3784],{"class":45,"line":456},[43,3746,3747],{"class":1277},"ORDER_STATUSES ",[43,3749,1570],{"class":53},[43,3751,3563],{"class":53},[43,3753,3566],{"class":53},[43,3755,3756],{"class":57},"pending",[43,3758,3566],{"class":53},[43,3760,1598],{"class":53},[43,3762,299],{"class":53},[43,3764,1593],{"class":57},[43,3766,3566],{"class":53},[43,3768,1598],{"class":53},[43,3770,299],{"class":53},[43,3772,3773],{"class":57},"cancelled",[43,3775,3566],{"class":53},[43,3777,1598],{"class":53},[43,3779,299],{"class":53},[43,3781,1603],{"class":57},[43,3783,3566],{"class":53},[43,3785,238],{"class":53},[43,3787,3788,3791,3793,3795,3798,3800,3803,3805,3808,3810,3813],{"class":45,"line":464},[43,3789,3790],{"class":1277},"ORDER_STATUS_WEIGHTS ",[43,3792,1570],{"class":53},[43,3794,3563],{"class":53},[43,3796,3797],{"class":148},"0.2",[43,3799,1598],{"class":53},[43,3801,3802],{"class":148}," 0.5",[43,3804,1598],{"class":53},[43,3806,3807],{"class":148}," 0.1",[43,3809,1598],{"class":53},[43,3811,3812],{"class":148}," 0.2",[43,3814,238],{"class":53},[43,3816,3817],{"class":45,"line":472},[43,3818,244],{"emptyLinePlaceholder":243},[43,3820,3821],{"class":45,"line":483},[43,3822,3823],{"class":1006},"# --- SQL Statements ---\n",[43,3825,3826,3829,3831],{"class":45,"line":494},[43,3827,3828],{"class":1277},"SQL_INSERT_CUSTOMERS ",[43,3830,1570],{"class":53},[43,3832,3833],{"class":53}," \"\"\"\n",[43,3835,3836],{"class":45,"line":506},[43,3837,3838],{"class":57},"                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n",[43,3840,3841,3844,3847,3849,3851,3853,3855,3857,3859,3861,3863,3865,3867],{"class":45,"line":517},[43,3842,3843],{"class":57},"                       VALUES (",[43,3845,3846],{"class":148},"%s",[43,3848,2197],{"class":57},[43,3850,3846],{"class":148},[43,3852,2197],{"class":57},[43,3854,3846],{"class":148},[43,3856,2197],{"class":57},[43,3858,3846],{"class":148},[43,3860,2197],{"class":57},[43,3862,3846],{"class":148},[43,3864,2197],{"class":57},[43,3866,3846],{"class":148},[43,3868,3869],{"class":57},") ON CONFLICT (email) DO\n",[43,3871,3872],{"class":45,"line":525},[43,3873,3874],{"class":57},"                       UPDATE\n",[43,3876,3877],{"class":45,"line":538},[43,3878,3879],{"class":57},"                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n",[43,3881,3882,3885],{"class":45,"line":550},[43,3883,3884],{"class":57},"                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; ",[43,3886,3887],{"class":53},"\\\n",[43,3889,3890],{"class":45,"line":558},[43,3891,3892],{"class":53},"                       \"\"\"\n",[43,3894,3895],{"class":45,"line":568},[43,3896,244],{"emptyLinePlaceholder":243},[43,3898,3899,3902,3904],{"class":45,"line":578},[43,3900,3901],{"class":1277},"SQL_INSERT_PRODUCTS ",[43,3903,1570],{"class":53},[43,3905,3833],{"class":53},[43,3907,3908],{"class":45,"line":588},[43,3909,3910],{"class":57},"                      INSERT INTO products(name, category, sku, created_at, updated_at)\n",[43,3912,3913,3916,3918,3920,3922,3924,3926,3928,3930,3932,3934],{"class":45,"line":595},[43,3914,3915],{"class":57},"                      VALUES (",[43,3917,3846],{"class":148},[43,3919,2197],{"class":57},[43,3921,3846],{"class":148},[43,3923,2197],{"class":57},[43,3925,3846],{"class":148},[43,3927,2197],{"class":57},[43,3929,3846],{"class":148},[43,3931,2197],{"class":57},[43,3933,3846],{"class":148},[43,3935,3936],{"class":57},") ON CONFLICT (sku) DO\n",[43,3938,3939],{"class":45,"line":606},[43,3940,3941],{"class":57},"                      UPDATE\n",[43,3943,3944],{"class":45,"line":614},[43,3945,3946],{"class":57},"                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n",[43,3948,3949,3952],{"class":45,"line":624},[43,3950,3951],{"class":57},"                          updated_at=EXCLUDED.updated_at; ",[43,3953,3887],{"class":53},[43,3955,3956],{"class":45,"line":633},[43,3957,3958],{"class":53},"                      \"\"\"\n",[43,3960,3961],{"class":45,"line":643},[43,3962,244],{"emptyLinePlaceholder":243},[43,3964,3965,3968,3970],{"class":45,"line":650},[43,3966,3967],{"class":1277},"SQL_INSERT_VARIANTS ",[43,3969,1570],{"class":53},[43,3971,3833],{"class":53},[43,3973,3974],{"class":45,"line":661},[43,3975,3976],{"class":57},"                      INSERT INTO product_variants\n",[43,3978,3979],{"class":45,"line":669},[43,3980,3981],{"class":57},"                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n",[43,3983,3984],{"class":45,"line":679},[43,3985,3986],{"class":57},"                       stock_quantity, is_active, created_at, updated_at)\n",[43,3988,3989,3991,3993,3995,3997,3999,4001,4003,4005,4007,4009,4011,4013,4015,4017,4019,4021,4023,4025,4027,4029],{"class":45,"line":687},[43,3990,3915],{"class":57},[43,3992,3846],{"class":148},[43,3994,2197],{"class":57},[43,3996,3846],{"class":148},[43,3998,2197],{"class":57},[43,4000,3846],{"class":148},[43,4002,2197],{"class":57},[43,4004,3846],{"class":148},[43,4006,2197],{"class":57},[43,4008,3846],{"class":148},[43,4010,2197],{"class":57},[43,4012,3846],{"class":148},[43,4014,2197],{"class":57},[43,4016,3846],{"class":148},[43,4018,2197],{"class":57},[43,4020,3846],{"class":148},[43,4022,2197],{"class":57},[43,4024,3846],{"class":148},[43,4026,2197],{"class":57},[43,4028,3846],{"class":148},[43,4030,4031],{"class":57},") ON CONFLICT (variant_sku) DO\n",[43,4033,4034],{"class":45,"line":695},[43,4035,3941],{"class":57},[43,4037,4038],{"class":45,"line":702},[43,4039,4040],{"class":57},"                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n",[43,4042,4043],{"class":45,"line":709},[43,4044,4045],{"class":57},"                          manufacturing_price=EXCLUDED.manufacturing_price,\n",[43,4047,4048],{"class":45,"line":719},[43,4049,4050],{"class":57},"                          selling_price=EXCLUDED.selling_price,\n",[43,4052,4053],{"class":45,"line":728},[43,4054,4055],{"class":57},"                          stock_quantity=EXCLUDED.stock_quantity,\n",[43,4057,4058,4060],{"class":45,"line":735},[43,4059,3951],{"class":57},[43,4061,3887],{"class":53},[43,4063,4064],{"class":45,"line":746},[43,4065,3958],{"class":53},[43,4067,4068],{"class":45,"line":757},[43,4069,244],{"emptyLinePlaceholder":243},[43,4071,4072,4075,4077,4079,4082,4084,4087,4089,4092],{"class":45,"line":765},[43,4073,4074],{"class":1277},"SQL_DELETE_ORDERS_IN_WINDOW ",[43,4076,1570],{"class":53},[43,4078,299],{"class":53},[43,4080,4081],{"class":57},"DELETE FROM orders WHERE order_date BETWEEN ",[43,4083,3846],{"class":148},[43,4085,4086],{"class":57}," AND ",[43,4088,3846],{"class":148},[43,4090,4091],{"class":57},";",[43,4093,305],{"class":53},[43,4095,4096],{"class":45,"line":775},[43,4097,244],{"emptyLinePlaceholder":243},[43,4099,4100,4103,4105],{"class":45,"line":785},[43,4101,4102],{"class":1277},"SQL_INSERT_ORDERS ",[43,4104,1570],{"class":53},[43,4106,3833],{"class":53},[43,4108,4109],{"class":45,"line":792},[43,4110,4111],{"class":57},"                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n",[43,4113,4114,4117,4119,4121,4123,4125,4127,4129,4131,4133,4135,4137,4139,4142],{"class":45,"line":803},[43,4115,4116],{"class":57},"                    VALUES (",[43,4118,3846],{"class":148},[43,4120,2197],{"class":57},[43,4122,3846],{"class":148},[43,4124,2197],{"class":57},[43,4126,3846],{"class":148},[43,4128,2197],{"class":57},[43,4130,3846],{"class":148},[43,4132,2197],{"class":57},[43,4134,3846],{"class":148},[43,4136,2197],{"class":57},[43,4138,3846],{"class":148},[43,4140,4141],{"class":57},"); ",[43,4143,3887],{"class":53},[43,4145,4146],{"class":45,"line":811},[43,4147,4148],{"class":53},"                    \"\"\"\n",[43,4150,4151],{"class":45,"line":821},[43,4152,244],{"emptyLinePlaceholder":243},[43,4154,4155,4158,4160],{"class":45,"line":830},[43,4156,4157],{"class":1277},"SQL_INSERT_ORDER_ITEMS ",[43,4159,1570],{"class":53},[43,4161,3833],{"class":53},[43,4163,4164],{"class":45,"line":838},[43,4165,4166],{"class":57},"                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n",[43,4168,4169,4172,4174,4176,4178,4180,4182,4184,4186,4188,4190,4192],{"class":45,"line":848},[43,4170,4171],{"class":57},"                         VALUES (",[43,4173,3846],{"class":148},[43,4175,2197],{"class":57},[43,4177,3846],{"class":148},[43,4179,2197],{"class":57},[43,4181,3846],{"class":148},[43,4183,2197],{"class":57},[43,4185,3846],{"class":148},[43,4187,2197],{"class":57},[43,4189,3846],{"class":148},[43,4191,4141],{"class":57},[43,4193,3887],{"class":53},[43,4195,4196],{"class":45,"line":857},[43,4197,4198],{"class":53},"                         \"\"\"\n",[43,4200,4201],{"class":45,"line":865},[43,4202,244],{"emptyLinePlaceholder":243},[43,4204,4205,4208,4210],{"class":45,"line":875},[43,4206,4207],{"class":1277},"SQL_UPDATE_ORDER_TOTALS ",[43,4209,1570],{"class":53},[43,4211,3833],{"class":53},[43,4213,4214],{"class":45,"line":884},[43,4215,4216],{"class":57},"                          UPDATE orders o\n",[43,4218,4219],{"class":45,"line":891},[43,4220,4221],{"class":57},"                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n",[43,4223,4224],{"class":45,"line":903},[43,4225,4226],{"class":57},"  SELECT order_id, SUM(total_price) sum_total\n",[43,4228,4230],{"class":45,"line":4229},74,[43,4231,4232],{"class":57},"  FROM order_items GROUP BY order_id\n",[43,4234,4236],{"class":45,"line":4235},75,[43,4237,4238],{"class":57},") oi\n",[43,4240,4242],{"class":45,"line":4241},76,[43,4243,4244],{"class":57},"                          WHERE o.id = oi.order_id\n",[43,4246,4248,4251],{"class":45,"line":4247},77,[43,4249,4250],{"class":57},"                            AND o.order_date BETWEEN ",[43,4252,4253],{"class":148},"%s\n",[43,4255,4257,4260,4262,4265],{"class":45,"line":4256},78,[43,4258,4259],{"class":57},"                            AND ",[43,4261,3846],{"class":148},[43,4263,4264],{"class":57},"; ",[43,4266,3887],{"class":53},[43,4268,4270],{"class":45,"line":4269},79,[43,4271,4272],{"class":53},"                          \"\"\"\n",[43,4274,4276],{"class":45,"line":4275},80,[43,4277,244],{"emptyLinePlaceholder":243},[43,4279,4281,4284,4286],{"class":45,"line":4280},81,[43,4282,4283],{"class":1277},"SQL_STATS_COUNTS ",[43,4285,1570],{"class":53},[43,4287,4288],{"class":53}," {\n",[43,4290,4292,4295,4298,4300,4302,4304,4307,4309],{"class":45,"line":4291},82,[43,4293,4294],{"class":53},"    \"",[43,4296,4297],{"class":57},"customers",[43,4299,3566],{"class":53},[43,4301,54],{"class":53},[43,4303,299],{"class":53},[43,4305,4306],{"class":57},"SELECT COUNT(*) FROM customers",[43,4308,3566],{"class":53},[43,4310,2316],{"class":53},[43,4312,4314,4316,4319,4321,4323,4325,4328,4330],{"class":45,"line":4313},83,[43,4315,4294],{"class":53},[43,4317,4318],{"class":57},"products",[43,4320,3566],{"class":53},[43,4322,54],{"class":53},[43,4324,299],{"class":53},[43,4326,4327],{"class":57},"SELECT COUNT(*) FROM products",[43,4329,3566],{"class":53},[43,4331,2316],{"class":53},[43,4333,4335,4337,4340,4342,4344,4346,4349,4351],{"class":45,"line":4334},84,[43,4336,4294],{"class":53},[43,4338,4339],{"class":57},"variants",[43,4341,3566],{"class":53},[43,4343,54],{"class":53},[43,4345,299],{"class":53},[43,4347,4348],{"class":57},"SELECT COUNT(*) FROM product_variants",[43,4350,3566],{"class":53},[43,4352,2316],{"class":53},[43,4354,4356,4358,4361,4363,4365,4367,4370,4372,4374,4376,4378],{"class":45,"line":4355},85,[43,4357,4294],{"class":53},[43,4359,4360],{"class":57},"orders",[43,4362,3566],{"class":53},[43,4364,54],{"class":53},[43,4366,299],{"class":53},[43,4368,4369],{"class":57},"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN ",[43,4371,3846],{"class":148},[43,4373,4086],{"class":57},[43,4375,3846],{"class":148},[43,4377,3566],{"class":53},[43,4379,2316],{"class":53},[43,4381,4383,4385,4388,4390,4392],{"class":45,"line":4382},86,[43,4384,4294],{"class":53},[43,4386,4387],{"class":57},"items",[43,4389,3566],{"class":53},[43,4391,54],{"class":53},[43,4393,3833],{"class":53},[43,4395,4397],{"class":45,"line":4396},87,[43,4398,4399],{"class":57},"             SELECT COUNT(*)\n",[43,4401,4403],{"class":45,"line":4402},88,[43,4404,4405],{"class":57},"             FROM order_items oi\n",[43,4407,4409],{"class":45,"line":4408},89,[43,4410,4411],{"class":57},"                      JOIN orders o ON o.id = oi.order_id\n",[43,4413,4415,4418,4420,4422,4424],{"class":45,"line":4414},90,[43,4416,4417],{"class":57},"             WHERE o.order_date BETWEEN ",[43,4419,3846],{"class":148},[43,4421,4086],{"class":57},[43,4423,3846],{"class":148},[43,4425,1462],{"class":57},[43,4427,4429,4432],{"class":45,"line":4428},91,[43,4430,4431],{"class":53},"             \"\"\"",[43,4433,2316],{"class":53},[43,4435,4437],{"class":45,"line":4436},92,[43,4438,4439],{"class":53},"}\n",[43,4441,4443],{"class":45,"line":4442},93,[43,4444,244],{"emptyLinePlaceholder":243},[43,4446,4448,4451,4453],{"class":45,"line":4447},94,[43,4449,4450],{"class":1277},"SQL_CHAOS_VALIDATION ",[43,4452,1570],{"class":53},[43,4454,3833],{"class":53},[43,4456,4458],{"class":45,"line":4457},95,[43,4459,4460],{"class":57},"                       SELECT p.category,\n",[43,4462,4464],{"class":45,"line":4463},96,[43,4465,4466],{"class":57},"                              SUM(CASE\n",[43,4468,4470],{"class":45,"line":4469},97,[43,4471,4472],{"class":57},"                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n",[43,4474,4476],{"class":45,"line":4475},98,[43,4477,4478],{"class":57},"                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n",[43,4480,4482],{"class":45,"line":4481},99,[43,4483,4484],{"class":57},"                                          THEN 1\n",[43,4486,4488],{"class":45,"line":4487},100,[43,4489,4490],{"class":57},"                                      ELSE 0 END) invalid\n",[43,4492,4494],{"class":45,"line":4493},101,[43,4495,4496],{"class":57},"                       FROM product_variants v\n",[43,4498,4500],{"class":45,"line":4499},102,[43,4501,4502],{"class":57},"                                JOIN products p ON p.id = v.product_id\n",[43,4504,4506],{"class":45,"line":4505},103,[43,4507,4508],{"class":57},"                       GROUP BY 1\n",[43,4510,4512,4515],{"class":45,"line":4511},104,[43,4513,4514],{"class":57},"                       ORDER BY 1; ",[43,4516,3887],{"class":53},[43,4518,4520],{"class":45,"line":4519},105,[43,4521,3892],{"class":53},[43,4523,4525],{"class":45,"line":4524},106,[43,4526,244],{"emptyLinePlaceholder":243},[43,4528,4530],{"class":45,"line":4529},107,[43,4531,244],{"emptyLinePlaceholder":243},[43,4533,4535,4538,4541],{"class":45,"line":4534},108,[43,4536,4537],{"class":1871},"def",[43,4539,4540],{"class":1418}," parse_args",[43,4542,4543],{"class":53},"():\n",[43,4545,4547,4550,4552,4554,4557,4560,4562,4565,4567,4570],{"class":45,"line":4546},109,[43,4548,4549],{"class":1277},"    now ",[43,4551,1570],{"class":53},[43,4553,3481],{"class":1277},[43,4555,4556],{"class":53},".",[43,4558,4559],{"class":1418},"now",[43,4561,1422],{"class":53},[43,4563,4564],{"class":1418},"timezone",[43,4566,4556],{"class":53},[43,4568,4569],{"class":49},"utc",[43,4571,1405],{"class":53},[43,4573,4575,4578,4580,4582,4584,4587,4589,4593,4595,4597,4599,4602,4604,4606,4608,4611,4613,4615,4617,4620,4622,4624],{"class":45,"line":4574},110,[43,4576,4577],{"class":1277},"    day_start ",[43,4579,1570],{"class":53},[43,4581,2395],{"class":1277},[43,4583,4556],{"class":53},[43,4585,4586],{"class":1418},"replace",[43,4588,1422],{"class":53},[43,4590,4592],{"class":4591},"sHdIc","hour",[43,4594,1570],{"class":53},[43,4596,1935],{"class":148},[43,4598,1598],{"class":53},[43,4600,4601],{"class":4591}," minute",[43,4603,1570],{"class":53},[43,4605,1935],{"class":148},[43,4607,1598],{"class":53},[43,4609,4610],{"class":4591}," second",[43,4612,1570],{"class":53},[43,4614,1935],{"class":148},[43,4616,1598],{"class":53},[43,4618,4619],{"class":4591}," microsecond",[43,4621,1570],{"class":53},[43,4623,1935],{"class":148},[43,4625,1405],{"class":53},[43,4627,4629,4632,4634,4636,4638,4640,4642,4644,4646,4649,4651,4653,4655,4658,4660,4662,4664,4666,4668,4670,4672,4675],{"class":45,"line":4628},111,[43,4630,4631],{"class":1277},"    day_end ",[43,4633,1570],{"class":53},[43,4635,2395],{"class":1277},[43,4637,4556],{"class":53},[43,4639,4586],{"class":1418},[43,4641,1422],{"class":53},[43,4643,4592],{"class":4591},[43,4645,1570],{"class":53},[43,4647,4648],{"class":148},"23",[43,4650,1598],{"class":53},[43,4652,4601],{"class":4591},[43,4654,1570],{"class":53},[43,4656,4657],{"class":148},"59",[43,4659,1598],{"class":53},[43,4661,4610],{"class":4591},[43,4663,1570],{"class":53},[43,4665,4657],{"class":148},[43,4667,1598],{"class":53},[43,4669,4619],{"class":4591},[43,4671,1570],{"class":53},[43,4673,4674],{"class":148},"999999",[43,4676,1405],{"class":53},[43,4678,4680],{"class":45,"line":4679},112,[43,4681,244],{"emptyLinePlaceholder":243},[43,4683,4685,4688,4690,4692,4694,4697,4699,4701,4703,4705,4708,4710],{"class":45,"line":4684},113,[43,4686,4687],{"class":1277},"    p ",[43,4689,1570],{"class":53},[43,4691,3463],{"class":1277},[43,4693,4556],{"class":53},[43,4695,4696],{"class":1418},"ArgumentParser",[43,4698,1422],{"class":53},[43,4700,1041],{"class":4591},[43,4702,1570],{"class":53},[43,4704,3566],{"class":53},[43,4706,4707],{"class":57},"Generate demo ecommerce data (idempotent).",[43,4709,3566],{"class":53},[43,4711,1405],{"class":53},[43,4713,4715,4718,4720,4723,4725,4727,4730,4732,4734,4737,4740,4743,4745,4747,4750,4752],{"class":45,"line":4714},114,[43,4716,4717],{"class":1277},"    p",[43,4719,4556],{"class":53},[43,4721,4722],{"class":1418},"add_argument",[43,4724,1422],{"class":53},[43,4726,3566],{"class":53},[43,4728,4729],{"class":57},"--dsn",[43,4731,3566],{"class":53},[43,4733,1598],{"class":53},[43,4735,4736],{"class":4591}," required",[43,4738,4739],{"class":53},"=True,",[43,4741,4742],{"class":4591}," help",[43,4744,1570],{"class":53},[43,4746,3566],{"class":53},[43,4748,4749],{"class":57},"PostgreSQL DSN",[43,4751,3566],{"class":53},[43,4753,1405],{"class":53},[43,4755,4757,4759,4761,4763,4765,4767,4770,4772,4774,4777,4779,4782,4784,4787,4789,4792],{"class":45,"line":4756},115,[43,4758,4717],{"class":1277},[43,4760,4556],{"class":53},[43,4762,4722],{"class":1418},[43,4764,1422],{"class":53},[43,4766,3566],{"class":53},[43,4768,4769],{"class":57},"--customers",[43,4771,3566],{"class":53},[43,4773,1598],{"class":53},[43,4775,4776],{"class":4591}," type",[43,4778,1570],{"class":53},[43,4780,4781],{"class":2063},"int",[43,4783,1598],{"class":53},[43,4785,4786],{"class":4591}," default",[43,4788,1570],{"class":53},[43,4790,4791],{"class":148},"100",[43,4793,1405],{"class":53},[43,4795,4797,4799,4801,4803,4805,4807,4810,4812,4814,4816,4818,4820,4822,4824,4826,4829],{"class":45,"line":4796},116,[43,4798,4717],{"class":1277},[43,4800,4556],{"class":53},[43,4802,4722],{"class":1418},[43,4804,1422],{"class":53},[43,4806,3566],{"class":53},[43,4808,4809],{"class":57},"--products",[43,4811,3566],{"class":53},[43,4813,1598],{"class":53},[43,4815,4776],{"class":4591},[43,4817,1570],{"class":53},[43,4819,4781],{"class":2063},[43,4821,1598],{"class":53},[43,4823,4786],{"class":4591},[43,4825,1570],{"class":53},[43,4827,4828],{"class":148},"50",[43,4830,1405],{"class":53},[43,4832,4834,4836,4838,4840,4842,4844,4847,4849,4851,4853,4855,4857,4859,4861,4863,4866],{"class":45,"line":4833},117,[43,4835,4717],{"class":1277},[43,4837,4556],{"class":53},[43,4839,4722],{"class":1418},[43,4841,1422],{"class":53},[43,4843,3566],{"class":53},[43,4845,4846],{"class":57},"--orders",[43,4848,3566],{"class":53},[43,4850,1598],{"class":53},[43,4852,4776],{"class":4591},[43,4854,1570],{"class":53},[43,4856,4781],{"class":2063},[43,4858,1598],{"class":53},[43,4860,4786],{"class":4591},[43,4862,1570],{"class":53},[43,4864,4865],{"class":148},"500",[43,4867,1405],{"class":53},[43,4869,4871,4873,4875,4877,4879,4881,4884,4886,4888,4890,4892,4894,4896,4898,4900,4903],{"class":45,"line":4870},118,[43,4872,4717],{"class":1277},[43,4874,4556],{"class":53},[43,4876,4722],{"class":1418},[43,4878,1422],{"class":53},[43,4880,3566],{"class":53},[43,4882,4883],{"class":57},"--max-items-per-order",[43,4885,3566],{"class":53},[43,4887,1598],{"class":53},[43,4889,4776],{"class":4591},[43,4891,1570],{"class":53},[43,4893,4781],{"class":2063},[43,4895,1598],{"class":53},[43,4897,4786],{"class":4591},[43,4899,1570],{"class":53},[43,4901,4902],{"class":148},"5",[43,4904,1405],{"class":53},[43,4906,4908,4910,4912,4914,4916,4918,4921,4923,4925,4927,4929,4932,4934,4936,4938,4941,4943,4945,4947,4949,4952,4955,4957],{"class":45,"line":4907},119,[43,4909,4717],{"class":1277},[43,4911,4556],{"class":53},[43,4913,4722],{"class":1418},[43,4915,1422],{"class":53},[43,4917,3566],{"class":53},[43,4919,4920],{"class":57},"--chaos-percent",[43,4922,3566],{"class":53},[43,4924,1598],{"class":53},[43,4926,4776],{"class":4591},[43,4928,1570],{"class":53},[43,4930,4931],{"class":2063},"float",[43,4933,1598],{"class":53},[43,4935,4786],{"class":4591},[43,4937,1570],{"class":53},[43,4939,4940],{"class":148},"0.0",[43,4942,1598],{"class":53},[43,4944,4742],{"class":4591},[43,4946,1570],{"class":53},[43,4948,3566],{"class":53},[43,4950,4951],{"class":148},"%%",[43,4953,4954],{"class":57}," of variants with invalid sizes",[43,4956,3566],{"class":53},[43,4958,1405],{"class":53},[43,4960,4962,4964,4966,4968,4970,4972,4975,4977,4979,4981,4983,4985,4987,4989,4991,4994,4996,4998,5000,5002,5005,5007],{"class":45,"line":4961},120,[43,4963,4717],{"class":1277},[43,4965,4556],{"class":53},[43,4967,4722],{"class":1418},[43,4969,1422],{"class":53},[43,4971,3566],{"class":53},[43,4973,4974],{"class":57},"--scale",[43,4976,3566],{"class":53},[43,4978,1598],{"class":53},[43,4980,4776],{"class":4591},[43,4982,1570],{"class":53},[43,4984,4781],{"class":2063},[43,4986,1598],{"class":53},[43,4988,4786],{"class":4591},[43,4990,1570],{"class":53},[43,4992,4993],{"class":148},"1",[43,4995,1598],{"class":53},[43,4997,4742],{"class":4591},[43,4999,1570],{"class":53},[43,5001,3566],{"class":53},[43,5003,5004],{"class":57},"Multiply base volumes",[43,5006,3566],{"class":53},[43,5008,1405],{"class":53},[43,5010,5012,5014,5016,5018,5020,5022,5025,5027,5029,5031,5033,5035,5037,5039,5041,5044,5046,5048,5050,5052,5055,5057],{"class":45,"line":5011},121,[43,5013,4717],{"class":1277},[43,5015,4556],{"class":53},[43,5017,4722],{"class":1418},[43,5019,1422],{"class":53},[43,5021,3566],{"class":53},[43,5023,5024],{"class":57},"--seed",[43,5026,3566],{"class":53},[43,5028,1598],{"class":53},[43,5030,4776],{"class":4591},[43,5032,1570],{"class":53},[43,5034,4781],{"class":2063},[43,5036,1598],{"class":53},[43,5038,4786],{"class":4591},[43,5040,1570],{"class":53},[43,5042,5043],{"class":148},"42",[43,5045,1598],{"class":53},[43,5047,4742],{"class":4591},[43,5049,1570],{"class":53},[43,5051,3566],{"class":53},[43,5053,5054],{"class":57},"Deterministic RNG seed",[43,5056,3566],{"class":53},[43,5058,1405],{"class":53},[43,5060,5062,5064,5066,5068,5070,5072,5075,5077,5079,5081,5083,5086,5088,5090,5092,5094,5097,5099],{"class":45,"line":5061},122,[43,5063,4717],{"class":1277},[43,5065,4556],{"class":53},[43,5067,4722],{"class":1418},[43,5069,1422],{"class":53},[43,5071,3566],{"class":53},[43,5073,5074],{"class":57},"--starting-at",[43,5076,3566],{"class":53},[43,5078,1598],{"class":53},[43,5080,4776],{"class":4591},[43,5082,1570],{"class":53},[43,5084,5085],{"class":2063},"str",[43,5087,1598],{"class":53},[43,5089,4742],{"class":4591},[43,5091,1570],{"class":53},[43,5093,3566],{"class":53},[43,5095,5096],{"class":57},"ISO start (e.g. 2024-01-01)",[43,5098,3566],{"class":53},[43,5100,1405],{"class":53},[43,5102,5104,5106,5108,5110,5112,5114,5117,5119,5121,5123,5125,5127,5129,5131,5133,5135,5138,5140],{"class":45,"line":5103},123,[43,5105,4717],{"class":1277},[43,5107,4556],{"class":53},[43,5109,4722],{"class":1418},[43,5111,1422],{"class":53},[43,5113,3566],{"class":53},[43,5115,5116],{"class":57},"--ending-at",[43,5118,3566],{"class":53},[43,5120,1598],{"class":53},[43,5122,4776],{"class":4591},[43,5124,1570],{"class":53},[43,5126,5085],{"class":2063},[43,5128,1598],{"class":53},[43,5130,4742],{"class":4591},[43,5132,1570],{"class":53},[43,5134,3566],{"class":53},[43,5136,5137],{"class":57},"ISO end (e.g. 2024-06-30)",[43,5139,3566],{"class":53},[43,5141,1405],{"class":53},[43,5143,5145],{"class":45,"line":5144},124,[43,5146,244],{"emptyLinePlaceholder":243},[43,5148,5150,5153,5155,5158,5160,5163],{"class":45,"line":5149},125,[43,5151,5152],{"class":1277},"    a ",[43,5154,1570],{"class":53},[43,5156,5157],{"class":1277}," p",[43,5159,4556],{"class":53},[43,5161,5162],{"class":1418},"parse_args",[43,5164,2416],{"class":53},[43,5166,5168,5171,5173,5176,5179,5182,5184,5186,5189,5192,5194,5197],{"class":45,"line":5167},126,[43,5169,5170],{"class":1277},"    a",[43,5172,4556],{"class":53},[43,5174,5175],{"class":49},"starting_at",[43,5177,5178],{"class":53}," =",[43,5180,5181],{"class":1277}," a",[43,5183,4556],{"class":53},[43,5185,5175],{"class":49},[43,5187,5188],{"class":53}," or",[43,5190,5191],{"class":1277}," day_start",[43,5193,4556],{"class":53},[43,5195,5196],{"class":1418},"isoformat",[43,5198,2416],{"class":53},[43,5200,5202,5204,5206,5209,5211,5213,5215,5217,5219,5222,5224,5226],{"class":45,"line":5201},127,[43,5203,5170],{"class":1277},[43,5205,4556],{"class":53},[43,5207,5208],{"class":49},"ending_at",[43,5210,5178],{"class":53},[43,5212,5181],{"class":1277},[43,5214,4556],{"class":53},[43,5216,5208],{"class":49},[43,5218,5188],{"class":53},[43,5220,5221],{"class":1277}," day_end",[43,5223,4556],{"class":53},[43,5225,5196],{"class":1418},[43,5227,2416],{"class":53},[43,5229,5231,5234],{"class":45,"line":5230},128,[43,5232,5233],{"class":3427},"    return",[43,5235,5236],{"class":1277}," a\n",[43,5238,5240],{"class":45,"line":5239},129,[43,5241,244],{"emptyLinePlaceholder":243},[43,5243,5245],{"class":45,"line":5244},130,[43,5246,244],{"emptyLinePlaceholder":243},[43,5248,5250,5252,5255,5257,5260],{"class":45,"line":5249},131,[43,5251,4537],{"class":1871},[43,5253,5254],{"class":1418}," iso",[43,5256,1422],{"class":53},[43,5258,5259],{"class":4591},"dt",[43,5261,5262],{"class":53},"):\n",[43,5264,5266,5268,5270,5272,5275,5277,5279,5282,5285,5287,5289,5291,5293],{"class":45,"line":5265},132,[43,5267,5233],{"class":3427},[43,5269,3481],{"class":1277},[43,5271,4556],{"class":53},[43,5273,5274],{"class":1418},"fromisoformat",[43,5276,1422],{"class":53},[43,5278,5259],{"class":1418},[43,5280,5281],{"class":53},").",[43,5283,5284],{"class":1418},"astimezone",[43,5286,1422],{"class":53},[43,5288,4564],{"class":1418},[43,5290,4556],{"class":53},[43,5292,4569],{"class":49},[43,5294,1405],{"class":53},[43,5296,5298],{"class":45,"line":5297},133,[43,5299,244],{"emptyLinePlaceholder":243},[43,5301,5303],{"class":45,"line":5302},134,[43,5304,244],{"emptyLinePlaceholder":243},[43,5306,5308,5310,5313,5315,5318,5320,5323],{"class":45,"line":5307},135,[43,5309,4537],{"class":1871},[43,5311,5312],{"class":1418}," rdate",[43,5314,1422],{"class":53},[43,5316,5317],{"class":4591},"s",[43,5319,1598],{"class":53},[43,5321,5322],{"class":4591}," e",[43,5324,5262],{"class":53},[43,5326,5328,5331,5334],{"class":45,"line":5327},136,[43,5329,5330],{"class":3427},"    \"\"\"",[43,5332,5333],{"class":1006},"Return random datetime between s and e.",[43,5335,3428],{"class":3427},[43,5337,5339,5341,5344,5347,5349,5351,5354,5356,5359,5361,5364,5366,5368,5370,5373,5376,5379,5382,5385,5387,5390],{"class":45,"line":5338},137,[43,5340,5233],{"class":3427},[43,5342,5343],{"class":1277}," s ",[43,5345,5346],{"class":53},"+",[43,5348,3486],{"class":1418},[43,5350,1422],{"class":53},[43,5352,5353],{"class":4591},"seconds",[43,5355,1570],{"class":53},[43,5357,5358],{"class":1418},"random",[43,5360,4556],{"class":53},[43,5362,5363],{"class":1418},"randint",[43,5365,1422],{"class":53},[43,5367,1935],{"class":148},[43,5369,1598],{"class":53},[43,5371,5372],{"class":2063}," int",[43,5374,5375],{"class":53},"((",[43,5377,5378],{"class":1418},"e ",[43,5380,5381],{"class":53},"-",[43,5383,5384],{"class":1418}," s",[43,5386,5281],{"class":53},[43,5388,5389],{"class":1418},"total_seconds",[43,5391,5392],{"class":53},"())))\n",[43,5394,5396],{"class":45,"line":5395},138,[43,5397,244],{"emptyLinePlaceholder":243},[43,5399,5401],{"class":45,"line":5400},139,[43,5402,244],{"emptyLinePlaceholder":243},[43,5404,5406,5408,5411,5413,5416,5418,5421,5423,5426],{"class":45,"line":5405},140,[43,5407,4537],{"class":1871},[43,5409,5410],{"class":1418}," execmany",[43,5412,1422],{"class":53},[43,5414,5415],{"class":4591},"conn",[43,5417,1598],{"class":53},[43,5419,5420],{"class":4591}," sql",[43,5422,1598],{"class":53},[43,5424,5425],{"class":4591}," rows",[43,5427,5262],{"class":53},[43,5429,5431,5434,5437,5439,5442,5444,5447,5450],{"class":45,"line":5430},141,[43,5432,5433],{"class":3427},"    with",[43,5435,5436],{"class":1277}," conn",[43,5438,4556],{"class":53},[43,5440,5441],{"class":1418},"cursor",[43,5443,2398],{"class":53},[43,5445,5446],{"class":3427}," as",[43,5448,5449],{"class":1277}," cur",[43,5451,67],{"class":53},[43,5453,5455,5458,5460,5463,5465,5467,5469,5471],{"class":45,"line":5454},142,[43,5456,5457],{"class":1277},"        cur",[43,5459,4556],{"class":53},[43,5461,5462],{"class":1418},"executemany",[43,5464,1422],{"class":53},[43,5466,1198],{"class":1418},[43,5468,1598],{"class":53},[43,5470,5425],{"class":1418},[43,5472,1405],{"class":53},[43,5474,5476,5479,5481,5484],{"class":45,"line":5475},143,[43,5477,5478],{"class":1277},"    conn",[43,5480,4556],{"class":53},[43,5482,5483],{"class":1418},"commit",[43,5485,2416],{"class":53},[43,5487,5489],{"class":45,"line":5488},144,[43,5490,244],{"emptyLinePlaceholder":243},[43,5492,5494,5496,5499,5501,5504],{"class":45,"line":5493},145,[43,5495,4537],{"class":1871},[43,5497,5498],{"class":1418}," gen_customers",[43,5500,1422],{"class":53},[43,5502,5503],{"class":4591},"n",[43,5505,5262],{"class":53},[43,5507,5509,5512,5515,5518,5521,5523,5525],{"class":45,"line":5508},146,[43,5510,5511],{"class":3427},"    for",[43,5513,5514],{"class":1277}," _ ",[43,5516,5517],{"class":3427},"in",[43,5519,5520],{"class":1418}," range",[43,5522,1422],{"class":53},[43,5524,5503],{"class":1418},[43,5526,5262],{"class":53},[43,5528,5530,5533],{"class":45,"line":5529},147,[43,5531,5532],{"class":3427},"        yield",[43,5534,1284],{"class":53},[43,5536,5538,5541,5543,5545],{"class":45,"line":5537},148,[43,5539,5540],{"class":1277},"            fake",[43,5542,4556],{"class":53},[43,5544,922],{"class":1418},[43,5546,5547],{"class":53},"(),\n",[43,5549,5551,5553,5555,5558,5560,5563],{"class":45,"line":5550},149,[43,5552,5540],{"class":1277},[43,5554,4556],{"class":53},[43,5556,5557],{"class":49},"unique",[43,5559,4556],{"class":53},[43,5561,5562],{"class":1418},"email",[43,5564,5547],{"class":53},[43,5566,5568,5570,5572,5575],{"class":45,"line":5567},150,[43,5569,5540],{"class":1277},[43,5571,4556],{"class":53},[43,5573,5574],{"class":1418},"country",[43,5576,5547],{"class":53},[43,5578,5580,5583,5585,5587,5589,5592,5594,5597],{"class":45,"line":5579},151,[43,5581,5582],{"class":1277},"            random",[43,5584,4556],{"class":53},[43,5586,5363],{"class":1418},[43,5588,1422],{"class":53},[43,5590,5591],{"class":148},"18",[43,5593,1598],{"class":53},[43,5595,5596],{"class":148}," 70",[43,5598,1612],{"class":53},[43,5600,5602,5605,5607,5609,5611,5613,5615,5617],{"class":45,"line":5601},152,[43,5603,5604],{"class":1277},"            datetime",[43,5606,4556],{"class":53},[43,5608,4559],{"class":1418},[43,5610,1422],{"class":53},[43,5612,4564],{"class":1418},[43,5614,4556],{"class":53},[43,5616,4569],{"class":49},[43,5618,1612],{"class":53},[43,5620,5622,5624,5626,5628,5630,5632,5634,5636],{"class":45,"line":5621},153,[43,5623,5604],{"class":1277},[43,5625,4556],{"class":53},[43,5627,4559],{"class":1418},[43,5629,1422],{"class":53},[43,5631,4564],{"class":1418},[43,5633,4556],{"class":53},[43,5635,4569],{"class":49},[43,5637,1612],{"class":53},[43,5639,5641],{"class":45,"line":5640},154,[43,5642,5643],{"class":53},"        )\n",[43,5645,5647],{"class":45,"line":5646},155,[43,5648,244],{"emptyLinePlaceholder":243},[43,5650,5652],{"class":45,"line":5651},156,[43,5653,244],{"emptyLinePlaceholder":243},[43,5655,5657,5659,5662,5664,5666],{"class":45,"line":5656},157,[43,5658,4537],{"class":1871},[43,5660,5661],{"class":1418}," gen_products",[43,5663,1422],{"class":53},[43,5665,5503],{"class":4591},[43,5667,5262],{"class":53},[43,5669,5671,5673,5675,5677,5679,5681,5683],{"class":45,"line":5670},158,[43,5672,5511],{"class":3427},[43,5674,5514],{"class":1277},[43,5676,5517],{"class":3427},[43,5678,5520],{"class":1418},[43,5680,1422],{"class":53},[43,5682,5503],{"class":1418},[43,5684,5262],{"class":53},[43,5686,5688,5691,5693,5696,5698,5701,5703,5706],{"class":45,"line":5687},159,[43,5689,5690],{"class":1277},"        cat ",[43,5692,1570],{"class":53},[43,5694,5695],{"class":1277}," random",[43,5697,4556],{"class":53},[43,5699,5700],{"class":1418},"choice",[43,5702,1422],{"class":53},[43,5704,5705],{"class":1418},"PRODUCT_CATEGORIES",[43,5707,1405],{"class":53},[43,5709,5711,5713],{"class":45,"line":5710},160,[43,5712,5532],{"class":3427},[43,5714,1284],{"class":53},[43,5716,5718,5721,5723,5726,5729,5731,5734,5737,5740,5742,5745,5748,5750,5752,5754],{"class":45,"line":5717},161,[43,5719,5720],{"class":1871},"            f",[43,5722,3566],{"class":57},[43,5724,5725],{"class":148},"{",[43,5727,5728],{"class":1277},"fake",[43,5730,4556],{"class":53},[43,5732,5733],{"class":1418},"word",[43,5735,5736],{"class":53},"().",[43,5738,5739],{"class":1418},"capitalize",[43,5741,2398],{"class":53},[43,5743,5744],{"class":148},"}",[43,5746,5747],{"class":148}," {",[43,5749,3276],{"class":1277},[43,5751,5744],{"class":148},[43,5753,3566],{"class":57},[43,5755,2316],{"class":53},[43,5757,5759,5762],{"class":45,"line":5758},162,[43,5760,5761],{"class":1277},"            cat",[43,5763,2316],{"class":53},[43,5765,5767,5769,5771,5773,5775,5778,5780,5782,5785,5787,5789,5792],{"class":45,"line":5766},163,[43,5768,5540],{"class":1277},[43,5770,4556],{"class":53},[43,5772,5557],{"class":49},[43,5774,4556],{"class":53},[43,5776,5777],{"class":1418},"bothify",[43,5779,1422],{"class":53},[43,5781,3566],{"class":53},[43,5783,5784],{"class":57},"SKU-####-??",[43,5786,3566],{"class":53},[43,5788,5281],{"class":53},[43,5790,5791],{"class":1418},"upper",[43,5793,5547],{"class":53},[43,5795,5797,5799,5801,5803,5805,5807,5809,5811],{"class":45,"line":5796},164,[43,5798,5604],{"class":1277},[43,5800,4556],{"class":53},[43,5802,4559],{"class":1418},[43,5804,1422],{"class":53},[43,5806,4564],{"class":1418},[43,5808,4556],{"class":53},[43,5810,4569],{"class":49},[43,5812,1612],{"class":53},[43,5814,5816,5818,5820,5822,5824,5826,5828,5830],{"class":45,"line":5815},165,[43,5817,5604],{"class":1277},[43,5819,4556],{"class":53},[43,5821,4559],{"class":1418},[43,5823,1422],{"class":53},[43,5825,4564],{"class":1418},[43,5827,4556],{"class":53},[43,5829,4569],{"class":49},[43,5831,1612],{"class":53},[43,5833,5835],{"class":45,"line":5834},166,[43,5836,5643],{"class":53},[43,5838,5840],{"class":45,"line":5839},167,[43,5841,244],{"emptyLinePlaceholder":243},[43,5843,5845],{"class":45,"line":5844},168,[43,5846,244],{"emptyLinePlaceholder":243},[43,5848,5850,5852,5855,5857,5860,5862,5865],{"class":45,"line":5849},169,[43,5851,4537],{"class":1871},[43,5853,5854],{"class":1418}," gen_variants",[43,5856,1422],{"class":53},[43,5858,5859],{"class":4591},"prod_rows",[43,5861,1598],{"class":53},[43,5863,5864],{"class":4591}," chaos",[43,5866,5262],{"class":53},[43,5868,5870,5872,5875,5877,5880,5882,5885],{"class":45,"line":5869},170,[43,5871,5511],{"class":3427},[43,5873,5874],{"class":1277}," pid",[43,5876,1598],{"class":53},[43,5878,5879],{"class":1277}," cat ",[43,5881,5517],{"class":3427},[43,5883,5884],{"class":1277}," prod_rows",[43,5886,67],{"class":53},[43,5888,5890,5893,5895,5897,5899,5901,5903,5905,5907,5909,5911,5913,5916],{"class":45,"line":5889},171,[43,5891,5892],{"class":3427},"        for",[43,5894,5514],{"class":1277},[43,5896,5517],{"class":3427},[43,5898,5520],{"class":1418},[43,5900,1422],{"class":53},[43,5902,5358],{"class":1418},[43,5904,4556],{"class":53},[43,5906,5363],{"class":1418},[43,5908,1422],{"class":53},[43,5910,4993],{"class":148},[43,5912,1598],{"class":53},[43,5914,5915],{"class":148}," 4",[43,5917,5918],{"class":53},")):\n",[43,5920,5922,5925,5927,5930,5932,5934,5936,5938,5940,5942,5945,5947,5949,5951],{"class":45,"line":5921},172,[43,5923,5924],{"class":1277},"            sku ",[43,5926,1570],{"class":53},[43,5928,5929],{"class":1277}," fake",[43,5931,4556],{"class":53},[43,5933,5557],{"class":49},[43,5935,4556],{"class":53},[43,5937,5777],{"class":1418},[43,5939,1422],{"class":53},[43,5941,3566],{"class":53},[43,5943,5944],{"class":57},"VAR-####-??",[43,5946,3566],{"class":53},[43,5948,5281],{"class":53},[43,5950,5791],{"class":1418},[43,5952,2416],{"class":53},[43,5954,5956,5959,5961,5963,5965,5967,5969,5972],{"class":45,"line":5955},173,[43,5957,5958],{"class":1277},"            color ",[43,5960,1570],{"class":53},[43,5962,5695],{"class":1277},[43,5964,4556],{"class":53},[43,5966,5700],{"class":1418},[43,5968,1422],{"class":53},[43,5970,5971],{"class":1418},"COLORS",[43,5973,1405],{"class":53},[43,5975,5977,5980,5982,5985,5987,5989,5991,5993,5995,5998,6001,6004,6006,6009,6011,6013,6015,6018,6020,6022,6024,6026,6029],{"class":45,"line":5976},174,[43,5978,5979],{"class":1277},"            size ",[43,5981,1570],{"class":53},[43,5983,5984],{"class":2063}," str",[43,5986,1422],{"class":53},[43,5988,5358],{"class":1418},[43,5990,4556],{"class":53},[43,5992,5700],{"class":1418},[43,5994,1422],{"class":53},[43,5996,5997],{"class":1418},"SIZES_SHOES",[43,5999,6000],{"class":53},"))",[43,6002,6003],{"class":3427}," if",[43,6005,5879],{"class":1277},[43,6007,6008],{"class":53},"==",[43,6010,299],{"class":53},[43,6012,3587],{"class":57},[43,6014,3566],{"class":53},[43,6016,6017],{"class":3427}," else",[43,6019,5695],{"class":1277},[43,6021,4556],{"class":53},[43,6023,5700],{"class":1418},[43,6025,1422],{"class":53},[43,6027,6028],{"class":1418},"SIZES_APPAREL",[43,6030,1405],{"class":53},[43,6032,6034],{"class":45,"line":6033},175,[43,6035,244],{"emptyLinePlaceholder":243},[43,6037,6039],{"class":45,"line":6038},176,[43,6040,6041],{"class":1006},"            # Chaos mode\n",[43,6043,6045,6048,6051,6054,6056,6059,6061,6063,6065,6067,6070,6072,6075,6077,6080],{"class":45,"line":6044},177,[43,6046,6047],{"class":3427},"            if",[43,6049,6050],{"class":1277}," chaos ",[43,6052,6053],{"class":53},">",[43,6055,1737],{"class":148},[43,6057,6058],{"class":53}," and",[43,6060,5695],{"class":1277},[43,6062,4556],{"class":53},[43,6064,5358],{"class":1418},[43,6066,2398],{"class":53},[43,6068,6069],{"class":53}," \u003C",[43,6071,1587],{"class":53},[43,6073,6074],{"class":1277},"chaos ",[43,6076,1751],{"class":53},[43,6078,6079],{"class":148}," 100",[43,6081,5262],{"class":53},[43,6083,6085,6088,6090,6092,6094,6096,6098],{"class":45,"line":6084},178,[43,6086,6087],{"class":3427},"                if",[43,6089,5879],{"class":1277},[43,6091,6008],{"class":53},[43,6093,299],{"class":53},[43,6095,3587],{"class":57},[43,6097,3566],{"class":53},[43,6099,67],{"class":53},[43,6101,6103,6106,6108,6110,6112,6114,6116,6118],{"class":45,"line":6102},179,[43,6104,6105],{"class":1277},"                    size ",[43,6107,1570],{"class":53},[43,6109,5695],{"class":1277},[43,6111,4556],{"class":53},[43,6113,5700],{"class":1418},[43,6115,1422],{"class":53},[43,6117,6028],{"class":1418},[43,6119,1405],{"class":53},[43,6121,6123,6126],{"class":45,"line":6122},180,[43,6124,6125],{"class":3427},"                else",[43,6127,67],{"class":53},[43,6129,6131,6133,6135,6137,6139,6141,6143,6145,6147,6149],{"class":45,"line":6130},181,[43,6132,6105],{"class":1277},[43,6134,1570],{"class":53},[43,6136,5984],{"class":2063},[43,6138,1422],{"class":53},[43,6140,5358],{"class":1418},[43,6142,4556],{"class":53},[43,6144,5700],{"class":1418},[43,6146,1422],{"class":53},[43,6148,5997],{"class":1418},[43,6150,6151],{"class":53},"))\n",[43,6153,6155],{"class":45,"line":6154},182,[43,6156,244],{"emptyLinePlaceholder":243},[43,6158,6160,6163,6165,6168,6170,6172,6174,6177,6179,6181,6183,6186,6189,6192],{"class":45,"line":6159},183,[43,6161,6162],{"class":1277},"            manuf ",[43,6164,1570],{"class":53},[43,6166,6167],{"class":1418}," round",[43,6169,1422],{"class":53},[43,6171,5358],{"class":1418},[43,6173,4556],{"class":53},[43,6175,6176],{"class":1418},"uniform",[43,6178,1422],{"class":53},[43,6180,2622],{"class":148},[43,6182,1598],{"class":53},[43,6184,6185],{"class":148}," 80",[43,6187,6188],{"class":53},"),",[43,6190,6191],{"class":148}," 2",[43,6193,1405],{"class":53},[43,6195,6197,6200,6202,6204,6206,6209,6211,6213,6215,6217,6219,6222,6224,6227,6229,6231],{"class":45,"line":6196},184,[43,6198,6199],{"class":1277},"            sell ",[43,6201,1570],{"class":53},[43,6203,6167],{"class":1418},[43,6205,1422],{"class":53},[43,6207,6208],{"class":1418},"manuf ",[43,6210,1425],{"class":53},[43,6212,5695],{"class":1418},[43,6214,4556],{"class":53},[43,6216,6176],{"class":1418},[43,6218,1422],{"class":53},[43,6220,6221],{"class":148},"1.2",[43,6223,1598],{"class":53},[43,6225,6226],{"class":148}," 2.0",[43,6228,6188],{"class":53},[43,6230,6191],{"class":148},[43,6232,1405],{"class":53},[43,6234,6236,6239],{"class":45,"line":6235},185,[43,6237,6238],{"class":3427},"            yield",[43,6240,1284],{"class":53},[43,6242,6244,6247,6249,6252,6254,6257,6259,6262,6264,6267,6269,6272],{"class":45,"line":6243},186,[43,6245,6246],{"class":1277},"                pid",[43,6248,1598],{"class":53},[43,6250,6251],{"class":1277}," sku",[43,6253,1598],{"class":53},[43,6255,6256],{"class":1277}," color",[43,6258,1598],{"class":53},[43,6260,6261],{"class":1277}," size",[43,6263,1598],{"class":53},[43,6265,6266],{"class":1277}," manuf",[43,6268,1598],{"class":53},[43,6270,6271],{"class":1277}," sell",[43,6273,2316],{"class":53},[43,6275,6277,6280,6282,6284,6286,6288,6290,6293,6295],{"class":45,"line":6276},187,[43,6278,6279],{"class":1277},"                random",[43,6281,4556],{"class":53},[43,6283,5363],{"class":1418},[43,6285,1422],{"class":53},[43,6287,1935],{"class":148},[43,6289,1598],{"class":53},[43,6291,6292],{"class":148}," 200",[43,6294,6188],{"class":53},[43,6296,6297],{"class":53}," True,\n",[43,6299,6301,6304,6306,6308,6310,6312,6314,6316,6318,6320,6322,6324,6326,6328,6330,6332],{"class":45,"line":6300},188,[43,6302,6303],{"class":1277},"                datetime",[43,6305,4556],{"class":53},[43,6307,4559],{"class":1418},[43,6309,1422],{"class":53},[43,6311,4564],{"class":1418},[43,6313,4556],{"class":53},[43,6315,4569],{"class":49},[43,6317,6188],{"class":53},[43,6319,3481],{"class":1277},[43,6321,4556],{"class":53},[43,6323,4559],{"class":1418},[43,6325,1422],{"class":53},[43,6327,4564],{"class":1418},[43,6329,4556],{"class":53},[43,6331,4569],{"class":49},[43,6333,1612],{"class":53},[43,6335,6337],{"class":45,"line":6336},189,[43,6338,6339],{"class":53},"            )\n",[43,6341,6343],{"class":45,"line":6342},190,[43,6344,244],{"emptyLinePlaceholder":243},[43,6346,6348],{"class":45,"line":6347},191,[43,6349,244],{"emptyLinePlaceholder":243},[43,6351,6353,6355,6358,6360,6363,6365,6368,6370,6372,6374,6376],{"class":45,"line":6352},192,[43,6354,4537],{"class":1871},[43,6356,6357],{"class":1418}," gen_orders",[43,6359,1422],{"class":53},[43,6361,6362],{"class":4591},"cust_ids",[43,6364,1598],{"class":53},[43,6366,6367],{"class":4591}," n",[43,6369,1598],{"class":53},[43,6371,5384],{"class":4591},[43,6373,1598],{"class":53},[43,6375,5322],{"class":4591},[43,6377,5262],{"class":53},[43,6379,6381,6383,6385,6387,6389,6391,6393],{"class":45,"line":6380},193,[43,6382,5511],{"class":3427},[43,6384,5514],{"class":1277},[43,6386,5517],{"class":3427},[43,6388,5520],{"class":1418},[43,6390,1422],{"class":53},[43,6392,5503],{"class":1418},[43,6394,5262],{"class":53},[43,6396,6398,6400,6402,6404,6406,6408,6410,6412,6414,6416,6418,6420,6422,6424,6426,6428,6430,6433,6435,6438,6440,6443,6446,6448,6451,6454],{"class":45,"line":6397},194,[43,6399,5532],{"class":3427},[43,6401,1587],{"class":53},[43,6403,5358],{"class":1277},[43,6405,4556],{"class":53},[43,6407,5700],{"class":1418},[43,6409,1422],{"class":53},[43,6411,6362],{"class":1418},[43,6413,6188],{"class":53},[43,6415,5312],{"class":1418},[43,6417,1422],{"class":53},[43,6419,5317],{"class":1418},[43,6421,1598],{"class":53},[43,6423,5322],{"class":1418},[43,6425,6188],{"class":53},[43,6427,5695],{"class":1277},[43,6429,4556],{"class":53},[43,6431,6432],{"class":1418},"choices",[43,6434,1422],{"class":53},[43,6436,6437],{"class":1418},"ORDER_STATUSES",[43,6439,1598],{"class":53},[43,6441,6442],{"class":1418}," ORDER_STATUS_WEIGHTS",[43,6444,6445],{"class":53},")[",[43,6447,1935],{"class":148},[43,6449,6450],{"class":53},"],",[43,6452,6453],{"class":148}," 0.0",[43,6455,2316],{"class":53},[43,6457,6459,6462,6464,6466,6468,6470,6472,6474,6476,6478,6480,6482,6484,6486,6488,6490],{"class":45,"line":6458},195,[43,6460,6461],{"class":1277},"               datetime",[43,6463,4556],{"class":53},[43,6465,4559],{"class":1418},[43,6467,1422],{"class":53},[43,6469,4564],{"class":1418},[43,6471,4556],{"class":53},[43,6473,4569],{"class":49},[43,6475,6188],{"class":53},[43,6477,3481],{"class":1277},[43,6479,4556],{"class":53},[43,6481,4559],{"class":1418},[43,6483,1422],{"class":53},[43,6485,4564],{"class":1418},[43,6487,4556],{"class":53},[43,6489,4569],{"class":49},[43,6491,6492],{"class":53},"),)\n",[43,6494,6496],{"class":45,"line":6495},196,[43,6497,244],{"emptyLinePlaceholder":243},[43,6499,6501],{"class":45,"line":6500},197,[43,6502,244],{"emptyLinePlaceholder":243},[43,6504,6506,6508,6511,6513,6516,6518,6521,6523,6526],{"class":45,"line":6505},198,[43,6507,4537],{"class":1871},[43,6509,6510],{"class":1418}," gen_items",[43,6512,1422],{"class":53},[43,6514,6515],{"class":4591},"order_ids",[43,6517,1598],{"class":53},[43,6519,6520],{"class":4591}," variant_ids",[43,6522,1598],{"class":53},[43,6524,6525],{"class":4591}," max_items",[43,6527,5262],{"class":53},[43,6529,6531,6533,6536,6538,6541],{"class":45,"line":6530},199,[43,6532,5511],{"class":3427},[43,6534,6535],{"class":1277}," oid ",[43,6537,5517],{"class":3427},[43,6539,6540],{"class":1277}," order_ids",[43,6542,67],{"class":53},[43,6544,6546,6548,6551,6553,6555,6557,6560,6562,6565,6567,6569,6571,6573,6575,6577,6579,6582,6584,6586,6588,6590],{"class":45,"line":6545},200,[43,6547,5892],{"class":3427},[43,6549,6550],{"class":1277}," vid ",[43,6552,5517],{"class":3427},[43,6554,5695],{"class":1277},[43,6556,4556],{"class":53},[43,6558,6559],{"class":1418},"sample",[43,6561,1422],{"class":53},[43,6563,6564],{"class":1418},"variant_ids",[43,6566,1598],{"class":53},[43,6568,5695],{"class":1418},[43,6570,4556],{"class":53},[43,6572,5363],{"class":1418},[43,6574,1422],{"class":53},[43,6576,4993],{"class":148},[43,6578,1598],{"class":53},[43,6580,6581],{"class":1418}," max",[43,6583,1422],{"class":53},[43,6585,4993],{"class":148},[43,6587,1598],{"class":53},[43,6589,6525],{"class":1418},[43,6591,6592],{"class":53},"))):\n",[43,6594,6596,6598,6600,6603,6605,6608,6610,6612,6614,6616,6618,6620,6622,6625,6627,6629,6631,6633,6635,6637,6639,6642,6644,6646,6648,6650,6652,6654,6656,6658,6660,6662,6664,6666],{"class":45,"line":6595},201,[43,6597,6238],{"class":3427},[43,6599,1587],{"class":53},[43,6601,6602],{"class":1277},"oid",[43,6604,1598],{"class":53},[43,6606,6607],{"class":1277}," vid",[43,6609,1598],{"class":53},[43,6611,5695],{"class":1277},[43,6613,4556],{"class":53},[43,6615,5363],{"class":1418},[43,6617,1422],{"class":53},[43,6619,4993],{"class":148},[43,6621,1598],{"class":53},[43,6623,6624],{"class":148}," 3",[43,6626,6188],{"class":53},[43,6628,6167],{"class":1418},[43,6630,1422],{"class":53},[43,6632,5358],{"class":1418},[43,6634,4556],{"class":53},[43,6636,6176],{"class":1418},[43,6638,1422],{"class":53},[43,6640,6641],{"class":148},"20",[43,6643,1598],{"class":53},[43,6645,6292],{"class":148},[43,6647,6188],{"class":53},[43,6649,6191],{"class":148},[43,6651,6188],{"class":53},[43,6653,3481],{"class":1277},[43,6655,4556],{"class":53},[43,6657,4559],{"class":1418},[43,6659,1422],{"class":53},[43,6661,4564],{"class":1418},[43,6663,4556],{"class":53},[43,6665,4569],{"class":49},[43,6667,6151],{"class":53},[43,6669,6671],{"class":45,"line":6670},202,[43,6672,244],{"emptyLinePlaceholder":243},[43,6674,6676],{"class":45,"line":6675},203,[43,6677,244],{"emptyLinePlaceholder":243},[43,6679,6681,6683,6686,6688,6690,6692,6695,6697,6700,6702,6705,6707,6710,6712,6715,6717,6720,6722,6724,6726,6729],{"class":45,"line":6680},204,[43,6682,4537],{"class":1871},[43,6684,6685],{"class":1418}," print_box_summary",[43,6687,1422],{"class":53},[43,6689,3677],{"class":4591},[43,6691,1598],{"class":53},[43,6693,6694],{"class":4591}," E",[43,6696,1598],{"class":53},[43,6698,6699],{"class":4591}," c_cnt",[43,6701,1598],{"class":53},[43,6703,6704],{"class":4591}," p_cnt",[43,6706,1598],{"class":53},[43,6708,6709],{"class":4591}," v_cnt",[43,6711,1598],{"class":53},[43,6713,6714],{"class":4591}," o_cnt",[43,6716,1598],{"class":53},[43,6718,6719],{"class":4591}," i_cnt",[43,6721,1598],{"class":53},[43,6723,6525],{"class":4591},[43,6725,1598],{"class":53},[43,6727,6728],{"class":4591}," bad_by_cat",[43,6730,5262],{"class":53},[43,6732,6734,6737,6739,6741,6744,6747,6749],{"class":45,"line":6733},205,[43,6735,6736],{"class":1418},"    print",[43,6738,1422],{"class":53},[43,6740,3566],{"class":53},[43,6742,6743],{"class":1277},"\\n",[43,6745,6746],{"class":57},"✅ Data generation complete (idempotent window load)",[43,6748,3566],{"class":53},[43,6750,1405],{"class":53},[43,6752,6754,6756,6758,6761,6764,6766,6768,6770,6772,6774,6776,6779,6781,6784,6786,6788,6790,6792,6794],{"class":45,"line":6753},206,[43,6755,6736],{"class":1418},[43,6757,1422],{"class":53},[43,6759,6760],{"class":1871},"f",[43,6762,6763],{"class":57},"\"Window: ",[43,6765,5725],{"class":148},[43,6767,3677],{"class":1418},[43,6769,4556],{"class":53},[43,6771,5196],{"class":1418},[43,6773,2398],{"class":53},[43,6775,5744],{"class":148},[43,6777,6778],{"class":57}," → ",[43,6780,5725],{"class":148},[43,6782,6783],{"class":1418},"E",[43,6785,4556],{"class":53},[43,6787,5196],{"class":1418},[43,6789,2398],{"class":53},[43,6791,5744],{"class":148},[43,6793,3566],{"class":57},[43,6795,1405],{"class":53},[43,6797,6799,6801,6803,6805,6808,6810,6813,6816,6818,6821,6823,6826,6828,6830,6833,6835,6838,6840,6842,6844],{"class":45,"line":6798},207,[43,6800,6736],{"class":1418},[43,6802,1422],{"class":53},[43,6804,6760],{"class":1871},[43,6806,6807],{"class":57},"\"Counts — Customers: ",[43,6809,5725],{"class":148},[43,6811,6812],{"class":1418},"c_cnt",[43,6814,6815],{"class":1871},":,",[43,6817,5744],{"class":148},[43,6819,6820],{"class":57}," | Products: ",[43,6822,5725],{"class":148},[43,6824,6825],{"class":1418},"p_cnt",[43,6827,6815],{"class":1871},[43,6829,5744],{"class":148},[43,6831,6832],{"class":57}," | Variants: ",[43,6834,5725],{"class":148},[43,6836,6837],{"class":1418},"v_cnt",[43,6839,6815],{"class":1871},[43,6841,5744],{"class":148},[43,6843,3566],{"class":57},[43,6845,1405],{"class":53},[43,6847,6849,6851,6853,6855,6858,6860,6863,6865,6867,6870,6872,6875,6877,6879,6882,6884,6887,6889,6891],{"class":45,"line":6848},208,[43,6850,6736],{"class":1418},[43,6852,1422],{"class":53},[43,6854,6760],{"class":1871},[43,6856,6857],{"class":57},"\"Window Facts — Orders: ",[43,6859,5725],{"class":148},[43,6861,6862],{"class":1418},"o_cnt",[43,6864,6815],{"class":1871},[43,6866,5744],{"class":148},[43,6868,6869],{"class":57}," | Items: ",[43,6871,5725],{"class":148},[43,6873,6874],{"class":1418},"i_cnt",[43,6876,6815],{"class":1871},[43,6878,5744],{"class":148},[43,6880,6881],{"class":57}," | MaxItems/Order: ",[43,6883,5725],{"class":148},[43,6885,6886],{"class":1418},"max_items",[43,6888,5744],{"class":148},[43,6890,3566],{"class":57},[43,6892,1405],{"class":53},[43,6894,6896,6898,6900,6902,6905,6907],{"class":45,"line":6895},209,[43,6897,6736],{"class":1418},[43,6899,1422],{"class":53},[43,6901,3566],{"class":53},[43,6903,6904],{"class":57},"Chaos check (invalid sizes per category):",[43,6906,3566],{"class":53},[43,6908,1405],{"class":53},[43,6910,6912,6914,6917,6919,6922,6924,6926],{"class":45,"line":6911},210,[43,6913,5511],{"class":3427},[43,6915,6916],{"class":1277}," cat",[43,6918,1598],{"class":53},[43,6920,6921],{"class":1277}," bad ",[43,6923,5517],{"class":3427},[43,6925,6728],{"class":1277},[43,6927,67],{"class":53},[43,6929,6931,6934,6936,6938,6941,6943,6945,6947,6950,6952,6955,6957,6959,6962],{"class":45,"line":6930},211,[43,6932,6933],{"class":1418},"        print",[43,6935,1422],{"class":53},[43,6937,6760],{"class":1871},[43,6939,6940],{"class":57},"\"  • ",[43,6942,5725],{"class":148},[43,6944,3276],{"class":1418},[43,6946,5744],{"class":148},[43,6948,6949],{"class":57},": ",[43,6951,5725],{"class":148},[43,6953,6954],{"class":1418},"bad",[43,6956,6815],{"class":1871},[43,6958,5744],{"class":148},[43,6960,6961],{"class":57}," invalid\"",[43,6963,1405],{"class":53},[43,6965,6967],{"class":45,"line":6966},212,[43,6968,244],{"emptyLinePlaceholder":243},[43,6970,6972],{"class":45,"line":6971},213,[43,6973,244],{"emptyLinePlaceholder":243},[43,6975,6977,6979,6982],{"class":45,"line":6976},214,[43,6978,4537],{"class":1871},[43,6980,6981],{"class":1418}," main",[43,6983,4543],{"class":53},[43,6985,6987,6990,6992,6994],{"class":45,"line":6986},215,[43,6988,6989],{"class":1277},"    args ",[43,6991,1570],{"class":53},[43,6993,4540],{"class":1418},[43,6995,2416],{"class":53},[43,6997,6999,7002,7004,7007,7009,7012,7014,7016],{"class":45,"line":6998},216,[43,7000,7001],{"class":1277},"    random",[43,7003,4556],{"class":53},[43,7005,7006],{"class":1418},"seed",[43,7008,1422],{"class":53},[43,7010,7011],{"class":1418},"args",[43,7013,4556],{"class":53},[43,7015,7006],{"class":49},[43,7017,1405],{"class":53},[43,7019,7021,7024,7026,7028,7030,7032,7034,7036],{"class":45,"line":7020},217,[43,7022,7023],{"class":1277},"    Faker",[43,7025,4556],{"class":53},[43,7027,7006],{"class":1418},[43,7029,1422],{"class":53},[43,7031,7011],{"class":1418},[43,7033,4556],{"class":53},[43,7035,7006],{"class":49},[43,7037,1405],{"class":53},[43,7039,7041,7044,7046,7049,7051,7053,7055,7057,7059,7061,7063,7065,7067,7069,7071,7073],{"class":45,"line":7040},218,[43,7042,7043],{"class":1277},"    S",[43,7045,1598],{"class":53},[43,7047,7048],{"class":1277}," E ",[43,7050,1570],{"class":53},[43,7052,5254],{"class":1418},[43,7054,1422],{"class":53},[43,7056,7011],{"class":1418},[43,7058,4556],{"class":53},[43,7060,5175],{"class":49},[43,7062,6188],{"class":53},[43,7064,5254],{"class":1418},[43,7066,1422],{"class":53},[43,7068,7011],{"class":1418},[43,7070,4556],{"class":53},[43,7072,5208],{"class":49},[43,7074,1405],{"class":53},[43,7076,7078],{"class":45,"line":7077},219,[43,7079,244],{"emptyLinePlaceholder":243},[43,7081,7083,7085,7087,7089,7091,7094,7096],{"class":45,"line":7082},220,[43,7084,6736],{"class":1418},[43,7086,1422],{"class":53},[43,7088,3566],{"class":53},[43,7090,6743],{"class":1277},[43,7092,7093],{"class":57},"=== Generating E-commerce Demo Data ===",[43,7095,3566],{"class":53},[43,7097,1405],{"class":53},[43,7099,7101,7103,7105,7107,7109,7111,7113,7115,7117,7119,7121,7123,7125,7127,7129,7131,7133,7135,7137],{"class":45,"line":7100},221,[43,7102,6736],{"class":1418},[43,7104,1422],{"class":53},[43,7106,6760],{"class":1871},[43,7108,6763],{"class":57},[43,7110,5725],{"class":148},[43,7112,3677],{"class":1418},[43,7114,4556],{"class":53},[43,7116,5196],{"class":1418},[43,7118,2398],{"class":53},[43,7120,5744],{"class":148},[43,7122,6778],{"class":57},[43,7124,5725],{"class":148},[43,7126,6783],{"class":1418},[43,7128,4556],{"class":53},[43,7130,5196],{"class":1418},[43,7132,2398],{"class":53},[43,7134,5744],{"class":148},[43,7136,3566],{"class":57},[43,7138,1405],{"class":53},[43,7140,7142,7144,7146,7148,7151,7153,7155,7157,7160,7162,7165,7167,7169,7171,7173,7175,7178,7180,7182,7184,7187,7190,7192,7195,7197,7199],{"class":45,"line":7141},222,[43,7143,6736],{"class":1418},[43,7145,1422],{"class":53},[43,7147,6760],{"class":1871},[43,7149,7150],{"class":57},"\"Scale x",[43,7152,5725],{"class":148},[43,7154,7011],{"class":1418},[43,7156,4556],{"class":53},[43,7158,7159],{"class":49},"scale",[43,7161,5744],{"class":148},[43,7163,7164],{"class":57}," | Seed ",[43,7166,5725],{"class":148},[43,7168,7011],{"class":1418},[43,7170,4556],{"class":53},[43,7172,7006],{"class":49},[43,7174,5744],{"class":148},[43,7176,7177],{"class":57}," | Chaos ",[43,7179,5725],{"class":148},[43,7181,7011],{"class":1418},[43,7183,4556],{"class":53},[43,7185,7186],{"class":49},"chaos_percent",[43,7188,7189],{"class":1871},":.1f",[43,7191,5744],{"class":148},[43,7193,7194],{"class":57},"%",[43,7196,6743],{"class":1277},[43,7198,3566],{"class":57},[43,7200,1405],{"class":53},[43,7202,7204],{"class":45,"line":7203},223,[43,7205,244],{"emptyLinePlaceholder":243},[43,7207,7209,7212,7214,7217,7219,7222,7224,7227,7229,7231,7233,7235,7237,7239,7241,7243,7245],{"class":45,"line":7208},224,[43,7210,7211],{"class":1277},"    base_c",[43,7213,1598],{"class":53},[43,7215,7216],{"class":1277}," base_p",[43,7218,1598],{"class":53},[43,7220,7221],{"class":1277}," base_o ",[43,7223,1570],{"class":53},[43,7225,7226],{"class":1277}," args",[43,7228,4556],{"class":53},[43,7230,4297],{"class":49},[43,7232,1598],{"class":53},[43,7234,7226],{"class":1277},[43,7236,4556],{"class":53},[43,7238,4318],{"class":49},[43,7240,1598],{"class":53},[43,7242,7226],{"class":1277},[43,7244,4556],{"class":53},[43,7246,7247],{"class":49},"orders\n",[43,7249,7251,7254,7256,7259,7261,7264,7266,7269,7271,7273,7275,7277,7279,7282,7284,7286,7288,7290,7292,7294,7296,7298,7300],{"class":45,"line":7250},225,[43,7252,7253],{"class":1277},"    n_c",[43,7255,1598],{"class":53},[43,7257,7258],{"class":1277}," n_p",[43,7260,1598],{"class":53},[43,7262,7263],{"class":1277}," n_o ",[43,7265,1570],{"class":53},[43,7267,7268],{"class":1277}," base_c ",[43,7270,1425],{"class":53},[43,7272,7226],{"class":1277},[43,7274,4556],{"class":53},[43,7276,7159],{"class":49},[43,7278,1598],{"class":53},[43,7280,7281],{"class":1277}," base_p ",[43,7283,1425],{"class":53},[43,7285,7226],{"class":1277},[43,7287,4556],{"class":53},[43,7289,7159],{"class":49},[43,7291,1598],{"class":53},[43,7293,7221],{"class":1277},[43,7295,1425],{"class":53},[43,7297,7226],{"class":1277},[43,7299,4556],{"class":53},[43,7301,7302],{"class":49},"scale\n",[43,7304,7306],{"class":45,"line":7305},226,[43,7307,244],{"emptyLinePlaceholder":243},[43,7309,7311,7313,7316,7318,7321,7323,7325,7327,7330,7333,7335,7337],{"class":45,"line":7310},227,[43,7312,5433],{"class":3427},[43,7314,7315],{"class":1277}," psycopg",[43,7317,4556],{"class":53},[43,7319,7320],{"class":1418},"connect",[43,7322,1422],{"class":53},[43,7324,7011],{"class":1418},[43,7326,4556],{"class":53},[43,7328,7329],{"class":49},"dsn",[43,7331,7332],{"class":53},")",[43,7334,5446],{"class":3427},[43,7336,5436],{"class":1277},[43,7338,67],{"class":53},[43,7340,7342,7345,7347,7349,7351,7354,7356,7358,7360,7363],{"class":45,"line":7341},228,[43,7343,7344],{"class":1418},"        execmany",[43,7346,1422],{"class":53},[43,7348,5415],{"class":1418},[43,7350,1598],{"class":53},[43,7352,7353],{"class":1418}," SQL_INSERT_CUSTOMERS",[43,7355,1598],{"class":53},[43,7357,5498],{"class":1418},[43,7359,1422],{"class":53},[43,7361,7362],{"class":1418},"n_c",[43,7364,6151],{"class":53},[43,7366,7368,7370,7372,7374,7376,7379,7381,7383,7385,7388],{"class":45,"line":7367},229,[43,7369,7344],{"class":1418},[43,7371,1422],{"class":53},[43,7373,5415],{"class":1418},[43,7375,1598],{"class":53},[43,7377,7378],{"class":1418}," SQL_INSERT_PRODUCTS",[43,7380,1598],{"class":53},[43,7382,5661],{"class":1418},[43,7384,1422],{"class":53},[43,7386,7387],{"class":1418},"n_p",[43,7389,6151],{"class":53},[43,7391,7393],{"class":45,"line":7392},230,[43,7394,244],{"emptyLinePlaceholder":243},[43,7396,7398,7401,7403,7406,7408,7410,7412,7415,7417,7419,7422,7424],{"class":45,"line":7397},231,[43,7399,7400],{"class":1277},"        prod_rows ",[43,7402,1570],{"class":53},[43,7404,7405],{"class":2063}," list",[43,7407,1422],{"class":53},[43,7409,5415],{"class":1418},[43,7411,4556],{"class":53},[43,7413,7414],{"class":1418},"execute",[43,7416,1422],{"class":53},[43,7418,3566],{"class":53},[43,7420,7421],{"class":57},"SELECT id, category FROM products",[43,7423,3566],{"class":53},[43,7425,6151],{"class":53},[43,7427,7429,7431,7433,7435,7437,7440,7442,7444,7446,7448,7450,7452,7454,7456],{"class":45,"line":7428},232,[43,7430,7344],{"class":1418},[43,7432,1422],{"class":53},[43,7434,5415],{"class":1418},[43,7436,1598],{"class":53},[43,7438,7439],{"class":1418}," SQL_INSERT_VARIANTS",[43,7441,1598],{"class":53},[43,7443,5854],{"class":1418},[43,7445,1422],{"class":53},[43,7447,5859],{"class":1418},[43,7449,1598],{"class":53},[43,7451,7226],{"class":1418},[43,7453,4556],{"class":53},[43,7455,7186],{"class":49},[43,7457,6151],{"class":53},[43,7459,7461],{"class":45,"line":7460},233,[43,7462,244],{"emptyLinePlaceholder":243},[43,7464,7466,7469,7471,7473,7475,7477,7479,7481],{"class":45,"line":7465},234,[43,7467,7468],{"class":3427},"        with",[43,7470,5436],{"class":1277},[43,7472,4556],{"class":53},[43,7474,5441],{"class":1418},[43,7476,2398],{"class":53},[43,7478,5446],{"class":3427},[43,7480,5449],{"class":1277},[43,7482,67],{"class":53},[43,7484,7486,7489,7491,7493,7495,7498,7500,7502,7504,7506,7508],{"class":45,"line":7485},235,[43,7487,7488],{"class":1277},"            cur",[43,7490,4556],{"class":53},[43,7492,7414],{"class":1418},[43,7494,1422],{"class":53},[43,7496,7497],{"class":1418},"SQL_DELETE_ORDERS_IN_WINDOW",[43,7499,1598],{"class":53},[43,7501,1587],{"class":53},[43,7503,3677],{"class":1418},[43,7505,1598],{"class":53},[43,7507,6694],{"class":1418},[43,7509,6151],{"class":53},[43,7511,7513,7516,7518,7520],{"class":45,"line":7512},236,[43,7514,7515],{"class":1277},"        conn",[43,7517,4556],{"class":53},[43,7519,5483],{"class":1418},[43,7521,2416],{"class":53},[43,7523,7525],{"class":45,"line":7524},237,[43,7526,244],{"emptyLinePlaceholder":243},[43,7528,7530,7533,7535,7537,7540,7543,7545,7548,7551,7554,7556,7558,7560,7562,7564,7566,7569,7571],{"class":45,"line":7529},238,[43,7531,7532],{"class":1277},"        cust_ids ",[43,7534,1570],{"class":53},[43,7536,3563],{"class":53},[43,7538,7539],{"class":1277},"r",[43,7541,7542],{"class":53},"[",[43,7544,1935],{"class":148},[43,7546,7547],{"class":53},"]",[43,7549,7550],{"class":3427}," for",[43,7552,7553],{"class":1277}," r ",[43,7555,5517],{"class":3427},[43,7557,5436],{"class":1277},[43,7559,4556],{"class":53},[43,7561,7414],{"class":1418},[43,7563,1422],{"class":53},[43,7565,3566],{"class":53},[43,7567,7568],{"class":57},"SELECT id FROM customers",[43,7570,3566],{"class":53},[43,7572,7573],{"class":53},")]\n",[43,7575,7577,7579,7581,7583,7585,7588,7590,7592,7594,7596,7598,7601,7603,7606,7608,7610],{"class":45,"line":7576},239,[43,7578,7344],{"class":1418},[43,7580,1422],{"class":53},[43,7582,5415],{"class":1418},[43,7584,1598],{"class":53},[43,7586,7587],{"class":1418}," SQL_INSERT_ORDERS",[43,7589,1598],{"class":53},[43,7591,6357],{"class":1418},[43,7593,1422],{"class":53},[43,7595,6362],{"class":1418},[43,7597,1598],{"class":53},[43,7599,7600],{"class":1418}," n_o",[43,7602,1598],{"class":53},[43,7604,7605],{"class":1418}," S",[43,7607,1598],{"class":53},[43,7609,6694],{"class":1418},[43,7611,6151],{"class":53},[43,7613,7615],{"class":45,"line":7614},240,[43,7616,244],{"emptyLinePlaceholder":243},[43,7618,7620,7623,7625,7627,7629,7631,7633,7635,7637,7639,7641,7643,7645,7647,7649,7651,7654,7656,7658,7660,7662,7664,7666,7668,7670,7672],{"class":45,"line":7619},241,[43,7621,7622],{"class":1277},"        order_ids ",[43,7624,1570],{"class":53},[43,7626,3563],{"class":53},[43,7628,7539],{"class":1277},[43,7630,7542],{"class":53},[43,7632,1935],{"class":148},[43,7634,7547],{"class":53},[43,7636,7550],{"class":3427},[43,7638,7553],{"class":1277},[43,7640,5517],{"class":3427},[43,7642,5436],{"class":1277},[43,7644,4556],{"class":53},[43,7646,7414],{"class":1418},[43,7648,1422],{"class":53},[43,7650,3566],{"class":53},[43,7652,7653],{"class":57},"SELECT id FROM orders WHERE order_date BETWEEN ",[43,7655,3846],{"class":148},[43,7657,4086],{"class":57},[43,7659,3846],{"class":148},[43,7661,3566],{"class":53},[43,7663,1598],{"class":53},[43,7665,1587],{"class":53},[43,7667,3677],{"class":1418},[43,7669,1598],{"class":53},[43,7671,6694],{"class":1418},[43,7673,7674],{"class":53},"))]\n",[43,7676,7678,7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7712,7714],{"class":45,"line":7677},242,[43,7679,7680],{"class":1277},"        variant_ids ",[43,7682,1570],{"class":53},[43,7684,3563],{"class":53},[43,7686,7539],{"class":1277},[43,7688,7542],{"class":53},[43,7690,1935],{"class":148},[43,7692,7547],{"class":53},[43,7694,7550],{"class":3427},[43,7696,7553],{"class":1277},[43,7698,5517],{"class":3427},[43,7700,5436],{"class":1277},[43,7702,4556],{"class":53},[43,7704,7414],{"class":1418},[43,7706,1422],{"class":53},[43,7708,3566],{"class":53},[43,7710,7711],{"class":57},"SELECT id FROM product_variants",[43,7713,3566],{"class":53},[43,7715,7573],{"class":53},[43,7717,7719,7721,7723,7725,7727,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7751],{"class":45,"line":7718},243,[43,7720,7344],{"class":1418},[43,7722,1422],{"class":53},[43,7724,5415],{"class":1418},[43,7726,1598],{"class":53},[43,7728,7729],{"class":1418}," SQL_INSERT_ORDER_ITEMS",[43,7731,1598],{"class":53},[43,7733,6510],{"class":1418},[43,7735,1422],{"class":53},[43,7737,6515],{"class":1418},[43,7739,1598],{"class":53},[43,7741,6520],{"class":1418},[43,7743,1598],{"class":53},[43,7745,7226],{"class":1418},[43,7747,4556],{"class":53},[43,7749,7750],{"class":49},"max_items_per_order",[43,7752,6151],{"class":53},[43,7754,7756],{"class":45,"line":7755},244,[43,7757,244],{"emptyLinePlaceholder":243},[43,7759,7761,7763,7765,7767,7769,7771,7773,7775],{"class":45,"line":7760},245,[43,7762,7468],{"class":3427},[43,7764,5436],{"class":1277},[43,7766,4556],{"class":53},[43,7768,5441],{"class":1418},[43,7770,2398],{"class":53},[43,7772,5446],{"class":3427},[43,7774,5449],{"class":1277},[43,7776,67],{"class":53},[43,7778,7780,7782,7784,7786,7788,7791,7793,7795,7797,7799,7801],{"class":45,"line":7779},246,[43,7781,7488],{"class":1277},[43,7783,4556],{"class":53},[43,7785,7414],{"class":1418},[43,7787,1422],{"class":53},[43,7789,7790],{"class":1418},"SQL_UPDATE_ORDER_TOTALS",[43,7792,1598],{"class":53},[43,7794,1587],{"class":53},[43,7796,3677],{"class":1418},[43,7798,1598],{"class":53},[43,7800,6694],{"class":1418},[43,7802,6151],{"class":53},[43,7804,7806,7808,7810,7812],{"class":45,"line":7805},247,[43,7807,7515],{"class":1277},[43,7809,4556],{"class":53},[43,7811,5483],{"class":1418},[43,7813,2416],{"class":53},[43,7815,7817],{"class":45,"line":7816},248,[43,7818,244],{"emptyLinePlaceholder":243},[43,7820,7822,7824,7826,7828,7830,7832,7834,7836],{"class":45,"line":7821},249,[43,7823,7468],{"class":3427},[43,7825,5436],{"class":1277},[43,7827,4556],{"class":53},[43,7829,5441],{"class":1418},[43,7831,2398],{"class":53},[43,7833,5446],{"class":3427},[43,7835,5449],{"class":1277},[43,7837,67],{"class":53},[43,7839,7841,7843,7845,7847,7849,7852,7854,7856,7858,7860,7863],{"class":45,"line":7840},250,[43,7842,7488],{"class":1277},[43,7844,4556],{"class":53},[43,7846,7414],{"class":1418},[43,7848,1422],{"class":53},[43,7850,7851],{"class":1418},"SQL_STATS_COUNTS",[43,7853,7542],{"class":53},[43,7855,3566],{"class":53},[43,7857,4297],{"class":57},[43,7859,3566],{"class":53},[43,7861,7862],{"class":53},"])",[43,7864,1462],{"class":1277},[43,7866,7868,7871,7873,7875,7877,7880,7883,7885],{"class":45,"line":7867},251,[43,7869,7870],{"class":1277},"            c_cnt ",[43,7872,1570],{"class":53},[43,7874,5449],{"class":1277},[43,7876,4556],{"class":53},[43,7878,7879],{"class":1418},"fetchone",[43,7881,7882],{"class":53},"()[",[43,7884,1935],{"class":148},[43,7886,238],{"class":53},[43,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910],{"class":45,"line":7889},252,[43,7891,7488],{"class":1277},[43,7893,4556],{"class":53},[43,7895,7414],{"class":1418},[43,7897,1422],{"class":53},[43,7899,7851],{"class":1418},[43,7901,7542],{"class":53},[43,7903,3566],{"class":53},[43,7905,4318],{"class":57},[43,7907,3566],{"class":53},[43,7909,7862],{"class":53},[43,7911,1462],{"class":1277},[43,7913,7915,7918,7920,7922,7924,7926,7928,7930],{"class":45,"line":7914},253,[43,7916,7917],{"class":1277},"            p_cnt ",[43,7919,1570],{"class":53},[43,7921,5449],{"class":1277},[43,7923,4556],{"class":53},[43,7925,7879],{"class":1418},[43,7927,7882],{"class":53},[43,7929,1935],{"class":148},[43,7931,238],{"class":53},[43,7933,7935,7937,7939,7941,7943,7945,7947,7949,7951,7953,7955],{"class":45,"line":7934},254,[43,7936,7488],{"class":1277},[43,7938,4556],{"class":53},[43,7940,7414],{"class":1418},[43,7942,1422],{"class":53},[43,7944,7851],{"class":1418},[43,7946,7542],{"class":53},[43,7948,3566],{"class":53},[43,7950,4339],{"class":57},[43,7952,3566],{"class":53},[43,7954,7862],{"class":53},[43,7956,1462],{"class":1277},[43,7958,7960,7963,7965,7967,7969,7971,7973,7975],{"class":45,"line":7959},255,[43,7961,7962],{"class":1277},"            v_cnt ",[43,7964,1570],{"class":53},[43,7966,5449],{"class":1277},[43,7968,4556],{"class":53},[43,7970,7879],{"class":1418},[43,7972,7882],{"class":53},[43,7974,1935],{"class":148},[43,7976,238],{"class":53},[43,7978,7980,7982,7984,7986,7988,7990,7992,7994,7996,7998,8000,8002,8004,8006,8008,8010],{"class":45,"line":7979},256,[43,7981,7488],{"class":1277},[43,7983,4556],{"class":53},[43,7985,7414],{"class":1418},[43,7987,1422],{"class":53},[43,7989,7851],{"class":1418},[43,7991,7542],{"class":53},[43,7993,3566],{"class":53},[43,7995,4360],{"class":57},[43,7997,3566],{"class":53},[43,7999,6450],{"class":53},[43,8001,1587],{"class":53},[43,8003,3677],{"class":1418},[43,8005,1598],{"class":53},[43,8007,6694],{"class":1418},[43,8009,6000],{"class":53},[43,8011,1462],{"class":1277},[43,8013,8015,8018,8020,8022,8024,8026,8028,8030],{"class":45,"line":8014},257,[43,8016,8017],{"class":1277},"            o_cnt ",[43,8019,1570],{"class":53},[43,8021,5449],{"class":1277},[43,8023,4556],{"class":53},[43,8025,7879],{"class":1418},[43,8027,7882],{"class":53},[43,8029,1935],{"class":148},[43,8031,238],{"class":53},[43,8033,8035,8037,8039,8041,8043,8045,8047,8049,8051,8053,8055,8057,8059,8061,8063,8065],{"class":45,"line":8034},258,[43,8036,7488],{"class":1277},[43,8038,4556],{"class":53},[43,8040,7414],{"class":1418},[43,8042,1422],{"class":53},[43,8044,7851],{"class":1418},[43,8046,7542],{"class":53},[43,8048,3566],{"class":53},[43,8050,4387],{"class":57},[43,8052,3566],{"class":53},[43,8054,6450],{"class":53},[43,8056,1587],{"class":53},[43,8058,3677],{"class":1418},[43,8060,1598],{"class":53},[43,8062,6694],{"class":1418},[43,8064,6000],{"class":53},[43,8066,1462],{"class":1277},[43,8068,8070,8073,8075,8077,8079,8081,8083,8085],{"class":45,"line":8069},259,[43,8071,8072],{"class":1277},"            i_cnt ",[43,8074,1570],{"class":53},[43,8076,5449],{"class":1277},[43,8078,4556],{"class":53},[43,8080,7879],{"class":1418},[43,8082,7882],{"class":53},[43,8084,1935],{"class":148},[43,8086,238],{"class":53},[43,8088,8090,8092,8094,8096,8098,8101,8103],{"class":45,"line":8089},260,[43,8091,7488],{"class":1277},[43,8093,4556],{"class":53},[43,8095,7414],{"class":1418},[43,8097,1422],{"class":53},[43,8099,8100],{"class":1418},"SQL_CHAOS_VALIDATION",[43,8102,7332],{"class":53},[43,8104,1462],{"class":1277},[43,8106,8108,8111,8113,8115,8117,8120],{"class":45,"line":8107},261,[43,8109,8110],{"class":1277},"            bad_by_cat ",[43,8112,1570],{"class":53},[43,8114,5449],{"class":1277},[43,8116,4556],{"class":53},[43,8118,8119],{"class":1418},"fetchall",[43,8121,2416],{"class":53},[43,8123,8125],{"class":45,"line":8124},262,[43,8126,244],{"emptyLinePlaceholder":243},[43,8128,8130,8133,8135,8137,8139,8141,8143,8145,8147,8149,8151,8153,8155,8157,8159,8161,8163,8165,8167,8169,8171,8173],{"class":45,"line":8129},263,[43,8131,8132],{"class":1418},"    print_box_summary",[43,8134,1422],{"class":53},[43,8136,3677],{"class":1418},[43,8138,1598],{"class":53},[43,8140,6694],{"class":1418},[43,8142,1598],{"class":53},[43,8144,6699],{"class":1418},[43,8146,1598],{"class":53},[43,8148,6704],{"class":1418},[43,8150,1598],{"class":53},[43,8152,6709],{"class":1418},[43,8154,1598],{"class":53},[43,8156,6714],{"class":1418},[43,8158,1598],{"class":53},[43,8160,6719],{"class":1418},[43,8162,1598],{"class":53},[43,8164,7226],{"class":1418},[43,8166,4556],{"class":53},[43,8168,7750],{"class":49},[43,8170,1598],{"class":53},[43,8172,6728],{"class":1418},[43,8174,1405],{"class":53},[43,8176,8178],{"class":45,"line":8177},264,[43,8179,244],{"emptyLinePlaceholder":243},[43,8181,8183],{"class":45,"line":8182},265,[43,8184,244],{"emptyLinePlaceholder":243},[43,8186,8188,8191,8194,8196,8198,8201,8203],{"class":45,"line":8187},266,[43,8189,8190],{"class":3427},"if",[43,8192,8193],{"class":1277}," __name__ ",[43,8195,6008],{"class":53},[43,8197,299],{"class":53},[43,8199,8200],{"class":57},"__main__",[43,8202,3566],{"class":53},[43,8204,67],{"class":53},[43,8206,8208,8211],{"class":45,"line":8207},267,[43,8209,8210],{"class":1418},"    main",[43,8212,2416],{"class":53},[1992,8214,8215],{},"After that, let's run the script and see if everything works as expected:",[3260,8217,8218,8240,8254],{},[3263,8219,8220],{"icon":3265,"label":3266},[33,8221,8223],{"className":2054,"code":8222,"language":2056,"meta":38,"style":38},"uv run generate_data.py --dsn postgresql://postgres:postgres@localhost:5432/postgres\n",[40,8224,8225],{"__ignoreMap":38},[43,8226,8227,8229,8231,8234,8237],{"class":45,"line":46},[43,8228,2041],{"class":2063},[43,8230,3163],{"class":57},[43,8232,8233],{"class":57}," generate_data.py",[43,8235,8236],{"class":57}," --dsn",[43,8238,8239],{"class":57}," postgresql://postgres:postgres@localhost:5432/postgres\n",[3263,8241,8242],{"icon":3265,"label":3309},[33,8243,8245],{"className":2054,"code":8244,"language":2056,"meta":38,"style":38},"make generate-data \n",[40,8246,8247],{"__ignoreMap":38},[43,8248,8249,8251],{"class":45,"line":46},[43,8250,3252],{"class":2063},[43,8252,8253],{"class":57}," generate-data\n",[3263,8255,8256],{"icon":3324,"label":3325},[33,8257,8260],{"className":2054,"code":8258,"filename":8259,"language":2056,"meta":38,"style":38},"=== Generating E-commerce Demo Data ===\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nScale x1 | Seed 42 | Chaos 0.0%\n\n\n✅ Data generation complete\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nCounts — Customers: 100 | Products: 50 | Variants: 144\nWindow Facts — Orders: 500 | Items: 1,487 | MaxItems/Order: 5\nChaos check (invalid sizes per category):\n  • accessories: 0 invalid\n  • hoodies: 0 invalid\n  • jackets: 0 invalid\n  • shoes: 0 invalid\n  • t-shirts: 0 invalid\n","Bash Output",[40,8261,8262,8282,8296,8319,8323,8327,8340,8350,8379,8411,8433,8446,8457,8468,8479],{"__ignoreMap":38},[43,8263,8264,8267,8270,8273,8276,8279],{"class":45,"line":46},[43,8265,8266],{"class":57},"===",[43,8268,8269],{"class":57}," Generating",[43,8271,8272],{"class":57}," E-commerce",[43,8274,8275],{"class":57}," Demo",[43,8277,8278],{"class":57}," Data",[43,8280,8281],{"class":57}," ===\n",[43,8283,8284,8287,8290,8293],{"class":45,"line":61},[43,8285,8286],{"class":2063},"Window:",[43,8288,8289],{"class":57}," 2025-10-19T00:00:00+00:00",[43,8291,8292],{"class":57}," →",[43,8294,8295],{"class":57}," 2025-10-19T23:59:59.999999+00:00\n",[43,8297,8298,8301,8304,8306,8309,8311,8313,8316],{"class":45,"line":70},[43,8299,8300],{"class":2063},"Scale",[43,8302,8303],{"class":57}," x1",[43,8305,3282],{"class":53},[43,8307,8308],{"class":2063}," Seed",[43,8310,3735],{"class":148},[43,8312,3282],{"class":53},[43,8314,8315],{"class":2063}," Chaos",[43,8317,8318],{"class":57}," 0.0%\n",[43,8320,8321],{"class":45,"line":78},[43,8322,244],{"emptyLinePlaceholder":243},[43,8324,8325],{"class":45,"line":86},[43,8326,244],{"emptyLinePlaceholder":243},[43,8328,8329,8332,8334,8337],{"class":45,"line":94},[43,8330,8331],{"class":2063},"✅",[43,8333,8278],{"class":57},[43,8335,8336],{"class":57}," generation",[43,8338,8339],{"class":57}," complete\n",[43,8341,8342,8344,8346,8348],{"class":45,"line":108},[43,8343,8286],{"class":2063},[43,8345,8289],{"class":57},[43,8347,8292],{"class":57},[43,8349,8295],{"class":57},[43,8351,8352,8355,8358,8361,8363,8365,8368,8371,8373,8376],{"class":45,"line":119},[43,8353,8354],{"class":2063},"Counts",[43,8356,8357],{"class":57}," —",[43,8359,8360],{"class":57}," Customers:",[43,8362,6079],{"class":148},[43,8364,3282],{"class":53},[43,8366,8367],{"class":2063}," Products:",[43,8369,8370],{"class":148}," 50",[43,8372,3282],{"class":53},[43,8374,8375],{"class":2063}," Variants:",[43,8377,8378],{"class":148}," 144\n",[43,8380,8381,8384,8387,8389,8392,8395,8397,8400,8403,8405,8408],{"class":45,"line":129},[43,8382,8383],{"class":2063},"Window",[43,8385,8386],{"class":57}," Facts",[43,8388,8357],{"class":57},[43,8390,8391],{"class":57}," Orders:",[43,8393,8394],{"class":148}," 500",[43,8396,3282],{"class":53},[43,8398,8399],{"class":2063}," Items:",[43,8401,8402],{"class":57}," 1,487",[43,8404,3282],{"class":53},[43,8406,8407],{"class":2063}," MaxItems/Order:",[43,8409,8410],{"class":148}," 5\n",[43,8412,8413,8416,8419,8422,8425,8428,8431],{"class":45,"line":140},[43,8414,8415],{"class":2063},"Chaos",[43,8417,8418],{"class":57}," check",[43,8420,8421],{"class":1277}," (invalid ",[43,8423,8424],{"class":57},"sizes",[43,8426,8427],{"class":57}," per",[43,8429,8430],{"class":57}," category",[43,8432,5262],{"class":1277},[43,8434,8435,8438,8441,8443],{"class":45,"line":152},[43,8436,8437],{"class":2063},"  •",[43,8439,8440],{"class":57}," accessories:",[43,8442,1737],{"class":148},[43,8444,8445],{"class":57}," invalid\n",[43,8447,8448,8450,8453,8455],{"class":45,"line":162},[43,8449,8437],{"class":2063},[43,8451,8452],{"class":57}," hoodies:",[43,8454,1737],{"class":148},[43,8456,8445],{"class":57},[43,8458,8459,8461,8464,8466],{"class":45,"line":170},[43,8460,8437],{"class":2063},[43,8462,8463],{"class":57}," jackets:",[43,8465,1737],{"class":148},[43,8467,8445],{"class":57},[43,8469,8470,8472,8475,8477],{"class":45,"line":182},[43,8471,8437],{"class":2063},[43,8473,8474],{"class":57}," shoes:",[43,8476,1737],{"class":148},[43,8478,8445],{"class":57},[43,8480,8481,8483,8486,8488],{"class":45,"line":374},[43,8482,8437],{"class":2063},[43,8484,8485],{"class":57}," t-shirts:",[43,8487,1737],{"class":148},[43,8489,8445],{"class":57},[1992,8491,8492],{},"Cool! Now we're ready to start our Bruin Pipeline!",[8494,8495,8496,8500],"details",{},[8497,8498,8499],"summary",{},"Click to expand the Script Argument List",[2135,8501,8502,8518],{},[2138,8503,8504],{},[2141,8505,8506,8509,8512,8515],{},[2144,8507,8508],{},"Argument",[2144,8510,8511],{},"Type",[2144,8513,8514],{},"Default",[2144,8516,8517],{},"Description",[2151,8519,8520,8541,8558,8575,8592,8609,8630,8652],{},[2141,8521,8522,8526,8530,8535],{},[2156,8523,8524],{},[40,8525,4729],{},[2156,8527,8528],{},[40,8529,5085],{},[2156,8531,8532],{},[1977,8533,8534],{},"(required)",[2156,8536,8537,8538],{},"PostgreSQL connection string (DSN). Example: ",[40,8539,8540],{},"postgresql://user:pass@localhost:5432/ecommerce",[2141,8542,8543,8547,8551,8555],{},[2156,8544,8545],{},[40,8546,4769],{},[2156,8548,8549],{},[40,8550,4781],{},[2156,8552,8553],{},[40,8554,4791],{},[2156,8556,8557],{},"Number of customers to generate.",[2141,8559,8560,8564,8568,8572],{},[2156,8561,8562],{},[40,8563,4809],{},[2156,8565,8566],{},[40,8567,4781],{},[2156,8569,8570],{},[40,8571,4828],{},[2156,8573,8574],{},"Number of products to generate.",[2141,8576,8577,8581,8585,8589],{},[2156,8578,8579],{},[40,8580,4846],{},[2156,8582,8583],{},[40,8584,4781],{},[2156,8586,8587],{},[40,8588,4865],{},[2156,8590,8591],{},"Number of orders to generate.",[2141,8593,8594,8598,8602,8606],{},[2156,8595,8596],{},[40,8597,4883],{},[2156,8599,8600],{},[40,8601,4781],{},[2156,8603,8604],{},[40,8605,4902],{},[2156,8607,8608],{},"Maximum number of items per order. Each order will have 1–N items.",[2141,8610,8611,8615,8619,8623],{},[2156,8612,8613],{},[40,8614,4920],{},[2156,8616,8617],{},[40,8618,4931],{},[2156,8620,8621],{},[40,8622,4940],{},[2156,8624,8625,8626,8629],{},"Percentage of product variants that should have ",[1977,8627,8628],{},"invalid sizes"," (used for validation testing).",[2141,8631,8632,8636,8641,8646],{},[2156,8633,8634],{},[40,8635,5074],{},[2156,8637,8638],{},[40,8639,8640],{},"str (ISO date)",[2156,8642,8643],{},[1977,8644,8645],{},"Yesterday at 00:00 UTC",[2156,8647,8648,8649,4556],{},"Beginning of the generated data window. Example: ",[40,8650,8651],{},"2024-01-01",[2141,8653,8654,8658,8662,8667],{},[2156,8655,8656],{},[40,8657,5116],{},[2156,8659,8660],{},[40,8661,8640],{},[2156,8663,8664],{},[1977,8665,8666],{},"Today at 23:59 UTC",[2156,8668,8669,8670,4556],{},"End of the generated data window. Example: ",[40,8671,8672],{},"2024-06-30",[8674,8675,8676],"blockquote",{},[1992,8677,8678,8681,8682,8685],{},[1977,8679,8680],{},"Note:"," You can also run the script with the ",[40,8683,8684],{},"--help"," flag to see the available arguments.",[1973,8687,8689],{"id":8688},"_5-creating-the-bruin-pipeline","5) Creating the Bruin Pipeline",[1992,8691,8692],{},"We have everything structured to start ingesting data into our Bruin Pipeline. So, first, we must create the assets.",[1992,8694,8695],{},"But before that, let's understand the structure of the Bruin Pipeline.",[1992,8697,8698],{},"A pipeline can be created using the Bruin CLI tool:",[33,8700,8703],{"className":2054,"code":8701,"filename":8702,"language":2056,"meta":38,"style":38},"# Example Command\nbruin init default some-feature\n","Bruin CLI",[40,8704,8705,8710],{"__ignoreMap":38},[43,8706,8707],{"class":45,"line":46},[43,8708,8709],{"class":1006},"# Example Command\n",[43,8711,8712,8714,8716,8718],{"class":45,"line":61},[43,8713,2091],{"class":2063},[43,8715,2094],{"class":57},[43,8717,4786],{"class":57},[43,8719,8720],{"class":57}," some-feature\n",[1992,8722,8723],{},"and it will always generate the same structure, where:",[2028,8725,8726,8752,8774],{},[2031,8727,8728,8732],{},[1977,8729,8730],{},[40,8731,31],{},[2028,8733,8734,8737],{},[2031,8735,8736],{},"The main configuration file for your Bruin environment.",[2031,8738,8739,8740,8743,8744,8747,8748,8751],{},"Defines ",[1977,8741,8742],{},"global settings"," like default ",[1977,8745,8746],{},"connections",", variables, and ",[1977,8749,8750],{},"behavior"," for all pipelines.",[2031,8753,8754,8759],{},[1977,8755,8756],{},[40,8757,8758],{},"some-feature/pipeline.yml",[2028,8760,8761,8768,8771],{},[2031,8762,8763,8764,5281],{},"Defines a specific pipeline for a domain or project (in this example, ",[8765,8766,8767],"em",{},"ecommerce",[2031,8769,8770],{},"Describes the end-to-end data flow — which assets to run, their dependencies, and schedules.",[2031,8772,8773],{},"Pipelines are modular, so you can maintain separate ones for different business domains.",[2031,8775,8776,8781],{},[1977,8777,8778],{},[40,8779,8780],{},"some-feature/assets/*",[2028,8782,8783,8786,8789],{},[2031,8784,8785],{},"Contains all the assets — the building blocks of your data pipelines.",[2031,8787,8788],{},"Each asset handles a distinct task: ingesting raw data, transforming it, or generating analytical tables.",[2031,8790,8791,8792,8795],{},"Since every asset is a file, it’s ",[1977,8793,8794],{},"version-controlled, testable, and reusable"," — just like code.",[1992,8797,8798,8799,8802,8803,8806,8807,4556],{},"The important thing to remember is that Bruin will check all files nested inside the ",[40,8800,8801],{},"assets"," folder for filenames with suffix ",[40,8804,8805],{},".asset.yml",", which can be any type of asset ",[40,8808,8809],{},".asset.*",[1992,8811,8812],{},"So, doesn't matter how you organize your pipeline assets, by nesting folders. If you follows the convention proposed, Bruin will understand automagically!",[1973,8814,8816],{"id":8815},"_6-raw-ingestion-assets","6. Raw Ingestion Assets",[1992,8818,8819,8820,8823],{},"Using ",[40,8821,8822],{},"ingestr",", we're able to retrieve data from a source database and ingest it into destination database.",[1992,8825,8826,8827,8830,8831,8834],{},"At our case, the goal is to ingest all the data generated from ",[40,8828,8829],{},"PostgresSQL"," to ",[40,8832,8833],{},"DuckDB",", which will act as our analytical database.",[1992,8836,8837,8838,8840],{},"Let's take a look at our ",[40,8839,8801],{}," and configuration:",[29,8842,8843,8965,9013,9099,9170,9278,9361],{"default-value":1011},[33,8844,8846],{"className":35,"code":8845,"filename":31,"language":37,"meta":38,"style":38},"default_environment: default\nenvironments:\n  default:\n    connections:\n      postgres:\n        - name: pg-default\n          username: postgres\n          password: postgres\n          host: localhost\n          port: 5432\n          database: postgres\n      duckdb:\n        - name: duckdb-default\n          path: duckdb.db\n\n",[40,8847,8848,8856,8862,8869,8876,8883,8894,8903,8912,8921,8930,8939,8946,8956],{"__ignoreMap":38},[43,8849,8850,8852,8854],{"class":45,"line":46},[43,8851,50],{"class":49},[43,8853,54],{"class":53},[43,8855,58],{"class":57},[43,8857,8858,8860],{"class":45,"line":61},[43,8859,64],{"class":49},[43,8861,67],{"class":53},[43,8863,8864,8867],{"class":45,"line":70},[43,8865,8866],{"class":49},"  default",[43,8868,67],{"class":53},[43,8870,8871,8874],{"class":45,"line":78},[43,8872,8873],{"class":49},"    connections",[43,8875,67],{"class":53},[43,8877,8878,8881],{"class":45,"line":86},[43,8879,8880],{"class":49},"      postgres",[43,8882,67],{"class":53},[43,8884,8885,8888,8890,8892],{"class":45,"line":94},[43,8886,8887],{"class":53},"        -",[43,8889,100],{"class":49},[43,8891,54],{"class":53},[43,8893,105],{"class":57},[43,8895,8896,8899,8901],{"class":45,"line":108},[43,8897,8898],{"class":49},"          username",[43,8900,54],{"class":53},[43,8902,116],{"class":57},[43,8904,8905,8908,8910],{"class":45,"line":119},[43,8906,8907],{"class":49},"          password",[43,8909,54],{"class":53},[43,8911,116],{"class":57},[43,8913,8914,8917,8919],{"class":45,"line":129},[43,8915,8916],{"class":49},"          host",[43,8918,54],{"class":53},[43,8920,137],{"class":57},[43,8922,8923,8926,8928],{"class":45,"line":140},[43,8924,8925],{"class":49},"          port",[43,8927,54],{"class":53},[43,8929,149],{"class":148},[43,8931,8932,8935,8937],{"class":45,"line":152},[43,8933,8934],{"class":49},"          database",[43,8936,54],{"class":53},[43,8938,116],{"class":57},[43,8940,8941,8944],{"class":45,"line":162},[43,8942,8943],{"class":49},"      duckdb",[43,8945,67],{"class":53},[43,8947,8948,8950,8952,8954],{"class":45,"line":170},[43,8949,8887],{"class":53},[43,8951,100],{"class":49},[43,8953,54],{"class":53},[43,8955,179],{"class":57},[43,8957,8958,8961,8963],{"class":45,"line":182},[43,8959,8960],{"class":49},"          path",[43,8962,54],{"class":53},[43,8964,190],{"class":57},[33,8966,8968],{"className":35,"code":8967,"filename":915,"language":37,"meta":38,"style":38},"name: ecommerce_pg_to_duckdb\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\n",[40,8969,8970,8979,8983,8989,9001],{"__ignoreMap":38},[43,8971,8972,8974,8976],{"class":45,"line":46},[43,8973,922],{"class":49},[43,8975,54],{"class":53},[43,8977,8978],{"class":57}," ecommerce_pg_to_duckdb\n",[43,8980,8981],{"class":45,"line":61},[43,8982,244],{"emptyLinePlaceholder":243},[43,8984,8985,8987],{"class":45,"line":70},[43,8986,936],{"class":49},[43,8988,67],{"class":53},[43,8990,8991,8993,8995,8997,8999],{"class":45,"line":78},[43,8992,943],{"class":49},[43,8994,54],{"class":53},[43,8996,299],{"class":53},[43,8998,950],{"class":57},[43,9000,305],{"class":53},[43,9002,9003,9005,9007,9009,9011],{"class":45,"line":86},[43,9004,957],{"class":49},[43,9006,54],{"class":53},[43,9008,299],{"class":53},[43,9010,964],{"class":57},[43,9012,305],{"class":53},[33,9014,9015],{"className":35,"code":1010,"filename":1011,"language":37,"meta":38,"style":38},[40,9016,9017,9025,9033,9037,9045,9049,9055,9061,9065,9071,9079,9091],{"__ignoreMap":38},[43,9018,9019,9021,9023],{"class":45,"line":46},[43,9020,922],{"class":49},[43,9022,54],{"class":53},[43,9024,1022],{"class":57},[43,9026,9027,9029,9031],{"class":45,"line":61},[43,9028,1027],{"class":49},[43,9030,54],{"class":53},[43,9032,1032],{"class":57},[43,9034,9035],{"class":45,"line":70},[43,9036,244],{"emptyLinePlaceholder":243},[43,9038,9039,9041,9043],{"class":45,"line":78},[43,9040,1041],{"class":49},[43,9042,54],{"class":53},[43,9044,1046],{"class":57},[43,9046,9047],{"class":45,"line":86},[43,9048,244],{"emptyLinePlaceholder":243},[43,9050,9051,9053],{"class":45,"line":94},[43,9052,1055],{"class":49},[43,9054,67],{"class":53},[43,9056,9057,9059],{"class":45,"line":108},[43,9058,1062],{"class":53},[43,9060,1065],{"class":57},[43,9062,9063],{"class":45,"line":119},[43,9064,244],{"emptyLinePlaceholder":243},[43,9066,9067,9069],{"class":45,"line":129},[43,9068,1074],{"class":49},[43,9070,67],{"class":53},[43,9072,9073,9075,9077],{"class":45,"line":140},[43,9074,1081],{"class":49},[43,9076,54],{"class":53},[43,9078,105],{"class":57},[43,9080,9081,9083,9085,9087,9089],{"class":45,"line":152},[43,9082,1090],{"class":49},[43,9084,54],{"class":53},[43,9086,299],{"class":53},[43,9088,1097],{"class":57},[43,9090,305],{"class":53},[43,9092,9093,9095,9097],{"class":45,"line":162},[43,9094,1104],{"class":49},[43,9096,54],{"class":53},[43,9098,1109],{"class":57},[33,9100,9102],{"className":35,"code":9101,"filename":1113,"language":37,"meta":38,"style":38},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\ntags:\n  - raw\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n",[40,9103,9104,9112,9120,9128,9134,9140,9146,9154,9162],{"__ignoreMap":38},[43,9105,9106,9108,9110],{"class":45,"line":46},[43,9107,922],{"class":49},[43,9109,54],{"class":53},[43,9111,1124],{"class":57},[43,9113,9114,9116,9118],{"class":45,"line":61},[43,9115,1027],{"class":49},[43,9117,54],{"class":53},[43,9119,1032],{"class":57},[43,9121,9122,9124,9126],{"class":45,"line":70},[43,9123,1041],{"class":49},[43,9125,54],{"class":53},[43,9127,1141],{"class":57},[43,9129,9130,9132],{"class":45,"line":78},[43,9131,1055],{"class":49},[43,9133,67],{"class":53},[43,9135,9136,9138],{"class":45,"line":86},[43,9137,1062],{"class":53},[43,9139,1065],{"class":57},[43,9141,9142,9144],{"class":45,"line":94},[43,9143,1074],{"class":49},[43,9145,67],{"class":53},[43,9147,9148,9150,9152],{"class":45,"line":108},[43,9149,1104],{"class":49},[43,9151,54],{"class":53},[43,9153,1109],{"class":57},[43,9155,9156,9158,9160],{"class":45,"line":119},[43,9157,1081],{"class":49},[43,9159,54],{"class":53},[43,9161,105],{"class":57},[43,9163,9164,9166,9168],{"class":45,"line":129},[43,9165,1090],{"class":49},[43,9167,54],{"class":53},[43,9169,1192],{"class":57},[33,9171,9174],{"className":35,"code":9172,"filename":9173,"language":37,"meta":38,"style":38},"name: raw.order_items\ntype: ingestr\n\ndescription: Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\ndepends:\n  - raw.orders\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.order_items\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.order_items.asset.yml",[40,9175,9176,9185,9193,9197,9206,9210,9216,9222,9226,9233,9239,9243,9249,9257,9270],{"__ignoreMap":38},[43,9177,9178,9180,9182],{"class":45,"line":46},[43,9179,922],{"class":49},[43,9181,54],{"class":53},[43,9183,9184],{"class":57}," raw.order_items\n",[43,9186,9187,9189,9191],{"class":45,"line":61},[43,9188,1027],{"class":49},[43,9190,54],{"class":53},[43,9192,1032],{"class":57},[43,9194,9195],{"class":45,"line":70},[43,9196,244],{"emptyLinePlaceholder":243},[43,9198,9199,9201,9203],{"class":45,"line":78},[43,9200,1041],{"class":49},[43,9202,54],{"class":53},[43,9204,9205],{"class":57}," Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n",[43,9207,9208],{"class":45,"line":86},[43,9209,244],{"emptyLinePlaceholder":243},[43,9211,9212,9214],{"class":45,"line":94},[43,9213,1055],{"class":49},[43,9215,67],{"class":53},[43,9217,9218,9220],{"class":45,"line":108},[43,9219,1062],{"class":53},[43,9221,1065],{"class":57},[43,9223,9224],{"class":45,"line":119},[43,9225,244],{"emptyLinePlaceholder":243},[43,9227,9228,9231],{"class":45,"line":129},[43,9229,9230],{"class":49},"depends",[43,9232,67],{"class":53},[43,9234,9235,9237],{"class":45,"line":140},[43,9236,1062],{"class":53},[43,9238,1124],{"class":57},[43,9240,9241],{"class":45,"line":152},[43,9242,244],{"emptyLinePlaceholder":243},[43,9244,9245,9247],{"class":45,"line":162},[43,9246,1074],{"class":49},[43,9248,67],{"class":53},[43,9250,9251,9253,9255],{"class":45,"line":170},[43,9252,1081],{"class":49},[43,9254,54],{"class":53},[43,9256,105],{"class":57},[43,9258,9259,9261,9263,9265,9268],{"class":45,"line":182},[43,9260,1090],{"class":49},[43,9262,54],{"class":53},[43,9264,299],{"class":53},[43,9266,9267],{"class":57},"public.order_items",[43,9269,305],{"class":53},[43,9271,9272,9274,9276],{"class":45,"line":374},[43,9273,1104],{"class":49},[43,9275,54],{"class":53},[43,9277,1109],{"class":57},[33,9279,9282],{"className":35,"code":9280,"filename":9281,"language":37,"meta":38,"style":38},"name: raw.product_variants\ntype: ingestr\ndescription: Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.product_variants\n","orders-performance/assets/ingestion/raw.product_variants.asset.yml",[40,9283,9284,9293,9301,9310,9314,9320,9326,9330,9336,9344,9352],{"__ignoreMap":38},[43,9285,9286,9288,9290],{"class":45,"line":46},[43,9287,922],{"class":49},[43,9289,54],{"class":53},[43,9291,9292],{"class":57}," raw.product_variants\n",[43,9294,9295,9297,9299],{"class":45,"line":61},[43,9296,1027],{"class":49},[43,9298,54],{"class":53},[43,9300,1032],{"class":57},[43,9302,9303,9305,9307],{"class":45,"line":70},[43,9304,1041],{"class":49},[43,9306,54],{"class":53},[43,9308,9309],{"class":57}," Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n",[43,9311,9312],{"class":45,"line":78},[43,9313,244],{"emptyLinePlaceholder":243},[43,9315,9316,9318],{"class":45,"line":86},[43,9317,1055],{"class":49},[43,9319,67],{"class":53},[43,9321,9322,9324],{"class":45,"line":94},[43,9323,1062],{"class":53},[43,9325,1065],{"class":57},[43,9327,9328],{"class":45,"line":108},[43,9329,244],{"emptyLinePlaceholder":243},[43,9331,9332,9334],{"class":45,"line":119},[43,9333,1074],{"class":49},[43,9335,67],{"class":53},[43,9337,9338,9340,9342],{"class":45,"line":129},[43,9339,1104],{"class":49},[43,9341,54],{"class":53},[43,9343,1109],{"class":57},[43,9345,9346,9348,9350],{"class":45,"line":140},[43,9347,1081],{"class":49},[43,9349,54],{"class":53},[43,9351,105],{"class":57},[43,9353,9354,9356,9358],{"class":45,"line":152},[43,9355,1090],{"class":49},[43,9357,54],{"class":53},[43,9359,9360],{"class":57}," public.product_variants\n",[33,9362,9365],{"className":35,"code":9363,"filename":9364,"language":37,"meta":38,"style":38},"name: raw.products\ntype: ingestr\n\ntags:\n  - raw\n\ndescription: Ingest OLTP products from Postgres into DuckDB raw layer.\n\nparameters:\n  source_connection: pg-default\n  source_table: public.products\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.products.asset.yml",[40,9366,9367,9376,9384,9388,9394,9400,9404,9413,9417,9423,9431,9440],{"__ignoreMap":38},[43,9368,9369,9371,9373],{"class":45,"line":46},[43,9370,922],{"class":49},[43,9372,54],{"class":53},[43,9374,9375],{"class":57}," raw.products\n",[43,9377,9378,9380,9382],{"class":45,"line":61},[43,9379,1027],{"class":49},[43,9381,54],{"class":53},[43,9383,1032],{"class":57},[43,9385,9386],{"class":45,"line":70},[43,9387,244],{"emptyLinePlaceholder":243},[43,9389,9390,9392],{"class":45,"line":78},[43,9391,1055],{"class":49},[43,9393,67],{"class":53},[43,9395,9396,9398],{"class":45,"line":86},[43,9397,1062],{"class":53},[43,9399,1065],{"class":57},[43,9401,9402],{"class":45,"line":94},[43,9403,244],{"emptyLinePlaceholder":243},[43,9405,9406,9408,9410],{"class":45,"line":108},[43,9407,1041],{"class":49},[43,9409,54],{"class":53},[43,9411,9412],{"class":57}," Ingest OLTP products from Postgres into DuckDB raw layer.\n",[43,9414,9415],{"class":45,"line":119},[43,9416,244],{"emptyLinePlaceholder":243},[43,9418,9419,9421],{"class":45,"line":129},[43,9420,1074],{"class":49},[43,9422,67],{"class":53},[43,9424,9425,9427,9429],{"class":45,"line":140},[43,9426,1081],{"class":49},[43,9428,54],{"class":53},[43,9430,105],{"class":57},[43,9432,9433,9435,9437],{"class":45,"line":152},[43,9434,1090],{"class":49},[43,9436,54],{"class":53},[43,9438,9439],{"class":57}," public.products\n",[43,9441,9442,9444,9446],{"class":45,"line":162},[43,9443,1104],{"class":49},[43,9445,54],{"class":53},[43,9447,1109],{"class":57},[1992,9449,9450],{},"The pipeline could run everything concurrently, but we're going to run it in a sequential way by awaiting the dependencies to be processed/resolved.",[1992,9452,9453],{},"In Airflow or Dagster, you write DAGs in Python — describing explicitly how tasks depend on one another.\nBruin takes a declarative approach: dependencies are simply listed in YAML under the depends: key, and the system automatically resolves execution order and lineage.",[1992,9455,9456],{},"Unlike Airflow (which just schedules tasks) or dbt (which only supports SQL), Bruin allows you to define transformations in both SQL and Python — directly tied to your ingestion assets.",[2135,9458,9459,9469],{},[2138,9460,9461],{},[2141,9462,9463,9466],{},[2144,9464,9465],{},"Pipeline Layer",[2144,9467,9468],{},"Bruin Equivalent",[2151,9470,9471,9482,9490],{},[2141,9472,9473,9476],{},[2156,9474,9475],{},"Ingestion (Airbyte, Fivetran)",[2156,9477,9478,9481],{},[40,9479,9480],{},"type: ingestr"," assets",[2141,9483,9484,9487],{},[2156,9485,9486],{},"Transformation (dbt)",[2156,9488,9489],{},"assets (YML,SQL or Python)",[2141,9491,9492,9495],{},[2156,9493,9494],{},"Orchestration (Airflow, Dagster)",[2156,9496,9497,9498],{},"Implicit asset graph with ",[40,9499,9500],{},"depends:",[1992,9502,9503],{},"Now, let's see if our ingestion layer is working as expected. Using the Bruin CLI, you must run the following command:",[3260,9505,9506,9527],{},[3263,9507,9508],{"icon":3265,"label":3266},[33,9509,9511],{"className":2054,"code":9510,"language":2056,"meta":38,"style":38},"bruin run orders-performance --tag raw\n",[40,9512,9513],{"__ignoreMap":38},[43,9514,9515,9517,9519,9522,9525],{"class":45,"line":46},[43,9516,2091],{"class":2063},[43,9518,3163],{"class":57},[43,9520,9521],{"class":57}," orders-performance",[43,9523,9524],{"class":57}," --tag",[43,9526,1065],{"class":57},[3263,9528,9529],{"icon":3324,"label":3325},[33,9530,9532],{"className":2054,"code":9531,"language":2056,"meta":38,"style":38},"Analyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\nStarting the pipeline execution...\n\n[20:24:23] Running:  raw.products\n[20:24:23] Running:  raw.customers\n[20:24:23] Running:  raw.orders\n[20:24:23] Running:  raw.product_variants\n\n...[logs]...\n\nPASS raw.products \nPASS raw.customers \nPASS raw.orders \nPASS raw.order_items \nPASS raw.product_variants \n\nbruin run completed successfully in 16.704s\n\n ✓ Assets executed      5 succeeded\n",[40,9533,9534,9561,9565,9576,9587,9591,9620,9624,9638,9650,9654,9666,9677,9688,9699,9703,9714,9718,9729,9738,9747,9756,9765,9769,9787,9791],{"__ignoreMap":38},[43,9535,9536,9539,9542,9545,9547,9550,9552,9555,9558],{"class":45,"line":46},[43,9537,9538],{"class":2063},"Analyzed",[43,9540,9541],{"class":57}," the",[43,9543,9544],{"class":57}," pipeline",[43,9546,1312],{"class":53},[43,9548,9549],{"class":57},"orders_performance",[43,9551,1590],{"class":53},[43,9553,9554],{"class":57}," with",[43,9556,9557],{"class":148}," 15",[43,9559,9560],{"class":57}," assets.\n",[43,9562,9563],{"class":45,"line":61},[43,9564,244],{"emptyLinePlaceholder":243},[43,9566,9567,9570,9573],{"class":45,"line":70},[43,9568,9569],{"class":2063},"Pipeline:",[43,9571,9572],{"class":57}," orders_performance",[43,9574,9575],{"class":1277}," (.)\n",[43,9577,9578,9581,9584],{"class":45,"line":78},[43,9579,9580],{"class":2063},"  No",[43,9582,9583],{"class":57}," issues",[43,9585,9586],{"class":57}," found\n",[43,9588,9589],{"class":45,"line":86},[43,9590,244],{"emptyLinePlaceholder":243},[43,9592,9593,9596,9599,9602,9604,9606,9609,9611,9614,9617],{"class":45,"line":94},[43,9594,9595],{"class":2063},"✓",[43,9597,9598],{"class":57}," Successfully",[43,9600,9601],{"class":57}," validated",[43,9603,9557],{"class":148},[43,9605,9481],{"class":57},[43,9607,9608],{"class":57}," across",[43,9610,1003],{"class":148},[43,9612,9613],{"class":57}," pipeline,",[43,9615,9616],{"class":57}," all",[43,9618,9619],{"class":57}," good.\n",[43,9621,9622],{"class":45,"line":108},[43,9623,244],{"emptyLinePlaceholder":243},[43,9625,9626,9629,9632,9635],{"class":45,"line":119},[43,9627,9628],{"class":2063},"Interval:",[43,9630,9631],{"class":57}," 2025-10-17T00:00:00Z",[43,9633,9634],{"class":57}," -",[43,9636,9637],{"class":57}," 2025-10-17T23:59:59Z\n",[43,9639,9640,9643,9645,9647],{"class":45,"line":129},[43,9641,9642],{"class":2063},"Starting",[43,9644,9541],{"class":57},[43,9646,9544],{"class":57},[43,9648,9649],{"class":57}," execution...\n",[43,9651,9652],{"class":45,"line":140},[43,9653,244],{"emptyLinePlaceholder":243},[43,9655,9656,9658,9661,9663],{"class":45,"line":152},[43,9657,7542],{"class":53},[43,9659,9660],{"class":1277},"20:24:23",[43,9662,7547],{"class":53},[43,9664,9665],{"class":1277}," Running:  raw.products\n",[43,9667,9668,9670,9672,9674],{"class":45,"line":162},[43,9669,7542],{"class":53},[43,9671,9660],{"class":1277},[43,9673,7547],{"class":53},[43,9675,9676],{"class":1277}," Running:  raw.customers\n",[43,9678,9679,9681,9683,9685],{"class":45,"line":170},[43,9680,7542],{"class":53},[43,9682,9660],{"class":1277},[43,9684,7547],{"class":53},[43,9686,9687],{"class":1277}," Running:  raw.orders\n",[43,9689,9690,9692,9694,9696],{"class":45,"line":182},[43,9691,7542],{"class":53},[43,9693,9660],{"class":1277},[43,9695,7547],{"class":53},[43,9697,9698],{"class":1277}," Running:  raw.product_variants\n",[43,9700,9701],{"class":45,"line":374},[43,9702,244],{"emptyLinePlaceholder":243},[43,9704,9705,9708,9711],{"class":45,"line":382},[43,9706,9707],{"class":1418},"...",[43,9709,9710],{"class":57},"[logs]",[43,9712,9713],{"class":1418},"...\n",[43,9715,9716],{"class":45,"line":392},[43,9717,244],{"emptyLinePlaceholder":243},[43,9719,9720,9723,9726],{"class":45,"line":399},[43,9721,9722],{"class":2063},"PASS",[43,9724,9725],{"class":57}," raw.products",[43,9727,9728],{"class":1277}," \n",[43,9730,9731,9733,9736],{"class":45,"line":410},[43,9732,9722],{"class":2063},[43,9734,9735],{"class":57}," raw.customers",[43,9737,9728],{"class":1277},[43,9739,9740,9742,9745],{"class":45,"line":417},[43,9741,9722],{"class":2063},[43,9743,9744],{"class":57}," raw.orders",[43,9746,9728],{"class":1277},[43,9748,9749,9751,9754],{"class":45,"line":425},[43,9750,9722],{"class":2063},[43,9752,9753],{"class":57}," raw.order_items",[43,9755,9728],{"class":1277},[43,9757,9758,9760,9763],{"class":45,"line":430},[43,9759,9722],{"class":2063},[43,9761,9762],{"class":57}," raw.product_variants",[43,9764,9728],{"class":1277},[43,9766,9767],{"class":45,"line":438},[43,9768,244],{"emptyLinePlaceholder":243},[43,9770,9771,9773,9775,9778,9781,9784],{"class":45,"line":446},[43,9772,2091],{"class":2063},[43,9774,3163],{"class":57},[43,9776,9777],{"class":57}," completed",[43,9779,9780],{"class":57}," successfully",[43,9782,9783],{"class":57}," in",[43,9785,9786],{"class":57}," 16.704s\n",[43,9788,9789],{"class":45,"line":456},[43,9790,244],{"emptyLinePlaceholder":243},[43,9792,9793,9796,9799,9802,9805],{"class":45,"line":464},[43,9794,9795],{"class":2063}," ✓",[43,9797,9798],{"class":57}," Assets",[43,9800,9801],{"class":57}," executed",[43,9803,9804],{"class":148},"      5",[43,9806,9807],{"class":57}," succeeded\n",[8674,9809,9810],{},[1992,9811,9812,9813,9816],{},"Note that using the ",[40,9814,9815],{},"--tag"," option we'll run only the assets that have the specified tag, avoiding the execution of unnecessary assets.",[1973,9818,9820],{"id":9819},"_7-implementing-quality-checks-staging-layer","7) Implementing Quality Checks (Staging layer)",[1992,9822,9823,9824,9827],{},"The staging layer is where raw data gets ",[1977,9825,9826],{},"cleaned, validated, and prepared"," for analytics. Unlike the raw layer (which mirrors source systems exactly), staging applies business rules, data quality checks, and standardized transformations that make downstream analysis reliable and consistent.",[1992,9829,9830,9831,9834,9835,9838,9839,9842],{},"In Bruin, the staging layer combines ",[1977,9832,9833],{},"SQL transformations"," with ",[1977,9836,9837],{},"declarative quality checks"," defined in your ",[40,9840,9841],{},"columns"," inside an asset.",[29,9844,9845,10025,10151,10495,10672,10855],{"default-value":1819},[33,9846,9848],{"className":1195,"code":9847,"filename":1819,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns:\n  - extends: Customer.ID\n  - extends: Customer.Email\n  - extends: Customer.Country\n  - extends: Customer.Age\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[40,9849,9850,9854,9858,9862,9866,9870,9874,9878,9883,9887,9892,9897,9902,9907,9912,9917,9922,9926,9930,9936,9947,9965,9987,10001,10005,10009,10015],{"__ignoreMap":38},[43,9851,9852],{"class":45,"line":46},[43,9853,1205],{"class":1006},[43,9855,9856],{"class":45,"line":61},[43,9857,1830],{"class":1006},[43,9859,9860],{"class":45,"line":70},[43,9861,1215],{"class":1006},[43,9863,9864],{"class":45,"line":78},[43,9865,1235],{"class":1006},[43,9867,9868],{"class":45,"line":86},[43,9869,1240],{"class":1006},[43,9871,9872],{"class":45,"line":94},[43,9873,1250],{"class":1006},[43,9875,9876],{"class":45,"line":108},[43,9877,1851],{"class":1006},[43,9879,9880],{"class":45,"line":119},[43,9881,9882],{"class":1006},"owner: daniel@gmail.com\n",[43,9884,9885],{"class":45,"line":129},[43,9886,244],{"emptyLinePlaceholder":243},[43,9888,9889],{"class":45,"line":140},[43,9890,9891],{"class":1006},"columns:\n",[43,9893,9894],{"class":45,"line":152},[43,9895,9896],{"class":1006},"  - extends: Customer.ID\n",[43,9898,9899],{"class":45,"line":162},[43,9900,9901],{"class":1006},"  - extends: Customer.Email\n",[43,9903,9904],{"class":45,"line":170},[43,9905,9906],{"class":1006},"  - extends: Customer.Country\n",[43,9908,9909],{"class":45,"line":182},[43,9910,9911],{"class":1006},"  - extends: Customer.Age\n",[43,9913,9914],{"class":45,"line":374},[43,9915,9916],{"class":1006},"  - extends: Base.CreatedAt\n",[43,9918,9919],{"class":45,"line":382},[43,9920,9921],{"class":1006},"  - extends: Base.UpdatedAt\n",[43,9923,9924],{"class":45,"line":392},[43,9925,1265],{"class":1006},[43,9927,9928],{"class":45,"line":399},[43,9929,244],{"emptyLinePlaceholder":243},[43,9931,9932,9934],{"class":45,"line":410},[43,9933,1410],{"class":148},[43,9935,9728],{"class":1277},[43,9937,9938,9940,9942,9944],{"class":45,"line":417},[43,9939,1868],{"class":1277},[43,9941,1872],{"class":1871},[43,9943,1389],{"class":148},[43,9945,9946],{"class":1277}," customer_id, \n",[43,9948,9949,9951,9953,9955,9957,9959,9961,9963],{"class":45,"line":425},[43,9950,1882],{"class":1418},[43,9952,1422],{"class":1277},[43,9954,1887],{"class":1418},[43,9956,1890],{"class":1277},[43,9958,1893],{"class":53},[43,9960,1428],{"class":1277},[43,9962,1281],{"class":148},[43,9964,1900],{"class":1277},[43,9966,9967,9969,9971,9973,9975,9977,9979,9981,9983,9985],{"class":45,"line":430},[43,9968,1882],{"class":1418},[43,9970,1422],{"class":1277},[43,9972,1887],{"class":1418},[43,9974,1911],{"class":1277},[43,9976,1590],{"class":53},[43,9978,1916],{"class":57},[43,9980,1590],{"class":53},[43,9982,1428],{"class":1277},[43,9984,1281],{"class":148},[43,9986,1925],{"class":1277},[43,9988,9989,9991,9993,9995,9997,9999],{"class":45,"line":438},[43,9990,1882],{"class":1418},[43,9992,1932],{"class":1277},[43,9994,1935],{"class":148},[43,9996,1428],{"class":1277},[43,9998,1281],{"class":148},[43,10000,1942],{"class":1277},[43,10002,10003],{"class":45,"line":446},[43,10004,1947],{"class":1277},[43,10006,10007],{"class":45,"line":456},[43,10008,1952],{"class":1277},[43,10010,10011,10013],{"class":45,"line":464},[43,10012,1438],{"class":148},[43,10014,1022],{"class":1277},[43,10016,10017,10019,10021,10023],{"class":45,"line":472},[43,10018,1963],{"class":148},[43,10020,1966],{"class":1277},[43,10022,1969],{"class":148},[43,10024,1462],{"class":1277},[33,10026,10029],{"className":1195,"code":10027,"filename":10028,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.products\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.products\n\ncolumns:\n  - extends: Product.ID\n  - extends: Product.Name\n  - extends: Product.Category\n  - extends: Product.SKU\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT\n  id AS product_id,\n  name,\n  category,\n  sku,\n  created_at,\n  updated_at\nFROM raw.products;\n","orders-performance/assets/staging/stg.products.sql",[40,10030,10031,10035,10040,10044,10048,10052,10056,10061,10065,10069,10074,10079,10084,10089,10093,10097,10101,10105,10109,10119,10126,10131,10136,10140,10144],{"__ignoreMap":38},[43,10032,10033],{"class":45,"line":46},[43,10034,1205],{"class":1006},[43,10036,10037],{"class":45,"line":61},[43,10038,10039],{"class":1006},"name: stg.products\n",[43,10041,10042],{"class":45,"line":70},[43,10043,1215],{"class":1006},[43,10045,10046],{"class":45,"line":78},[43,10047,1235],{"class":1006},[43,10049,10050],{"class":45,"line":86},[43,10051,1240],{"class":1006},[43,10053,10054],{"class":45,"line":94},[43,10055,1250],{"class":1006},[43,10057,10058],{"class":45,"line":108},[43,10059,10060],{"class":1006},"  - raw.products\n",[43,10062,10063],{"class":45,"line":119},[43,10064,244],{"emptyLinePlaceholder":243},[43,10066,10067],{"class":45,"line":129},[43,10068,9891],{"class":1006},[43,10070,10071],{"class":45,"line":140},[43,10072,10073],{"class":1006},"  - extends: Product.ID\n",[43,10075,10076],{"class":45,"line":152},[43,10077,10078],{"class":1006},"  - extends: Product.Name\n",[43,10080,10081],{"class":45,"line":162},[43,10082,10083],{"class":1006},"  - extends: Product.Category\n",[43,10085,10086],{"class":45,"line":170},[43,10087,10088],{"class":1006},"  - extends: Product.SKU\n",[43,10090,10091],{"class":45,"line":182},[43,10092,9916],{"class":1006},[43,10094,10095],{"class":45,"line":374},[43,10096,9921],{"class":1006},[43,10098,10099],{"class":45,"line":382},[43,10100,1265],{"class":1006},[43,10102,10103],{"class":45,"line":392},[43,10104,244],{"emptyLinePlaceholder":243},[43,10106,10107],{"class":45,"line":399},[43,10108,1674],{"class":148},[43,10110,10111,10114,10116],{"class":45,"line":410},[43,10112,10113],{"class":1277},"  id ",[43,10115,1281],{"class":148},[43,10117,10118],{"class":1277}," product_id,\n",[43,10120,10121,10124],{"class":45,"line":417},[43,10122,10123],{"class":148},"  name",[43,10125,2316],{"class":1277},[43,10127,10128],{"class":45,"line":425},[43,10129,10130],{"class":1277},"  category,\n",[43,10132,10133],{"class":45,"line":430},[43,10134,10135],{"class":1277},"  sku,\n",[43,10137,10138],{"class":45,"line":438},[43,10139,1947],{"class":1277},[43,10141,10142],{"class":45,"line":446},[43,10143,1952],{"class":1277},[43,10145,10146,10148],{"class":45,"line":456},[43,10147,1438],{"class":148},[43,10149,10150],{"class":1277}," raw.products;\n",[33,10152,10155],{"className":1195,"code":10153,"filename":10154,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.product_variants\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.product_variants\n  - stg.products\n\ncolumns:\n  - extends: Variant.ID\n  - extends: Variant.ProductID\n  - extends: Variant.VariantSKU\n  - extends: Variant.Color\n  - extends: Variant.Size\n  - extends: Variant.ManufacturingPrice\n  - extends: Variant.SellingPrice\n  - extends: Variant.StockQuantity\n  - extends: Variant.IsActive\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n\ncustom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n@bruin */\n\nSELECT\n  pv.id AS variant_id,\n  pv.product_id,\n  pv.variant_sku,\n  pv.color,\n  pv.size,\n  CASE WHEN pv.manufacturing_price \u003C 0 THEN 0 ELSE pv.manufacturing_price END AS manufacturing_price,\n  CASE WHEN pv.selling_price \u003C 0 THEN 0 ELSE pv.selling_price END AS selling_price,\n  CASE WHEN pv.stock_quantity \u003C 0 THEN 0 ELSE pv.stock_quantity END AS stock_quantity,\n  COALESCE(pv.is_active, TRUE) AS is_active,\n  pv.created_at,\n  pv.updated_at\nFROM raw.product_variants pv\nJOIN stg.products p ON p.product_id = pv.product_id;\n","orders-performance/assets/staging/stg.product_variants.sql",[40,10156,10157,10161,10166,10170,10174,10178,10182,10186,10191,10195,10199,10203,10208,10213,10218,10223,10228,10233,10238,10243,10248,10252,10256,10260,10265,10270,10275,10280,10285,10290,10295,10300,10305,10310,10315,10320,10325,10329,10333,10337,10347,10352,10357,10362,10367,10395,10423,10451,10463,10468,10473,10480],{"__ignoreMap":38},[43,10158,10159],{"class":45,"line":46},[43,10160,1205],{"class":1006},[43,10162,10163],{"class":45,"line":61},[43,10164,10165],{"class":1006},"name: stg.product_variants\n",[43,10167,10168],{"class":45,"line":70},[43,10169,1215],{"class":1006},[43,10171,10172],{"class":45,"line":78},[43,10173,1235],{"class":1006},[43,10175,10176],{"class":45,"line":86},[43,10177,1240],{"class":1006},[43,10179,10180],{"class":45,"line":94},[43,10181,1245],{"class":1006},[43,10183,10184],{"class":45,"line":108},[43,10185,1250],{"class":1006},[43,10187,10188],{"class":45,"line":119},[43,10189,10190],{"class":1006},"  - raw.product_variants\n",[43,10192,10193],{"class":45,"line":129},[43,10194,1502],{"class":1006},[43,10196,10197],{"class":45,"line":140},[43,10198,244],{"emptyLinePlaceholder":243},[43,10200,10201],{"class":45,"line":152},[43,10202,9891],{"class":1006},[43,10204,10205],{"class":45,"line":162},[43,10206,10207],{"class":1006},"  - extends: Variant.ID\n",[43,10209,10210],{"class":45,"line":170},[43,10211,10212],{"class":1006},"  - extends: Variant.ProductID\n",[43,10214,10215],{"class":45,"line":182},[43,10216,10217],{"class":1006},"  - extends: Variant.VariantSKU\n",[43,10219,10220],{"class":45,"line":374},[43,10221,10222],{"class":1006},"  - extends: Variant.Color\n",[43,10224,10225],{"class":45,"line":382},[43,10226,10227],{"class":1006},"  - extends: Variant.Size\n",[43,10229,10230],{"class":45,"line":392},[43,10231,10232],{"class":1006},"  - extends: Variant.ManufacturingPrice\n",[43,10234,10235],{"class":45,"line":399},[43,10236,10237],{"class":1006},"  - extends: Variant.SellingPrice\n",[43,10239,10240],{"class":45,"line":410},[43,10241,10242],{"class":1006},"  - extends: Variant.StockQuantity\n",[43,10244,10245],{"class":45,"line":417},[43,10246,10247],{"class":1006},"  - extends: Variant.IsActive\n",[43,10249,10250],{"class":45,"line":425},[43,10251,9916],{"class":1006},[43,10253,10254],{"class":45,"line":430},[43,10255,9921],{"class":1006},[43,10257,10258],{"class":45,"line":438},[43,10259,244],{"emptyLinePlaceholder":243},[43,10261,10262],{"class":45,"line":446},[43,10263,10264],{"class":1006},"custom_checks:\n",[43,10266,10267],{"class":45,"line":456},[43,10268,10269],{"class":1006},"  - name: validate product variant sizes\n",[43,10271,10272],{"class":45,"line":464},[43,10273,10274],{"class":1006},"    description: |\n",[43,10276,10277],{"class":45,"line":472},[43,10278,10279],{"class":1006},"      Ensures that if the product category is 'shoes', the size must be numeric.\n",[43,10281,10282],{"class":45,"line":483},[43,10283,10284],{"class":1006},"      Otherwise, the size must be one of ['S', 'M', 'L'].\n",[43,10286,10287],{"class":45,"line":494},[43,10288,10289],{"class":1006},"    value: 0\n",[43,10291,10292],{"class":45,"line":506},[43,10293,10294],{"class":1006},"    query: |\n",[43,10296,10297],{"class":45,"line":517},[43,10298,10299],{"class":1006},"      SELECT COUNT(*) AS invalid_count\n",[43,10301,10302],{"class":45,"line":525},[43,10303,10304],{"class":1006},"      FROM raw.product_variants v\n",[43,10306,10307],{"class":45,"line":538},[43,10308,10309],{"class":1006},"      JOIN stg.products p ON p.product_id = v.product_id\n",[43,10311,10312],{"class":45,"line":550},[43,10313,10314],{"class":1006},"      WHERE\n",[43,10316,10317],{"class":45,"line":558},[43,10318,10319],{"class":1006},"        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n",[43,10321,10322],{"class":45,"line":568},[43,10323,10324],{"class":1006},"        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[43,10326,10327],{"class":45,"line":578},[43,10328,1265],{"class":1006},[43,10330,10331],{"class":45,"line":588},[43,10332,244],{"emptyLinePlaceholder":243},[43,10334,10335],{"class":45,"line":595},[43,10336,1674],{"class":148},[43,10338,10339,10342,10344],{"class":45,"line":606},[43,10340,10341],{"class":1277},"  pv.id ",[43,10343,1281],{"class":148},[43,10345,10346],{"class":1277}," variant_id,\n",[43,10348,10349],{"class":45,"line":614},[43,10350,10351],{"class":1277},"  pv.product_id,\n",[43,10353,10354],{"class":45,"line":624},[43,10355,10356],{"class":1277},"  pv.variant_sku,\n",[43,10358,10359],{"class":45,"line":633},[43,10360,10361],{"class":1277},"  pv.color,\n",[43,10363,10364],{"class":45,"line":643},[43,10365,10366],{"class":1277},"  pv.size,\n",[43,10368,10369,10371,10373,10376,10378,10380,10382,10384,10386,10388,10390,10392],{"class":45,"line":650},[43,10370,1724],{"class":148},[43,10372,1727],{"class":148},[43,10374,10375],{"class":1277}," pv.manufacturing_price ",[43,10377,1303],{"class":53},[43,10379,1737],{"class":148},[43,10381,1309],{"class":148},[43,10383,1737],{"class":148},[43,10385,1744],{"class":148},[43,10387,10375],{"class":1277},[43,10389,1758],{"class":148},[43,10391,1389],{"class":148},[43,10393,10394],{"class":1277}," manufacturing_price,\n",[43,10396,10397,10399,10401,10404,10406,10408,10410,10412,10414,10416,10418,10420],{"class":45,"line":661},[43,10398,1724],{"class":148},[43,10400,1727],{"class":148},[43,10402,10403],{"class":1277}," pv.selling_price ",[43,10405,1303],{"class":53},[43,10407,1737],{"class":148},[43,10409,1309],{"class":148},[43,10411,1737],{"class":148},[43,10413,1744],{"class":148},[43,10415,10403],{"class":1277},[43,10417,1758],{"class":148},[43,10419,1389],{"class":148},[43,10421,10422],{"class":1277}," selling_price,\n",[43,10424,10425,10427,10429,10432,10434,10436,10438,10440,10442,10444,10446,10448],{"class":45,"line":669},[43,10426,1724],{"class":148},[43,10428,1727],{"class":148},[43,10430,10431],{"class":1277}," pv.stock_quantity ",[43,10433,1303],{"class":53},[43,10435,1737],{"class":148},[43,10437,1309],{"class":148},[43,10439,1737],{"class":148},[43,10441,1744],{"class":148},[43,10443,10431],{"class":1277},[43,10445,1758],{"class":148},[43,10447,1389],{"class":148},[43,10449,10450],{"class":1277}," stock_quantity,\n",[43,10452,10453,10455,10458,10460],{"class":45,"line":679},[43,10454,1882],{"class":1418},[43,10456,10457],{"class":1277},"(pv.is_active, TRUE) ",[43,10459,1281],{"class":148},[43,10461,10462],{"class":1277}," is_active,\n",[43,10464,10465],{"class":45,"line":687},[43,10466,10467],{"class":1277},"  pv.created_at,\n",[43,10469,10470],{"class":45,"line":695},[43,10471,10472],{"class":1277},"  pv.updated_at\n",[43,10474,10475,10477],{"class":45,"line":702},[43,10476,1438],{"class":148},[43,10478,10479],{"class":1277}," raw.product_variants pv\n",[43,10481,10482,10484,10486,10488,10490,10492],{"class":45,"line":709},[43,10483,1775],{"class":148},[43,10485,1778],{"class":1277},[43,10487,1564],{"class":148},[43,10489,1783],{"class":1277},[43,10491,1570],{"class":53},[43,10493,10494],{"class":1277}," pv.product_id;\n",[33,10496,10499],{"className":1195,"code":10497,"filename":10498,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.orders\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.orders\n  - raw.customers\n\ncolumns:\n  - extends: Order.ID\n  - extends: Order.CustomerID\n  - extends: Order.OrderDate\n  - extends: Order.Status\n  - extends: Order.TotalAmount\n@bruin */\n\nWITH src AS (\n  SELECT\n    o.id              AS order_id,\n    o.customer_id,\n    o.order_date,\n    o.status,\n    CASE WHEN o.total_amount \u003C 0 THEN 0 ELSE o.total_amount END AS total_amount\n  FROM raw.orders o\n)\nSELECT * FROM src;\n","orders-performance/assets/staging/stg.orders.sql",[40,10500,10501,10505,10510,10514,10518,10522,10526,10530,10535,10539,10543,10547,10552,10557,10562,10567,10572,10576,10580,10590,10594,10604,10609,10614,10619,10648,10655,10659],{"__ignoreMap":38},[43,10502,10503],{"class":45,"line":46},[43,10504,1205],{"class":1006},[43,10506,10507],{"class":45,"line":61},[43,10508,10509],{"class":1006},"name: stg.orders\n",[43,10511,10512],{"class":45,"line":70},[43,10513,1215],{"class":1006},[43,10515,10516],{"class":45,"line":78},[43,10517,1235],{"class":1006},[43,10519,10520],{"class":45,"line":86},[43,10521,1240],{"class":1006},[43,10523,10524],{"class":45,"line":94},[43,10525,1245],{"class":1006},[43,10527,10528],{"class":45,"line":108},[43,10529,1250],{"class":1006},[43,10531,10532],{"class":45,"line":119},[43,10533,10534],{"class":1006},"  - raw.orders\n",[43,10536,10537],{"class":45,"line":129},[43,10538,1851],{"class":1006},[43,10540,10541],{"class":45,"line":140},[43,10542,244],{"emptyLinePlaceholder":243},[43,10544,10545],{"class":45,"line":152},[43,10546,9891],{"class":1006},[43,10548,10549],{"class":45,"line":162},[43,10550,10551],{"class":1006},"  - extends: Order.ID\n",[43,10553,10554],{"class":45,"line":170},[43,10555,10556],{"class":1006},"  - extends: Order.CustomerID\n",[43,10558,10559],{"class":45,"line":182},[43,10560,10561],{"class":1006},"  - extends: Order.OrderDate\n",[43,10563,10564],{"class":45,"line":374},[43,10565,10566],{"class":1006},"  - extends: Order.Status\n",[43,10568,10569],{"class":45,"line":382},[43,10570,10571],{"class":1006},"  - extends: Order.TotalAmount\n",[43,10573,10574],{"class":45,"line":392},[43,10575,1265],{"class":1006},[43,10577,10578],{"class":45,"line":399},[43,10579,244],{"emptyLinePlaceholder":243},[43,10581,10582,10584,10586,10588],{"class":45,"line":410},[43,10583,1274],{"class":148},[43,10585,1278],{"class":1277},[43,10587,1281],{"class":148},[43,10589,1284],{"class":1277},[43,10591,10592],{"class":45,"line":417},[43,10593,1626],{"class":148},[43,10595,10596,10599,10601],{"class":45,"line":425},[43,10597,10598],{"class":1277},"    o.id              ",[43,10600,1281],{"class":148},[43,10602,10603],{"class":1277}," order_id,\n",[43,10605,10606],{"class":45,"line":430},[43,10607,10608],{"class":1277},"    o.customer_id,\n",[43,10610,10611],{"class":45,"line":438},[43,10612,10613],{"class":1277},"    o.order_date,\n",[43,10615,10616],{"class":45,"line":446},[43,10617,10618],{"class":1277},"    o.status,\n",[43,10620,10621,10624,10626,10629,10631,10633,10635,10637,10639,10641,10643,10645],{"class":45,"line":456},[43,10622,10623],{"class":148},"    CASE",[43,10625,1727],{"class":148},[43,10627,10628],{"class":1277}," o.total_amount ",[43,10630,1303],{"class":53},[43,10632,1737],{"class":148},[43,10634,1309],{"class":148},[43,10636,1737],{"class":148},[43,10638,1744],{"class":148},[43,10640,10628],{"class":1277},[43,10642,1758],{"class":148},[43,10644,1389],{"class":148},[43,10646,10647],{"class":1277}," total_amount\n",[43,10649,10650,10652],{"class":45,"line":464},[43,10651,1397],{"class":148},[43,10653,10654],{"class":1277}," raw.orders o\n",[43,10656,10657],{"class":45,"line":472},[43,10658,1405],{"class":1277},[43,10660,10661,10663,10666,10669],{"class":45,"line":483},[43,10662,1410],{"class":148},[43,10664,10665],{"class":53}," *",[43,10667,10668],{"class":148}," FROM",[43,10670,10671],{"class":1277}," src;\n",[33,10673,10676],{"className":1195,"code":10674,"filename":10675,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.order_items\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.order_items\n\ncolumns:\n  - extends: OrderItem.ID\n  - extends: OrderItem.OrderID\n  - extends: OrderItem.VariantID\n  - extends: OrderItem.Quantity\n  - extends: OrderItem.UnitPrice\n  - extends: OrderItem.TotalPrice\n  - extends: Base.CreatedAt\n@bruin */\n\nSELECT\n  oi.id AS order_item_id,\n  oi.order_id,\n  oi.variant_id,\n  oi.quantity,\n  CASE WHEN oi.unit_price \u003C 0 THEN 0 ELSE oi.unit_price END AS unit_price,\n  CASE WHEN oi.total_price \u003C 0 THEN 0 ELSE oi.total_price END AS total_price,\n  oi.created_at\nFROM raw.order_items oi;\n","orders-performance/assets/staging/stg.order_items.sql",[40,10677,10678,10682,10687,10691,10695,10699,10703,10708,10712,10716,10721,10726,10731,10736,10741,10746,10750,10754,10758,10762,10772,10777,10782,10787,10815,10843,10848],{"__ignoreMap":38},[43,10679,10680],{"class":45,"line":46},[43,10681,1205],{"class":1006},[43,10683,10684],{"class":45,"line":61},[43,10685,10686],{"class":1006},"name: stg.order_items\n",[43,10688,10689],{"class":45,"line":70},[43,10690,1215],{"class":1006},[43,10692,10693],{"class":45,"line":78},[43,10694,1235],{"class":1006},[43,10696,10697],{"class":45,"line":86},[43,10698,1240],{"class":1006},[43,10700,10701],{"class":45,"line":94},[43,10702,1250],{"class":1006},[43,10704,10705],{"class":45,"line":108},[43,10706,10707],{"class":1006},"  - raw.order_items\n",[43,10709,10710],{"class":45,"line":119},[43,10711,244],{"emptyLinePlaceholder":243},[43,10713,10714],{"class":45,"line":129},[43,10715,9891],{"class":1006},[43,10717,10718],{"class":45,"line":140},[43,10719,10720],{"class":1006},"  - extends: OrderItem.ID\n",[43,10722,10723],{"class":45,"line":152},[43,10724,10725],{"class":1006},"  - extends: OrderItem.OrderID\n",[43,10727,10728],{"class":45,"line":162},[43,10729,10730],{"class":1006},"  - extends: OrderItem.VariantID\n",[43,10732,10733],{"class":45,"line":170},[43,10734,10735],{"class":1006},"  - extends: OrderItem.Quantity\n",[43,10737,10738],{"class":45,"line":182},[43,10739,10740],{"class":1006},"  - extends: OrderItem.UnitPrice\n",[43,10742,10743],{"class":45,"line":374},[43,10744,10745],{"class":1006},"  - extends: OrderItem.TotalPrice\n",[43,10747,10748],{"class":45,"line":382},[43,10749,9916],{"class":1006},[43,10751,10752],{"class":45,"line":392},[43,10753,1265],{"class":1006},[43,10755,10756],{"class":45,"line":399},[43,10757,244],{"emptyLinePlaceholder":243},[43,10759,10760],{"class":45,"line":410},[43,10761,1674],{"class":148},[43,10763,10764,10767,10769],{"class":45,"line":417},[43,10765,10766],{"class":1277},"  oi.id ",[43,10768,1281],{"class":148},[43,10770,10771],{"class":1277}," order_item_id,\n",[43,10773,10774],{"class":45,"line":425},[43,10775,10776],{"class":1277},"  oi.order_id,\n",[43,10778,10779],{"class":45,"line":430},[43,10780,10781],{"class":1277},"  oi.variant_id,\n",[43,10783,10784],{"class":45,"line":438},[43,10785,10786],{"class":1277},"  oi.quantity,\n",[43,10788,10789,10791,10793,10796,10798,10800,10802,10804,10806,10808,10810,10812],{"class":45,"line":446},[43,10790,1724],{"class":148},[43,10792,1727],{"class":148},[43,10794,10795],{"class":1277}," oi.unit_price ",[43,10797,1303],{"class":53},[43,10799,1737],{"class":148},[43,10801,1309],{"class":148},[43,10803,1737],{"class":148},[43,10805,1744],{"class":148},[43,10807,10795],{"class":1277},[43,10809,1758],{"class":148},[43,10811,1389],{"class":148},[43,10813,10814],{"class":1277}," unit_price,\n",[43,10816,10817,10819,10821,10824,10826,10828,10830,10832,10834,10836,10838,10840],{"class":45,"line":456},[43,10818,1724],{"class":148},[43,10820,1727],{"class":148},[43,10822,10823],{"class":1277}," oi.total_price ",[43,10825,1303],{"class":53},[43,10827,1737],{"class":148},[43,10829,1309],{"class":148},[43,10831,1737],{"class":148},[43,10833,1744],{"class":148},[43,10835,10823],{"class":1277},[43,10837,1758],{"class":148},[43,10839,1389],{"class":148},[43,10841,10842],{"class":1277}," total_price,\n",[43,10844,10845],{"class":45,"line":464},[43,10846,10847],{"class":1277},"  oi.created_at\n",[43,10849,10850,10852],{"class":45,"line":472},[43,10851,1438],{"class":148},[43,10853,10854],{"class":1277}," raw.order_items oi;\n",[33,10856,10858],{"className":35,"code":10857,"filename":258,"language":37,"meta":38,"style":38},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fieds for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      \n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        description: Surrogate key for customer in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n        description: Full name of the customer.\n      Country:\n        name: country\n        type: string\n        description: Country of residence.\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n\n  Product:\n    description: A product offered for sale.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: product_id\n        type: integer\n        description: Surrogate key for product in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Name:\n        name: name\n        type: string\n        description: Product display name.\n        checks:\n          - name: not_null\n      Category:\n        name: category\n        type: string\n        description: Product category.\n        checks:\n          - name: not_null\n      SKU:\n        name: sku\n        type: string\n        description: Stock keeping unit for the product.\n        checks:\n          - name: not_null\n          - name: unique\n\n  Variant:\n    description: A specific variation of a product.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: variant_id\n        type: integer\n        description: Surrogate key for variant in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      ProductID:\n        name: product_id\n        type: integer\n        description: Reference to Product.ID.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantSKU:\n        name: variant_sku\n        type: string\n        description: SKU for the variant.\n        checks:\n          - name: not_null\n          - name: unique\n      Color:\n        name: color\n        type: string\n        description: Variant color.\n      Size:\n        name: size\n        type: string\n        description: Variant size.\n      ManufacturingPrice:\n        name: manufacturing_price\n        type: numeric\n        description: Manufacturing cost per unit.\n        checks:\n          - name: not_null\n      SellingPrice:\n        name: selling_price\n        type: numeric\n        description: Selling price per unit.\n        checks:\n          - name: not_null\n      StockQuantity:\n        name: stock_quantity\n        type: integer\n        description: Available stock quantity.\n        checks:\n          - name: not_null\n      IsActive:\n        name: is_active\n        type: boolean\n        description: Whether the variant is active.\n        checks:\n          - name: not_null\n\n  Order:\n    description: A purchase order placed by a customer.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_id\n        type: integer\n        description: Surrogate key for order in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      CustomerID:\n        name: customer_id\n        type: integer\n        description: Reference to Customer.ID for the purchaser.\n        checks:\n          - name: not_null\n          - name: positive\n      OrderNumber:\n        name: order_number\n        type: string\n        description: Human-readable order number.\n      OrderDate:\n        name: order_date\n        type: timestamp\n        description: When the order was placed.\n        checks:\n          - name: not_null\n      Status:\n        name: status\n        type: string\n        description: Order lifecycle status.\n        checks:\n          - name: not_null\n          - name: accepted_values\n            value:\n              - pending\n              - paid\n              - cancelled\n              - shipped\n      TotalAmount:\n        name: total_amount\n        type: numeric\n        description: Total order amount.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n  OrderItem:\n    description: A line item in an order.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_item_id\n        type: integer\n        description: Surrogate key for order item in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      OrderID:\n        name: order_id\n        type: integer\n        description: Reference to Order.ID this item belongs to.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantID:\n        name: variant_id\n        type: integer\n        description: Reference to Variant.ID purchased.\n        checks:\n          - name: not_null\n          - name: positive\n      Quantity:\n        name: quantity\n        type: integer\n        description: Quantity purchased (must be positive).\n        checks:\n          - name: not_null\n          - name: range\n            min: 1\n      UnitPrice:\n        name: unit_price\n        type: numeric\n        description: Price per unit at purchase time.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n      TotalPrice:\n        name: total_price\n        type: numeric\n        description: Total price for the line (Quantity * UnitPrice).\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n",[40,10859,10860,10866,10872,10880,10886,10896,10902,10908,10914,10922,10928,10938,10944,10950,10956,10962,10970,10976,10986,10992,10998,11002,11008,11014,11023,11029,11035,11043,11051,11059,11067,11073,11083,11093,11098,11104,11112,11120,11128,11134,11144,11148,11154,11162,11170,11178,11184,11194,11198,11204,11212,11218,11224,11230,11236,11244,11252,11261,11267,11277,11287,11293,11301,11309,11318,11324,11334,11340,11348,11356,11365,11371,11379,11387,11396,11402,11410,11418,11427,11433,11443,11451,11455,11462,11471,11477,11484,11490,11496,11505,11513,11522,11528,11538,11548,11555,11564,11572,11581,11587,11597,11604,11613,11621,11630,11636,11646,11653,11662,11670,11679,11685,11695,11705,11709,11716,11725,11731,11737,11743,11749,11758,11766,11775,11781,11791,11801,11808,11816,11824,11833,11839,11849,11860,11867,11876,11884,11893,11899,11909,11919,11926,11935,11943,11952,11959,11968,11976,11985,11992,12001,12010,12019,12025,12035,12042,12051,12059,12068,12074,12084,12091,12100,12108,12117,12123,12133,12140,12149,12158,12167,12173,12183,12187,12194,12203,12209,12215,12221,12227,12236,12244,12253,12259,12269,12279,12286,12294,12302,12311,12317,12327,12337,12344,12353,12361,12370,12377,12386,12394,12403,12409,12419,12426,12435,12443,12452,12458,12468,12479,12486,12494,12501,12508,12515,12522,12530,12538,12547,12553,12563,12573,12581,12585,12592,12601,12607,12613,12619,12625,12634,12642,12651,12657,12667,12677,12684,12692,12700,12709,12715,12725,12735,12742,12750,12758,12767,12773,12783,12793,12800,12809,12817,12826,12832,12842,12852,12861,12868,12877,12885,12894,12900,12910,12920,12928,12935,12944,12953,12963,12970,12981,12992],{"__ignoreMap":38},[43,10861,10862,10864],{"class":45,"line":46},[43,10863,265],{"class":49},[43,10865,67],{"class":53},[43,10867,10868,10870],{"class":45,"line":61},[43,10869,272],{"class":49},[43,10871,67],{"class":53},[43,10873,10874,10876,10878],{"class":45,"line":70},[43,10875,279],{"class":49},[43,10877,54],{"class":53},[43,10879,284],{"class":57},[43,10881,10882,10884],{"class":45,"line":78},[43,10883,289],{"class":49},[43,10885,67],{"class":53},[43,10887,10888,10890,10892,10894],{"class":45,"line":86},[43,10889,296],{"class":53},[43,10891,299],{"class":53},[43,10893,302],{"class":57},[43,10895,305],{"class":53},[43,10897,10898,10900],{"class":45,"line":94},[43,10899,310],{"class":49},[43,10901,67],{"class":53},[43,10903,10904,10906],{"class":45,"line":108},[43,10905,296],{"class":53},[43,10907,319],{"class":57},[43,10909,10910,10912],{"class":45,"line":119},[43,10911,324],{"class":49},[43,10913,67],{"class":53},[43,10915,10916,10918,10920],{"class":45,"line":129},[43,10917,279],{"class":49},[43,10919,54],{"class":53},[43,10921,335],{"class":57},[43,10923,10924,10926],{"class":45,"line":140},[43,10925,289],{"class":49},[43,10927,67],{"class":53},[43,10929,10930,10932,10934,10936],{"class":45,"line":152},[43,10931,296],{"class":53},[43,10933,299],{"class":53},[43,10935,302],{"class":57},[43,10937,305],{"class":53},[43,10939,10940,10942],{"class":45,"line":162},[43,10941,310],{"class":49},[43,10943,67],{"class":53},[43,10945,10946,10948],{"class":45,"line":170},[43,10947,296],{"class":53},[43,10949,364],{"class":57},[43,10951,10952,10954],{"class":45,"line":182},[43,10953,296],{"class":53},[43,10955,371],{"class":57},[43,10957,10958,10960],{"class":45,"line":374},[43,10959,377],{"class":49},[43,10961,67],{"class":53},[43,10963,10964,10966,10968],{"class":45,"line":382},[43,10965,279],{"class":49},[43,10967,54],{"class":53},[43,10969,389],{"class":57},[43,10971,10972,10974],{"class":45,"line":392},[43,10973,289],{"class":49},[43,10975,67],{"class":53},[43,10977,10978,10980,10982,10984],{"class":45,"line":399},[43,10979,296],{"class":53},[43,10981,299],{"class":53},[43,10983,302],{"class":57},[43,10985,305],{"class":53},[43,10987,10988,10990],{"class":45,"line":410},[43,10989,310],{"class":49},[43,10991,67],{"class":53},[43,10993,10994,10996],{"class":45,"line":417},[43,10995,296],{"class":53},[43,10997,422],{"class":57},[43,10999,11000],{"class":45,"line":425},[43,11001,244],{"emptyLinePlaceholder":243},[43,11003,11004,11006],{"class":45,"line":430},[43,11005,433],{"class":49},[43,11007,67],{"class":53},[43,11009,11010,11012],{"class":45,"line":438},[43,11011,441],{"class":49},[43,11013,67],{"class":53},[43,11015,11016,11018,11020],{"class":45,"line":446},[43,11017,279],{"class":49},[43,11019,54],{"class":53},[43,11021,11022],{"class":57}," Required fieds for every Ingestion/Staging step.\n",[43,11024,11025,11027],{"class":45,"line":456},[43,11026,459],{"class":49},[43,11028,67],{"class":53},[43,11030,11031,11033],{"class":45,"line":464},[43,11032,467],{"class":49},[43,11034,67],{"class":53},[43,11036,11037,11039,11041],{"class":45,"line":472},[43,11038,475],{"class":49},[43,11040,54],{"class":53},[43,11042,480],{"class":57},[43,11044,11045,11047,11049],{"class":45,"line":483},[43,11046,486],{"class":49},[43,11048,54],{"class":53},[43,11050,491],{"class":57},[43,11052,11053,11055,11057],{"class":45,"line":494},[43,11054,497],{"class":49},[43,11056,54],{"class":53},[43,11058,503],{"class":502},[43,11060,11061,11063,11065],{"class":45,"line":506},[43,11062,509],{"class":49},[43,11064,54],{"class":53},[43,11066,514],{"class":57},[43,11068,11069,11071],{"class":45,"line":517},[43,11070,520],{"class":49},[43,11072,67],{"class":53},[43,11074,11075,11077,11079,11081],{"class":45,"line":525},[43,11076,528],{"class":53},[43,11078,100],{"class":49},[43,11080,54],{"class":53},[43,11082,535],{"class":57},[43,11084,11085,11087,11089,11091],{"class":45,"line":538},[43,11086,528],{"class":53},[43,11088,100],{"class":49},[43,11090,54],{"class":53},[43,11092,547],{"class":57},[43,11094,11095],{"class":45,"line":550},[43,11096,11097],{"class":1277},"      \n",[43,11099,11100,11102],{"class":45,"line":558},[43,11101,553],{"class":49},[43,11103,67],{"class":53},[43,11105,11106,11108,11110],{"class":45,"line":568},[43,11107,475],{"class":49},[43,11109,54],{"class":53},[43,11111,565],{"class":57},[43,11113,11114,11116,11118],{"class":45,"line":578},[43,11115,486],{"class":49},[43,11117,54],{"class":53},[43,11119,575],{"class":57},[43,11121,11122,11124,11126],{"class":45,"line":588},[43,11123,509],{"class":49},[43,11125,54],{"class":53},[43,11127,585],{"class":57},[43,11129,11130,11132],{"class":45,"line":595},[43,11131,520],{"class":49},[43,11133,67],{"class":53},[43,11135,11136,11138,11140,11142],{"class":45,"line":606},[43,11137,528],{"class":53},[43,11139,100],{"class":49},[43,11141,54],{"class":53},[43,11143,535],{"class":57},[43,11145,11146],{"class":45,"line":614},[43,11147,244],{"emptyLinePlaceholder":243},[43,11149,11150,11152],{"class":45,"line":624},[43,11151,609],{"class":49},[43,11153,67],{"class":53},[43,11155,11156,11158,11160],{"class":45,"line":633},[43,11157,475],{"class":49},[43,11159,54],{"class":53},[43,11161,621],{"class":57},[43,11163,11164,11166,11168],{"class":45,"line":643},[43,11165,486],{"class":49},[43,11167,54],{"class":53},[43,11169,575],{"class":57},[43,11171,11172,11174,11176],{"class":45,"line":650},[43,11173,509],{"class":49},[43,11175,54],{"class":53},[43,11177,640],{"class":57},[43,11179,11180,11182],{"class":45,"line":661},[43,11181,520],{"class":49},[43,11183,67],{"class":53},[43,11185,11186,11188,11190,11192],{"class":45,"line":669},[43,11187,528],{"class":53},[43,11189,100],{"class":49},[43,11191,54],{"class":53},[43,11193,535],{"class":57},[43,11195,11196],{"class":45,"line":679},[43,11197,244],{"emptyLinePlaceholder":243},[43,11199,11200,11202],{"class":45,"line":687},[43,11201,664],{"class":49},[43,11203,67],{"class":53},[43,11205,11206,11208,11210],{"class":45,"line":695},[43,11207,279],{"class":49},[43,11209,54],{"class":53},[43,11211,676],{"class":57},[43,11213,11214,11216],{"class":45,"line":702},[43,11215,682],{"class":49},[43,11217,67],{"class":53},[43,11219,11220,11222],{"class":45,"line":709},[43,11221,296],{"class":53},[43,11223,692],{"class":57},[43,11225,11226,11228],{"class":45,"line":719},[43,11227,459],{"class":49},[43,11229,67],{"class":53},[43,11231,11232,11234],{"class":45,"line":728},[43,11233,467],{"class":49},[43,11235,67],{"class":53},[43,11237,11238,11240,11242],{"class":45,"line":735},[43,11239,475],{"class":49},[43,11241,54],{"class":53},[43,11243,716],{"class":57},[43,11245,11246,11248,11250],{"class":45,"line":746},[43,11247,486],{"class":49},[43,11249,54],{"class":53},[43,11251,491],{"class":57},[43,11253,11254,11256,11258],{"class":45,"line":757},[43,11255,509],{"class":49},[43,11257,54],{"class":53},[43,11259,11260],{"class":57}," Surrogate key for customer in staging.\n",[43,11262,11263,11265],{"class":45,"line":765},[43,11264,520],{"class":49},[43,11266,67],{"class":53},[43,11268,11269,11271,11273,11275],{"class":45,"line":775},[43,11270,528],{"class":53},[43,11272,100],{"class":49},[43,11274,54],{"class":53},[43,11276,535],{"class":57},[43,11278,11279,11281,11283,11285],{"class":45,"line":785},[43,11280,528],{"class":53},[43,11282,100],{"class":49},[43,11284,54],{"class":53},[43,11286,547],{"class":57},[43,11288,11289,11291],{"class":45,"line":792},[43,11290,760],{"class":49},[43,11292,67],{"class":53},[43,11294,11295,11297,11299],{"class":45,"line":803},[43,11296,475],{"class":49},[43,11298,54],{"class":53},[43,11300,772],{"class":57},[43,11302,11303,11305,11307],{"class":45,"line":811},[43,11304,486],{"class":49},[43,11306,54],{"class":53},[43,11308,782],{"class":57},[43,11310,11311,11313,11315],{"class":45,"line":821},[43,11312,509],{"class":49},[43,11314,54],{"class":53},[43,11316,11317],{"class":57}," E-mail address used during registration.\n",[43,11319,11320,11322],{"class":45,"line":830},[43,11321,520],{"class":49},[43,11323,67],{"class":53},[43,11325,11326,11328,11330,11332],{"class":45,"line":838},[43,11327,528],{"class":53},[43,11329,100],{"class":49},[43,11331,54],{"class":53},[43,11333,535],{"class":57},[43,11335,11336,11338],{"class":45,"line":848},[43,11337,806],{"class":49},[43,11339,67],{"class":53},[43,11341,11342,11344,11346],{"class":45,"line":857},[43,11343,475],{"class":49},[43,11345,54],{"class":53},[43,11347,818],{"class":57},[43,11349,11350,11352,11354],{"class":45,"line":865},[43,11351,486],{"class":49},[43,11353,54],{"class":53},[43,11355,782],{"class":57},[43,11357,11358,11360,11362],{"class":45,"line":875},[43,11359,509],{"class":49},[43,11361,54],{"class":53},[43,11363,11364],{"class":57}," Full name of the customer.\n",[43,11366,11367,11369],{"class":45,"line":884},[43,11368,833],{"class":49},[43,11370,67],{"class":53},[43,11372,11373,11375,11377],{"class":45,"line":891},[43,11374,475],{"class":49},[43,11376,54],{"class":53},[43,11378,845],{"class":57},[43,11380,11381,11383,11385],{"class":45,"line":903},[43,11382,486],{"class":49},[43,11384,54],{"class":53},[43,11386,782],{"class":57},[43,11388,11389,11391,11393],{"class":45,"line":4229},[43,11390,509],{"class":49},[43,11392,54],{"class":53},[43,11394,11395],{"class":57}," Country of residence.\n",[43,11397,11398,11400],{"class":45,"line":4235},[43,11399,860],{"class":49},[43,11401,67],{"class":53},[43,11403,11404,11406,11408],{"class":45,"line":4241},[43,11405,475],{"class":49},[43,11407,54],{"class":53},[43,11409,872],{"class":57},[43,11411,11412,11414,11416],{"class":45,"line":4247},[43,11413,486],{"class":49},[43,11415,54],{"class":53},[43,11417,491],{"class":57},[43,11419,11420,11422,11424],{"class":45,"line":4256},[43,11421,509],{"class":49},[43,11423,54],{"class":53},[43,11425,11426],{"class":57}," Age of the customer.\n",[43,11428,11429,11431],{"class":45,"line":4269},[43,11430,520],{"class":49},[43,11432,67],{"class":53},[43,11434,11435,11437,11439,11441],{"class":45,"line":4275},[43,11436,528],{"class":53},[43,11438,100],{"class":49},[43,11440,54],{"class":53},[43,11442,900],{"class":57},[43,11444,11445,11447,11449],{"class":45,"line":4280},[43,11446,906],{"class":49},[43,11448,54],{"class":53},[43,11450,911],{"class":148},[43,11452,11453],{"class":45,"line":4291},[43,11454,244],{"emptyLinePlaceholder":243},[43,11456,11457,11460],{"class":45,"line":4313},[43,11458,11459],{"class":49},"  Product",[43,11461,67],{"class":53},[43,11463,11464,11466,11468],{"class":45,"line":4334},[43,11465,279],{"class":49},[43,11467,54],{"class":53},[43,11469,11470],{"class":57}," A product offered for sale.\n",[43,11472,11473,11475],{"class":45,"line":4355},[43,11474,682],{"class":49},[43,11476,67],{"class":53},[43,11478,11479,11481],{"class":45,"line":4382},[43,11480,296],{"class":53},[43,11482,11483],{"class":57}," product-catalog\n",[43,11485,11486,11488],{"class":45,"line":4396},[43,11487,459],{"class":49},[43,11489,67],{"class":53},[43,11491,11492,11494],{"class":45,"line":4402},[43,11493,467],{"class":49},[43,11495,67],{"class":53},[43,11497,11498,11500,11502],{"class":45,"line":4408},[43,11499,475],{"class":49},[43,11501,54],{"class":53},[43,11503,11504],{"class":57}," product_id\n",[43,11506,11507,11509,11511],{"class":45,"line":4414},[43,11508,486],{"class":49},[43,11510,54],{"class":53},[43,11512,491],{"class":57},[43,11514,11515,11517,11519],{"class":45,"line":4428},[43,11516,509],{"class":49},[43,11518,54],{"class":53},[43,11520,11521],{"class":57}," Surrogate key for product in staging.\n",[43,11523,11524,11526],{"class":45,"line":4436},[43,11525,520],{"class":49},[43,11527,67],{"class":53},[43,11529,11530,11532,11534,11536],{"class":45,"line":4442},[43,11531,528],{"class":53},[43,11533,100],{"class":49},[43,11535,54],{"class":53},[43,11537,535],{"class":57},[43,11539,11540,11542,11544,11546],{"class":45,"line":4447},[43,11541,528],{"class":53},[43,11543,100],{"class":49},[43,11545,54],{"class":53},[43,11547,547],{"class":57},[43,11549,11550,11553],{"class":45,"line":4457},[43,11551,11552],{"class":49},"      Name",[43,11554,67],{"class":53},[43,11556,11557,11559,11561],{"class":45,"line":4463},[43,11558,475],{"class":49},[43,11560,54],{"class":53},[43,11562,11563],{"class":57}," name\n",[43,11565,11566,11568,11570],{"class":45,"line":4469},[43,11567,486],{"class":49},[43,11569,54],{"class":53},[43,11571,782],{"class":57},[43,11573,11574,11576,11578],{"class":45,"line":4475},[43,11575,509],{"class":49},[43,11577,54],{"class":53},[43,11579,11580],{"class":57}," Product display name.\n",[43,11582,11583,11585],{"class":45,"line":4481},[43,11584,520],{"class":49},[43,11586,67],{"class":53},[43,11588,11589,11591,11593,11595],{"class":45,"line":4487},[43,11590,528],{"class":53},[43,11592,100],{"class":49},[43,11594,54],{"class":53},[43,11596,535],{"class":57},[43,11598,11599,11602],{"class":45,"line":4493},[43,11600,11601],{"class":49},"      Category",[43,11603,67],{"class":53},[43,11605,11606,11608,11610],{"class":45,"line":4499},[43,11607,475],{"class":49},[43,11609,54],{"class":53},[43,11611,11612],{"class":57}," category\n",[43,11614,11615,11617,11619],{"class":45,"line":4505},[43,11616,486],{"class":49},[43,11618,54],{"class":53},[43,11620,782],{"class":57},[43,11622,11623,11625,11627],{"class":45,"line":4511},[43,11624,509],{"class":49},[43,11626,54],{"class":53},[43,11628,11629],{"class":57}," Product category.\n",[43,11631,11632,11634],{"class":45,"line":4519},[43,11633,520],{"class":49},[43,11635,67],{"class":53},[43,11637,11638,11640,11642,11644],{"class":45,"line":4524},[43,11639,528],{"class":53},[43,11641,100],{"class":49},[43,11643,54],{"class":53},[43,11645,535],{"class":57},[43,11647,11648,11651],{"class":45,"line":4529},[43,11649,11650],{"class":49},"      SKU",[43,11652,67],{"class":53},[43,11654,11655,11657,11659],{"class":45,"line":4534},[43,11656,475],{"class":49},[43,11658,54],{"class":53},[43,11660,11661],{"class":57}," sku\n",[43,11663,11664,11666,11668],{"class":45,"line":4546},[43,11665,486],{"class":49},[43,11667,54],{"class":53},[43,11669,782],{"class":57},[43,11671,11672,11674,11676],{"class":45,"line":4574},[43,11673,509],{"class":49},[43,11675,54],{"class":53},[43,11677,11678],{"class":57}," Stock keeping unit for the product.\n",[43,11680,11681,11683],{"class":45,"line":4628},[43,11682,520],{"class":49},[43,11684,67],{"class":53},[43,11686,11687,11689,11691,11693],{"class":45,"line":4679},[43,11688,528],{"class":53},[43,11690,100],{"class":49},[43,11692,54],{"class":53},[43,11694,535],{"class":57},[43,11696,11697,11699,11701,11703],{"class":45,"line":4684},[43,11698,528],{"class":53},[43,11700,100],{"class":49},[43,11702,54],{"class":53},[43,11704,547],{"class":57},[43,11706,11707],{"class":45,"line":4714},[43,11708,244],{"emptyLinePlaceholder":243},[43,11710,11711,11714],{"class":45,"line":4756},[43,11712,11713],{"class":49},"  Variant",[43,11715,67],{"class":53},[43,11717,11718,11720,11722],{"class":45,"line":4796},[43,11719,279],{"class":49},[43,11721,54],{"class":53},[43,11723,11724],{"class":57}," A specific variation of a product.\n",[43,11726,11727,11729],{"class":45,"line":4833},[43,11728,682],{"class":49},[43,11730,67],{"class":53},[43,11732,11733,11735],{"class":45,"line":4870},[43,11734,296],{"class":53},[43,11736,11483],{"class":57},[43,11738,11739,11741],{"class":45,"line":4907},[43,11740,459],{"class":49},[43,11742,67],{"class":53},[43,11744,11745,11747],{"class":45,"line":4961},[43,11746,467],{"class":49},[43,11748,67],{"class":53},[43,11750,11751,11753,11755],{"class":45,"line":5011},[43,11752,475],{"class":49},[43,11754,54],{"class":53},[43,11756,11757],{"class":57}," variant_id\n",[43,11759,11760,11762,11764],{"class":45,"line":5061},[43,11761,486],{"class":49},[43,11763,54],{"class":53},[43,11765,491],{"class":57},[43,11767,11768,11770,11772],{"class":45,"line":5103},[43,11769,509],{"class":49},[43,11771,54],{"class":53},[43,11773,11774],{"class":57}," Surrogate key for variant in staging.\n",[43,11776,11777,11779],{"class":45,"line":5144},[43,11778,520],{"class":49},[43,11780,67],{"class":53},[43,11782,11783,11785,11787,11789],{"class":45,"line":5149},[43,11784,528],{"class":53},[43,11786,100],{"class":49},[43,11788,54],{"class":53},[43,11790,535],{"class":57},[43,11792,11793,11795,11797,11799],{"class":45,"line":5167},[43,11794,528],{"class":53},[43,11796,100],{"class":49},[43,11798,54],{"class":53},[43,11800,547],{"class":57},[43,11802,11803,11806],{"class":45,"line":5201},[43,11804,11805],{"class":49},"      ProductID",[43,11807,67],{"class":53},[43,11809,11810,11812,11814],{"class":45,"line":5230},[43,11811,475],{"class":49},[43,11813,54],{"class":53},[43,11815,11504],{"class":57},[43,11817,11818,11820,11822],{"class":45,"line":5239},[43,11819,486],{"class":49},[43,11821,54],{"class":53},[43,11823,491],{"class":57},[43,11825,11826,11828,11830],{"class":45,"line":5244},[43,11827,509],{"class":49},[43,11829,54],{"class":53},[43,11831,11832],{"class":57}," Reference to Product.ID.\n",[43,11834,11835,11837],{"class":45,"line":5249},[43,11836,520],{"class":49},[43,11838,67],{"class":53},[43,11840,11841,11843,11845,11847],{"class":45,"line":5265},[43,11842,528],{"class":53},[43,11844,100],{"class":49},[43,11846,54],{"class":53},[43,11848,535],{"class":57},[43,11850,11851,11853,11855,11857],{"class":45,"line":5297},[43,11852,528],{"class":53},[43,11854,100],{"class":49},[43,11856,54],{"class":53},[43,11858,11859],{"class":57}," positive\n",[43,11861,11862,11865],{"class":45,"line":5302},[43,11863,11864],{"class":49},"      VariantSKU",[43,11866,67],{"class":53},[43,11868,11869,11871,11873],{"class":45,"line":5307},[43,11870,475],{"class":49},[43,11872,54],{"class":53},[43,11874,11875],{"class":57}," variant_sku\n",[43,11877,11878,11880,11882],{"class":45,"line":5327},[43,11879,486],{"class":49},[43,11881,54],{"class":53},[43,11883,782],{"class":57},[43,11885,11886,11888,11890],{"class":45,"line":5338},[43,11887,509],{"class":49},[43,11889,54],{"class":53},[43,11891,11892],{"class":57}," SKU for the variant.\n",[43,11894,11895,11897],{"class":45,"line":5395},[43,11896,520],{"class":49},[43,11898,67],{"class":53},[43,11900,11901,11903,11905,11907],{"class":45,"line":5400},[43,11902,528],{"class":53},[43,11904,100],{"class":49},[43,11906,54],{"class":53},[43,11908,535],{"class":57},[43,11910,11911,11913,11915,11917],{"class":45,"line":5405},[43,11912,528],{"class":53},[43,11914,100],{"class":49},[43,11916,54],{"class":53},[43,11918,547],{"class":57},[43,11920,11921,11924],{"class":45,"line":5430},[43,11922,11923],{"class":49},"      Color",[43,11925,67],{"class":53},[43,11927,11928,11930,11932],{"class":45,"line":5454},[43,11929,475],{"class":49},[43,11931,54],{"class":53},[43,11933,11934],{"class":57}," color\n",[43,11936,11937,11939,11941],{"class":45,"line":5475},[43,11938,486],{"class":49},[43,11940,54],{"class":53},[43,11942,782],{"class":57},[43,11944,11945,11947,11949],{"class":45,"line":5488},[43,11946,509],{"class":49},[43,11948,54],{"class":53},[43,11950,11951],{"class":57}," Variant color.\n",[43,11953,11954,11957],{"class":45,"line":5493},[43,11955,11956],{"class":49},"      Size",[43,11958,67],{"class":53},[43,11960,11961,11963,11965],{"class":45,"line":5508},[43,11962,475],{"class":49},[43,11964,54],{"class":53},[43,11966,11967],{"class":57}," size\n",[43,11969,11970,11972,11974],{"class":45,"line":5529},[43,11971,486],{"class":49},[43,11973,54],{"class":53},[43,11975,782],{"class":57},[43,11977,11978,11980,11982],{"class":45,"line":5537},[43,11979,509],{"class":49},[43,11981,54],{"class":53},[43,11983,11984],{"class":57}," Variant size.\n",[43,11986,11987,11990],{"class":45,"line":5550},[43,11988,11989],{"class":49},"      ManufacturingPrice",[43,11991,67],{"class":53},[43,11993,11994,11996,11998],{"class":45,"line":5567},[43,11995,475],{"class":49},[43,11997,54],{"class":53},[43,11999,12000],{"class":57}," manufacturing_price\n",[43,12002,12003,12005,12007],{"class":45,"line":5579},[43,12004,486],{"class":49},[43,12006,54],{"class":53},[43,12008,12009],{"class":57}," numeric\n",[43,12011,12012,12014,12016],{"class":45,"line":5601},[43,12013,509],{"class":49},[43,12015,54],{"class":53},[43,12017,12018],{"class":57}," Manufacturing cost per unit.\n",[43,12020,12021,12023],{"class":45,"line":5621},[43,12022,520],{"class":49},[43,12024,67],{"class":53},[43,12026,12027,12029,12031,12033],{"class":45,"line":5640},[43,12028,528],{"class":53},[43,12030,100],{"class":49},[43,12032,54],{"class":53},[43,12034,535],{"class":57},[43,12036,12037,12040],{"class":45,"line":5646},[43,12038,12039],{"class":49},"      SellingPrice",[43,12041,67],{"class":53},[43,12043,12044,12046,12048],{"class":45,"line":5651},[43,12045,475],{"class":49},[43,12047,54],{"class":53},[43,12049,12050],{"class":57}," selling_price\n",[43,12052,12053,12055,12057],{"class":45,"line":5656},[43,12054,486],{"class":49},[43,12056,54],{"class":53},[43,12058,12009],{"class":57},[43,12060,12061,12063,12065],{"class":45,"line":5670},[43,12062,509],{"class":49},[43,12064,54],{"class":53},[43,12066,12067],{"class":57}," Selling price per unit.\n",[43,12069,12070,12072],{"class":45,"line":5687},[43,12071,520],{"class":49},[43,12073,67],{"class":53},[43,12075,12076,12078,12080,12082],{"class":45,"line":5710},[43,12077,528],{"class":53},[43,12079,100],{"class":49},[43,12081,54],{"class":53},[43,12083,535],{"class":57},[43,12085,12086,12089],{"class":45,"line":5717},[43,12087,12088],{"class":49},"      StockQuantity",[43,12090,67],{"class":53},[43,12092,12093,12095,12097],{"class":45,"line":5758},[43,12094,475],{"class":49},[43,12096,54],{"class":53},[43,12098,12099],{"class":57}," stock_quantity\n",[43,12101,12102,12104,12106],{"class":45,"line":5766},[43,12103,486],{"class":49},[43,12105,54],{"class":53},[43,12107,491],{"class":57},[43,12109,12110,12112,12114],{"class":45,"line":5796},[43,12111,509],{"class":49},[43,12113,54],{"class":53},[43,12115,12116],{"class":57}," Available stock quantity.\n",[43,12118,12119,12121],{"class":45,"line":5815},[43,12120,520],{"class":49},[43,12122,67],{"class":53},[43,12124,12125,12127,12129,12131],{"class":45,"line":5834},[43,12126,528],{"class":53},[43,12128,100],{"class":49},[43,12130,54],{"class":53},[43,12132,535],{"class":57},[43,12134,12135,12138],{"class":45,"line":5839},[43,12136,12137],{"class":49},"      IsActive",[43,12139,67],{"class":53},[43,12141,12142,12144,12146],{"class":45,"line":5844},[43,12143,475],{"class":49},[43,12145,54],{"class":53},[43,12147,12148],{"class":57}," is_active\n",[43,12150,12151,12153,12155],{"class":45,"line":5849},[43,12152,486],{"class":49},[43,12154,54],{"class":53},[43,12156,12157],{"class":57}," boolean\n",[43,12159,12160,12162,12164],{"class":45,"line":5869},[43,12161,509],{"class":49},[43,12163,54],{"class":53},[43,12165,12166],{"class":57}," Whether the variant is active.\n",[43,12168,12169,12171],{"class":45,"line":5889},[43,12170,520],{"class":49},[43,12172,67],{"class":53},[43,12174,12175,12177,12179,12181],{"class":45,"line":5921},[43,12176,528],{"class":53},[43,12178,100],{"class":49},[43,12180,54],{"class":53},[43,12182,535],{"class":57},[43,12184,12185],{"class":45,"line":5955},[43,12186,244],{"emptyLinePlaceholder":243},[43,12188,12189,12192],{"class":45,"line":5976},[43,12190,12191],{"class":49},"  Order",[43,12193,67],{"class":53},[43,12195,12196,12198,12200],{"class":45,"line":6033},[43,12197,279],{"class":49},[43,12199,54],{"class":53},[43,12201,12202],{"class":57}," A purchase order placed by a customer.\n",[43,12204,12205,12207],{"class":45,"line":6038},[43,12206,682],{"class":49},[43,12208,67],{"class":53},[43,12210,12211,12213],{"class":45,"line":6044},[43,12212,296],{"class":53},[43,12214,422],{"class":57},[43,12216,12217,12219],{"class":45,"line":6084},[43,12218,459],{"class":49},[43,12220,67],{"class":53},[43,12222,12223,12225],{"class":45,"line":6102},[43,12224,467],{"class":49},[43,12226,67],{"class":53},[43,12228,12229,12231,12233],{"class":45,"line":6122},[43,12230,475],{"class":49},[43,12232,54],{"class":53},[43,12234,12235],{"class":57}," order_id\n",[43,12237,12238,12240,12242],{"class":45,"line":6130},[43,12239,486],{"class":49},[43,12241,54],{"class":53},[43,12243,491],{"class":57},[43,12245,12246,12248,12250],{"class":45,"line":6154},[43,12247,509],{"class":49},[43,12249,54],{"class":53},[43,12251,12252],{"class":57}," Surrogate key for order in staging.\n",[43,12254,12255,12257],{"class":45,"line":6159},[43,12256,520],{"class":49},[43,12258,67],{"class":53},[43,12260,12261,12263,12265,12267],{"class":45,"line":6196},[43,12262,528],{"class":53},[43,12264,100],{"class":49},[43,12266,54],{"class":53},[43,12268,535],{"class":57},[43,12270,12271,12273,12275,12277],{"class":45,"line":6235},[43,12272,528],{"class":53},[43,12274,100],{"class":49},[43,12276,54],{"class":53},[43,12278,547],{"class":57},[43,12280,12281,12284],{"class":45,"line":6243},[43,12282,12283],{"class":49},"      CustomerID",[43,12285,67],{"class":53},[43,12287,12288,12290,12292],{"class":45,"line":6276},[43,12289,475],{"class":49},[43,12291,54],{"class":53},[43,12293,716],{"class":57},[43,12295,12296,12298,12300],{"class":45,"line":6300},[43,12297,486],{"class":49},[43,12299,54],{"class":53},[43,12301,491],{"class":57},[43,12303,12304,12306,12308],{"class":45,"line":6336},[43,12305,509],{"class":49},[43,12307,54],{"class":53},[43,12309,12310],{"class":57}," Reference to Customer.ID for the purchaser.\n",[43,12312,12313,12315],{"class":45,"line":6342},[43,12314,520],{"class":49},[43,12316,67],{"class":53},[43,12318,12319,12321,12323,12325],{"class":45,"line":6347},[43,12320,528],{"class":53},[43,12322,100],{"class":49},[43,12324,54],{"class":53},[43,12326,535],{"class":57},[43,12328,12329,12331,12333,12335],{"class":45,"line":6352},[43,12330,528],{"class":53},[43,12332,100],{"class":49},[43,12334,54],{"class":53},[43,12336,11859],{"class":57},[43,12338,12339,12342],{"class":45,"line":6380},[43,12340,12341],{"class":49},"      OrderNumber",[43,12343,67],{"class":53},[43,12345,12346,12348,12350],{"class":45,"line":6397},[43,12347,475],{"class":49},[43,12349,54],{"class":53},[43,12351,12352],{"class":57}," order_number\n",[43,12354,12355,12357,12359],{"class":45,"line":6458},[43,12356,486],{"class":49},[43,12358,54],{"class":53},[43,12360,782],{"class":57},[43,12362,12363,12365,12367],{"class":45,"line":6495},[43,12364,509],{"class":49},[43,12366,54],{"class":53},[43,12368,12369],{"class":57}," Human-readable order number.\n",[43,12371,12372,12375],{"class":45,"line":6500},[43,12373,12374],{"class":49},"      OrderDate",[43,12376,67],{"class":53},[43,12378,12379,12381,12383],{"class":45,"line":6505},[43,12380,475],{"class":49},[43,12382,54],{"class":53},[43,12384,12385],{"class":57}," order_date\n",[43,12387,12388,12390,12392],{"class":45,"line":6530},[43,12389,486],{"class":49},[43,12391,54],{"class":53},[43,12393,575],{"class":57},[43,12395,12396,12398,12400],{"class":45,"line":6545},[43,12397,509],{"class":49},[43,12399,54],{"class":53},[43,12401,12402],{"class":57}," When the order was placed.\n",[43,12404,12405,12407],{"class":45,"line":6595},[43,12406,520],{"class":49},[43,12408,67],{"class":53},[43,12410,12411,12413,12415,12417],{"class":45,"line":6670},[43,12412,528],{"class":53},[43,12414,100],{"class":49},[43,12416,54],{"class":53},[43,12418,535],{"class":57},[43,12420,12421,12424],{"class":45,"line":6675},[43,12422,12423],{"class":49},"      Status",[43,12425,67],{"class":53},[43,12427,12428,12430,12432],{"class":45,"line":6680},[43,12429,475],{"class":49},[43,12431,54],{"class":53},[43,12433,12434],{"class":57}," status\n",[43,12436,12437,12439,12441],{"class":45,"line":6733},[43,12438,486],{"class":49},[43,12440,54],{"class":53},[43,12442,782],{"class":57},[43,12444,12445,12447,12449],{"class":45,"line":6753},[43,12446,509],{"class":49},[43,12448,54],{"class":53},[43,12450,12451],{"class":57}," Order lifecycle status.\n",[43,12453,12454,12456],{"class":45,"line":6798},[43,12455,520],{"class":49},[43,12457,67],{"class":53},[43,12459,12460,12462,12464,12466],{"class":45,"line":6848},[43,12461,528],{"class":53},[43,12463,100],{"class":49},[43,12465,54],{"class":53},[43,12467,535],{"class":57},[43,12469,12470,12472,12474,12476],{"class":45,"line":6895},[43,12471,528],{"class":53},[43,12473,100],{"class":49},[43,12475,54],{"class":53},[43,12477,12478],{"class":57}," accepted_values\n",[43,12480,12481,12484],{"class":45,"line":6911},[43,12482,12483],{"class":49},"            value",[43,12485,67],{"class":53},[43,12487,12488,12491],{"class":45,"line":6930},[43,12489,12490],{"class":53},"              -",[43,12492,12493],{"class":57}," pending\n",[43,12495,12496,12498],{"class":45,"line":6966},[43,12497,12490],{"class":53},[43,12499,12500],{"class":57}," paid\n",[43,12502,12503,12505],{"class":45,"line":6971},[43,12504,12490],{"class":53},[43,12506,12507],{"class":57}," cancelled\n",[43,12509,12510,12512],{"class":45,"line":6976},[43,12511,12490],{"class":53},[43,12513,12514],{"class":57}," shipped\n",[43,12516,12517,12520],{"class":45,"line":6986},[43,12518,12519],{"class":49},"      TotalAmount",[43,12521,67],{"class":53},[43,12523,12524,12526,12528],{"class":45,"line":6998},[43,12525,475],{"class":49},[43,12527,54],{"class":53},[43,12529,10647],{"class":57},[43,12531,12532,12534,12536],{"class":45,"line":7020},[43,12533,486],{"class":49},[43,12535,54],{"class":53},[43,12537,12009],{"class":57},[43,12539,12540,12542,12544],{"class":45,"line":7040},[43,12541,509],{"class":49},[43,12543,54],{"class":53},[43,12545,12546],{"class":57}," Total order amount.\n",[43,12548,12549,12551],{"class":45,"line":7077},[43,12550,520],{"class":49},[43,12552,67],{"class":53},[43,12554,12555,12557,12559,12561],{"class":45,"line":7082},[43,12556,528],{"class":53},[43,12558,100],{"class":49},[43,12560,54],{"class":53},[43,12562,535],{"class":57},[43,12564,12565,12567,12569,12571],{"class":45,"line":7100},[43,12566,528],{"class":53},[43,12568,100],{"class":49},[43,12570,54],{"class":53},[43,12572,900],{"class":57},[43,12574,12575,12577,12579],{"class":45,"line":7141},[43,12576,906],{"class":49},[43,12578,54],{"class":53},[43,12580,911],{"class":148},[43,12582,12583],{"class":45,"line":7203},[43,12584,244],{"emptyLinePlaceholder":243},[43,12586,12587,12590],{"class":45,"line":7208},[43,12588,12589],{"class":49},"  OrderItem",[43,12591,67],{"class":53},[43,12593,12594,12596,12598],{"class":45,"line":7250},[43,12595,279],{"class":49},[43,12597,54],{"class":53},[43,12599,12600],{"class":57}," A line item in an order.\n",[43,12602,12603,12605],{"class":45,"line":7305},[43,12604,682],{"class":49},[43,12606,67],{"class":53},[43,12608,12609,12611],{"class":45,"line":7310},[43,12610,296],{"class":53},[43,12612,422],{"class":57},[43,12614,12615,12617],{"class":45,"line":7341},[43,12616,459],{"class":49},[43,12618,67],{"class":53},[43,12620,12621,12623],{"class":45,"line":7367},[43,12622,467],{"class":49},[43,12624,67],{"class":53},[43,12626,12627,12629,12631],{"class":45,"line":7392},[43,12628,475],{"class":49},[43,12630,54],{"class":53},[43,12632,12633],{"class":57}," order_item_id\n",[43,12635,12636,12638,12640],{"class":45,"line":7397},[43,12637,486],{"class":49},[43,12639,54],{"class":53},[43,12641,491],{"class":57},[43,12643,12644,12646,12648],{"class":45,"line":7428},[43,12645,509],{"class":49},[43,12647,54],{"class":53},[43,12649,12650],{"class":57}," Surrogate key for order item in staging.\n",[43,12652,12653,12655],{"class":45,"line":7460},[43,12654,520],{"class":49},[43,12656,67],{"class":53},[43,12658,12659,12661,12663,12665],{"class":45,"line":7465},[43,12660,528],{"class":53},[43,12662,100],{"class":49},[43,12664,54],{"class":53},[43,12666,535],{"class":57},[43,12668,12669,12671,12673,12675],{"class":45,"line":7485},[43,12670,528],{"class":53},[43,12672,100],{"class":49},[43,12674,54],{"class":53},[43,12676,547],{"class":57},[43,12678,12679,12682],{"class":45,"line":7512},[43,12680,12681],{"class":49},"      OrderID",[43,12683,67],{"class":53},[43,12685,12686,12688,12690],{"class":45,"line":7524},[43,12687,475],{"class":49},[43,12689,54],{"class":53},[43,12691,12235],{"class":57},[43,12693,12694,12696,12698],{"class":45,"line":7529},[43,12695,486],{"class":49},[43,12697,54],{"class":53},[43,12699,491],{"class":57},[43,12701,12702,12704,12706],{"class":45,"line":7576},[43,12703,509],{"class":49},[43,12705,54],{"class":53},[43,12707,12708],{"class":57}," Reference to Order.ID this item belongs to.\n",[43,12710,12711,12713],{"class":45,"line":7614},[43,12712,520],{"class":49},[43,12714,67],{"class":53},[43,12716,12717,12719,12721,12723],{"class":45,"line":7619},[43,12718,528],{"class":53},[43,12720,100],{"class":49},[43,12722,54],{"class":53},[43,12724,535],{"class":57},[43,12726,12727,12729,12731,12733],{"class":45,"line":7677},[43,12728,528],{"class":53},[43,12730,100],{"class":49},[43,12732,54],{"class":53},[43,12734,11859],{"class":57},[43,12736,12737,12740],{"class":45,"line":7718},[43,12738,12739],{"class":49},"      VariantID",[43,12741,67],{"class":53},[43,12743,12744,12746,12748],{"class":45,"line":7755},[43,12745,475],{"class":49},[43,12747,54],{"class":53},[43,12749,11757],{"class":57},[43,12751,12752,12754,12756],{"class":45,"line":7760},[43,12753,486],{"class":49},[43,12755,54],{"class":53},[43,12757,491],{"class":57},[43,12759,12760,12762,12764],{"class":45,"line":7779},[43,12761,509],{"class":49},[43,12763,54],{"class":53},[43,12765,12766],{"class":57}," Reference to Variant.ID purchased.\n",[43,12768,12769,12771],{"class":45,"line":7805},[43,12770,520],{"class":49},[43,12772,67],{"class":53},[43,12774,12775,12777,12779,12781],{"class":45,"line":7816},[43,12776,528],{"class":53},[43,12778,100],{"class":49},[43,12780,54],{"class":53},[43,12782,535],{"class":57},[43,12784,12785,12787,12789,12791],{"class":45,"line":7821},[43,12786,528],{"class":53},[43,12788,100],{"class":49},[43,12790,54],{"class":53},[43,12792,11859],{"class":57},[43,12794,12795,12798],{"class":45,"line":7840},[43,12796,12797],{"class":49},"      Quantity",[43,12799,67],{"class":53},[43,12801,12802,12804,12806],{"class":45,"line":7867},[43,12803,475],{"class":49},[43,12805,54],{"class":53},[43,12807,12808],{"class":57}," quantity\n",[43,12810,12811,12813,12815],{"class":45,"line":7889},[43,12812,486],{"class":49},[43,12814,54],{"class":53},[43,12816,491],{"class":57},[43,12818,12819,12821,12823],{"class":45,"line":7914},[43,12820,509],{"class":49},[43,12822,54],{"class":53},[43,12824,12825],{"class":57}," Quantity purchased (must be positive).\n",[43,12827,12828,12830],{"class":45,"line":7934},[43,12829,520],{"class":49},[43,12831,67],{"class":53},[43,12833,12834,12836,12838,12840],{"class":45,"line":7959},[43,12835,528],{"class":53},[43,12837,100],{"class":49},[43,12839,54],{"class":53},[43,12841,535],{"class":57},[43,12843,12844,12846,12848,12850],{"class":45,"line":7979},[43,12845,528],{"class":53},[43,12847,100],{"class":49},[43,12849,54],{"class":53},[43,12851,900],{"class":57},[43,12853,12854,12856,12858],{"class":45,"line":8014},[43,12855,906],{"class":49},[43,12857,54],{"class":53},[43,12859,12860],{"class":148}," 1\n",[43,12862,12863,12866],{"class":45,"line":8034},[43,12864,12865],{"class":49},"      UnitPrice",[43,12867,67],{"class":53},[43,12869,12870,12872,12874],{"class":45,"line":8069},[43,12871,475],{"class":49},[43,12873,54],{"class":53},[43,12875,12876],{"class":57}," unit_price\n",[43,12878,12879,12881,12883],{"class":45,"line":8089},[43,12880,486],{"class":49},[43,12882,54],{"class":53},[43,12884,12009],{"class":57},[43,12886,12887,12889,12891],{"class":45,"line":8107},[43,12888,509],{"class":49},[43,12890,54],{"class":53},[43,12892,12893],{"class":57}," Price per unit at purchase time.\n",[43,12895,12896,12898],{"class":45,"line":8124},[43,12897,520],{"class":49},[43,12899,67],{"class":53},[43,12901,12902,12904,12906,12908],{"class":45,"line":8129},[43,12903,528],{"class":53},[43,12905,100],{"class":49},[43,12907,54],{"class":53},[43,12909,535],{"class":57},[43,12911,12912,12914,12916,12918],{"class":45,"line":8177},[43,12913,528],{"class":53},[43,12915,100],{"class":49},[43,12917,54],{"class":53},[43,12919,900],{"class":57},[43,12921,12922,12924,12926],{"class":45,"line":8182},[43,12923,906],{"class":49},[43,12925,54],{"class":53},[43,12927,911],{"class":148},[43,12929,12930,12933],{"class":45,"line":8187},[43,12931,12932],{"class":49},"      TotalPrice",[43,12934,67],{"class":53},[43,12936,12937,12939,12941],{"class":45,"line":8207},[43,12938,475],{"class":49},[43,12940,54],{"class":53},[43,12942,12943],{"class":57}," total_price\n",[43,12945,12947,12949,12951],{"class":45,"line":12946},268,[43,12948,486],{"class":49},[43,12950,54],{"class":53},[43,12952,12009],{"class":57},[43,12954,12956,12958,12960],{"class":45,"line":12955},269,[43,12957,509],{"class":49},[43,12959,54],{"class":53},[43,12961,12962],{"class":57}," Total price for the line (Quantity * UnitPrice).\n",[43,12964,12966,12968],{"class":45,"line":12965},270,[43,12967,520],{"class":49},[43,12969,67],{"class":53},[43,12971,12973,12975,12977,12979],{"class":45,"line":12972},271,[43,12974,528],{"class":53},[43,12976,100],{"class":49},[43,12978,54],{"class":53},[43,12980,535],{"class":57},[43,12982,12984,12986,12988,12990],{"class":45,"line":12983},272,[43,12985,528],{"class":53},[43,12987,100],{"class":49},[43,12989,54],{"class":53},[43,12991,900],{"class":57},[43,12993,12995,12997,12999],{"class":45,"line":12994},273,[43,12996,906],{"class":49},[43,12998,54],{"class":53},[43,13000,911],{"class":148},[1992,13002,13003,13004,13006],{},"You can work with column check by adding inside your asset the ",[40,13005,9841],{}," the needed definitions for the output of the column that you will materialize:",[33,13008,13011],{"className":1195,"code":13009,"filename":1819,"highlights":13010,"language":1198,"meta":38,"style":38},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns: \n  - name: customer_id \n    type: integer\n    primary_key: true\n    checks:\n      - name: unique\n      - name: not_null\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[162,170,182,374,382,392,399],[40,13012,13013,13017,13021,13025,13029,13033,13037,13041,13045,13049,13053,13057,13064,13070,13076,13082,13088,13094,13100,13104,13108,13114,13124,13142,13164,13178,13182,13186,13192],{"__ignoreMap":38},[43,13014,13015],{"class":45,"line":46},[43,13016,1205],{"class":1006},[43,13018,13019],{"class":45,"line":61},[43,13020,1830],{"class":1006},[43,13022,13023],{"class":45,"line":70},[43,13024,1215],{"class":1006},[43,13026,13027],{"class":45,"line":78},[43,13028,244],{"emptyLinePlaceholder":243},[43,13030,13031],{"class":45,"line":86},[43,13032,1235],{"class":1006},[43,13034,13035],{"class":45,"line":94},[43,13036,1240],{"class":1006},[43,13038,13039],{"class":45,"line":108},[43,13040,244],{"emptyLinePlaceholder":243},[43,13042,13043],{"class":45,"line":119},[43,13044,1250],{"class":1006},[43,13046,13047],{"class":45,"line":129},[43,13048,1851],{"class":1006},[43,13050,13051],{"class":45,"line":140},[43,13052,9882],{"class":1006},[43,13054,13055],{"class":45,"line":152},[43,13056,244],{"emptyLinePlaceholder":243},[43,13058,13061],{"class":13059,"line":162},[45,13060],"highlight",[43,13062,13063],{"class":1006},"columns: \n",[43,13065,13067],{"class":13066,"line":170},[45,13060],[43,13068,13069],{"class":1006},"  - name: customer_id \n",[43,13071,13073],{"class":13072,"line":182},[45,13060],[43,13074,13075],{"class":1006},"    type: integer\n",[43,13077,13079],{"class":13078,"line":374},[45,13060],[43,13080,13081],{"class":1006},"    primary_key: true\n",[43,13083,13085],{"class":13084,"line":382},[45,13060],[43,13086,13087],{"class":1006},"    checks:\n",[43,13089,13091],{"class":13090,"line":392},[45,13060],[43,13092,13093],{"class":1006},"      - name: unique\n",[43,13095,13097],{"class":13096,"line":399},[45,13060],[43,13098,13099],{"class":1006},"      - name: not_null\n",[43,13101,13102],{"class":45,"line":410},[43,13103,1265],{"class":1006},[43,13105,13106],{"class":45,"line":417},[43,13107,244],{"emptyLinePlaceholder":243},[43,13109,13110,13112],{"class":45,"line":425},[43,13111,1410],{"class":148},[43,13113,9728],{"class":1277},[43,13115,13116,13118,13120,13122],{"class":45,"line":430},[43,13117,1868],{"class":1277},[43,13119,1872],{"class":1871},[43,13121,1389],{"class":148},[43,13123,9946],{"class":1277},[43,13125,13126,13128,13130,13132,13134,13136,13138,13140],{"class":45,"line":438},[43,13127,1882],{"class":1418},[43,13129,1422],{"class":1277},[43,13131,1887],{"class":1418},[43,13133,1890],{"class":1277},[43,13135,1893],{"class":53},[43,13137,1428],{"class":1277},[43,13139,1281],{"class":148},[43,13141,1900],{"class":1277},[43,13143,13144,13146,13148,13150,13152,13154,13156,13158,13160,13162],{"class":45,"line":446},[43,13145,1882],{"class":1418},[43,13147,1422],{"class":1277},[43,13149,1887],{"class":1418},[43,13151,1911],{"class":1277},[43,13153,1590],{"class":53},[43,13155,1916],{"class":57},[43,13157,1590],{"class":53},[43,13159,1428],{"class":1277},[43,13161,1281],{"class":148},[43,13163,1925],{"class":1277},[43,13165,13166,13168,13170,13172,13174,13176],{"class":45,"line":456},[43,13167,1882],{"class":1418},[43,13169,1932],{"class":1277},[43,13171,1935],{"class":148},[43,13173,1428],{"class":1277},[43,13175,1281],{"class":148},[43,13177,1942],{"class":1277},[43,13179,13180],{"class":45,"line":464},[43,13181,1947],{"class":1277},[43,13183,13184],{"class":45,"line":472},[43,13185,1952],{"class":1277},[43,13187,13188,13190],{"class":45,"line":483},[43,13189,1438],{"class":148},[43,13191,1022],{"class":1277},[43,13193,13194,13196,13198,13200],{"class":45,"line":494},[43,13195,1963],{"class":148},[43,13197,1966],{"class":1277},[43,13199,1969],{"class":148},[43,13201,1462],{"class":1277},[1992,13203,13204],{},[1977,13205,13206],{},"Available Check Types",[2135,13208,13209,13222],{},[2138,13210,13211],{},[2141,13212,13213,13216,13219],{},[2144,13214,13215],{},"Check Type",[2144,13217,13218],{},"Purpose",[2144,13220,13221],{},"Example Configuration",[2151,13223,13224,13239,13253,13279,13309,13324],{},[2141,13225,13226,13231,13234],{},[2156,13227,13228],{},[40,13229,13230],{},"not_null",[2156,13232,13233],{},"Ensures no NULL values",[2156,13235,13236],{},[40,13237,13238],{},"- name: not_null",[2141,13240,13241,13245,13248],{},[2156,13242,13243],{},[40,13244,5557],{},[2156,13246,13247],{},"Ensures no duplicate values",[2156,13249,13250],{},[40,13251,13252],{},"- name: unique",[2141,13254,13255,13260,13263],{},[2156,13256,13257],{},[40,13258,13259],{},"range",[2156,13261,13262],{},"Validates numeric ranges",[2156,13264,13265,13268,13271,13274,13276],{},[40,13266,13267],{},"- name: range",[13269,13270],"br",{},[40,13272,13273],{},"  min: 0",[13269,13275],{},[40,13277,13278],{},"  max: 100",[2141,13280,13281,13286,13289],{},[2156,13282,13283],{},[40,13284,13285],{},"accepted_values",[2156,13287,13288],{},"Validates against allowed values",[2156,13290,13291,13294,13296,13299,13301,13304,13306],{},[40,13292,13293],{},"- name: accepted_values",[13269,13295],{},[40,13297,13298],{},"  value:",[13269,13300],{},[40,13302,13303],{},"    - pending",[13269,13305],{},[40,13307,13308],{},"    - paid",[2141,13310,13311,13316,13319],{},[2156,13312,13313],{},[40,13314,13315],{},"positive",[2156,13317,13318],{},"Ensures positive numbers",[2156,13320,13321],{},[40,13322,13323],{},"- name: positive",[2141,13325,13326,13331,13334],{},[2156,13327,13328],{},[40,13329,13330],{},"regex",[2156,13332,13333],{},"Pattern matching validation",[2156,13335,13336,13339,13341],{},[40,13337,13338],{},"- name: regex",[13269,13340],{},[40,13342,13343],{},"  pattern: '^[A-Z]{3}-\\d{4}$'",[1992,13345,13346,13347,13350,13351,13354,13355,13357,13358,13361],{},"Bruin's approach to data quality is ",[1977,13348,13349],{},"declarative and reusable",". Instead of writing custom validation SQL for every table, you define ",[1977,13352,13353],{},"entities and attributes"," in ",[40,13356,258],{},", then reference them in your staging assets using the ",[40,13359,13360],{},"extends:"," keyword.",[1992,13363,13364],{},"Here's how the column check system works:",[1992,13366,13367],{},[1977,13368,13369],{},"Entity Definition in glossary.yml:",[33,13371,13373],{"className":35,"code":13372,"language":37,"meta":38,"style":38},"entities:\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n",[40,13374,13375,13381,13387,13395,13401,13407,13413,13419,13427,13435,13443,13449,13459,13465,13473,13481,13489,13495,13505],{"__ignoreMap":38},[43,13376,13377,13379],{"class":45,"line":46},[43,13378,433],{"class":49},[43,13380,67],{"class":53},[43,13382,13383,13385],{"class":45,"line":61},[43,13384,664],{"class":49},[43,13386,67],{"class":53},[43,13388,13389,13391,13393],{"class":45,"line":70},[43,13390,279],{"class":49},[43,13392,54],{"class":53},[43,13394,676],{"class":57},[43,13396,13397,13399],{"class":45,"line":78},[43,13398,682],{"class":49},[43,13400,67],{"class":53},[43,13402,13403,13405],{"class":45,"line":86},[43,13404,296],{"class":53},[43,13406,692],{"class":57},[43,13408,13409,13411],{"class":45,"line":94},[43,13410,459],{"class":49},[43,13412,67],{"class":53},[43,13414,13415,13417],{"class":45,"line":108},[43,13416,760],{"class":49},[43,13418,67],{"class":53},[43,13420,13421,13423,13425],{"class":45,"line":119},[43,13422,475],{"class":49},[43,13424,54],{"class":53},[43,13426,772],{"class":57},[43,13428,13429,13431,13433],{"class":45,"line":129},[43,13430,486],{"class":49},[43,13432,54],{"class":53},[43,13434,782],{"class":57},[43,13436,13437,13439,13441],{"class":45,"line":140},[43,13438,509],{"class":49},[43,13440,54],{"class":53},[43,13442,11317],{"class":57},[43,13444,13445,13447],{"class":45,"line":152},[43,13446,520],{"class":49},[43,13448,67],{"class":53},[43,13450,13451,13453,13455,13457],{"class":45,"line":162},[43,13452,528],{"class":53},[43,13454,100],{"class":49},[43,13456,54],{"class":53},[43,13458,535],{"class":57},[43,13460,13461,13463],{"class":45,"line":170},[43,13462,860],{"class":49},[43,13464,67],{"class":53},[43,13466,13467,13469,13471],{"class":45,"line":182},[43,13468,475],{"class":49},[43,13470,54],{"class":53},[43,13472,872],{"class":57},[43,13474,13475,13477,13479],{"class":45,"line":374},[43,13476,486],{"class":49},[43,13478,54],{"class":53},[43,13480,491],{"class":57},[43,13482,13483,13485,13487],{"class":45,"line":382},[43,13484,509],{"class":49},[43,13486,54],{"class":53},[43,13488,11426],{"class":57},[43,13490,13491,13493],{"class":45,"line":392},[43,13492,520],{"class":49},[43,13494,67],{"class":53},[43,13496,13497,13499,13501,13503],{"class":45,"line":399},[43,13498,528],{"class":53},[43,13500,100],{"class":49},[43,13502,54],{"class":53},[43,13504,900],{"class":57},[43,13506,13507,13509,13511],{"class":45,"line":410},[43,13508,906],{"class":49},[43,13510,54],{"class":53},[43,13512,911],{"class":148},[1992,13514,13515],{},"Then, at your asset you could easily just extends it, avoiding duplicate validations across other assets:",[33,13517,13519],{"className":1195,"code":13518,"language":1198,"meta":38,"style":38},"/* @bruin\ncolumns:\n  - extends: Customer.Email    # Inherits not_null check\n  - extends: Customer.Age      # Inherits range check (min: 0)\n@bruin */\n",[40,13520,13521,13525,13529,13534,13539],{"__ignoreMap":38},[43,13522,13523],{"class":45,"line":46},[43,13524,1205],{"class":1006},[43,13526,13527],{"class":45,"line":61},[43,13528,9891],{"class":1006},[43,13530,13531],{"class":45,"line":70},[43,13532,13533],{"class":1006},"  - extends: Customer.Email    # Inherits not_null check\n",[43,13535,13536],{"class":45,"line":78},[43,13537,13538],{"class":1006},"  - extends: Customer.Age      # Inherits range check (min: 0)\n",[43,13540,13541],{"class":45,"line":86},[43,13542,1265],{"class":1006},[1992,13544,13545,13546,13549],{},"For complex validations that go beyond column-level checks, Bruin supports ",[1977,13547,13548],{},"custom checks"," with SQL queries:",[33,13551,13553],{"className":35,"code":13552,"language":37,"meta":38,"style":38},"custom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0  # Expected result (0 = no violations)\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[40,13554,13555,13562,13573,13582,13586,13590,13602,13611,13615,13619,13623,13627,13631],{"__ignoreMap":38},[43,13556,13557,13560],{"class":45,"line":46},[43,13558,13559],{"class":49},"custom_checks",[43,13561,67],{"class":53},[43,13563,13564,13566,13568,13570],{"class":45,"line":61},[43,13565,1062],{"class":53},[43,13567,100],{"class":49},[43,13569,54],{"class":53},[43,13571,13572],{"class":57}," validate product variant sizes\n",[43,13574,13575,13577,13579],{"class":45,"line":70},[43,13576,279],{"class":49},[43,13578,54],{"class":53},[43,13580,13581],{"class":3427}," |\n",[43,13583,13584],{"class":45,"line":78},[43,13585,10279],{"class":57},[43,13587,13588],{"class":45,"line":86},[43,13589,10284],{"class":57},[43,13591,13592,13595,13597,13599],{"class":45,"line":94},[43,13593,13594],{"class":49},"    value",[43,13596,54],{"class":53},[43,13598,1737],{"class":148},[43,13600,13601],{"class":1006},"  # Expected result (0 = no violations)\n",[43,13603,13604,13607,13609],{"class":45,"line":108},[43,13605,13606],{"class":49},"    query",[43,13608,54],{"class":53},[43,13610,13581],{"class":3427},[43,13612,13613],{"class":45,"line":119},[43,13614,10299],{"class":57},[43,13616,13617],{"class":45,"line":129},[43,13618,10304],{"class":57},[43,13620,13621],{"class":45,"line":140},[43,13622,10309],{"class":57},[43,13624,13625],{"class":45,"line":152},[43,13626,10314],{"class":57},[43,13628,13629],{"class":45,"line":162},[43,13630,10319],{"class":57},[43,13632,13633],{"class":45,"line":170},[43,13634,10324],{"class":57},[1992,13636,13637],{},"Now that we understood the basics of Bruin's data quality system, let's run the staging pipeline:",[3260,13639,13640,13660],{},[3263,13641,13642],{"icon":3265,"label":3266},[33,13643,13645],{"className":2054,"code":13644,"language":2056,"meta":38,"style":38},"bruin run orders-performance --tag staging\n",[40,13646,13647],{"__ignoreMap":38},[43,13648,13649,13651,13653,13655,13657],{"class":45,"line":46},[43,13650,2091],{"class":2063},[43,13652,3163],{"class":57},[43,13654,9521],{"class":57},[43,13656,9524],{"class":57},[43,13658,13659],{"class":57}," staging\n",[3263,13661,13662],{"icon":3324,"label":3325},[3409,13663,13664],{},[33,13665,13667],{"className":2054,"code":13666,"language":2056,"meta":38,"style":38},"\nAnalyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\n\nStarting the pipeline execution...\n\n[20:59:31] Running:  stg.products\n[20:59:31] Running:  stg.order_items\n[20:59:31] Running:  stg.orders\n[20:59:31] Running:  stg.customers\n[20:59:31] Finished: stg.products (28ms)\n[20:59:31] Running:  stg.product_variants\n[20:59:31] Finished: stg.orders (57ms)\n[20:59:31] Finished: stg.order_items (78ms)\n[20:59:31] Finished: stg.customers (101ms)\n[20:59:31] Finished: stg.product_variants (89ms)\n[20:59:31] Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n[20:59:31] Finished: stg.product_variants:custom-check:validate_product_variant_sizes (6ms)\n\n==================================================\n\nPASS stg.products \nPASS stg.orders \nPASS stg.order_items \nPASS stg.customers \nPASS stg.product_variants .\n\n\nbruin run completed successfully in 125ms\n\n ✓ Assets executed      5 succeeded\n ✓ Quality checks       1 succeeded\n\n",[40,13668,13669,13673,13693,13697,13705,13713,13717,13739,13743,13753,13757,13767,13771,13783,13794,13805,13816,13832,13843,13859,13875,13891,13907,13918,13934,13938,13943,13947,13956,13965,13974,13983,13993,13997,14001,14016,14020,14032],{"__ignoreMap":38},[43,13670,13671],{"class":45,"line":46},[43,13672,244],{"emptyLinePlaceholder":243},[43,13674,13675,13677,13679,13681,13683,13685,13687,13689,13691],{"class":45,"line":61},[43,13676,9538],{"class":2063},[43,13678,9541],{"class":57},[43,13680,9544],{"class":57},[43,13682,1312],{"class":53},[43,13684,9549],{"class":57},[43,13686,1590],{"class":53},[43,13688,9554],{"class":57},[43,13690,9557],{"class":148},[43,13692,9560],{"class":57},[43,13694,13695],{"class":45,"line":70},[43,13696,244],{"emptyLinePlaceholder":243},[43,13698,13699,13701,13703],{"class":45,"line":78},[43,13700,9569],{"class":2063},[43,13702,9572],{"class":57},[43,13704,9575],{"class":1277},[43,13706,13707,13709,13711],{"class":45,"line":86},[43,13708,9580],{"class":2063},[43,13710,9583],{"class":57},[43,13712,9586],{"class":57},[43,13714,13715],{"class":45,"line":94},[43,13716,244],{"emptyLinePlaceholder":243},[43,13718,13719,13721,13723,13725,13727,13729,13731,13733,13735,13737],{"class":45,"line":108},[43,13720,9595],{"class":2063},[43,13722,9598],{"class":57},[43,13724,9601],{"class":57},[43,13726,9557],{"class":148},[43,13728,9481],{"class":57},[43,13730,9608],{"class":57},[43,13732,1003],{"class":148},[43,13734,9613],{"class":57},[43,13736,9616],{"class":57},[43,13738,9619],{"class":57},[43,13740,13741],{"class":45,"line":119},[43,13742,244],{"emptyLinePlaceholder":243},[43,13744,13745,13747,13749,13751],{"class":45,"line":129},[43,13746,9628],{"class":2063},[43,13748,9631],{"class":57},[43,13750,9634],{"class":57},[43,13752,9637],{"class":57},[43,13754,13755],{"class":45,"line":140},[43,13756,244],{"emptyLinePlaceholder":243},[43,13758,13759,13761,13763,13765],{"class":45,"line":152},[43,13760,9642],{"class":2063},[43,13762,9541],{"class":57},[43,13764,9544],{"class":57},[43,13766,9649],{"class":57},[43,13768,13769],{"class":45,"line":162},[43,13770,244],{"emptyLinePlaceholder":243},[43,13772,13773,13775,13778,13780],{"class":45,"line":170},[43,13774,7542],{"class":53},[43,13776,13777],{"class":1277},"20:59:31",[43,13779,7547],{"class":53},[43,13781,13782],{"class":1277}," Running:  stg.products\n",[43,13784,13785,13787,13789,13791],{"class":45,"line":182},[43,13786,7542],{"class":53},[43,13788,13777],{"class":1277},[43,13790,7547],{"class":53},[43,13792,13793],{"class":1277}," Running:  stg.order_items\n",[43,13795,13796,13798,13800,13802],{"class":45,"line":374},[43,13797,7542],{"class":53},[43,13799,13777],{"class":1277},[43,13801,7547],{"class":53},[43,13803,13804],{"class":1277}," Running:  stg.orders\n",[43,13806,13807,13809,13811,13813],{"class":45,"line":382},[43,13808,7542],{"class":53},[43,13810,13777],{"class":1277},[43,13812,7547],{"class":53},[43,13814,13815],{"class":1277}," Running:  stg.customers\n",[43,13817,13818,13820,13822,13824,13827,13830],{"class":45,"line":392},[43,13819,7542],{"class":53},[43,13821,13777],{"class":1277},[43,13823,7547],{"class":53},[43,13825,13826],{"class":1277}," Finished: stg.products (",[43,13828,13829],{"class":2063},"28ms",[43,13831,1405],{"class":1277},[43,13833,13834,13836,13838,13840],{"class":45,"line":399},[43,13835,7542],{"class":53},[43,13837,13777],{"class":1277},[43,13839,7547],{"class":53},[43,13841,13842],{"class":1277}," Running:  stg.product_variants\n",[43,13844,13845,13847,13849,13851,13854,13857],{"class":45,"line":410},[43,13846,7542],{"class":53},[43,13848,13777],{"class":1277},[43,13850,7547],{"class":53},[43,13852,13853],{"class":1277}," Finished: stg.orders (",[43,13855,13856],{"class":2063},"57ms",[43,13858,1405],{"class":1277},[43,13860,13861,13863,13865,13867,13870,13873],{"class":45,"line":417},[43,13862,7542],{"class":53},[43,13864,13777],{"class":1277},[43,13866,7547],{"class":53},[43,13868,13869],{"class":1277}," Finished: stg.order_items (",[43,13871,13872],{"class":2063},"78ms",[43,13874,1405],{"class":1277},[43,13876,13877,13879,13881,13883,13886,13889],{"class":45,"line":425},[43,13878,7542],{"class":53},[43,13880,13777],{"class":1277},[43,13882,7547],{"class":53},[43,13884,13885],{"class":1277}," Finished: stg.customers (",[43,13887,13888],{"class":2063},"101ms",[43,13890,1405],{"class":1277},[43,13892,13893,13895,13897,13899,13902,13905],{"class":45,"line":430},[43,13894,7542],{"class":53},[43,13896,13777],{"class":1277},[43,13898,7547],{"class":53},[43,13900,13901],{"class":1277}," Finished: stg.product_variants (",[43,13903,13904],{"class":2063},"89ms",[43,13906,1405],{"class":1277},[43,13908,13909,13911,13913,13915],{"class":45,"line":438},[43,13910,7542],{"class":53},[43,13912,13777],{"class":1277},[43,13914,7547],{"class":53},[43,13916,13917],{"class":1277}," Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n",[43,13919,13920,13922,13924,13926,13929,13932],{"class":45,"line":446},[43,13921,7542],{"class":53},[43,13923,13777],{"class":1277},[43,13925,7547],{"class":53},[43,13927,13928],{"class":1277}," Finished: stg.product_variants:custom-check:validate_product_variant_sizes (",[43,13930,13931],{"class":2063},"6ms",[43,13933,1405],{"class":1277},[43,13935,13936],{"class":45,"line":456},[43,13937,244],{"emptyLinePlaceholder":243},[43,13939,13940],{"class":45,"line":464},[43,13941,13942],{"class":57},"==================================================\n",[43,13944,13945],{"class":45,"line":472},[43,13946,244],{"emptyLinePlaceholder":243},[43,13948,13949,13951,13954],{"class":45,"line":483},[43,13950,9722],{"class":2063},[43,13952,13953],{"class":57}," stg.products",[43,13955,9728],{"class":1277},[43,13957,13958,13960,13963],{"class":45,"line":494},[43,13959,9722],{"class":2063},[43,13961,13962],{"class":57}," stg.orders",[43,13964,9728],{"class":1277},[43,13966,13967,13969,13972],{"class":45,"line":506},[43,13968,9722],{"class":2063},[43,13970,13971],{"class":57}," stg.order_items",[43,13973,9728],{"class":1277},[43,13975,13976,13978,13981],{"class":45,"line":517},[43,13977,9722],{"class":2063},[43,13979,13980],{"class":57}," stg.customers",[43,13982,9728],{"class":1277},[43,13984,13985,13987,13990],{"class":45,"line":525},[43,13986,9722],{"class":2063},[43,13988,13989],{"class":57}," stg.product_variants",[43,13991,13992],{"class":57}," .\n",[43,13994,13995],{"class":45,"line":538},[43,13996,244],{"emptyLinePlaceholder":243},[43,13998,13999],{"class":45,"line":550},[43,14000,244],{"emptyLinePlaceholder":243},[43,14002,14003,14005,14007,14009,14011,14013],{"class":45,"line":558},[43,14004,2091],{"class":2063},[43,14006,3163],{"class":57},[43,14008,9777],{"class":57},[43,14010,9780],{"class":57},[43,14012,9783],{"class":57},[43,14014,14015],{"class":57}," 125ms\n",[43,14017,14018],{"class":45,"line":568},[43,14019,244],{"emptyLinePlaceholder":243},[43,14021,14022,14024,14026,14028,14030],{"class":45,"line":578},[43,14023,9795],{"class":2063},[43,14025,9798],{"class":57},[43,14027,9801],{"class":57},[43,14029,9804],{"class":148},[43,14031,9807],{"class":57},[43,14033,14034,14036,14039,14042,14045],{"class":45,"line":588},[43,14035,9795],{"class":2063},[43,14037,14038],{"class":57}," Quality",[43,14040,14041],{"class":57}," checks",[43,14043,14044],{"class":148},"       1",[43,14046,9807],{"class":57},[1992,14048,14049],{},"Each asset runs its quality checks alongside transformations, keeping data accurate at every step. You can reuse validation rules across assets, add business context through glossaries, and rely on incremental checks that catch issues early.",[1973,14051,14053],{"id":14052},"_8-designing-and-running-your-analytics-layer","8) Designing and Running Your Analytics Layer",[1992,14055,14056],{},"Here we define models with a clear grain, apply final business rules, and expose KPIs for decision-making. These models typically power\ndashboards and self-service exploration.",[1992,14058,14059],{},"Just like in the Raw and Staging sections above, below is a code tree that shows how the mart is structured in our\norders-performance pipeline. Each model consumes stg.* tables and produces clean outputs.",[29,14061,14063,14497,14941,15515,15740],{"default-value":14062},"mart.sales_daily.asset.sql",[33,14064,14066],{"className":1195,"code":14065,"filename":14062,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.sales_daily\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: append\n\ndepends:\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: sale_date\n    type: date\n    checks:\n      - name: not_null\n  - name: orders_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: total revenue non-negative\n    value: 0\n    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n\n@bruin */\n\nWITH daily_orders AS (SELECT CAST(CAST(order_date AS TIMESTAMP) AS DATE)                               AS sale_date,\n                             COUNT(*)                                                                  AS orders_count,\n                             SUM(CASE WHEN status IN ('paid', 'shipped') THEN total_amount ELSE 0 END) AS revenue\n                      FROM stg.orders\n                      GROUP BY 1),\n     daily_items AS (SELECT CAST(CAST(o.order_date AS TIMESTAMP) AS DATE) AS sale_date,\n                            COUNT(*)                                      AS items_count\n                     FROM stg.order_items oi\n                            JOIN stg.orders o ON o.order_id = oi.order_id\n                     GROUP BY 1)\nSELECT d.sale_date,\n       d.orders_count,\n       COALESCE(i.items_count, 0) AS items_count,\n       d.revenue\nFROM daily_orders d\nORDER BY sale_date;\n",[40,14067,14068,14072,14076,14081,14085,14089,14093,14097,14102,14106,14110,14114,14118,14122,14126,14131,14136,14140,14144,14149,14153,14157,14161,14166,14170,14174,14178,14183,14188,14192,14196,14200,14204,14209,14213,14218,14222,14226,14230,14274,14291,14348,14356,14365,14401,14418,14425,14440,14449,14456,14461,14478,14483,14490],{"__ignoreMap":38},[43,14069,14070],{"class":45,"line":46},[43,14071,1205],{"class":1006},[43,14073,14074],{"class":45,"line":61},[43,14075,244],{"emptyLinePlaceholder":243},[43,14077,14078],{"class":45,"line":70},[43,14079,14080],{"class":1006},"name: mart.sales_daily\n",[43,14082,14083],{"class":45,"line":78},[43,14084,1215],{"class":1006},[43,14086,14087],{"class":45,"line":86},[43,14088,244],{"emptyLinePlaceholder":243},[43,14090,14091],{"class":45,"line":94},[43,14092,1235],{"class":1006},[43,14094,14095],{"class":45,"line":108},[43,14096,1240],{"class":1006},[43,14098,14099],{"class":45,"line":119},[43,14100,14101],{"class":1006},"  strategy: append\n",[43,14103,14104],{"class":45,"line":129},[43,14105,244],{"emptyLinePlaceholder":243},[43,14107,14108],{"class":45,"line":140},[43,14109,1250],{"class":1006},[43,14111,14112],{"class":45,"line":152},[43,14113,1512],{"class":1006},[43,14115,14116],{"class":45,"line":162},[43,14117,1517],{"class":1006},[43,14119,14120],{"class":45,"line":170},[43,14121,244],{"emptyLinePlaceholder":243},[43,14123,14124],{"class":45,"line":182},[43,14125,9891],{"class":1006},[43,14127,14128],{"class":45,"line":374},[43,14129,14130],{"class":1006},"  - name: sale_date\n",[43,14132,14133],{"class":45,"line":382},[43,14134,14135],{"class":1006},"    type: date\n",[43,14137,14138],{"class":45,"line":392},[43,14139,13087],{"class":1006},[43,14141,14142],{"class":45,"line":399},[43,14143,13099],{"class":1006},[43,14145,14146],{"class":45,"line":410},[43,14147,14148],{"class":1006},"  - name: orders_count\n",[43,14150,14151],{"class":45,"line":417},[43,14152,13075],{"class":1006},[43,14154,14155],{"class":45,"line":425},[43,14156,13087],{"class":1006},[43,14158,14159],{"class":45,"line":430},[43,14160,13099],{"class":1006},[43,14162,14163],{"class":45,"line":438},[43,14164,14165],{"class":1006},"  - name: items_count\n",[43,14167,14168],{"class":45,"line":446},[43,14169,13075],{"class":1006},[43,14171,14172],{"class":45,"line":456},[43,14173,13087],{"class":1006},[43,14175,14176],{"class":45,"line":464},[43,14177,13099],{"class":1006},[43,14179,14180],{"class":45,"line":472},[43,14181,14182],{"class":1006},"  - name: revenue\n",[43,14184,14185],{"class":45,"line":483},[43,14186,14187],{"class":1006},"    type: numeric\n",[43,14189,14190],{"class":45,"line":494},[43,14191,13087],{"class":1006},[43,14193,14194],{"class":45,"line":506},[43,14195,13099],{"class":1006},[43,14197,14198],{"class":45,"line":517},[43,14199,244],{"emptyLinePlaceholder":243},[43,14201,14202],{"class":45,"line":525},[43,14203,10264],{"class":1006},[43,14205,14206],{"class":45,"line":538},[43,14207,14208],{"class":1006},"  - name: total revenue non-negative\n",[43,14210,14211],{"class":45,"line":550},[43,14212,10289],{"class":1006},[43,14214,14215],{"class":45,"line":558},[43,14216,14217],{"class":1006},"    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n",[43,14219,14220],{"class":45,"line":568},[43,14221,244],{"emptyLinePlaceholder":243},[43,14223,14224],{"class":45,"line":578},[43,14225,1265],{"class":1006},[43,14227,14228],{"class":45,"line":588},[43,14229,244],{"emptyLinePlaceholder":243},[43,14231,14232,14234,14237,14239,14241,14243,14246,14248,14251,14254,14256,14259,14261,14263,14266,14269,14271],{"class":45,"line":595},[43,14233,1274],{"class":148},[43,14235,14236],{"class":1277}," daily_orders ",[43,14238,1281],{"class":148},[43,14240,1587],{"class":1277},[43,14242,1410],{"class":148},[43,14244,14245],{"class":1418}," CAST",[43,14247,1422],{"class":1277},[43,14249,14250],{"class":1418},"CAST",[43,14252,14253],{"class":1277},"(order_date ",[43,14255,1281],{"class":148},[43,14257,14258],{"class":1871}," TIMESTAMP",[43,14260,1428],{"class":1277},[43,14262,1281],{"class":148},[43,14264,14265],{"class":1871}," DATE",[43,14267,14268],{"class":1277},")                               ",[43,14270,1281],{"class":148},[43,14272,14273],{"class":1277}," sale_date,\n",[43,14275,14276,14279,14281,14283,14286,14288],{"class":45,"line":606},[43,14277,14278],{"class":1418},"                             COUNT",[43,14280,1422],{"class":1277},[43,14282,1425],{"class":53},[43,14284,14285],{"class":1277},")                                                                  ",[43,14287,1281],{"class":148},[43,14289,14290],{"class":1277}," orders_count,\n",[43,14292,14293,14296,14298,14301,14303,14306,14309,14311,14313,14315,14317,14319,14321,14323,14325,14327,14330,14333,14336,14338,14341,14343,14345],{"class":45,"line":614},[43,14294,14295],{"class":1418},"                             SUM",[43,14297,1422],{"class":1277},[43,14299,14300],{"class":148},"CASE",[43,14302,1727],{"class":148},[43,14304,14305],{"class":148}," status",[43,14307,14308],{"class":148}," IN",[43,14310,1587],{"class":1277},[43,14312,1590],{"class":53},[43,14314,1593],{"class":57},[43,14316,1590],{"class":53},[43,14318,2197],{"class":1277},[43,14320,1590],{"class":53},[43,14322,1603],{"class":57},[43,14324,1590],{"class":53},[43,14326,1428],{"class":1277},[43,14328,14329],{"class":148},"THEN",[43,14331,14332],{"class":1277}," total_amount ",[43,14334,14335],{"class":148},"ELSE",[43,14337,1737],{"class":148},[43,14339,14340],{"class":148}," END",[43,14342,1428],{"class":1277},[43,14344,1281],{"class":148},[43,14346,14347],{"class":1277}," revenue\n",[43,14349,14350,14353],{"class":45,"line":624},[43,14351,14352],{"class":148},"                      FROM",[43,14354,14355],{"class":1277}," stg.orders\n",[43,14357,14358,14361,14363],{"class":45,"line":633},[43,14359,14360],{"class":148},"                      GROUP BY",[43,14362,1003],{"class":148},[43,14364,1612],{"class":1277},[43,14366,14367,14370,14372,14374,14376,14378,14380,14382,14385,14387,14389,14391,14393,14395,14397,14399],{"class":45,"line":643},[43,14368,14369],{"class":1277},"     daily_items ",[43,14371,1281],{"class":148},[43,14373,1587],{"class":1277},[43,14375,1410],{"class":148},[43,14377,14245],{"class":1418},[43,14379,1422],{"class":1277},[43,14381,14250],{"class":1418},[43,14383,14384],{"class":1277},"(o.order_date ",[43,14386,1281],{"class":148},[43,14388,14258],{"class":1871},[43,14390,1428],{"class":1277},[43,14392,1281],{"class":148},[43,14394,14265],{"class":1871},[43,14396,1428],{"class":1277},[43,14398,1281],{"class":148},[43,14400,14273],{"class":1277},[43,14402,14403,14406,14408,14410,14413,14415],{"class":45,"line":650},[43,14404,14405],{"class":1418},"                            COUNT",[43,14407,1422],{"class":1277},[43,14409,1425],{"class":53},[43,14411,14412],{"class":1277},")                                      ",[43,14414,1281],{"class":148},[43,14416,14417],{"class":1277}," items_count\n",[43,14419,14420,14423],{"class":45,"line":661},[43,14421,14422],{"class":148},"                     FROM",[43,14424,1553],{"class":1277},[43,14426,14427,14430,14432,14434,14436,14438],{"class":45,"line":669},[43,14428,14429],{"class":148},"                            JOIN",[43,14431,1561],{"class":1277},[43,14433,1564],{"class":148},[43,14435,1567],{"class":1277},[43,14437,1570],{"class":53},[43,14439,1573],{"class":1277},[43,14441,14442,14445,14447],{"class":45,"line":679},[43,14443,14444],{"class":148},"                     GROUP BY",[43,14446,1003],{"class":148},[43,14448,1405],{"class":1277},[43,14450,14451,14453],{"class":45,"line":687},[43,14452,1410],{"class":148},[43,14454,14455],{"class":1277}," d.sale_date,\n",[43,14457,14458],{"class":45,"line":695},[43,14459,14460],{"class":1277},"       d.orders_count,\n",[43,14462,14463,14466,14469,14471,14473,14475],{"class":45,"line":702},[43,14464,14465],{"class":1418},"       COALESCE",[43,14467,14468],{"class":1277},"(i.items_count, ",[43,14470,1935],{"class":148},[43,14472,1428],{"class":1277},[43,14474,1281],{"class":148},[43,14476,14477],{"class":1277}," items_count,\n",[43,14479,14480],{"class":45,"line":709},[43,14481,14482],{"class":1277},"       d.revenue\n",[43,14484,14485,14487],{"class":45,"line":719},[43,14486,1438],{"class":148},[43,14488,14489],{"class":1277}," daily_orders d\n",[43,14491,14492,14494],{"class":45,"line":728},[43,14493,1453],{"class":148},[43,14495,14496],{"class":1277}," sale_date;\n",[33,14498,14501],{"className":1195,"code":14499,"filename":14500,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.product_performance\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: product_id\n    type: BIGINT\n    checks:\n      - name: not_null\n  - name: product_name\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: category\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: HUGEINT\n    checks:\n      - name: not_null\n  - name: gross_revenue\n    type: DECIMAL(38,2)\n    checks:\n      - name: not_null\n  - name: avg_item_price\n    type: DOUBLE\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: no negative prices or revenue\n    value: 0\n    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), items_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","mart.product_performance.asset.sql",[40,14502,14503,14507,14511,14515,14519,14523,14527,14531,14535,14539,14543,14547,14551,14555,14559,14563,14567,14572,14577,14581,14585,14590,14595,14599,14603,14608,14612,14616,14620,14625,14630,14634,14638,14643,14648,14652,14656,14661,14666,14670,14674,14678,14682,14687,14691,14696,14700,14704,14708,14718,14726,14732,14746,14772,14781,14785,14789,14793,14797,14803,14817,14821,14825,14829,14837,14841,14851,14861,14897,14903,14917,14931],{"__ignoreMap":38},[43,14504,14505],{"class":45,"line":46},[43,14506,1205],{"class":1006},[43,14508,14509],{"class":45,"line":61},[43,14510,244],{"emptyLinePlaceholder":243},[43,14512,14513],{"class":45,"line":70},[43,14514,1477],{"class":1006},[43,14516,14517],{"class":45,"line":78},[43,14518,1215],{"class":1006},[43,14520,14521],{"class":45,"line":86},[43,14522,244],{"emptyLinePlaceholder":243},[43,14524,14525],{"class":45,"line":94},[43,14526,1235],{"class":1006},[43,14528,14529],{"class":45,"line":108},[43,14530,1240],{"class":1006},[43,14532,14533],{"class":45,"line":119},[43,14534,1245],{"class":1006},[43,14536,14537],{"class":45,"line":129},[43,14538,244],{"emptyLinePlaceholder":243},[43,14540,14541],{"class":45,"line":140},[43,14542,1250],{"class":1006},[43,14544,14545],{"class":45,"line":152},[43,14546,1502],{"class":1006},[43,14548,14549],{"class":45,"line":162},[43,14550,1507],{"class":1006},[43,14552,14553],{"class":45,"line":170},[43,14554,1512],{"class":1006},[43,14556,14557],{"class":45,"line":182},[43,14558,1517],{"class":1006},[43,14560,14561],{"class":45,"line":374},[43,14562,244],{"emptyLinePlaceholder":243},[43,14564,14565],{"class":45,"line":382},[43,14566,9891],{"class":1006},[43,14568,14569],{"class":45,"line":392},[43,14570,14571],{"class":1006},"  - name: product_id\n",[43,14573,14574],{"class":45,"line":399},[43,14575,14576],{"class":1006},"    type: BIGINT\n",[43,14578,14579],{"class":45,"line":410},[43,14580,13087],{"class":1006},[43,14582,14583],{"class":45,"line":417},[43,14584,13099],{"class":1006},[43,14586,14587],{"class":45,"line":425},[43,14588,14589],{"class":1006},"  - name: product_name\n",[43,14591,14592],{"class":45,"line":430},[43,14593,14594],{"class":1006},"    type: VARCHAR\n",[43,14596,14597],{"class":45,"line":438},[43,14598,13087],{"class":1006},[43,14600,14601],{"class":45,"line":446},[43,14602,13099],{"class":1006},[43,14604,14605],{"class":45,"line":456},[43,14606,14607],{"class":1006},"  - name: category\n",[43,14609,14610],{"class":45,"line":464},[43,14611,14594],{"class":1006},[43,14613,14614],{"class":45,"line":472},[43,14615,13087],{"class":1006},[43,14617,14618],{"class":45,"line":483},[43,14619,13099],{"class":1006},[43,14621,14622],{"class":45,"line":494},[43,14623,14624],{"class":1006},"  - name: items_sold\n",[43,14626,14627],{"class":45,"line":506},[43,14628,14629],{"class":1006},"    type: HUGEINT\n",[43,14631,14632],{"class":45,"line":517},[43,14633,13087],{"class":1006},[43,14635,14636],{"class":45,"line":525},[43,14637,13099],{"class":1006},[43,14639,14640],{"class":45,"line":538},[43,14641,14642],{"class":1006},"  - name: gross_revenue\n",[43,14644,14645],{"class":45,"line":550},[43,14646,14647],{"class":1006},"    type: DECIMAL(38,2)\n",[43,14649,14650],{"class":45,"line":558},[43,14651,13087],{"class":1006},[43,14653,14654],{"class":45,"line":568},[43,14655,13099],{"class":1006},[43,14657,14658],{"class":45,"line":578},[43,14659,14660],{"class":1006},"  - name: avg_item_price\n",[43,14662,14663],{"class":45,"line":588},[43,14664,14665],{"class":1006},"    type: DOUBLE\n",[43,14667,14668],{"class":45,"line":595},[43,14669,13087],{"class":1006},[43,14671,14672],{"class":45,"line":606},[43,14673,13099],{"class":1006},[43,14675,14676],{"class":45,"line":614},[43,14677,244],{"emptyLinePlaceholder":243},[43,14679,14680],{"class":45,"line":624},[43,14681,10264],{"class":1006},[43,14683,14684],{"class":45,"line":633},[43,14685,14686],{"class":1006},"  - name: no negative prices or revenue\n",[43,14688,14689],{"class":45,"line":643},[43,14690,10289],{"class":1006},[43,14692,14693],{"class":45,"line":650},[43,14694,14695],{"class":1006},"    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n",[43,14697,14698],{"class":45,"line":661},[43,14699,244],{"emptyLinePlaceholder":243},[43,14701,14702],{"class":45,"line":669},[43,14703,1265],{"class":1006},[43,14705,14706],{"class":45,"line":679},[43,14707,244],{"emptyLinePlaceholder":243},[43,14709,14710,14712,14714,14716],{"class":45,"line":687},[43,14711,1274],{"class":148},[43,14713,1532],{"class":1277},[43,14715,1281],{"class":148},[43,14717,1284],{"class":1277},[43,14719,14720,14722,14724],{"class":45,"line":695},[43,14721,1289],{"class":148},[43,14723,1543],{"class":1277},[43,14725,1546],{"class":53},[43,14727,14728,14730],{"class":45,"line":702},[43,14729,1397],{"class":148},[43,14731,1553],{"class":1277},[43,14733,14734,14736,14738,14740,14742,14744],{"class":45,"line":709},[43,14735,1558],{"class":148},[43,14737,1561],{"class":1277},[43,14739,1564],{"class":148},[43,14741,1567],{"class":1277},[43,14743,1570],{"class":53},[43,14745,1573],{"class":1277},[43,14747,14748,14750,14752,14754,14756,14758,14760,14762,14764,14766,14768,14770],{"class":45,"line":719},[43,14749,1578],{"class":148},[43,14751,1581],{"class":1277},[43,14753,1584],{"class":148},[43,14755,1587],{"class":1277},[43,14757,1590],{"class":53},[43,14759,1593],{"class":57},[43,14761,1590],{"class":53},[43,14763,1598],{"class":1277},[43,14765,1590],{"class":53},[43,14767,1603],{"class":57},[43,14769,1590],{"class":53},[43,14771,1405],{"class":1277},[43,14773,14774,14777,14779],{"class":45,"line":728},[43,14775,14776],{"class":1277},"), items_with_product ",[43,14778,1281],{"class":148},[43,14780,1284],{"class":1277},[43,14782,14783],{"class":45,"line":735},[43,14784,1626],{"class":148},[43,14786,14787],{"class":45,"line":746},[43,14788,1631],{"class":1277},[43,14790,14791],{"class":45,"line":757},[43,14792,1636],{"class":1277},[43,14794,14795],{"class":45,"line":765},[43,14796,1641],{"class":1277},[43,14798,14799,14801],{"class":45,"line":775},[43,14800,1397],{"class":148},[43,14802,1648],{"class":1277},[43,14804,14805,14807,14809,14811,14813,14815],{"class":45,"line":785},[43,14806,1558],{"class":148},[43,14808,1655],{"class":1277},[43,14810,1564],{"class":148},[43,14812,1660],{"class":1277},[43,14814,1570],{"class":53},[43,14816,1665],{"class":1277},[43,14818,14819],{"class":45,"line":792},[43,14820,1405],{"class":1277},[43,14822,14823],{"class":45,"line":803},[43,14824,1674],{"class":148},[43,14826,14827],{"class":45,"line":811},[43,14828,1679],{"class":1277},[43,14830,14831,14833,14835],{"class":45,"line":821},[43,14832,1684],{"class":1277},[43,14834,1281],{"class":148},[43,14836,1689],{"class":1277},[43,14838,14839],{"class":45,"line":830},[43,14840,1694],{"class":1277},[43,14842,14843,14845,14847,14849],{"class":45,"line":838},[43,14844,1699],{"class":1418},[43,14846,1702],{"class":1277},[43,14848,1281],{"class":148},[43,14850,1707],{"class":1277},[43,14852,14853,14855,14857,14859],{"class":45,"line":848},[43,14854,1699],{"class":1418},[43,14856,1714],{"class":1277},[43,14858,1281],{"class":148},[43,14860,1719],{"class":1277},[43,14862,14863,14865,14867,14869,14871,14873,14875,14877,14879,14881,14883,14885,14887,14889,14891,14893,14895],{"class":45,"line":857},[43,14864,1724],{"class":148},[43,14866,1727],{"class":148},[43,14868,1730],{"class":1418},[43,14870,1702],{"class":1277},[43,14872,1570],{"class":53},[43,14874,1737],{"class":148},[43,14876,1309],{"class":148},[43,14878,1737],{"class":148},[43,14880,1744],{"class":148},[43,14882,1730],{"class":1418},[43,14884,1714],{"class":1277},[43,14886,1751],{"class":53},[43,14888,1730],{"class":1418},[43,14890,1702],{"class":1277},[43,14892,1758],{"class":148},[43,14894,1389],{"class":148},[43,14896,1763],{"class":1277},[43,14898,14899,14901],{"class":45,"line":865},[43,14900,1438],{"class":148},[43,14902,1770],{"class":1277},[43,14904,14905,14907,14909,14911,14913,14915],{"class":45,"line":875},[43,14906,1775],{"class":148},[43,14908,1778],{"class":1277},[43,14910,1564],{"class":148},[43,14912,1783],{"class":1277},[43,14914,1570],{"class":53},[43,14916,1788],{"class":1277},[43,14918,14919,14921,14923,14925,14927,14929],{"class":45,"line":884},[43,14920,1446],{"class":148},[43,14922,1003],{"class":148},[43,14924,1598],{"class":1277},[43,14926,1799],{"class":148},[43,14928,1598],{"class":1277},[43,14930,1804],{"class":148},[43,14932,14933,14935,14937,14939],{"class":45,"line":891},[43,14934,1453],{"class":148},[43,14936,1811],{"class":1277},[43,14938,1459],{"class":148},[43,14940,1462],{"class":1277},[33,14942,14945],{"className":1195,"code":14943,"filename":14944,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.variant_profitability\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n  - stg.products\n\ncolumns:\n  - name: variant_id\n    type: integer\n    checks:\n      - name: not_null\n      - name: unique\n  - name: variant_sku\n    type: string\n    checks:\n      - name: not_null\n  - name: product_id\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n  - name: cost\n    type: numeric\n    checks:\n      - name: not_null\n  - name: profit\n    type: numeric\n    checks:\n      - name: not_null\n  - name: margin_pct\n    type: numeric\n    checks:\n      - name: not_null\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), joined AS (\n  SELECT\n    v.variant_id,\n    p.name as product_name,\n    v.variant_sku,\n    v.product_id,\n    v.manufacturing_price,\n    v.selling_price,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n  JOIN stg.products p ON p.product_id = v.product_id\n)\nSELECT\n    j.product_name,\n  j.variant_id,\n  j.variant_sku,\n  j.product_id,\n  SUM(j.quantity) AS items_sold,\n  SUM(j.total_price) AS revenue,\n  SUM(j.quantity * j.manufacturing_price) AS cost,\n  SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price) AS profit,\n  CASE WHEN SUM(j.total_price) = 0 THEN 0\n       ELSE (SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price)) / SUM(j.total_price)\n  END AS margin_pct,\n  BOOL_OR(j.selling_price \u003C j.manufacturing_price) AS selling_price_below_cost\nFROM joined j\nGROUP BY 1,2,3,4\nORDER BY profit DESC;\n","mart.variant_profitability.asset.sql",[40,14946,14947,14951,14955,14960,14964,14968,14972,14976,14980,14984,14988,14992,14996,15000,15004,15008,15012,15017,15021,15025,15029,15033,15038,15043,15047,15051,15055,15059,15063,15067,15071,15075,15079,15083,15087,15091,15095,15099,15104,15108,15112,15116,15121,15125,15129,15133,15138,15142,15146,15150,15154,15158,15162,15172,15180,15186,15200,15226,15235,15239,15244,15254,15259,15263,15268,15273,15277,15281,15287,15301,15316,15320,15324,15329,15334,15339,15344,15355,15367,15384,15405,15423,15453,15463,15477,15484,15504],{"__ignoreMap":38},[43,14948,14949],{"class":45,"line":46},[43,14950,1205],{"class":1006},[43,14952,14953],{"class":45,"line":61},[43,14954,244],{"emptyLinePlaceholder":243},[43,14956,14957],{"class":45,"line":70},[43,14958,14959],{"class":1006},"name: mart.variant_profitability\n",[43,14961,14962],{"class":45,"line":78},[43,14963,1215],{"class":1006},[43,14965,14966],{"class":45,"line":86},[43,14967,244],{"emptyLinePlaceholder":243},[43,14969,14970],{"class":45,"line":94},[43,14971,1235],{"class":1006},[43,14973,14974],{"class":45,"line":108},[43,14975,1240],{"class":1006},[43,14977,14978],{"class":45,"line":119},[43,14979,1245],{"class":1006},[43,14981,14982],{"class":45,"line":129},[43,14983,244],{"emptyLinePlaceholder":243},[43,14985,14986],{"class":45,"line":140},[43,14987,1250],{"class":1006},[43,14989,14990],{"class":45,"line":152},[43,14991,1507],{"class":1006},[43,14993,14994],{"class":45,"line":162},[43,14995,1512],{"class":1006},[43,14997,14998],{"class":45,"line":170},[43,14999,1517],{"class":1006},[43,15001,15002],{"class":45,"line":182},[43,15003,1502],{"class":1006},[43,15005,15006],{"class":45,"line":374},[43,15007,244],{"emptyLinePlaceholder":243},[43,15009,15010],{"class":45,"line":382},[43,15011,9891],{"class":1006},[43,15013,15014],{"class":45,"line":392},[43,15015,15016],{"class":1006},"  - name: variant_id\n",[43,15018,15019],{"class":45,"line":399},[43,15020,13075],{"class":1006},[43,15022,15023],{"class":45,"line":410},[43,15024,13087],{"class":1006},[43,15026,15027],{"class":45,"line":417},[43,15028,13099],{"class":1006},[43,15030,15031],{"class":45,"line":425},[43,15032,13093],{"class":1006},[43,15034,15035],{"class":45,"line":430},[43,15036,15037],{"class":1006},"  - name: variant_sku\n",[43,15039,15040],{"class":45,"line":438},[43,15041,15042],{"class":1006},"    type: string\n",[43,15044,15045],{"class":45,"line":446},[43,15046,13087],{"class":1006},[43,15048,15049],{"class":45,"line":456},[43,15050,13099],{"class":1006},[43,15052,15053],{"class":45,"line":464},[43,15054,14571],{"class":1006},[43,15056,15057],{"class":45,"line":472},[43,15058,13075],{"class":1006},[43,15060,15061],{"class":45,"line":483},[43,15062,13087],{"class":1006},[43,15064,15065],{"class":45,"line":494},[43,15066,13099],{"class":1006},[43,15068,15069],{"class":45,"line":506},[43,15070,14624],{"class":1006},[43,15072,15073],{"class":45,"line":517},[43,15074,13075],{"class":1006},[43,15076,15077],{"class":45,"line":525},[43,15078,13087],{"class":1006},[43,15080,15081],{"class":45,"line":538},[43,15082,13099],{"class":1006},[43,15084,15085],{"class":45,"line":550},[43,15086,14182],{"class":1006},[43,15088,15089],{"class":45,"line":558},[43,15090,14187],{"class":1006},[43,15092,15093],{"class":45,"line":568},[43,15094,13087],{"class":1006},[43,15096,15097],{"class":45,"line":578},[43,15098,13099],{"class":1006},[43,15100,15101],{"class":45,"line":588},[43,15102,15103],{"class":1006},"  - name: cost\n",[43,15105,15106],{"class":45,"line":595},[43,15107,14187],{"class":1006},[43,15109,15110],{"class":45,"line":606},[43,15111,13087],{"class":1006},[43,15113,15114],{"class":45,"line":614},[43,15115,13099],{"class":1006},[43,15117,15118],{"class":45,"line":624},[43,15119,15120],{"class":1006},"  - name: profit\n",[43,15122,15123],{"class":45,"line":633},[43,15124,14187],{"class":1006},[43,15126,15127],{"class":45,"line":643},[43,15128,13087],{"class":1006},[43,15130,15131],{"class":45,"line":650},[43,15132,13099],{"class":1006},[43,15134,15135],{"class":45,"line":661},[43,15136,15137],{"class":1006},"  - name: margin_pct\n",[43,15139,15140],{"class":45,"line":669},[43,15141,14187],{"class":1006},[43,15143,15144],{"class":45,"line":679},[43,15145,13087],{"class":1006},[43,15147,15148],{"class":45,"line":687},[43,15149,13099],{"class":1006},[43,15151,15152],{"class":45,"line":695},[43,15153,244],{"emptyLinePlaceholder":243},[43,15155,15156],{"class":45,"line":702},[43,15157,1265],{"class":1006},[43,15159,15160],{"class":45,"line":709},[43,15161,244],{"emptyLinePlaceholder":243},[43,15163,15164,15166,15168,15170],{"class":45,"line":719},[43,15165,1274],{"class":148},[43,15167,1532],{"class":1277},[43,15169,1281],{"class":148},[43,15171,1284],{"class":1277},[43,15173,15174,15176,15178],{"class":45,"line":728},[43,15175,1289],{"class":148},[43,15177,1543],{"class":1277},[43,15179,1546],{"class":53},[43,15181,15182,15184],{"class":45,"line":735},[43,15183,1397],{"class":148},[43,15185,1553],{"class":1277},[43,15187,15188,15190,15192,15194,15196,15198],{"class":45,"line":746},[43,15189,1558],{"class":148},[43,15191,1561],{"class":1277},[43,15193,1564],{"class":148},[43,15195,1567],{"class":1277},[43,15197,1570],{"class":53},[43,15199,1573],{"class":1277},[43,15201,15202,15204,15206,15208,15210,15212,15214,15216,15218,15220,15222,15224],{"class":45,"line":757},[43,15203,1578],{"class":148},[43,15205,1581],{"class":1277},[43,15207,1584],{"class":148},[43,15209,1587],{"class":1277},[43,15211,1590],{"class":53},[43,15213,1593],{"class":57},[43,15215,1590],{"class":53},[43,15217,1598],{"class":1277},[43,15219,1590],{"class":53},[43,15221,1603],{"class":57},[43,15223,1590],{"class":53},[43,15225,1405],{"class":1277},[43,15227,15228,15231,15233],{"class":45,"line":765},[43,15229,15230],{"class":1277},"), joined ",[43,15232,1281],{"class":148},[43,15234,1284],{"class":1277},[43,15236,15237],{"class":45,"line":775},[43,15238,1626],{"class":148},[43,15240,15241],{"class":45,"line":785},[43,15242,15243],{"class":1277},"    v.variant_id,\n",[43,15245,15246,15249,15252],{"class":45,"line":792},[43,15247,15248],{"class":1277},"    p.name ",[43,15250,15251],{"class":148},"as",[43,15253,1689],{"class":1277},[43,15255,15256],{"class":45,"line":803},[43,15257,15258],{"class":1277},"    v.variant_sku,\n",[43,15260,15261],{"class":45,"line":811},[43,15262,1631],{"class":1277},[43,15264,15265],{"class":45,"line":821},[43,15266,15267],{"class":1277},"    v.manufacturing_price,\n",[43,15269,15270],{"class":45,"line":830},[43,15271,15272],{"class":1277},"    v.selling_price,\n",[43,15274,15275],{"class":45,"line":838},[43,15276,1636],{"class":1277},[43,15278,15279],{"class":45,"line":848},[43,15280,1641],{"class":1277},[43,15282,15283,15285],{"class":45,"line":857},[43,15284,1397],{"class":148},[43,15286,1648],{"class":1277},[43,15288,15289,15291,15293,15295,15297,15299],{"class":45,"line":865},[43,15290,1558],{"class":148},[43,15292,1655],{"class":1277},[43,15294,1564],{"class":148},[43,15296,1660],{"class":1277},[43,15298,1570],{"class":53},[43,15300,1665],{"class":1277},[43,15302,15303,15305,15307,15309,15311,15313],{"class":45,"line":875},[43,15304,1558],{"class":148},[43,15306,1778],{"class":1277},[43,15308,1564],{"class":148},[43,15310,1783],{"class":1277},[43,15312,1570],{"class":53},[43,15314,15315],{"class":1277}," v.product_id\n",[43,15317,15318],{"class":45,"line":884},[43,15319,1405],{"class":1277},[43,15321,15322],{"class":45,"line":891},[43,15323,1674],{"class":148},[43,15325,15326],{"class":45,"line":903},[43,15327,15328],{"class":1277},"    j.product_name,\n",[43,15330,15331],{"class":45,"line":4229},[43,15332,15333],{"class":1277},"  j.variant_id,\n",[43,15335,15336],{"class":45,"line":4235},[43,15337,15338],{"class":1277},"  j.variant_sku,\n",[43,15340,15341],{"class":45,"line":4241},[43,15342,15343],{"class":1277},"  j.product_id,\n",[43,15345,15346,15348,15351,15353],{"class":45,"line":4247},[43,15347,1699],{"class":1418},[43,15349,15350],{"class":1277},"(j.quantity) ",[43,15352,1281],{"class":148},[43,15354,1707],{"class":1277},[43,15356,15357,15359,15362,15364],{"class":45,"line":4256},[43,15358,1699],{"class":1418},[43,15360,15361],{"class":1277},"(j.total_price) ",[43,15363,1281],{"class":148},[43,15365,15366],{"class":1277}," revenue,\n",[43,15368,15369,15371,15374,15376,15379,15381],{"class":45,"line":4269},[43,15370,1699],{"class":1418},[43,15372,15373],{"class":1277},"(j.quantity ",[43,15375,1425],{"class":53},[43,15377,15378],{"class":1277}," j.manufacturing_price) ",[43,15380,1281],{"class":148},[43,15382,15383],{"class":1277}," cost,\n",[43,15385,15386,15388,15390,15392,15394,15396,15398,15400,15402],{"class":45,"line":4275},[43,15387,1699],{"class":1418},[43,15389,15361],{"class":1277},[43,15391,5381],{"class":53},[43,15393,1730],{"class":1418},[43,15395,15373],{"class":1277},[43,15397,1425],{"class":53},[43,15399,15378],{"class":1277},[43,15401,1281],{"class":148},[43,15403,15404],{"class":1277}," profit,\n",[43,15406,15407,15409,15411,15413,15415,15417,15419,15421],{"class":45,"line":4280},[43,15408,1724],{"class":148},[43,15410,1727],{"class":148},[43,15412,1730],{"class":1418},[43,15414,15361],{"class":1277},[43,15416,1570],{"class":53},[43,15418,1737],{"class":148},[43,15420,1309],{"class":148},[43,15422,911],{"class":148},[43,15424,15425,15428,15430,15433,15435,15437,15439,15441,15443,15446,15448,15450],{"class":45,"line":4291},[43,15426,15427],{"class":148},"       ELSE",[43,15429,1587],{"class":1277},[43,15431,15432],{"class":1418},"SUM",[43,15434,15361],{"class":1277},[43,15436,5381],{"class":53},[43,15438,1730],{"class":1418},[43,15440,15373],{"class":1277},[43,15442,1425],{"class":53},[43,15444,15445],{"class":1277}," j.manufacturing_price)) ",[43,15447,1751],{"class":53},[43,15449,1730],{"class":1418},[43,15451,15452],{"class":1277},"(j.total_price)\n",[43,15454,15455,15458,15460],{"class":45,"line":4313},[43,15456,15457],{"class":148},"  END",[43,15459,1389],{"class":148},[43,15461,15462],{"class":1277}," margin_pct,\n",[43,15464,15465,15468,15470,15472,15474],{"class":45,"line":4334},[43,15466,15467],{"class":1277},"  BOOL_OR(j.selling_price ",[43,15469,1303],{"class":53},[43,15471,15378],{"class":1277},[43,15473,1281],{"class":148},[43,15475,15476],{"class":1277}," selling_price_below_cost\n",[43,15478,15479,15481],{"class":45,"line":4355},[43,15480,1438],{"class":148},[43,15482,15483],{"class":1277}," joined j\n",[43,15485,15486,15488,15490,15492,15494,15496,15499,15501],{"class":45,"line":4382},[43,15487,1446],{"class":148},[43,15489,1003],{"class":148},[43,15491,1598],{"class":1277},[43,15493,1799],{"class":148},[43,15495,1598],{"class":1277},[43,15497,15498],{"class":148},"3",[43,15500,1598],{"class":1277},[43,15502,15503],{"class":148},"4\n",[43,15505,15506,15508,15511,15513],{"class":45,"line":4396},[43,15507,1453],{"class":148},[43,15509,15510],{"class":1277}," profit ",[43,15512,1459],{"class":148},[43,15514,1462],{"class":1277},[33,15516,15519],{"className":1195,"code":15517,"filename":15518,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n\n@bruin */\n\nWITH src AS (SELECT CASE\n                        WHEN age \u003C 25 THEN '18-24'\n                        WHEN age BETWEEN 25 AND 34 THEN '25-34'\n                        WHEN age BETWEEN 35 AND 49 THEN '35-49'\n                        ELSE '50+'\n                        END AS age_group\n             FROM stg.customers)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","mart.customers_by_age.asset.sql",[40,15520,15521,15525,15529,15533,15537,15541,15545,15549,15553,15557,15561,15565,15569,15573,15577,15581,15585,15589,15593,15607,15626,15648,15670,15681,15690,15698,15704,15718,15724,15730],{"__ignoreMap":38},[43,15522,15523],{"class":45,"line":46},[43,15524,1205],{"class":1006},[43,15526,15527],{"class":45,"line":61},[43,15528,244],{"emptyLinePlaceholder":243},[43,15530,15531],{"class":45,"line":70},[43,15532,1210],{"class":1006},[43,15534,15535],{"class":45,"line":78},[43,15536,1215],{"class":1006},[43,15538,15539],{"class":45,"line":86},[43,15540,1220],{"class":1006},[43,15542,15543],{"class":45,"line":94},[43,15544,1225],{"class":1006},[43,15546,15547],{"class":45,"line":108},[43,15548,1230],{"class":1006},[43,15550,15551],{"class":45,"line":119},[43,15552,244],{"emptyLinePlaceholder":243},[43,15554,15555],{"class":45,"line":129},[43,15556,1235],{"class":1006},[43,15558,15559],{"class":45,"line":140},[43,15560,1240],{"class":1006},[43,15562,15563],{"class":45,"line":152},[43,15564,1245],{"class":1006},[43,15566,15567],{"class":45,"line":162},[43,15568,244],{"emptyLinePlaceholder":243},[43,15570,15571],{"class":45,"line":170},[43,15572,1250],{"class":1006},[43,15574,15575],{"class":45,"line":182},[43,15576,1255],{"class":1006},[43,15578,15579],{"class":45,"line":374},[43,15580,1260],{"class":1006},[43,15582,15583],{"class":45,"line":382},[43,15584,244],{"emptyLinePlaceholder":243},[43,15586,15587],{"class":45,"line":392},[43,15588,1265],{"class":1006},[43,15590,15591],{"class":45,"line":399},[43,15592,244],{"emptyLinePlaceholder":243},[43,15594,15595,15597,15599,15601,15603,15605],{"class":45,"line":410},[43,15596,1274],{"class":148},[43,15598,1278],{"class":1277},[43,15600,1281],{"class":148},[43,15602,1587],{"class":1277},[43,15604,1410],{"class":148},[43,15606,1292],{"class":148},[43,15608,15609,15612,15614,15616,15618,15620,15622,15624],{"class":45,"line":417},[43,15610,15611],{"class":148},"                        WHEN",[43,15613,1300],{"class":1277},[43,15615,1303],{"class":53},[43,15617,1306],{"class":148},[43,15619,1309],{"class":148},[43,15621,1312],{"class":53},[43,15623,1315],{"class":57},[43,15625,1318],{"class":53},[43,15627,15628,15630,15632,15634,15636,15638,15640,15642,15644,15646],{"class":45,"line":425},[43,15629,15611],{"class":148},[43,15631,1300],{"class":1277},[43,15633,1327],{"class":148},[43,15635,1306],{"class":148},[43,15637,1332],{"class":148},[43,15639,1335],{"class":148},[43,15641,1309],{"class":148},[43,15643,1312],{"class":53},[43,15645,1342],{"class":57},[43,15647,1318],{"class":53},[43,15649,15650,15652,15654,15656,15658,15660,15662,15664,15666,15668],{"class":45,"line":430},[43,15651,15611],{"class":148},[43,15653,1300],{"class":1277},[43,15655,1327],{"class":148},[43,15657,1355],{"class":148},[43,15659,1332],{"class":148},[43,15661,1360],{"class":148},[43,15663,1309],{"class":148},[43,15665,1312],{"class":53},[43,15667,1367],{"class":57},[43,15669,1318],{"class":53},[43,15671,15672,15675,15677,15679],{"class":45,"line":438},[43,15673,15674],{"class":148},"                        ELSE",[43,15676,1312],{"class":53},[43,15678,1379],{"class":57},[43,15680,1318],{"class":53},[43,15682,15683,15686,15688],{"class":45,"line":446},[43,15684,15685],{"class":148},"                        END",[43,15687,1389],{"class":148},[43,15689,1392],{"class":1277},[43,15691,15692,15695],{"class":45,"line":456},[43,15693,15694],{"class":148},"             FROM",[43,15696,15697],{"class":1277}," stg.customers)\n",[43,15699,15700,15702],{"class":45,"line":464},[43,15701,1410],{"class":148},[43,15703,1413],{"class":1277},[43,15705,15706,15708,15710,15712,15714,15716],{"class":45,"line":472},[43,15707,1419],{"class":1418},[43,15709,1422],{"class":1277},[43,15711,1425],{"class":53},[43,15713,1428],{"class":1277},[43,15715,1281],{"class":148},[43,15717,1433],{"class":1277},[43,15719,15720,15722],{"class":45,"line":483},[43,15721,1438],{"class":148},[43,15723,1441],{"class":1277},[43,15725,15726,15728],{"class":45,"line":494},[43,15727,1446],{"class":148},[43,15729,1392],{"class":1277},[43,15731,15732,15734,15736,15738],{"class":45,"line":506},[43,15733,1453],{"class":148},[43,15735,1456],{"class":1277},[43,15737,1459],{"class":148},[43,15739,1462],{"class":1277},[33,15741,15744],{"className":1195,"code":15742,"filename":15743,"language":1198,"meta":38,"style":38},"/* @bruin\n\nname: mart.customers_by_country\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\n\n@bruin */\n\nSELECT\n    country,\n    COUNT(*) AS total_customers\n  FROM stg.customers\n  GROUP BY country\n  ORDER BY total_customers DESC\n","mart.customers_by_county.asset.sql",[40,15745,15746,15750,15754,15759,15763,15767,15771,15775,15779,15783,15787,15791,15795,15799,15803,15807,15812,15827,15833,15840],{"__ignoreMap":38},[43,15747,15748],{"class":45,"line":46},[43,15749,1205],{"class":1006},[43,15751,15752],{"class":45,"line":61},[43,15753,244],{"emptyLinePlaceholder":243},[43,15755,15756],{"class":45,"line":70},[43,15757,15758],{"class":1006},"name: mart.customers_by_country\n",[43,15760,15761],{"class":45,"line":78},[43,15762,1215],{"class":1006},[43,15764,15765],{"class":45,"line":86},[43,15766,244],{"emptyLinePlaceholder":243},[43,15768,15769],{"class":45,"line":94},[43,15770,1235],{"class":1006},[43,15772,15773],{"class":45,"line":108},[43,15774,1240],{"class":1006},[43,15776,15777],{"class":45,"line":119},[43,15778,1245],{"class":1006},[43,15780,15781],{"class":45,"line":129},[43,15782,244],{"emptyLinePlaceholder":243},[43,15784,15785],{"class":45,"line":140},[43,15786,1250],{"class":1006},[43,15788,15789],{"class":45,"line":152},[43,15790,1255],{"class":1006},[43,15792,15793],{"class":45,"line":162},[43,15794,244],{"emptyLinePlaceholder":243},[43,15796,15797],{"class":45,"line":170},[43,15798,1265],{"class":1006},[43,15800,15801],{"class":45,"line":182},[43,15802,244],{"emptyLinePlaceholder":243},[43,15804,15805],{"class":45,"line":374},[43,15806,1674],{"class":148},[43,15808,15809],{"class":45,"line":382},[43,15810,15811],{"class":1277},"    country,\n",[43,15813,15814,15817,15819,15821,15823,15825],{"class":45,"line":392},[43,15815,15816],{"class":1418},"    COUNT",[43,15818,1422],{"class":1277},[43,15820,1425],{"class":53},[43,15822,1428],{"class":1277},[43,15824,1281],{"class":148},[43,15826,1433],{"class":1277},[43,15828,15829,15831],{"class":45,"line":399},[43,15830,1397],{"class":148},[43,15832,1400],{"class":1277},[43,15834,15835,15838],{"class":45,"line":410},[43,15836,15837],{"class":148},"  GROUP BY",[43,15839,845],{"class":1277},[43,15841,15842,15845,15847],{"class":45,"line":417},[43,15843,15844],{"class":148},"  ORDER BY",[43,15846,1456],{"class":1277},[43,15848,15849],{"class":148},"DESC\n",[1992,15851,15852],{},"So now, we clearly have a data pipeline that turns raw data into well-structured, curated datasets which can be used\nfor analysis. We can also leverage the power of Bruin's data quality system to ensure that our data is always up-to-date\nand accurate.",[1992,15854,15855],{},"Let's run the mart pipeline:",[3260,15857,15858,15878],{},[3263,15859,15860],{"icon":3265,"label":3266},[33,15861,15863],{"className":2054,"code":15862,"language":2056,"meta":38,"style":38},"bruin run orders-performance --tag mart \n",[40,15864,15865],{"__ignoreMap":38},[43,15866,15867,15869,15871,15873,15875],{"class":45,"line":46},[43,15868,2091],{"class":2063},[43,15870,3163],{"class":57},[43,15872,9521],{"class":57},[43,15874,9524],{"class":57},[43,15876,15877],{"class":57}," mart\n",[3263,15879,15880],{"icon":3324,"label":3325},[3409,15881,15882],{},[33,15883,15885],{"className":2054,"code":15884,"language":2056,"meta":38,"style":38},"bruin run orders-performance --tag mart \nAnalyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found                                                                                                                                                                   \n\n✓ Successfully validated 15 assets across 1 pipeline, all good.                                                                                                                     \n                                                                                                                                                                                    \nInterval: 2025-10-18T00:00:00Z - 2025-10-18T23:59:59Z\n\nStarting the pipeline execution...\n\n[23:23:17] Running:  mart.sales_daily\n[23:23:17] Running:  mart.customers_by_country\n[23:23:17] Running:  mart.product_performance\n[23:23:17] Running:  mart.variant_profitability\n[23:23:17] Running:  mart.customers_by_age\n[23:23:17] Finished: mart.sales_daily (31ms)\n[23:23:17] Running:  mart.sales_daily:custom-check:total_revenue_non-negative\n[23:23:17] Running:  mart.sales_daily:revenue:not_null\n[23:23:17] Running:  mart.sales_daily:sale_date:not_null\n[23:23:17] Running:  mart.sales_daily:orders_count:not_null\n[23:23:17] Running:  mart.sales_daily:items_count:not_null\n[23:23:17] Finished: mart.customers_by_country (55ms)\n[23:23:17] Finished: mart.sales_daily:custom-check:total_revenue_non-negative (28ms)\n[23:23:17] Finished: mart.sales_daily:revenue:not_null (34ms)\n[23:23:17] Finished: mart.customers_by_age (93ms)\n[23:23:17] Finished: mart.sales_daily:sale_date:not_null (69ms)\n[23:23:17] Finished: mart.variant_profitability (127ms)\n[23:23:17] Running:  mart.variant_profitability:margin_pct:not_null\n[23:23:17] Running:  mart.variant_profitability:product_id:not_null\n[23:23:17] Running:  mart.variant_profitability:cost:not_null\n[23:23:17] Running:  mart.variant_profitability:profit:not_null\n[23:23:17] Running:  mart.variant_profitability:variant_sku:not_null\n[23:23:17] Running:  mart.variant_profitability:revenue:not_null\n[23:23:17] Running:  mart.variant_profitability:items_sold:not_null\n[23:23:17] Running:  mart.variant_profitability:variant_id:unique\n[23:23:17] Running:  mart.variant_profitability:variant_id:not_null\n[23:23:17] Finished: mart.variant_profitability:margin_pct:not_null (5ms)\n[23:23:17] Finished: mart.variant_profitability:profit:not_null (11ms)\n[23:23:17] Finished: mart.variant_profitability:cost:not_null (17ms)\n[23:23:17] Finished: mart.variant_profitability:variant_id:unique (23ms)\n[23:23:17] Finished: mart.variant_profitability:variant_id:not_null (30ms)\n[23:23:17] Finished: mart.variant_profitability:revenue:not_null (36ms)\n[23:23:17] Finished: mart.variant_profitability:product_id:not_null (42ms)\n[23:23:17] Finished: mart.variant_profitability:variant_sku:not_null (49ms)\n[23:23:17] Finished: mart.variant_profitability:items_sold:not_null (55ms)\n[23:23:17] Finished: mart.sales_daily:items_count:not_null (161ms)\n[23:23:17] Finished: mart.sales_daily:orders_count:not_null (168ms)\n[23:23:17] Finished: mart.product_performance (238ms)\n[23:23:17] Running:  mart.product_performance:custom-check:no_negative_prices_or_revenue\n[23:23:17] Running:  mart.product_performance:category:not_null\n[23:23:17] Running:  mart.product_performance:avg_item_price:not_null\n[23:23:17] Running:  mart.product_performance:product_id:not_null\n[23:23:17] Running:  mart.product_performance:gross_revenue:not_null\n[23:23:17] Running:  mart.product_performance:product_name:not_null\n[23:23:17] Running:  mart.product_performance:items_sold:not_null\n[23:23:17] Finished: mart.product_performance:category:not_null (5ms)\n[23:23:17] Finished: mart.product_performance:custom-check:no_negative_prices_or_revenue (11ms)\n[23:23:17] Finished: mart.product_performance:product_id:not_null (18ms)\n[23:23:17] Finished: mart.product_performance:product_name:not_null (23ms)\n[23:23:17] Finished: mart.product_performance:gross_revenue:not_null (29ms)\n[23:23:17] Finished: mart.product_performance:avg_item_price:not_null (35ms)\n[23:23:17] Finished: mart.product_performance:items_sold:not_null (43ms)\n\n==================================================\n\nPASS mart.sales_daily .....\nPASS mart.customers_by_country \nPASS mart.customers_by_age \nPASS mart.variant_profitability .........\nPASS mart.product_performance .......\n\n\nbruin run completed successfully in 281ms\n\n ✓ Assets executed      5 succeeded\n ✓ Quality checks       21 succeeded\n\n",[40,15886,15887,15902,15922,15926,15934,15946,15950,15976,15981,15993,15997,16007,16011,16023,16034,16045,16056,16067,16083,16094,16105,16116,16127,16138,16154,16169,16185,16201,16217,16233,16244,16255,16266,16277,16288,16299,16310,16321,16332,16348,16364,16380,16396,16412,16428,16444,16460,16475,16491,16507,16523,16534,16545,16556,16567,16578,16589,16600,16615,16630,16646,16661,16677,16693,16709,16713,16717,16721,16731,16740,16749,16759,16769,16773,16777,16792,16796,16808],{"__ignoreMap":38},[43,15888,15889,15891,15893,15895,15897,15900],{"class":45,"line":46},[43,15890,2091],{"class":2063},[43,15892,3163],{"class":57},[43,15894,9521],{"class":57},[43,15896,9524],{"class":57},[43,15898,15899],{"class":57}," mart",[43,15901,9728],{"class":1277},[43,15903,15904,15906,15908,15910,15912,15914,15916,15918,15920],{"class":45,"line":61},[43,15905,9538],{"class":2063},[43,15907,9541],{"class":57},[43,15909,9544],{"class":57},[43,15911,1312],{"class":53},[43,15913,9549],{"class":57},[43,15915,1590],{"class":53},[43,15917,9554],{"class":57},[43,15919,9557],{"class":148},[43,15921,9560],{"class":57},[43,15923,15924],{"class":45,"line":70},[43,15925,244],{"emptyLinePlaceholder":243},[43,15927,15928,15930,15932],{"class":45,"line":78},[43,15929,9569],{"class":2063},[43,15931,9572],{"class":57},[43,15933,9575],{"class":1277},[43,15935,15936,15938,15940,15943],{"class":45,"line":86},[43,15937,9580],{"class":2063},[43,15939,9583],{"class":57},[43,15941,15942],{"class":57}," found",[43,15944,15945],{"class":1277},"                                                                                                                                                                   \n",[43,15947,15948],{"class":45,"line":94},[43,15949,244],{"emptyLinePlaceholder":243},[43,15951,15952,15954,15956,15958,15960,15962,15964,15966,15968,15970,15973],{"class":45,"line":108},[43,15953,9595],{"class":2063},[43,15955,9598],{"class":57},[43,15957,9601],{"class":57},[43,15959,9557],{"class":148},[43,15961,9481],{"class":57},[43,15963,9608],{"class":57},[43,15965,1003],{"class":148},[43,15967,9613],{"class":57},[43,15969,9616],{"class":57},[43,15971,15972],{"class":57}," good.",[43,15974,15975],{"class":1277},"                                                                                                                     \n",[43,15977,15978],{"class":45,"line":119},[43,15979,15980],{"class":1277},"                                                                                                                                                                                    \n",[43,15982,15983,15985,15988,15990],{"class":45,"line":129},[43,15984,9628],{"class":2063},[43,15986,15987],{"class":57}," 2025-10-18T00:00:00Z",[43,15989,9634],{"class":57},[43,15991,15992],{"class":57}," 2025-10-18T23:59:59Z\n",[43,15994,15995],{"class":45,"line":140},[43,15996,244],{"emptyLinePlaceholder":243},[43,15998,15999,16001,16003,16005],{"class":45,"line":152},[43,16000,9642],{"class":2063},[43,16002,9541],{"class":57},[43,16004,9544],{"class":57},[43,16006,9649],{"class":57},[43,16008,16009],{"class":45,"line":162},[43,16010,244],{"emptyLinePlaceholder":243},[43,16012,16013,16015,16018,16020],{"class":45,"line":170},[43,16014,7542],{"class":53},[43,16016,16017],{"class":1277},"23:23:17",[43,16019,7547],{"class":53},[43,16021,16022],{"class":1277}," Running:  mart.sales_daily\n",[43,16024,16025,16027,16029,16031],{"class":45,"line":182},[43,16026,7542],{"class":53},[43,16028,16017],{"class":1277},[43,16030,7547],{"class":53},[43,16032,16033],{"class":1277}," Running:  mart.customers_by_country\n",[43,16035,16036,16038,16040,16042],{"class":45,"line":374},[43,16037,7542],{"class":53},[43,16039,16017],{"class":1277},[43,16041,7547],{"class":53},[43,16043,16044],{"class":1277}," Running:  mart.product_performance\n",[43,16046,16047,16049,16051,16053],{"class":45,"line":382},[43,16048,7542],{"class":53},[43,16050,16017],{"class":1277},[43,16052,7547],{"class":53},[43,16054,16055],{"class":1277}," Running:  mart.variant_profitability\n",[43,16057,16058,16060,16062,16064],{"class":45,"line":392},[43,16059,7542],{"class":53},[43,16061,16017],{"class":1277},[43,16063,7547],{"class":53},[43,16065,16066],{"class":1277}," Running:  mart.customers_by_age\n",[43,16068,16069,16071,16073,16075,16078,16081],{"class":45,"line":399},[43,16070,7542],{"class":53},[43,16072,16017],{"class":1277},[43,16074,7547],{"class":53},[43,16076,16077],{"class":1277}," Finished: mart.sales_daily (",[43,16079,16080],{"class":2063},"31ms",[43,16082,1405],{"class":1277},[43,16084,16085,16087,16089,16091],{"class":45,"line":410},[43,16086,7542],{"class":53},[43,16088,16017],{"class":1277},[43,16090,7547],{"class":53},[43,16092,16093],{"class":1277}," Running:  mart.sales_daily:custom-check:total_revenue_non-negative\n",[43,16095,16096,16098,16100,16102],{"class":45,"line":417},[43,16097,7542],{"class":53},[43,16099,16017],{"class":1277},[43,16101,7547],{"class":53},[43,16103,16104],{"class":1277}," Running:  mart.sales_daily:revenue:not_null\n",[43,16106,16107,16109,16111,16113],{"class":45,"line":425},[43,16108,7542],{"class":53},[43,16110,16017],{"class":1277},[43,16112,7547],{"class":53},[43,16114,16115],{"class":1277}," Running:  mart.sales_daily:sale_date:not_null\n",[43,16117,16118,16120,16122,16124],{"class":45,"line":430},[43,16119,7542],{"class":53},[43,16121,16017],{"class":1277},[43,16123,7547],{"class":53},[43,16125,16126],{"class":1277}," Running:  mart.sales_daily:orders_count:not_null\n",[43,16128,16129,16131,16133,16135],{"class":45,"line":438},[43,16130,7542],{"class":53},[43,16132,16017],{"class":1277},[43,16134,7547],{"class":53},[43,16136,16137],{"class":1277}," Running:  mart.sales_daily:items_count:not_null\n",[43,16139,16140,16142,16144,16146,16149,16152],{"class":45,"line":446},[43,16141,7542],{"class":53},[43,16143,16017],{"class":1277},[43,16145,7547],{"class":53},[43,16147,16148],{"class":1277}," Finished: mart.customers_by_country (",[43,16150,16151],{"class":2063},"55ms",[43,16153,1405],{"class":1277},[43,16155,16156,16158,16160,16162,16165,16167],{"class":45,"line":456},[43,16157,7542],{"class":53},[43,16159,16017],{"class":1277},[43,16161,7547],{"class":53},[43,16163,16164],{"class":1277}," Finished: mart.sales_daily:custom-check:total_revenue_non-negative (",[43,16166,13829],{"class":2063},[43,16168,1405],{"class":1277},[43,16170,16171,16173,16175,16177,16180,16183],{"class":45,"line":464},[43,16172,7542],{"class":53},[43,16174,16017],{"class":1277},[43,16176,7547],{"class":53},[43,16178,16179],{"class":1277}," Finished: mart.sales_daily:revenue:not_null (",[43,16181,16182],{"class":2063},"34ms",[43,16184,1405],{"class":1277},[43,16186,16187,16189,16191,16193,16196,16199],{"class":45,"line":472},[43,16188,7542],{"class":53},[43,16190,16017],{"class":1277},[43,16192,7547],{"class":53},[43,16194,16195],{"class":1277}," Finished: mart.customers_by_age (",[43,16197,16198],{"class":2063},"93ms",[43,16200,1405],{"class":1277},[43,16202,16203,16205,16207,16209,16212,16215],{"class":45,"line":483},[43,16204,7542],{"class":53},[43,16206,16017],{"class":1277},[43,16208,7547],{"class":53},[43,16210,16211],{"class":1277}," Finished: mart.sales_daily:sale_date:not_null (",[43,16213,16214],{"class":2063},"69ms",[43,16216,1405],{"class":1277},[43,16218,16219,16221,16223,16225,16228,16231],{"class":45,"line":494},[43,16220,7542],{"class":53},[43,16222,16017],{"class":1277},[43,16224,7547],{"class":53},[43,16226,16227],{"class":1277}," Finished: mart.variant_profitability (",[43,16229,16230],{"class":2063},"127ms",[43,16232,1405],{"class":1277},[43,16234,16235,16237,16239,16241],{"class":45,"line":506},[43,16236,7542],{"class":53},[43,16238,16017],{"class":1277},[43,16240,7547],{"class":53},[43,16242,16243],{"class":1277}," Running:  mart.variant_profitability:margin_pct:not_null\n",[43,16245,16246,16248,16250,16252],{"class":45,"line":517},[43,16247,7542],{"class":53},[43,16249,16017],{"class":1277},[43,16251,7547],{"class":53},[43,16253,16254],{"class":1277}," Running:  mart.variant_profitability:product_id:not_null\n",[43,16256,16257,16259,16261,16263],{"class":45,"line":525},[43,16258,7542],{"class":53},[43,16260,16017],{"class":1277},[43,16262,7547],{"class":53},[43,16264,16265],{"class":1277}," Running:  mart.variant_profitability:cost:not_null\n",[43,16267,16268,16270,16272,16274],{"class":45,"line":538},[43,16269,7542],{"class":53},[43,16271,16017],{"class":1277},[43,16273,7547],{"class":53},[43,16275,16276],{"class":1277}," Running:  mart.variant_profitability:profit:not_null\n",[43,16278,16279,16281,16283,16285],{"class":45,"line":550},[43,16280,7542],{"class":53},[43,16282,16017],{"class":1277},[43,16284,7547],{"class":53},[43,16286,16287],{"class":1277}," Running:  mart.variant_profitability:variant_sku:not_null\n",[43,16289,16290,16292,16294,16296],{"class":45,"line":558},[43,16291,7542],{"class":53},[43,16293,16017],{"class":1277},[43,16295,7547],{"class":53},[43,16297,16298],{"class":1277}," Running:  mart.variant_profitability:revenue:not_null\n",[43,16300,16301,16303,16305,16307],{"class":45,"line":568},[43,16302,7542],{"class":53},[43,16304,16017],{"class":1277},[43,16306,7547],{"class":53},[43,16308,16309],{"class":1277}," Running:  mart.variant_profitability:items_sold:not_null\n",[43,16311,16312,16314,16316,16318],{"class":45,"line":578},[43,16313,7542],{"class":53},[43,16315,16017],{"class":1277},[43,16317,7547],{"class":53},[43,16319,16320],{"class":1277}," Running:  mart.variant_profitability:variant_id:unique\n",[43,16322,16323,16325,16327,16329],{"class":45,"line":588},[43,16324,7542],{"class":53},[43,16326,16017],{"class":1277},[43,16328,7547],{"class":53},[43,16330,16331],{"class":1277}," Running:  mart.variant_profitability:variant_id:not_null\n",[43,16333,16334,16336,16338,16340,16343,16346],{"class":45,"line":595},[43,16335,7542],{"class":53},[43,16337,16017],{"class":1277},[43,16339,7547],{"class":53},[43,16341,16342],{"class":1277}," Finished: mart.variant_profitability:margin_pct:not_null (",[43,16344,16345],{"class":2063},"5ms",[43,16347,1405],{"class":1277},[43,16349,16350,16352,16354,16356,16359,16362],{"class":45,"line":606},[43,16351,7542],{"class":53},[43,16353,16017],{"class":1277},[43,16355,7547],{"class":53},[43,16357,16358],{"class":1277}," Finished: mart.variant_profitability:profit:not_null (",[43,16360,16361],{"class":2063},"11ms",[43,16363,1405],{"class":1277},[43,16365,16366,16368,16370,16372,16375,16378],{"class":45,"line":614},[43,16367,7542],{"class":53},[43,16369,16017],{"class":1277},[43,16371,7547],{"class":53},[43,16373,16374],{"class":1277}," Finished: mart.variant_profitability:cost:not_null (",[43,16376,16377],{"class":2063},"17ms",[43,16379,1405],{"class":1277},[43,16381,16382,16384,16386,16388,16391,16394],{"class":45,"line":624},[43,16383,7542],{"class":53},[43,16385,16017],{"class":1277},[43,16387,7547],{"class":53},[43,16389,16390],{"class":1277}," Finished: mart.variant_profitability:variant_id:unique (",[43,16392,16393],{"class":2063},"23ms",[43,16395,1405],{"class":1277},[43,16397,16398,16400,16402,16404,16407,16410],{"class":45,"line":633},[43,16399,7542],{"class":53},[43,16401,16017],{"class":1277},[43,16403,7547],{"class":53},[43,16405,16406],{"class":1277}," Finished: mart.variant_profitability:variant_id:not_null (",[43,16408,16409],{"class":2063},"30ms",[43,16411,1405],{"class":1277},[43,16413,16414,16416,16418,16420,16423,16426],{"class":45,"line":643},[43,16415,7542],{"class":53},[43,16417,16017],{"class":1277},[43,16419,7547],{"class":53},[43,16421,16422],{"class":1277}," Finished: mart.variant_profitability:revenue:not_null (",[43,16424,16425],{"class":2063},"36ms",[43,16427,1405],{"class":1277},[43,16429,16430,16432,16434,16436,16439,16442],{"class":45,"line":650},[43,16431,7542],{"class":53},[43,16433,16017],{"class":1277},[43,16435,7547],{"class":53},[43,16437,16438],{"class":1277}," Finished: mart.variant_profitability:product_id:not_null (",[43,16440,16441],{"class":2063},"42ms",[43,16443,1405],{"class":1277},[43,16445,16446,16448,16450,16452,16455,16458],{"class":45,"line":661},[43,16447,7542],{"class":53},[43,16449,16017],{"class":1277},[43,16451,7547],{"class":53},[43,16453,16454],{"class":1277}," Finished: mart.variant_profitability:variant_sku:not_null (",[43,16456,16457],{"class":2063},"49ms",[43,16459,1405],{"class":1277},[43,16461,16462,16464,16466,16468,16471,16473],{"class":45,"line":669},[43,16463,7542],{"class":53},[43,16465,16017],{"class":1277},[43,16467,7547],{"class":53},[43,16469,16470],{"class":1277}," Finished: mart.variant_profitability:items_sold:not_null (",[43,16472,16151],{"class":2063},[43,16474,1405],{"class":1277},[43,16476,16477,16479,16481,16483,16486,16489],{"class":45,"line":679},[43,16478,7542],{"class":53},[43,16480,16017],{"class":1277},[43,16482,7547],{"class":53},[43,16484,16485],{"class":1277}," Finished: mart.sales_daily:items_count:not_null (",[43,16487,16488],{"class":2063},"161ms",[43,16490,1405],{"class":1277},[43,16492,16493,16495,16497,16499,16502,16505],{"class":45,"line":687},[43,16494,7542],{"class":53},[43,16496,16017],{"class":1277},[43,16498,7547],{"class":53},[43,16500,16501],{"class":1277}," Finished: mart.sales_daily:orders_count:not_null (",[43,16503,16504],{"class":2063},"168ms",[43,16506,1405],{"class":1277},[43,16508,16509,16511,16513,16515,16518,16521],{"class":45,"line":695},[43,16510,7542],{"class":53},[43,16512,16017],{"class":1277},[43,16514,7547],{"class":53},[43,16516,16517],{"class":1277}," Finished: mart.product_performance (",[43,16519,16520],{"class":2063},"238ms",[43,16522,1405],{"class":1277},[43,16524,16525,16527,16529,16531],{"class":45,"line":702},[43,16526,7542],{"class":53},[43,16528,16017],{"class":1277},[43,16530,7547],{"class":53},[43,16532,16533],{"class":1277}," Running:  mart.product_performance:custom-check:no_negative_prices_or_revenue\n",[43,16535,16536,16538,16540,16542],{"class":45,"line":709},[43,16537,7542],{"class":53},[43,16539,16017],{"class":1277},[43,16541,7547],{"class":53},[43,16543,16544],{"class":1277}," Running:  mart.product_performance:category:not_null\n",[43,16546,16547,16549,16551,16553],{"class":45,"line":719},[43,16548,7542],{"class":53},[43,16550,16017],{"class":1277},[43,16552,7547],{"class":53},[43,16554,16555],{"class":1277}," Running:  mart.product_performance:avg_item_price:not_null\n",[43,16557,16558,16560,16562,16564],{"class":45,"line":728},[43,16559,7542],{"class":53},[43,16561,16017],{"class":1277},[43,16563,7547],{"class":53},[43,16565,16566],{"class":1277}," Running:  mart.product_performance:product_id:not_null\n",[43,16568,16569,16571,16573,16575],{"class":45,"line":735},[43,16570,7542],{"class":53},[43,16572,16017],{"class":1277},[43,16574,7547],{"class":53},[43,16576,16577],{"class":1277}," Running:  mart.product_performance:gross_revenue:not_null\n",[43,16579,16580,16582,16584,16586],{"class":45,"line":746},[43,16581,7542],{"class":53},[43,16583,16017],{"class":1277},[43,16585,7547],{"class":53},[43,16587,16588],{"class":1277}," Running:  mart.product_performance:product_name:not_null\n",[43,16590,16591,16593,16595,16597],{"class":45,"line":757},[43,16592,7542],{"class":53},[43,16594,16017],{"class":1277},[43,16596,7547],{"class":53},[43,16598,16599],{"class":1277}," Running:  mart.product_performance:items_sold:not_null\n",[43,16601,16602,16604,16606,16608,16611,16613],{"class":45,"line":765},[43,16603,7542],{"class":53},[43,16605,16017],{"class":1277},[43,16607,7547],{"class":53},[43,16609,16610],{"class":1277}," Finished: mart.product_performance:category:not_null (",[43,16612,16345],{"class":2063},[43,16614,1405],{"class":1277},[43,16616,16617,16619,16621,16623,16626,16628],{"class":45,"line":775},[43,16618,7542],{"class":53},[43,16620,16017],{"class":1277},[43,16622,7547],{"class":53},[43,16624,16625],{"class":1277}," Finished: mart.product_performance:custom-check:no_negative_prices_or_revenue (",[43,16627,16361],{"class":2063},[43,16629,1405],{"class":1277},[43,16631,16632,16634,16636,16638,16641,16644],{"class":45,"line":785},[43,16633,7542],{"class":53},[43,16635,16017],{"class":1277},[43,16637,7547],{"class":53},[43,16639,16640],{"class":1277}," Finished: mart.product_performance:product_id:not_null (",[43,16642,16643],{"class":2063},"18ms",[43,16645,1405],{"class":1277},[43,16647,16648,16650,16652,16654,16657,16659],{"class":45,"line":792},[43,16649,7542],{"class":53},[43,16651,16017],{"class":1277},[43,16653,7547],{"class":53},[43,16655,16656],{"class":1277}," Finished: mart.product_performance:product_name:not_null (",[43,16658,16393],{"class":2063},[43,16660,1405],{"class":1277},[43,16662,16663,16665,16667,16669,16672,16675],{"class":45,"line":803},[43,16664,7542],{"class":53},[43,16666,16017],{"class":1277},[43,16668,7547],{"class":53},[43,16670,16671],{"class":1277}," Finished: mart.product_performance:gross_revenue:not_null (",[43,16673,16674],{"class":2063},"29ms",[43,16676,1405],{"class":1277},[43,16678,16679,16681,16683,16685,16688,16691],{"class":45,"line":811},[43,16680,7542],{"class":53},[43,16682,16017],{"class":1277},[43,16684,7547],{"class":53},[43,16686,16687],{"class":1277}," Finished: mart.product_performance:avg_item_price:not_null (",[43,16689,16690],{"class":2063},"35ms",[43,16692,1405],{"class":1277},[43,16694,16695,16697,16699,16701,16704,16707],{"class":45,"line":821},[43,16696,7542],{"class":53},[43,16698,16017],{"class":1277},[43,16700,7547],{"class":53},[43,16702,16703],{"class":1277}," Finished: mart.product_performance:items_sold:not_null (",[43,16705,16706],{"class":2063},"43ms",[43,16708,1405],{"class":1277},[43,16710,16711],{"class":45,"line":830},[43,16712,244],{"emptyLinePlaceholder":243},[43,16714,16715],{"class":45,"line":838},[43,16716,13942],{"class":57},[43,16718,16719],{"class":45,"line":848},[43,16720,244],{"emptyLinePlaceholder":243},[43,16722,16723,16725,16728],{"class":45,"line":857},[43,16724,9722],{"class":2063},[43,16726,16727],{"class":57}," mart.sales_daily",[43,16729,16730],{"class":57}," .....\n",[43,16732,16733,16735,16738],{"class":45,"line":865},[43,16734,9722],{"class":2063},[43,16736,16737],{"class":57}," mart.customers_by_country",[43,16739,9728],{"class":1277},[43,16741,16742,16744,16747],{"class":45,"line":875},[43,16743,9722],{"class":2063},[43,16745,16746],{"class":57}," mart.customers_by_age",[43,16748,9728],{"class":1277},[43,16750,16751,16753,16756],{"class":45,"line":884},[43,16752,9722],{"class":2063},[43,16754,16755],{"class":57}," mart.variant_profitability",[43,16757,16758],{"class":57}," .........\n",[43,16760,16761,16763,16766],{"class":45,"line":891},[43,16762,9722],{"class":2063},[43,16764,16765],{"class":57}," mart.product_performance",[43,16767,16768],{"class":57}," .......\n",[43,16770,16771],{"class":45,"line":903},[43,16772,244],{"emptyLinePlaceholder":243},[43,16774,16775],{"class":45,"line":4229},[43,16776,244],{"emptyLinePlaceholder":243},[43,16778,16779,16781,16783,16785,16787,16789],{"class":45,"line":4235},[43,16780,2091],{"class":2063},[43,16782,3163],{"class":57},[43,16784,9777],{"class":57},[43,16786,9780],{"class":57},[43,16788,9783],{"class":57},[43,16790,16791],{"class":57}," 281ms\n",[43,16793,16794],{"class":45,"line":4241},[43,16795,244],{"emptyLinePlaceholder":243},[43,16797,16798,16800,16802,16804,16806],{"class":45,"line":4247},[43,16799,9795],{"class":2063},[43,16801,9798],{"class":57},[43,16803,9801],{"class":57},[43,16805,9804],{"class":148},[43,16807,9807],{"class":57},[43,16809,16810,16812,16814,16816,16819],{"class":45,"line":4256},[43,16811,9795],{"class":2063},[43,16813,14038],{"class":57},[43,16815,14041],{"class":57},[43,16817,16818],{"class":148},"       21",[43,16820,9807],{"class":57},[1992,16822,16823],{},"Everything worked as expected! Now we can start using/querying our data using the CLI:",[3260,16825,16826,16918,16933],{},[3263,16827,16828],{"icon":3265,"label":3266},[33,16829,16831],{"className":2054,"code":16830,"language":2056,"meta":38,"style":38},"for t in \\\n  mart.sales_daily \\\n  mart.product_performance \\\n  mart.variant_profitability \\\n  mart.customers_by_age \\\n  mart.customers_by_country; do\n  bruin query --c duckdb-default --q \"select * from $t limit 10\"\ndone\n\n",[40,16832,16833,16845,16852,16859,16866,16873,16883,16913],{"__ignoreMap":38},[43,16834,16835,16838,16841,16843],{"class":45,"line":46},[43,16836,16837],{"class":3427},"for",[43,16839,16840],{"class":1277}," t ",[43,16842,5517],{"class":3427},[43,16844,3169],{"class":1277},[43,16846,16847,16850],{"class":45,"line":61},[43,16848,16849],{"class":57},"  mart.sales_daily",[43,16851,3169],{"class":1277},[43,16853,16854,16857],{"class":45,"line":70},[43,16855,16856],{"class":57},"  mart.product_performance",[43,16858,3169],{"class":1277},[43,16860,16861,16864],{"class":45,"line":78},[43,16862,16863],{"class":57},"  mart.variant_profitability",[43,16865,3169],{"class":1277},[43,16867,16868,16871],{"class":45,"line":86},[43,16869,16870],{"class":57},"  mart.customers_by_age",[43,16872,3169],{"class":1277},[43,16874,16875,16878,16880],{"class":45,"line":94},[43,16876,16877],{"class":57},"  mart.customers_by_country",[43,16879,4091],{"class":53},[43,16881,16882],{"class":3427}," do\n",[43,16884,16885,16888,16891,16894,16897,16900,16902,16905,16908,16911],{"class":45,"line":108},[43,16886,16887],{"class":2063},"  bruin",[43,16889,16890],{"class":57}," query",[43,16892,16893],{"class":57}," --c",[43,16895,16896],{"class":57}," duckdb-default",[43,16898,16899],{"class":57}," --q",[43,16901,299],{"class":53},[43,16903,16904],{"class":57},"select * from ",[43,16906,16907],{"class":1277},"$t",[43,16909,16910],{"class":57}," limit 10",[43,16912,305],{"class":53},[43,16914,16915],{"class":45,"line":119},[43,16916,16917],{"class":3427},"done\n",[3263,16919,16921],{"icon":16920,"label":3309},"i-lucide-file-terminal",[33,16922,16924],{"className":2054,"code":16923,"language":2056,"meta":38,"style":38},"make mart-list\n",[40,16925,16926],{"__ignoreMap":38},[43,16927,16928,16930],{"class":45,"line":46},[43,16929,3252],{"class":2063},[43,16931,16932],{"class":57}," mart-list\n",[3263,16934,16935],{"icon":3324,"label":3325},[3409,16936,16937],{},[33,16938,16940],{"className":2054,"code":16939,"language":2056,"meta":38,"style":38},"┌───────────────────────────────┬──────────────┬─────────────┬───────────┐\n│ SALE_DATE                     │ ORDERS_COUNT │ ITEMS_COUNT │ REVENUE   │\n├───────────────────────────────┼──────────────┼─────────────┼───────────┤\n│ 2025-10-20 00:00:00 +0000 UTC │ 440          │ 1328        │ 206063.72 │\n│ 2025-10-21 00:00:00 +0000 UTC │ 60           │ 178         │ 26792.41  │\n└───────────────────────────────┴──────────────┴─────────────┴───────────┘\n┌────────────┬────────────────────┬─────────────┬────────────┬───────────────┬────────────────────┐\n│ PRODUCT_ID │ PRODUCT_NAME       │ CATEGORY    │ ITEMS_SOLD │ GROSS_REVENUE │ AVG_ITEM_PRICE     │\n├────────────┼────────────────────┼─────────────┼────────────┼───────────────┼────────────────────┤\n│ 26         │ Well hoodies       │ hoodies     │ 101        │ 11578.84      │ 114.64198019801981 │\n│ 8          │ Often shoes        │ shoes       │ 84         │ 9511.24       │ 113.22904761904762 │\n│ 9          │ Professor t-shirts │ t-shirts    │ 82         │ 9300.89       │ 113.42548780487805 │\n│ 41         │ White t-shirts     │ t-shirts    │ 80         │ 9202.42       │ 115.03025          │\n│ 30         │ Pull jackets       │ jackets     │ 80         │ 8586.61       │ 107.33262500000001 │\n│ 37         │ Resource jackets   │ jackets     │ 74         │ 8289.51       │ 112.02040540540541 │\n│ 35         │ Others hoodies     │ hoodies     │ 73         │ 7810.05       │ 106.98698630136987 │\n│ 10         │ Old hoodies        │ hoodies     │ 66         │ 7365.61       │ 111.60015151515151 │\n│ 16         │ Nothing hoodies    │ hoodies     │ 61         │ 7222.53       │ 118.40213114754098 │\n│ 38         │ Along accessories  │ accessories │ 54         │ 6740.6        │ 124.82592592592593 │\n└────────────┴────────────────────┴─────────────┴────────────┴───────────────┴────────────────────┘\n┌────────────────────┬────────────┬─────────────┬────────────┬────────────┬─────────┬────────┬─────────┬────────────────────┬──────────────────────────┐\n│ PRODUCT_NAME       │ VARIANT_ID │ VARIANT_SKU │ PRODUCT_ID │ ITEMS_SOLD │ REVENUE │ COST   │ PROFIT  │ MARGIN_PCT         │ SELLING_PRICE_BELOW_COST │\n├────────────────────┼────────────┼─────────────┼────────────┼────────────┼─────────┼────────┼─────────┼────────────────────┼──────────────────────────┤\n│ White t-shirts     │ 111        │ VAR-7584-ZF │ 41         │ 35         │ 5118.96 │ 1022   │ 4096.96 │ 0.8003500711081939 │ false                    │\n│ House jackets      │ 75         │ VAR-2214-YG │ 27         │ 19         │ 3119.34 │ 390.64 │ 2728.7  │ 0.8747683804907448 │ false                    │\n│ East shoes         │ 50         │ VAR-1369-ZH │ 18         │ 22         │ 3051.23 │ 563.2  │ 2488.03 │ 0.8154186999996723 │ false                    │\n│ Well hoodies       │ 72         │ VAR-5281-PQ │ 26         │ 29         │ 3192.99 │ 816.06 │ 2376.93 │ 0.7444213730703823 │ false                    │\n│ Town hoodies       │ 63         │ VAR-7820-CG │ 23         │ 26         │ 3068.31 │ 776.62 │ 2291.69 │ 0.7468899817815019 │ false                    │\n│ Prepare shoes      │ 65         │ VAR-7788-NK │ 24         │ 21         │ 2700.78 │ 426.51 │ 2274.27 │ 0.8420789549685646 │ false                    │\n│ Indicate hoodies   │ 114        │ VAR-4479-TB │ 43         │ 20         │ 2623.64 │ 359.8  │ 2263.84 │ 0.8628622829351589 │ false                    │\n│ Professor t-shirts │ 24         │ VAR-8098-JV │ 9          │ 30         │ 3144.22 │ 899.1  │ 2245.12 │ 0.7140467270101964 │ false                    │\n│ Under t-shirts     │ 109        │ VAR-4156-ZV │ 40         │ 20         │ 2673.75 │ 503    │ 2170.75 │ 0.8118747078073866 │ false                    │\n│ Others hoodies     │ 91         │ VAR-7790-FB │ 35         │ 27         │ 2555.88 │ 413.64 │ 2142.24 │ 0.8381614160289215 │ false                    │\n└────────────────────┴────────────┴─────────────┴────────────┴────────────┴─────────┴────────┴─────────┴────────────────────┴──────────────────────────┘\n┌───────────┬─────────────────┐\n│ AGE_GROUP │ TOTAL_CUSTOMERS │\n├───────────┼─────────────────┤\n│ 50+       │ 39              │\n│ 35-49     │ 24              │\n│ 25-34     │ 19              │\n│ 18-24     │ 18              │\n└───────────┴─────────────────┘\n┌──────────────────────────────────────────────┬─────────────────┐\n│ COUNTRY                                      │ TOTAL_CUSTOMERS │\n├──────────────────────────────────────────────┼─────────────────┤\n│ Chad                                         │ 3               │\n│ Cayman Islands                               │ 3               │\n│ Lithuania                                    │ 2               │\n│ Libyan Arab Jamahiriya                       │ 2               │\n│ South Georgia and the South Sandwich Islands │ 2               │\n│ Korea                                        │ 2               │\n│ El Salvador                                  │ 2               │\n│ Guam                                         │ 2               │\n│ Egypt                                        │ 2               │\n│ Denmark                                      │ 2               │\n└──────────────────────────────────────────────┴─────────────────┘\n",[40,16941,16942,16947,16975,16980,17016,17049,17054,17059,17096,17101,17139,17175,17211,17246,17281,17317,17351,17386,17421,17457,17462,17467,17517,17522,17576,17631,17685,17738,17792,17847,17902,17953,18006,18058,18063,18068,18082,18087,18102,18115,18128,18141,18146,18151,18165,18170,18185,18202,18216,18236,18263,18277,18294,18307,18320,18333],{"__ignoreMap":38},[43,16943,16944],{"class":45,"line":46},[43,16945,16946],{"class":2063},"┌───────────────────────────────┬──────────────┬─────────────┬───────────┐\n",[43,16948,16949,16952,16955,16958,16961,16964,16967,16969,16972],{"class":45,"line":61},[43,16950,16951],{"class":2063},"│",[43,16953,16954],{"class":57}," SALE_DATE",[43,16956,16957],{"class":57},"                     │",[43,16959,16960],{"class":57}," ORDERS_COUNT",[43,16962,16963],{"class":57}," │",[43,16965,16966],{"class":57}," ITEMS_COUNT",[43,16968,16963],{"class":57},[43,16970,16971],{"class":57}," REVENUE",[43,16973,16974],{"class":57},"   │\n",[43,16976,16977],{"class":45,"line":70},[43,16978,16979],{"class":2063},"├───────────────────────────────┼──────────────┼─────────────┼───────────┤\n",[43,16981,16982,16984,16987,16990,16993,16996,16998,17001,17004,17007,17010,17013],{"class":45,"line":78},[43,16983,16951],{"class":2063},[43,16985,16986],{"class":57}," 2025-10-20",[43,16988,16989],{"class":57}," 00:00:00",[43,16991,16992],{"class":57}," +0000",[43,16994,16995],{"class":57}," UTC",[43,16997,16963],{"class":57},[43,16999,17000],{"class":148}," 440",[43,17002,17003],{"class":57},"          │",[43,17005,17006],{"class":148}," 1328",[43,17008,17009],{"class":57},"        │",[43,17011,17012],{"class":148}," 206063.72",[43,17014,17015],{"class":57}," │\n",[43,17017,17018,17020,17023,17025,17027,17029,17031,17034,17037,17040,17043,17046],{"class":45,"line":86},[43,17019,16951],{"class":2063},[43,17021,17022],{"class":57}," 2025-10-21",[43,17024,16989],{"class":57},[43,17026,16992],{"class":57},[43,17028,16995],{"class":57},[43,17030,16963],{"class":57},[43,17032,17033],{"class":148}," 60",[43,17035,17036],{"class":57},"           │",[43,17038,17039],{"class":148}," 178",[43,17041,17042],{"class":57},"         │",[43,17044,17045],{"class":148}," 26792.41",[43,17047,17048],{"class":57},"  │\n",[43,17050,17051],{"class":45,"line":94},[43,17052,17053],{"class":2063},"└───────────────────────────────┴──────────────┴─────────────┴───────────┘\n",[43,17055,17056],{"class":45,"line":108},[43,17057,17058],{"class":2063},"┌────────────┬────────────────────┬─────────────┬────────────┬───────────────┬────────────────────┐\n",[43,17060,17061,17063,17066,17068,17071,17074,17077,17080,17083,17085,17088,17090,17093],{"class":45,"line":119},[43,17062,16951],{"class":2063},[43,17064,17065],{"class":57}," PRODUCT_ID",[43,17067,16963],{"class":57},[43,17069,17070],{"class":57}," PRODUCT_NAME",[43,17072,17073],{"class":57},"       │",[43,17075,17076],{"class":57}," CATEGORY",[43,17078,17079],{"class":57},"    │",[43,17081,17082],{"class":57}," ITEMS_SOLD",[43,17084,16963],{"class":57},[43,17086,17087],{"class":57}," GROSS_REVENUE",[43,17089,16963],{"class":57},[43,17091,17092],{"class":57}," AVG_ITEM_PRICE",[43,17094,17095],{"class":57},"     │\n",[43,17097,17098],{"class":45,"line":129},[43,17099,17100],{"class":2063},"├────────────┼────────────────────┼─────────────┼────────────┼───────────────┼────────────────────┤\n",[43,17102,17103,17105,17108,17110,17113,17116,17118,17120,17123,17126,17128,17131,17134,17137],{"class":45,"line":140},[43,17104,16951],{"class":2063},[43,17106,17107],{"class":148}," 26",[43,17109,17042],{"class":57},[43,17111,17112],{"class":57}," Well",[43,17114,17115],{"class":57}," hoodies",[43,17117,17073],{"class":57},[43,17119,17115],{"class":57},[43,17121,17122],{"class":57},"     │",[43,17124,17125],{"class":148}," 101",[43,17127,17009],{"class":57},[43,17129,17130],{"class":148}," 11578.84",[43,17132,17133],{"class":57},"      │",[43,17135,17136],{"class":148}," 114.64198019801981",[43,17138,17015],{"class":57},[43,17140,17141,17143,17146,17148,17151,17154,17156,17158,17160,17163,17165,17168,17170,17173],{"class":45,"line":152},[43,17142,16951],{"class":2063},[43,17144,17145],{"class":148}," 8",[43,17147,17003],{"class":57},[43,17149,17150],{"class":57}," Often",[43,17152,17153],{"class":57}," shoes",[43,17155,17009],{"class":57},[43,17157,17153],{"class":57},[43,17159,17073],{"class":57},[43,17161,17162],{"class":148}," 84",[43,17164,17042],{"class":57},[43,17166,17167],{"class":148}," 9511.24",[43,17169,17073],{"class":57},[43,17171,17172],{"class":148}," 113.22904761904762",[43,17174,17015],{"class":57},[43,17176,17177,17179,17182,17184,17187,17190,17192,17194,17196,17199,17201,17204,17206,17209],{"class":45,"line":162},[43,17178,16951],{"class":2063},[43,17180,17181],{"class":148}," 9",[43,17183,17003],{"class":57},[43,17185,17186],{"class":57}," Professor",[43,17188,17189],{"class":57}," t-shirts",[43,17191,16963],{"class":57},[43,17193,17189],{"class":57},[43,17195,17079],{"class":57},[43,17197,17198],{"class":148}," 82",[43,17200,17042],{"class":57},[43,17202,17203],{"class":148}," 9300.89",[43,17205,17073],{"class":57},[43,17207,17208],{"class":148}," 113.42548780487805",[43,17210,17015],{"class":57},[43,17212,17213,17215,17218,17220,17223,17225,17227,17229,17231,17233,17235,17238,17240,17243],{"class":45,"line":170},[43,17214,16951],{"class":2063},[43,17216,17217],{"class":148}," 41",[43,17219,17042],{"class":57},[43,17221,17222],{"class":57}," White",[43,17224,17189],{"class":57},[43,17226,17122],{"class":57},[43,17228,17189],{"class":57},[43,17230,17079],{"class":57},[43,17232,6185],{"class":148},[43,17234,17042],{"class":57},[43,17236,17237],{"class":148}," 9202.42",[43,17239,17073],{"class":57},[43,17241,17242],{"class":148}," 115.03025",[43,17244,17245],{"class":57},"          │\n",[43,17247,17248,17250,17253,17255,17258,17261,17263,17265,17267,17269,17271,17274,17276,17279],{"class":45,"line":182},[43,17249,16951],{"class":2063},[43,17251,17252],{"class":148}," 30",[43,17254,17042],{"class":57},[43,17256,17257],{"class":57}," Pull",[43,17259,17260],{"class":57}," jackets",[43,17262,17073],{"class":57},[43,17264,17260],{"class":57},[43,17266,17122],{"class":57},[43,17268,6185],{"class":148},[43,17270,17042],{"class":57},[43,17272,17273],{"class":148}," 8586.61",[43,17275,17073],{"class":57},[43,17277,17278],{"class":148}," 107.33262500000001",[43,17280,17015],{"class":57},[43,17282,17283,17285,17288,17290,17293,17295,17298,17300,17302,17305,17307,17310,17312,17315],{"class":45,"line":374},[43,17284,16951],{"class":2063},[43,17286,17287],{"class":148}," 37",[43,17289,17042],{"class":57},[43,17291,17292],{"class":57}," Resource",[43,17294,17260],{"class":57},[43,17296,17297],{"class":57},"   │",[43,17299,17260],{"class":57},[43,17301,17122],{"class":57},[43,17303,17304],{"class":148}," 74",[43,17306,17042],{"class":57},[43,17308,17309],{"class":148}," 8289.51",[43,17311,17073],{"class":57},[43,17313,17314],{"class":148}," 112.02040540540541",[43,17316,17015],{"class":57},[43,17318,17319,17321,17323,17325,17328,17330,17332,17334,17336,17339,17341,17344,17346,17349],{"class":45,"line":382},[43,17320,16951],{"class":2063},[43,17322,1355],{"class":148},[43,17324,17042],{"class":57},[43,17326,17327],{"class":57}," Others",[43,17329,17115],{"class":57},[43,17331,17122],{"class":57},[43,17333,17115],{"class":57},[43,17335,17122],{"class":57},[43,17337,17338],{"class":148}," 73",[43,17340,17042],{"class":57},[43,17342,17343],{"class":148}," 7810.05",[43,17345,17073],{"class":57},[43,17347,17348],{"class":148}," 106.98698630136987",[43,17350,17015],{"class":57},[43,17352,17353,17355,17358,17360,17363,17365,17367,17369,17371,17374,17376,17379,17381,17384],{"class":45,"line":392},[43,17354,16951],{"class":2063},[43,17356,17357],{"class":148}," 10",[43,17359,17042],{"class":57},[43,17361,17362],{"class":57}," Old",[43,17364,17115],{"class":57},[43,17366,17009],{"class":57},[43,17368,17115],{"class":57},[43,17370,17122],{"class":57},[43,17372,17373],{"class":148}," 66",[43,17375,17042],{"class":57},[43,17377,17378],{"class":148}," 7365.61",[43,17380,17073],{"class":57},[43,17382,17383],{"class":148}," 111.60015151515151",[43,17385,17015],{"class":57},[43,17387,17388,17390,17393,17395,17398,17400,17402,17404,17406,17409,17411,17414,17416,17419],{"class":45,"line":399},[43,17389,16951],{"class":2063},[43,17391,17392],{"class":148}," 16",[43,17394,17042],{"class":57},[43,17396,17397],{"class":57}," Nothing",[43,17399,17115],{"class":57},[43,17401,17079],{"class":57},[43,17403,17115],{"class":57},[43,17405,17122],{"class":57},[43,17407,17408],{"class":148}," 61",[43,17410,17042],{"class":57},[43,17412,17413],{"class":148}," 7222.53",[43,17415,17073],{"class":57},[43,17417,17418],{"class":148}," 118.40213114754098",[43,17420,17015],{"class":57},[43,17422,17423,17425,17427,17429,17432,17435,17438,17440,17442,17445,17447,17450,17452,17455],{"class":45,"line":410},[43,17424,16951],{"class":2063},[43,17426,3725],{"class":148},[43,17428,17042],{"class":57},[43,17430,17431],{"class":57}," Along",[43,17433,17434],{"class":57}," accessories",[43,17436,17437],{"class":57},"  │",[43,17439,17434],{"class":57},[43,17441,16963],{"class":57},[43,17443,17444],{"class":148}," 54",[43,17446,17042],{"class":57},[43,17448,17449],{"class":148}," 6740.6",[43,17451,17009],{"class":57},[43,17453,17454],{"class":148}," 124.82592592592593",[43,17456,17015],{"class":57},[43,17458,17459],{"class":45,"line":417},[43,17460,17461],{"class":2063},"└────────────┴────────────────────┴─────────────┴────────────┴───────────────┴────────────────────┘\n",[43,17463,17464],{"class":45,"line":425},[43,17465,17466],{"class":2063},"┌────────────────────┬────────────┬─────────────┬────────────┬────────────┬─────────┬────────┬─────────┬────────────────────┬──────────────────────────┐\n",[43,17468,17469,17471,17473,17475,17478,17480,17483,17485,17487,17489,17491,17493,17495,17497,17500,17502,17505,17507,17510,17512,17515],{"class":45,"line":430},[43,17470,16951],{"class":2063},[43,17472,17070],{"class":57},[43,17474,17073],{"class":57},[43,17476,17477],{"class":57}," VARIANT_ID",[43,17479,16963],{"class":57},[43,17481,17482],{"class":57}," VARIANT_SKU",[43,17484,16963],{"class":57},[43,17486,17065],{"class":57},[43,17488,16963],{"class":57},[43,17490,17082],{"class":57},[43,17492,16963],{"class":57},[43,17494,16971],{"class":57},[43,17496,16963],{"class":57},[43,17498,17499],{"class":57}," COST",[43,17501,17297],{"class":57},[43,17503,17504],{"class":57}," PROFIT",[43,17506,17437],{"class":57},[43,17508,17509],{"class":57}," MARGIN_PCT",[43,17511,17042],{"class":57},[43,17513,17514],{"class":57}," SELLING_PRICE_BELOW_COST",[43,17516,17015],{"class":57},[43,17518,17519],{"class":45,"line":438},[43,17520,17521],{"class":2063},"├────────────────────┼────────────┼─────────────┼────────────┼────────────┼─────────┼────────┼─────────┼────────────────────┼──────────────────────────┤\n",[43,17523,17524,17526,17528,17530,17532,17535,17537,17540,17542,17544,17546,17548,17550,17553,17555,17558,17560,17563,17565,17568,17570,17573],{"class":45,"line":446},[43,17525,16951],{"class":2063},[43,17527,17222],{"class":57},[43,17529,17189],{"class":57},[43,17531,17122],{"class":57},[43,17533,17534],{"class":148}," 111",[43,17536,17009],{"class":57},[43,17538,17539],{"class":57}," VAR-7584-ZF",[43,17541,16963],{"class":57},[43,17543,17217],{"class":148},[43,17545,17042],{"class":57},[43,17547,1355],{"class":148},[43,17549,17042],{"class":57},[43,17551,17552],{"class":148}," 5118.96",[43,17554,16963],{"class":57},[43,17556,17557],{"class":148}," 1022",[43,17559,17297],{"class":57},[43,17561,17562],{"class":148}," 4096.96",[43,17564,16963],{"class":57},[43,17566,17567],{"class":148}," 0.8003500711081939",[43,17569,16963],{"class":57},[43,17571,17572],{"class":53}," false",[43,17574,17575],{"class":57},"                    │\n",[43,17577,17578,17580,17583,17585,17587,17590,17592,17595,17597,17600,17602,17605,17607,17610,17612,17615,17617,17620,17622,17625,17627,17629],{"class":45,"line":456},[43,17579,16951],{"class":2063},[43,17581,17582],{"class":57}," House",[43,17584,17260],{"class":57},[43,17586,17133],{"class":57},[43,17588,17589],{"class":148}," 75",[43,17591,17042],{"class":57},[43,17593,17594],{"class":57}," VAR-2214-YG",[43,17596,16963],{"class":57},[43,17598,17599],{"class":148}," 27",[43,17601,17042],{"class":57},[43,17603,17604],{"class":148}," 19",[43,17606,17042],{"class":57},[43,17608,17609],{"class":148}," 3119.34",[43,17611,16963],{"class":57},[43,17613,17614],{"class":148}," 390.64",[43,17616,16963],{"class":57},[43,17618,17619],{"class":148}," 2728.7",[43,17621,17437],{"class":57},[43,17623,17624],{"class":148}," 0.8747683804907448",[43,17626,16963],{"class":57},[43,17628,17572],{"class":53},[43,17630,17575],{"class":57},[43,17632,17633,17635,17638,17640,17642,17644,17646,17649,17651,17654,17656,17659,17661,17664,17666,17669,17671,17674,17676,17679,17681,17683],{"class":45,"line":464},[43,17634,16951],{"class":2063},[43,17636,17637],{"class":57}," East",[43,17639,17153],{"class":57},[43,17641,17042],{"class":57},[43,17643,8370],{"class":148},[43,17645,17042],{"class":57},[43,17647,17648],{"class":57}," VAR-1369-ZH",[43,17650,16963],{"class":57},[43,17652,17653],{"class":148}," 18",[43,17655,17042],{"class":57},[43,17657,17658],{"class":148}," 22",[43,17660,17042],{"class":57},[43,17662,17663],{"class":148}," 3051.23",[43,17665,16963],{"class":57},[43,17667,17668],{"class":148}," 563.2",[43,17670,17437],{"class":57},[43,17672,17673],{"class":148}," 2488.03",[43,17675,16963],{"class":57},[43,17677,17678],{"class":148}," 0.8154186999996723",[43,17680,16963],{"class":57},[43,17682,17572],{"class":53},[43,17684,17575],{"class":57},[43,17686,17687,17689,17691,17693,17695,17698,17700,17703,17705,17707,17709,17712,17714,17717,17719,17722,17724,17727,17729,17732,17734,17736],{"class":45,"line":472},[43,17688,16951],{"class":2063},[43,17690,17112],{"class":57},[43,17692,17115],{"class":57},[43,17694,17073],{"class":57},[43,17696,17697],{"class":148}," 72",[43,17699,17042],{"class":57},[43,17701,17702],{"class":57}," VAR-5281-PQ",[43,17704,16963],{"class":57},[43,17706,17107],{"class":148},[43,17708,17042],{"class":57},[43,17710,17711],{"class":148}," 29",[43,17713,17042],{"class":57},[43,17715,17716],{"class":148}," 3192.99",[43,17718,16963],{"class":57},[43,17720,17721],{"class":148}," 816.06",[43,17723,16963],{"class":57},[43,17725,17726],{"class":148}," 2376.93",[43,17728,16963],{"class":57},[43,17730,17731],{"class":148}," 0.7444213730703823",[43,17733,16963],{"class":57},[43,17735,17572],{"class":53},[43,17737,17575],{"class":57},[43,17739,17740,17742,17745,17747,17749,17752,17754,17757,17759,17762,17764,17766,17768,17771,17773,17776,17778,17781,17783,17786,17788,17790],{"class":45,"line":483},[43,17741,16951],{"class":2063},[43,17743,17744],{"class":57}," Town",[43,17746,17115],{"class":57},[43,17748,17073],{"class":57},[43,17750,17751],{"class":148}," 63",[43,17753,17042],{"class":57},[43,17755,17756],{"class":57}," VAR-7820-CG",[43,17758,16963],{"class":57},[43,17760,17761],{"class":148}," 23",[43,17763,17042],{"class":57},[43,17765,17107],{"class":148},[43,17767,17042],{"class":57},[43,17769,17770],{"class":148}," 3068.31",[43,17772,16963],{"class":57},[43,17774,17775],{"class":148}," 776.62",[43,17777,16963],{"class":57},[43,17779,17780],{"class":148}," 2291.69",[43,17782,16963],{"class":57},[43,17784,17785],{"class":148}," 0.7468899817815019",[43,17787,16963],{"class":57},[43,17789,17572],{"class":53},[43,17791,17575],{"class":57},[43,17793,17794,17796,17799,17801,17803,17806,17808,17811,17813,17816,17818,17821,17823,17826,17828,17831,17833,17836,17838,17841,17843,17845],{"class":45,"line":494},[43,17795,16951],{"class":2063},[43,17797,17798],{"class":57}," Prepare",[43,17800,17153],{"class":57},[43,17802,17133],{"class":57},[43,17804,17805],{"class":148}," 65",[43,17807,17042],{"class":57},[43,17809,17810],{"class":57}," VAR-7788-NK",[43,17812,16963],{"class":57},[43,17814,17815],{"class":148}," 24",[43,17817,17042],{"class":57},[43,17819,17820],{"class":148}," 21",[43,17822,17042],{"class":57},[43,17824,17825],{"class":148}," 2700.78",[43,17827,16963],{"class":57},[43,17829,17830],{"class":148}," 426.51",[43,17832,16963],{"class":57},[43,17834,17835],{"class":148}," 2274.27",[43,17837,16963],{"class":57},[43,17839,17840],{"class":148}," 0.8420789549685646",[43,17842,16963],{"class":57},[43,17844,17572],{"class":53},[43,17846,17575],{"class":57},[43,17848,17849,17851,17854,17856,17858,17861,17863,17866,17868,17871,17873,17876,17878,17881,17883,17886,17888,17891,17893,17896,17898,17900],{"class":45,"line":506},[43,17850,16951],{"class":2063},[43,17852,17853],{"class":57}," Indicate",[43,17855,17115],{"class":57},[43,17857,17297],{"class":57},[43,17859,17860],{"class":148}," 114",[43,17862,17009],{"class":57},[43,17864,17865],{"class":57}," VAR-4479-TB",[43,17867,16963],{"class":57},[43,17869,17870],{"class":148}," 43",[43,17872,17042],{"class":57},[43,17874,17875],{"class":148}," 20",[43,17877,17042],{"class":57},[43,17879,17880],{"class":148}," 2623.64",[43,17882,16963],{"class":57},[43,17884,17885],{"class":148}," 359.8",[43,17887,17437],{"class":57},[43,17889,17890],{"class":148}," 2263.84",[43,17892,16963],{"class":57},[43,17894,17895],{"class":148}," 0.8628622829351589",[43,17897,16963],{"class":57},[43,17899,17572],{"class":53},[43,17901,17575],{"class":57},[43,17903,17904,17906,17908,17910,17912,17914,17916,17919,17921,17923,17925,17927,17929,17932,17934,17937,17939,17942,17944,17947,17949,17951],{"class":45,"line":517},[43,17905,16951],{"class":2063},[43,17907,17186],{"class":57},[43,17909,17189],{"class":57},[43,17911,16963],{"class":57},[43,17913,17815],{"class":148},[43,17915,17042],{"class":57},[43,17917,17918],{"class":57}," VAR-8098-JV",[43,17920,16963],{"class":57},[43,17922,17181],{"class":148},[43,17924,17003],{"class":57},[43,17926,17252],{"class":148},[43,17928,17042],{"class":57},[43,17930,17931],{"class":148}," 3144.22",[43,17933,16963],{"class":57},[43,17935,17936],{"class":148}," 899.1",[43,17938,17437],{"class":57},[43,17940,17941],{"class":148}," 2245.12",[43,17943,16963],{"class":57},[43,17945,17946],{"class":148}," 0.7140467270101964",[43,17948,16963],{"class":57},[43,17950,17572],{"class":53},[43,17952,17575],{"class":57},[43,17954,17955,17957,17960,17962,17964,17967,17969,17972,17974,17976,17978,17980,17982,17985,17987,17990,17992,17995,17997,18000,18002,18004],{"class":45,"line":525},[43,17956,16951],{"class":2063},[43,17958,17959],{"class":57}," Under",[43,17961,17189],{"class":57},[43,17963,17122],{"class":57},[43,17965,17966],{"class":148}," 109",[43,17968,17009],{"class":57},[43,17970,17971],{"class":57}," VAR-4156-ZV",[43,17973,16963],{"class":57},[43,17975,3730],{"class":148},[43,17977,17042],{"class":57},[43,17979,17875],{"class":148},[43,17981,17042],{"class":57},[43,17983,17984],{"class":148}," 2673.75",[43,17986,16963],{"class":57},[43,17988,17989],{"class":148}," 503",[43,17991,17079],{"class":57},[43,17993,17994],{"class":148}," 2170.75",[43,17996,16963],{"class":57},[43,17998,17999],{"class":148}," 0.8118747078073866",[43,18001,16963],{"class":57},[43,18003,17572],{"class":53},[43,18005,17575],{"class":57},[43,18007,18008,18010,18012,18014,18016,18019,18021,18024,18026,18028,18030,18032,18034,18037,18039,18042,18044,18047,18049,18052,18054,18056],{"class":45,"line":538},[43,18009,16951],{"class":2063},[43,18011,17327],{"class":57},[43,18013,17115],{"class":57},[43,18015,17122],{"class":57},[43,18017,18018],{"class":148}," 91",[43,18020,17042],{"class":57},[43,18022,18023],{"class":57}," VAR-7790-FB",[43,18025,16963],{"class":57},[43,18027,1355],{"class":148},[43,18029,17042],{"class":57},[43,18031,17599],{"class":148},[43,18033,17042],{"class":57},[43,18035,18036],{"class":148}," 2555.88",[43,18038,16963],{"class":57},[43,18040,18041],{"class":148}," 413.64",[43,18043,16963],{"class":57},[43,18045,18046],{"class":148}," 2142.24",[43,18048,16963],{"class":57},[43,18050,18051],{"class":148}," 0.8381614160289215",[43,18053,16963],{"class":57},[43,18055,17572],{"class":53},[43,18057,17575],{"class":57},[43,18059,18060],{"class":45,"line":550},[43,18061,18062],{"class":2063},"└────────────────────┴────────────┴─────────────┴────────────┴────────────┴─────────┴────────┴─────────┴────────────────────┴──────────────────────────┘\n",[43,18064,18065],{"class":45,"line":558},[43,18066,18067],{"class":2063},"┌───────────┬─────────────────┐\n",[43,18069,18070,18072,18075,18077,18080],{"class":45,"line":568},[43,18071,16951],{"class":2063},[43,18073,18074],{"class":57}," AGE_GROUP",[43,18076,16963],{"class":57},[43,18078,18079],{"class":57}," TOTAL_CUSTOMERS",[43,18081,17015],{"class":57},[43,18083,18084],{"class":45,"line":578},[43,18085,18086],{"class":2063},"├───────────┼─────────────────┤\n",[43,18088,18089,18091,18094,18096,18099],{"class":45,"line":588},[43,18090,16951],{"class":2063},[43,18092,18093],{"class":57}," 50+",[43,18095,17073],{"class":57},[43,18097,18098],{"class":148}," 39",[43,18100,18101],{"class":57},"              │\n",[43,18103,18104,18106,18109,18111,18113],{"class":45,"line":595},[43,18105,16951],{"class":2063},[43,18107,18108],{"class":57}," 35-49",[43,18110,17122],{"class":57},[43,18112,17815],{"class":148},[43,18114,18101],{"class":57},[43,18116,18117,18119,18122,18124,18126],{"class":45,"line":606},[43,18118,16951],{"class":2063},[43,18120,18121],{"class":57}," 25-34",[43,18123,17122],{"class":57},[43,18125,17604],{"class":148},[43,18127,18101],{"class":57},[43,18129,18130,18132,18135,18137,18139],{"class":45,"line":614},[43,18131,16951],{"class":2063},[43,18133,18134],{"class":57}," 18-24",[43,18136,17122],{"class":57},[43,18138,17653],{"class":148},[43,18140,18101],{"class":57},[43,18142,18143],{"class":45,"line":624},[43,18144,18145],{"class":2063},"└───────────┴─────────────────┘\n",[43,18147,18148],{"class":45,"line":633},[43,18149,18150],{"class":2063},"┌──────────────────────────────────────────────┬─────────────────┐\n",[43,18152,18153,18155,18158,18161,18163],{"class":45,"line":643},[43,18154,16951],{"class":2063},[43,18156,18157],{"class":57}," COUNTRY",[43,18159,18160],{"class":57},"                                      │",[43,18162,18079],{"class":57},[43,18164,17015],{"class":57},[43,18166,18167],{"class":45,"line":650},[43,18168,18169],{"class":2063},"├──────────────────────────────────────────────┼─────────────────┤\n",[43,18171,18172,18174,18177,18180,18182],{"class":45,"line":661},[43,18173,16951],{"class":2063},[43,18175,18176],{"class":57}," Chad",[43,18178,18179],{"class":57},"                                         │",[43,18181,6624],{"class":148},[43,18183,18184],{"class":57},"               │\n",[43,18186,18187,18189,18192,18195,18198,18200],{"class":45,"line":669},[43,18188,16951],{"class":2063},[43,18190,18191],{"class":57}," Cayman",[43,18193,18194],{"class":57}," Islands",[43,18196,18197],{"class":57},"                               │",[43,18199,6624],{"class":148},[43,18201,18184],{"class":57},[43,18203,18204,18206,18209,18212,18214],{"class":45,"line":679},[43,18205,16951],{"class":2063},[43,18207,18208],{"class":57}," Lithuania",[43,18210,18211],{"class":57},"                                    │",[43,18213,6191],{"class":148},[43,18215,18184],{"class":57},[43,18217,18218,18220,18223,18226,18229,18232,18234],{"class":45,"line":687},[43,18219,16951],{"class":2063},[43,18221,18222],{"class":57}," Libyan",[43,18224,18225],{"class":57}," Arab",[43,18227,18228],{"class":57}," Jamahiriya",[43,18230,18231],{"class":57},"                       │",[43,18233,6191],{"class":148},[43,18235,18184],{"class":57},[43,18237,18238,18240,18243,18246,18248,18250,18252,18255,18257,18259,18261],{"class":45,"line":695},[43,18239,16951],{"class":2063},[43,18241,18242],{"class":57}," South",[43,18244,18245],{"class":57}," Georgia",[43,18247,6058],{"class":57},[43,18249,9541],{"class":57},[43,18251,18242],{"class":57},[43,18253,18254],{"class":57}," Sandwich",[43,18256,18194],{"class":57},[43,18258,16963],{"class":57},[43,18260,6191],{"class":148},[43,18262,18184],{"class":57},[43,18264,18265,18267,18270,18273,18275],{"class":45,"line":702},[43,18266,16951],{"class":2063},[43,18268,18269],{"class":57}," Korea",[43,18271,18272],{"class":57},"                                        │",[43,18274,6191],{"class":148},[43,18276,18184],{"class":57},[43,18278,18279,18281,18284,18287,18290,18292],{"class":45,"line":709},[43,18280,16951],{"class":2063},[43,18282,18283],{"class":57}," El",[43,18285,18286],{"class":57}," Salvador",[43,18288,18289],{"class":57},"                                  │",[43,18291,6191],{"class":148},[43,18293,18184],{"class":57},[43,18295,18296,18298,18301,18303,18305],{"class":45,"line":719},[43,18297,16951],{"class":2063},[43,18299,18300],{"class":57}," Guam",[43,18302,18179],{"class":57},[43,18304,6191],{"class":148},[43,18306,18184],{"class":57},[43,18308,18309,18311,18314,18316,18318],{"class":45,"line":728},[43,18310,16951],{"class":2063},[43,18312,18313],{"class":57}," Egypt",[43,18315,18272],{"class":57},[43,18317,6191],{"class":148},[43,18319,18184],{"class":57},[43,18321,18322,18324,18327,18329,18331],{"class":45,"line":735},[43,18323,16951],{"class":2063},[43,18325,18326],{"class":57}," Denmark",[43,18328,18160],{"class":57},[43,18330,6191],{"class":148},[43,18332,18184],{"class":57},[43,18334,18335],{"class":45,"line":746},[43,18336,18337],{"class":2063},"└──────────────────────────────────────────────┴─────────────────┘\n",[1973,18339,18341],{"id":18340},"_9-introducing-chaos-data","9) Introducing Chaos Data",[1992,18343,18344,18345,18348,18349,18352],{},"Now that you can generate deterministic data for your local pipeline, let’s add ",[1977,18346,18347],{},"controlled chaos"," — a small but powerful feature to validate your ",[1977,18350,18351],{},"data quality checks"," in Bruin. But why chaos?",[2028,18354,18355,18361,18378],{},[2031,18356,18357,18358,4556],{},"In real-world scenarios, upstream systems sometimes send ",[1977,18359,18360],{},"invalid or inconsistent data",[2031,18362,18363,18364,18366,18367,18370,18371,18374,18375,4556],{},"For instance, a product categorized as ",[40,18365,3587],{}," might contain an invalid ",[40,18368,18369],{},"size"," value like ",[40,18372,18373],{},"\"M\""," instead of ",[40,18376,18377],{},"\"42\"",[2031,18379,18380,18381,18384],{},"We intentionally simulate these cases so you can ",[1977,18382,18383],{},"test your validation logic"," during ingestion.",[1992,18386,18387,18388,18390,18391,18393],{},"The ",[40,18389,3383],{}," script includes a ",[40,18392,4920],{}," flag that controls how many product variants should be randomly invalidated.",[3260,18395,18396,18422,18447],{},[3263,18397,18398],{"icon":3265,"label":3266},[33,18399,18401],{"className":2054,"code":18400,"language":2056,"meta":38,"style":38},"uv run generate-data --dsn postgresql://postgres:postgres@localhost:5432/postgres --chaos-percent 5\n",[40,18402,18403],{"__ignoreMap":38},[43,18404,18405,18407,18409,18412,18414,18417,18420],{"class":45,"line":46},[43,18406,2041],{"class":2063},[43,18408,3163],{"class":57},[43,18410,18411],{"class":57}," generate-data",[43,18413,8236],{"class":57},[43,18415,18416],{"class":57}," postgresql://postgres:postgres@localhost:5432/postgres",[43,18418,18419],{"class":57}," --chaos-percent",[43,18421,8410],{"class":148},[3263,18423,18424],{"icon":16920,"label":3309},[33,18425,18427],{"className":2054,"code":18426,"language":2056,"meta":38,"style":38},"make generate-chaos SCALE=1 CHAOS=1\n",[40,18428,18429],{"__ignoreMap":38},[43,18430,18431,18433,18436,18439,18441,18444],{"class":45,"line":46},[43,18432,3252],{"class":2063},[43,18434,18435],{"class":57}," generate-chaos",[43,18437,18438],{"class":57}," SCALE=",[43,18440,4993],{"class":148},[43,18442,18443],{"class":57}," CHAOS=",[43,18445,18446],{"class":148},"1\n",[3263,18448,18449],{"icon":3324,"label":3325},[33,18450,18452],{"className":2054,"code":18451,"language":2056,"meta":38,"style":38},"=== Generating E-commerce Demo Data ===\nWindow: 2025-10-20T00:00:00+00:00 → 2025-10-20T23:59:59.999999+00:00\nScale x1 | Seed 42 | Chaos 5.0%\n\n✅ Data generation complete (idempotent window load)\nWindow: 2025-10-20T00:00:00+00:00 → 2025-10-20T23:59:59.999999+00:00\nCounts — Customers: 100 | Products: 50 | Variants: 127\nWindow Facts — Orders: 500 | Items: 1,495 | MaxItems/Order: 5\nChaos check (invalid sizes per category):\n  • accessories: 2 invalid\n  • hoodies: 4 invalid\n  • jackets: 4 invalid\n  • shoes: 19 invalid\n  • t-shirts: 2 invalid\n",[40,18453,18454,18468,18480,18499,18503,18525,18535,18558,18583,18599,18609,18619,18629,18639],{"__ignoreMap":38},[43,18455,18456,18458,18460,18462,18464,18466],{"class":45,"line":46},[43,18457,8266],{"class":57},[43,18459,8269],{"class":57},[43,18461,8272],{"class":57},[43,18463,8275],{"class":57},[43,18465,8278],{"class":57},[43,18467,8281],{"class":57},[43,18469,18470,18472,18475,18477],{"class":45,"line":61},[43,18471,8286],{"class":2063},[43,18473,18474],{"class":57}," 2025-10-20T00:00:00+00:00",[43,18476,8292],{"class":57},[43,18478,18479],{"class":57}," 2025-10-20T23:59:59.999999+00:00\n",[43,18481,18482,18484,18486,18488,18490,18492,18494,18496],{"class":45,"line":70},[43,18483,8300],{"class":2063},[43,18485,8303],{"class":57},[43,18487,3282],{"class":53},[43,18489,8308],{"class":2063},[43,18491,3735],{"class":148},[43,18493,3282],{"class":53},[43,18495,8315],{"class":2063},[43,18497,18498],{"class":57}," 5.0%\n",[43,18500,18501],{"class":45,"line":78},[43,18502,244],{"emptyLinePlaceholder":243},[43,18504,18505,18507,18509,18511,18514,18517,18520,18523],{"class":45,"line":86},[43,18506,8331],{"class":2063},[43,18508,8278],{"class":57},[43,18510,8336],{"class":57},[43,18512,18513],{"class":57}," complete",[43,18515,18516],{"class":1277}," (idempotent ",[43,18518,18519],{"class":57},"window",[43,18521,18522],{"class":57}," load",[43,18524,1405],{"class":1277},[43,18526,18527,18529,18531,18533],{"class":45,"line":94},[43,18528,8286],{"class":2063},[43,18530,18474],{"class":57},[43,18532,8292],{"class":57},[43,18534,18479],{"class":57},[43,18536,18537,18539,18541,18543,18545,18547,18549,18551,18553,18555],{"class":45,"line":108},[43,18538,8354],{"class":2063},[43,18540,8357],{"class":57},[43,18542,8360],{"class":57},[43,18544,6079],{"class":148},[43,18546,3282],{"class":53},[43,18548,8367],{"class":2063},[43,18550,8370],{"class":148},[43,18552,3282],{"class":53},[43,18554,8375],{"class":2063},[43,18556,18557],{"class":148}," 127\n",[43,18559,18560,18562,18564,18566,18568,18570,18572,18574,18577,18579,18581],{"class":45,"line":119},[43,18561,8383],{"class":2063},[43,18563,8386],{"class":57},[43,18565,8357],{"class":57},[43,18567,8391],{"class":57},[43,18569,8394],{"class":148},[43,18571,3282],{"class":53},[43,18573,8399],{"class":2063},[43,18575,18576],{"class":57}," 1,495",[43,18578,3282],{"class":53},[43,18580,8407],{"class":2063},[43,18582,8410],{"class":148},[43,18584,18585,18587,18589,18591,18593,18595,18597],{"class":45,"line":129},[43,18586,8415],{"class":2063},[43,18588,8418],{"class":57},[43,18590,8421],{"class":1277},[43,18592,8424],{"class":57},[43,18594,8427],{"class":57},[43,18596,8430],{"class":57},[43,18598,5262],{"class":1277},[43,18600,18601,18603,18605,18607],{"class":45,"line":140},[43,18602,8437],{"class":2063},[43,18604,8440],{"class":57},[43,18606,6191],{"class":148},[43,18608,8445],{"class":57},[43,18610,18611,18613,18615,18617],{"class":45,"line":152},[43,18612,8437],{"class":2063},[43,18614,8452],{"class":57},[43,18616,5915],{"class":148},[43,18618,8445],{"class":57},[43,18620,18621,18623,18625,18627],{"class":45,"line":162},[43,18622,8437],{"class":2063},[43,18624,8463],{"class":57},[43,18626,5915],{"class":148},[43,18628,8445],{"class":57},[43,18630,18631,18633,18635,18637],{"class":45,"line":170},[43,18632,8437],{"class":2063},[43,18634,8474],{"class":57},[43,18636,17604],{"class":148},[43,18638,8445],{"class":57},[43,18640,18641,18643,18645,18647],{"class":45,"line":182},[43,18642,8437],{"class":2063},[43,18644,8485],{"class":57},[43,18646,6191],{"class":148},[43,18648,8445],{"class":57},[1992,18650,18651,18652,18655],{},"This command generates ",[1977,18653,18654],{},"5% of product variants"," with inconsistent sizes:",[2028,18657,18658,18671],{},[2031,18659,18660,18661,18663,18664,2197,18666,2197,18668,18670],{},"Products in the ",[40,18662,3587],{}," category might get alphabetic sizes (",[40,18665,3677],{},[40,18667,3686],{},[40,18669,3695],{},") instead of numeric ones.",[2031,18672,18673,18674,2197,18676,18678,18679,18682,18683,4556],{},"Non-shoe products (",[40,18675,3569],{},[40,18677,3578],{},", etc.) might receive numeric sizes like ",[40,18680,18681],{},"37"," or ",[40,18684,18685],{},"41",[1992,18687,18688,18689,18692,18693,18695],{},"You can use any chaos level (e.g., ",[40,18690,18691],{},"--chaos-percent 10","), or leave it at the default (",[40,18694,4940],{},") for clean datasets.",[1992,18697,18698,18699,18703],{},"Bruin validation assets can now reference this rule.\nHere’s the SQL query that checks for these inconsistencies in your ",[1977,18700,18701],{},[40,18702,3111],{}," layer:",[3409,18705,18706],{},[33,18707,18709],{"className":1195,"code":10153,"filename":10154,"highlights":18708,"language":1198,"meta":38,"style":38},[446,456,464,472,483,494,506,517,525,538,550,558,568],[40,18710,18711,18715,18719,18723,18727,18731,18735,18739,18743,18747,18751,18755,18759,18763,18767,18771,18775,18779,18783,18787,18791,18795,18799,18803,18808,18813,18818,18823,18828,18833,18838,18843,18848,18853,18858,18863,18868,18872,18876,18880,18888,18892,18896,18900,18904,18930,18956,18982,18992,18996,19000,19006],{"__ignoreMap":38},[43,18712,18713],{"class":45,"line":46},[43,18714,1205],{"class":1006},[43,18716,18717],{"class":45,"line":61},[43,18718,10165],{"class":1006},[43,18720,18721],{"class":45,"line":70},[43,18722,1215],{"class":1006},[43,18724,18725],{"class":45,"line":78},[43,18726,1235],{"class":1006},[43,18728,18729],{"class":45,"line":86},[43,18730,1240],{"class":1006},[43,18732,18733],{"class":45,"line":94},[43,18734,1245],{"class":1006},[43,18736,18737],{"class":45,"line":108},[43,18738,1250],{"class":1006},[43,18740,18741],{"class":45,"line":119},[43,18742,10190],{"class":1006},[43,18744,18745],{"class":45,"line":129},[43,18746,1502],{"class":1006},[43,18748,18749],{"class":45,"line":140},[43,18750,244],{"emptyLinePlaceholder":243},[43,18752,18753],{"class":45,"line":152},[43,18754,9891],{"class":1006},[43,18756,18757],{"class":45,"line":162},[43,18758,10207],{"class":1006},[43,18760,18761],{"class":45,"line":170},[43,18762,10212],{"class":1006},[43,18764,18765],{"class":45,"line":182},[43,18766,10217],{"class":1006},[43,18768,18769],{"class":45,"line":374},[43,18770,10222],{"class":1006},[43,18772,18773],{"class":45,"line":382},[43,18774,10227],{"class":1006},[43,18776,18777],{"class":45,"line":392},[43,18778,10232],{"class":1006},[43,18780,18781],{"class":45,"line":399},[43,18782,10237],{"class":1006},[43,18784,18785],{"class":45,"line":410},[43,18786,10242],{"class":1006},[43,18788,18789],{"class":45,"line":417},[43,18790,10247],{"class":1006},[43,18792,18793],{"class":45,"line":425},[43,18794,9916],{"class":1006},[43,18796,18797],{"class":45,"line":430},[43,18798,9921],{"class":1006},[43,18800,18801],{"class":45,"line":438},[43,18802,244],{"emptyLinePlaceholder":243},[43,18804,18806],{"class":18805,"line":446},[45,13060],[43,18807,10264],{"class":1006},[43,18809,18811],{"class":18810,"line":456},[45,13060],[43,18812,10269],{"class":1006},[43,18814,18816],{"class":18815,"line":464},[45,13060],[43,18817,10274],{"class":1006},[43,18819,18821],{"class":18820,"line":472},[45,13060],[43,18822,10279],{"class":1006},[43,18824,18826],{"class":18825,"line":483},[45,13060],[43,18827,10284],{"class":1006},[43,18829,18831],{"class":18830,"line":494},[45,13060],[43,18832,10289],{"class":1006},[43,18834,18836],{"class":18835,"line":506},[45,13060],[43,18837,10294],{"class":1006},[43,18839,18841],{"class":18840,"line":517},[45,13060],[43,18842,10299],{"class":1006},[43,18844,18846],{"class":18845,"line":525},[45,13060],[43,18847,10304],{"class":1006},[43,18849,18851],{"class":18850,"line":538},[45,13060],[43,18852,10309],{"class":1006},[43,18854,18856],{"class":18855,"line":550},[45,13060],[43,18857,10314],{"class":1006},[43,18859,18861],{"class":18860,"line":558},[45,13060],[43,18862,10319],{"class":1006},[43,18864,18866],{"class":18865,"line":568},[45,13060],[43,18867,10324],{"class":1006},[43,18869,18870],{"class":45,"line":578},[43,18871,1265],{"class":1006},[43,18873,18874],{"class":45,"line":588},[43,18875,244],{"emptyLinePlaceholder":243},[43,18877,18878],{"class":45,"line":595},[43,18879,1674],{"class":148},[43,18881,18882,18884,18886],{"class":45,"line":606},[43,18883,10341],{"class":1277},[43,18885,1281],{"class":148},[43,18887,10346],{"class":1277},[43,18889,18890],{"class":45,"line":614},[43,18891,10351],{"class":1277},[43,18893,18894],{"class":45,"line":624},[43,18895,10356],{"class":1277},[43,18897,18898],{"class":45,"line":633},[43,18899,10361],{"class":1277},[43,18901,18902],{"class":45,"line":643},[43,18903,10366],{"class":1277},[43,18905,18906,18908,18910,18912,18914,18916,18918,18920,18922,18924,18926,18928],{"class":45,"line":650},[43,18907,1724],{"class":148},[43,18909,1727],{"class":148},[43,18911,10375],{"class":1277},[43,18913,1303],{"class":53},[43,18915,1737],{"class":148},[43,18917,1309],{"class":148},[43,18919,1737],{"class":148},[43,18921,1744],{"class":148},[43,18923,10375],{"class":1277},[43,18925,1758],{"class":148},[43,18927,1389],{"class":148},[43,18929,10394],{"class":1277},[43,18931,18932,18934,18936,18938,18940,18942,18944,18946,18948,18950,18952,18954],{"class":45,"line":661},[43,18933,1724],{"class":148},[43,18935,1727],{"class":148},[43,18937,10403],{"class":1277},[43,18939,1303],{"class":53},[43,18941,1737],{"class":148},[43,18943,1309],{"class":148},[43,18945,1737],{"class":148},[43,18947,1744],{"class":148},[43,18949,10403],{"class":1277},[43,18951,1758],{"class":148},[43,18953,1389],{"class":148},[43,18955,10422],{"class":1277},[43,18957,18958,18960,18962,18964,18966,18968,18970,18972,18974,18976,18978,18980],{"class":45,"line":669},[43,18959,1724],{"class":148},[43,18961,1727],{"class":148},[43,18963,10431],{"class":1277},[43,18965,1303],{"class":53},[43,18967,1737],{"class":148},[43,18969,1309],{"class":148},[43,18971,1737],{"class":148},[43,18973,1744],{"class":148},[43,18975,10431],{"class":1277},[43,18977,1758],{"class":148},[43,18979,1389],{"class":148},[43,18981,10450],{"class":1277},[43,18983,18984,18986,18988,18990],{"class":45,"line":679},[43,18985,1882],{"class":1418},[43,18987,10457],{"class":1277},[43,18989,1281],{"class":148},[43,18991,10462],{"class":1277},[43,18993,18994],{"class":45,"line":687},[43,18995,10467],{"class":1277},[43,18997,18998],{"class":45,"line":695},[43,18999,10472],{"class":1277},[43,19001,19002,19004],{"class":45,"line":702},[43,19003,1438],{"class":148},[43,19005,10479],{"class":1277},[43,19007,19008,19010,19012,19014,19016,19018],{"class":45,"line":709},[43,19009,1775],{"class":148},[43,19011,1778],{"class":1277},[43,19013,1564],{"class":148},[43,19015,1783],{"class":1277},[43,19017,1570],{"class":53},[43,19019,10494],{"class":1277},[1992,19021,19022],{},"If you introduced 5% chaos, this query should return a small number of invalid records — just enough to confirm your validation layer is working as expected. Let's run the full pipeline and see if the validation layer catches any errors:",[3260,19024,19025,19041],{},[3263,19026,19027],{"icon":3265,"label":3266},[33,19028,19030],{"className":2054,"code":19029,"language":2056,"meta":38,"style":38},"bruin run orders-performance\n",[40,19031,19032],{"__ignoreMap":38},[43,19033,19034,19036,19038],{"class":45,"line":46},[43,19035,2091],{"class":2063},[43,19037,3163],{"class":57},[43,19039,19040],{"class":57}," orders-performance\n",[3263,19042,19043],{"icon":3324,"label":3325},[3409,19044,19045],{},[33,19046,19048],{"className":2054,"code":19047,"language":2056,"meta":38,"style":38},"bruin run orders-performance\nAnalyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found                                                                                                                                                                   \n\n✓ Successfully validated 15 assets across 1 pipeline, all good.                                                                                                                     \n                                                                                                                                                                                    \nInterval: 2025-10-18T00:00:00Z - 2025-10-18T23:59:59Z\n\nStarting the pipeline execution...\n\n...\n\nPASS raw.products \nPASS stg.products \nPASS raw.customers \nPASS stg.customers \nPASS mart.customers_by_age \nPASS mart.customers_by_country \nPASS raw.product_variants \nPASS stg.product_variants F\nPASS raw.orders \nPASS stg.orders \nPASS raw.order_items \nPASS stg.order_items \nPASS mart.sales_daily .....\nUPSTREAM FAILED mart.product_performance UUUUUUU\nUPSTREAM FAILED mart.variant_profitability UUUUUUUUU\n\n\nbruin run completed with failures in 13.545s\n\n ✗ Assets executed      1 failed due to checks / 12 succeeded / 2 skipped\n ✗ Quality checks       1 failed / 5 succeeded / 16 skipped\n\n\n1 assets failed\n└── stg.product_variants\n    └── validate product variant sizes custom check - custom check 'validate product variant sizes' has returned 36 instead of the expected 0\n\n",[40,19049,19050,19058,19078,19082,19090,19100,19104,19128,19132,19142,19146,19156,19160,19164,19168,19176,19184,19192,19200,19208,19216,19224,19233,19241,19249,19257,19265,19273,19286,19297,19301,19305,19323,19327,19366,19391,19395,19399,19408,19416],{"__ignoreMap":38},[43,19051,19052,19054,19056],{"class":45,"line":46},[43,19053,2091],{"class":2063},[43,19055,3163],{"class":57},[43,19057,19040],{"class":57},[43,19059,19060,19062,19064,19066,19068,19070,19072,19074,19076],{"class":45,"line":61},[43,19061,9538],{"class":2063},[43,19063,9541],{"class":57},[43,19065,9544],{"class":57},[43,19067,1312],{"class":53},[43,19069,9549],{"class":57},[43,19071,1590],{"class":53},[43,19073,9554],{"class":57},[43,19075,9557],{"class":148},[43,19077,9560],{"class":57},[43,19079,19080],{"class":45,"line":70},[43,19081,244],{"emptyLinePlaceholder":243},[43,19083,19084,19086,19088],{"class":45,"line":78},[43,19085,9569],{"class":2063},[43,19087,9572],{"class":57},[43,19089,9575],{"class":1277},[43,19091,19092,19094,19096,19098],{"class":45,"line":86},[43,19093,9580],{"class":2063},[43,19095,9583],{"class":57},[43,19097,15942],{"class":57},[43,19099,15945],{"class":1277},[43,19101,19102],{"class":45,"line":94},[43,19103,244],{"emptyLinePlaceholder":243},[43,19105,19106,19108,19110,19112,19114,19116,19118,19120,19122,19124,19126],{"class":45,"line":108},[43,19107,9595],{"class":2063},[43,19109,9598],{"class":57},[43,19111,9601],{"class":57},[43,19113,9557],{"class":148},[43,19115,9481],{"class":57},[43,19117,9608],{"class":57},[43,19119,1003],{"class":148},[43,19121,9613],{"class":57},[43,19123,9616],{"class":57},[43,19125,15972],{"class":57},[43,19127,15975],{"class":1277},[43,19129,19130],{"class":45,"line":119},[43,19131,15980],{"class":1277},[43,19133,19134,19136,19138,19140],{"class":45,"line":129},[43,19135,9628],{"class":2063},[43,19137,15987],{"class":57},[43,19139,9634],{"class":57},[43,19141,15992],{"class":57},[43,19143,19144],{"class":45,"line":140},[43,19145,244],{"emptyLinePlaceholder":243},[43,19147,19148,19150,19152,19154],{"class":45,"line":152},[43,19149,9642],{"class":2063},[43,19151,9541],{"class":57},[43,19153,9544],{"class":57},[43,19155,9649],{"class":57},[43,19157,19158],{"class":45,"line":162},[43,19159,244],{"emptyLinePlaceholder":243},[43,19161,19162],{"class":45,"line":170},[43,19163,9713],{"class":1418},[43,19165,19166],{"class":45,"line":182},[43,19167,244],{"emptyLinePlaceholder":243},[43,19169,19170,19172,19174],{"class":45,"line":374},[43,19171,9722],{"class":2063},[43,19173,9725],{"class":57},[43,19175,9728],{"class":1277},[43,19177,19178,19180,19182],{"class":45,"line":382},[43,19179,9722],{"class":2063},[43,19181,13953],{"class":57},[43,19183,9728],{"class":1277},[43,19185,19186,19188,19190],{"class":45,"line":392},[43,19187,9722],{"class":2063},[43,19189,9735],{"class":57},[43,19191,9728],{"class":1277},[43,19193,19194,19196,19198],{"class":45,"line":399},[43,19195,9722],{"class":2063},[43,19197,13980],{"class":57},[43,19199,9728],{"class":1277},[43,19201,19202,19204,19206],{"class":45,"line":410},[43,19203,9722],{"class":2063},[43,19205,16746],{"class":57},[43,19207,9728],{"class":1277},[43,19209,19210,19212,19214],{"class":45,"line":417},[43,19211,9722],{"class":2063},[43,19213,16737],{"class":57},[43,19215,9728],{"class":1277},[43,19217,19218,19220,19222],{"class":45,"line":425},[43,19219,9722],{"class":2063},[43,19221,9762],{"class":57},[43,19223,9728],{"class":1277},[43,19225,19226,19228,19230],{"class":45,"line":430},[43,19227,9722],{"class":2063},[43,19229,13989],{"class":57},[43,19231,19232],{"class":57}," F\n",[43,19234,19235,19237,19239],{"class":45,"line":438},[43,19236,9722],{"class":2063},[43,19238,9744],{"class":57},[43,19240,9728],{"class":1277},[43,19242,19243,19245,19247],{"class":45,"line":446},[43,19244,9722],{"class":2063},[43,19246,13962],{"class":57},[43,19248,9728],{"class":1277},[43,19250,19251,19253,19255],{"class":45,"line":456},[43,19252,9722],{"class":2063},[43,19254,9753],{"class":57},[43,19256,9728],{"class":1277},[43,19258,19259,19261,19263],{"class":45,"line":464},[43,19260,9722],{"class":2063},[43,19262,13971],{"class":57},[43,19264,9728],{"class":1277},[43,19266,19267,19269,19271],{"class":45,"line":472},[43,19268,9722],{"class":2063},[43,19270,16727],{"class":57},[43,19272,16730],{"class":57},[43,19274,19275,19278,19281,19283],{"class":45,"line":483},[43,19276,19277],{"class":2063},"UPSTREAM",[43,19279,19280],{"class":57}," FAILED",[43,19282,16765],{"class":57},[43,19284,19285],{"class":57}," UUUUUUU\n",[43,19287,19288,19290,19292,19294],{"class":45,"line":494},[43,19289,19277],{"class":2063},[43,19291,19280],{"class":57},[43,19293,16755],{"class":57},[43,19295,19296],{"class":57}," UUUUUUUUU\n",[43,19298,19299],{"class":45,"line":506},[43,19300,244],{"emptyLinePlaceholder":243},[43,19302,19303],{"class":45,"line":517},[43,19304,244],{"emptyLinePlaceholder":243},[43,19306,19307,19309,19311,19313,19315,19318,19320],{"class":45,"line":525},[43,19308,2091],{"class":2063},[43,19310,3163],{"class":57},[43,19312,9777],{"class":57},[43,19314,9554],{"class":57},[43,19316,19317],{"class":57}," failures",[43,19319,9783],{"class":57},[43,19321,19322],{"class":57}," 13.545s\n",[43,19324,19325],{"class":45,"line":538},[43,19326,244],{"emptyLinePlaceholder":243},[43,19328,19329,19332,19334,19336,19339,19342,19345,19348,19350,19353,19356,19359,19361,19363],{"class":45,"line":550},[43,19330,19331],{"class":2063}," ✗",[43,19333,9798],{"class":57},[43,19335,9801],{"class":57},[43,19337,19338],{"class":148},"      1",[43,19340,19341],{"class":57}," failed",[43,19343,19344],{"class":57}," due",[43,19346,19347],{"class":57}," to",[43,19349,14041],{"class":57},[43,19351,19352],{"class":57}," /",[43,19354,19355],{"class":148}," 12",[43,19357,19358],{"class":57}," succeeded",[43,19360,19352],{"class":57},[43,19362,6191],{"class":148},[43,19364,19365],{"class":57}," skipped\n",[43,19367,19368,19370,19372,19374,19376,19378,19380,19383,19385,19387,19389],{"class":45,"line":558},[43,19369,19331],{"class":2063},[43,19371,14038],{"class":57},[43,19373,14041],{"class":57},[43,19375,14044],{"class":148},[43,19377,19341],{"class":57},[43,19379,19352],{"class":57},[43,19381,19382],{"class":148}," 5",[43,19384,19358],{"class":57},[43,19386,19352],{"class":57},[43,19388,17392],{"class":148},[43,19390,19365],{"class":57},[43,19392,19393],{"class":45,"line":568},[43,19394,244],{"emptyLinePlaceholder":243},[43,19396,19397],{"class":45,"line":578},[43,19398,244],{"emptyLinePlaceholder":243},[43,19400,19401,19403,19405],{"class":45,"line":588},[43,19402,4993],{"class":2063},[43,19404,9481],{"class":57},[43,19406,19407],{"class":57}," failed\n",[43,19409,19410,19413],{"class":45,"line":595},[43,19411,19412],{"class":2063},"└──",[43,19414,19415],{"class":57}," stg.product_variants\n",[43,19417,19418,19421,19424,19427,19430,19433,19436,19438,19440,19442,19444,19446,19449,19451,19454,19457,19460,19463,19466,19468,19471],{"class":45,"line":606},[43,19419,19420],{"class":2063},"    └──",[43,19422,19423],{"class":57}," validate",[43,19425,19426],{"class":57}," product",[43,19428,19429],{"class":57}," variant",[43,19431,19432],{"class":57}," sizes",[43,19434,19435],{"class":57}," custom",[43,19437,8418],{"class":57},[43,19439,9634],{"class":57},[43,19441,19435],{"class":57},[43,19443,8418],{"class":57},[43,19445,1312],{"class":53},[43,19447,19448],{"class":57},"validate product variant sizes",[43,19450,1590],{"class":53},[43,19452,19453],{"class":57}," has",[43,19455,19456],{"class":57}," returned",[43,19458,19459],{"class":148}," 36",[43,19461,19462],{"class":57}," instead",[43,19464,19465],{"class":57}," of",[43,19467,9541],{"class":57},[43,19469,19470],{"class":57}," expected",[43,19472,911],{"class":148},[1973,19474,19476,19477],{"id":19475},"_10-conclusion-next-steps","10) ",[1977,19478,19479],{},"Conclusion & Next Steps",[1992,19481,19482,19483,19486,19487,2197,19490,2204,19493,19495],{},"You’ve just built a fully operational, production-style ",[1977,19484,19485],{},"e-commerce analytics pipeline"," using ",[1977,19488,19489],{},"Bruin",[1977,19491,19492],{},"Postgres",[1977,19494,8833],{}," — from ingestion to quality validation and final metrics delivery.",[1992,19497,19498],{},"At this stage, you should now be comfortable with:",[2028,19500,19501,19508,19519,19526],{},[2031,19502,19503,19504,19507],{},"Defining ",[1977,19505,19506],{},"data generation scripts"," that mirror real-world volume and variety.",[2031,19509,8819,19510,1587,19513,2197,19515,19518],{},[1977,19511,19512],{},"Bruin assets",[40,19514,8805],{},[40,19516,19517],{},".asset.sql",") to model ingestion, staging, and mart layers.",[2031,19520,19521,19522,19525],{},"Declaring ",[1977,19523,19524],{},"data quality rules"," and custom validation queries.",[2031,19527,19528,19529,4556],{},"Executing and debugging pipelines locally with the ",[1977,19530,8702],{},[1992,19532,19533],{},[1977,19534,19535],{},"Where to Go From Here:",[19537,19538,19540,19545,19555,19589,19593,19600,19604,19607],"steps",{"level":19539},"4",[19541,19542,19544],"h4",{"id":19543},"integrate-chaos-data","Integrate Chaos Data",[1992,19546,19547,19548,19550,19551,19554],{},"Re-run your generator with a ",[40,19549,4920],{}," above zero to inject controlled invalid data.\nYou can then observe how ",[1977,19552,19553],{},"staging and custom checks"," detect anomalies automatically — this is your first taste of data observability in practice.",[33,19556,19558],{"className":2054,"code":19557,"language":2056,"meta":38,"style":38},"uv run generate_data.py --dsn postgresql://postgres:postgres@localhost:5432/postgres --chaos-percent 10\nbruin run orders-performance --tag staging\n",[40,19559,19560,19577],{"__ignoreMap":38},[43,19561,19562,19564,19566,19568,19570,19572,19574],{"class":45,"line":46},[43,19563,2041],{"class":2063},[43,19565,3163],{"class":57},[43,19567,8233],{"class":57},[43,19569,8236],{"class":57},[43,19571,18416],{"class":57},[43,19573,18419],{"class":57},[43,19575,19576],{"class":148}," 10\n",[43,19578,19579,19581,19583,19585,19587],{"class":45,"line":61},[43,19580,2091],{"class":2063},[43,19582,3163],{"class":57},[43,19584,9521],{"class":57},[43,19586,9524],{"class":57},[43,19588,13659],{"class":57},[19541,19590,19592],{"id":19591},"add-incremental-loads","Add Incremental Loads",[1992,19594,19595,19596,19599],{},"Refactor your ingestion assets to use ",[40,19597,19598],{},"WHERE updated_at >= last_ingest_time",".\nBruin supports parameterized variables and time windows for efficient, repeatable data refreshes.",[19541,19601,19603],{"id":19602},"extend-the-mart-layer","Extend the Mart Layer",[1992,19605,19606],{},"Experiment with new KPIs:",[2028,19608,19609,19619,19628],{},[2031,19610,19611,19614,19615,9834,19617],{},[1977,19612,19613],{},"Repeat Purchase Rate"," → joining ",[40,19616,4360],{},[40,19618,4297],{},[2031,19620,19621,19624,19625],{},[1977,19622,19623],{},"Top Revenue Categories"," → grouping by ",[40,19626,19627],{},"product.category",[2031,19629,19630,19633,19634,19637],{},[1977,19631,19632],{},"Profitability Over Time"," → time-window analysis of the ",[40,19635,19636],{},"mart.variant_profitability"," table",[1992,19639,19640,19641,19644,19645,19648,19649,19653],{},"Don't forget to ",[1977,19642,19643],{},"share your thoughts"," or any ",[1977,19646,19647],{},"issue"," with the community at our ",[2044,19650,19652],{"href":19651},"#","Slack Community","!",[19655,19656,19657],"style",{},"html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}",{"title":38,"searchDepth":46,"depth":61,"links":19659},[19660,19661,19662,19663,19664,19665,19666,19667,19668,19669,19670],{"id":1975,"depth":61,"text":1979},{"id":2025,"depth":61,"text":2026},{"id":2114,"depth":61,"text":2115},{"id":3142,"depth":61,"text":3143},{"id":3376,"depth":61,"text":3377},{"id":8688,"depth":61,"text":8689},{"id":8815,"depth":61,"text":8816},{"id":9819,"depth":61,"text":9820},{"id":14052,"depth":61,"text":14053},{"id":18340,"depth":61,"text":18341},{"id":19475,"depth":61,"text":19671},"10) Conclusion & Next Steps","Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB","md",null,{},{"icon":22},{"title":19,"description":19672},"GU-2HTAYap7KAKRCwkzL8Tx7Zz1DOTNMxx_yN5cXchI",[19680,19674],{"title":10,"path":6,"stem":7,"description":19681,"icon":11,"children":-1},"Welcome to Bruin University.",1760934909921]